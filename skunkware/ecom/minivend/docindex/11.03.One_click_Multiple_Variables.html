<HTML>
<HEAD>
<TITLE>One-click Multiple Variables</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF">
<H3><A HREF="index.html">Index</A>&nbsp;&nbsp;<A HREF="11.00.FORMS_AND_MINIVEND.html">Up</A>&nbsp;&nbsp;<A HREF="11.02.Form_Actions.html">&lt;&lt;</A>&nbsp;&nbsp;<A HREF="11.04.Checks_and_Selections.html">&gt;&gt;</A>&nbsp;&nbsp;</H3>
<HR>
<H2><A NAME="One_click_Multiple_Variables">One-click Multiple Variables</A></H2>
<P>
MiniVend can set multiple variables with a single button or form control.
You first define the variable set (or profile, as in search and order
profiles) inside a scratch variable:

<P>
<PRE>  [set Search by Category]
  mv_search_field=category
  mv_search_file=categories
  mv_todo=search
  [/set]
</PRE>
<P>
The special variable <CODE>mv_click</CODE> sets variables just as if they were put in on the form. It is controlled by
a single button, as in:

<P>
<PRE>    &lt;INPUT TYPE=submit NAME=mv_click VALUE=&quot;Search by Category&quot;&gt;
</PRE>
<P>
When the user clicks the submit button, all three variables will take on
the values defined in the ``Search by Category'' scratch variable. You can
set the scratch variable on the same form as the button is on -- in fact
that is recommended for clarity.

<P>
The <CODE>mv_click</CODE> variable will not be carried from form to form, it must be set on the form
being submitted.

<P>
The special variable <CODE>mv_check</CODE> sets variables for the form actions
<EM>checkout, control, refresh, return, search,</EM> and <EM>submit</EM>. This function operates <EM>after</EM> the values are set from the form, including the ones set by <CODE>mv_click</CODE>, and can be used to condition input to search routines or orders.

<P>
The variable sets can contain and be generated by most MiniVend tags -- the
profile is interpolated for MiniVend tags before being used. This may not
operate how you would expect -- for instance, if you set:

<P>
<PRE>    [set check]
    [cgi name=mv_todo set=bar hide=1]
    mv_todo=search
    [if cgi mv_todo eq 'search']
    do something
    [/if]
    [/set]
</PRE>
<P>
The if condition is guaranteed to be false, because the tag interpretation
takes place before the evaluation of the variable setting.

<P>
Any setting of variables already containing a value will overwrite the
variable, so to build sets of fields (as in mv_search_field and
mv_return_fields) you must use comma separation if that is supported for
the field.

<P>
It is very convenient to use <CODE>mv_click</CODE> as a trigger for embedded Perl:

<P>
<PRE>    &lt;FORM ...
    &lt;INPUT TYPE=hidden NAME=mv_check VALUE=&quot;Invalid Input&quot;&gt;
    ...
    &lt;/FORM&gt;
</PRE>
<P>
<PRE>    [set Invalid Input]
    [perl]
    my $type        = $CGI-&gt;{mv_searchtype};
    my $spell_check = $CGI-&gt;{mv_spelling_errors};
    my $out = '';
    if($spell_check and $type eq 'text') {
        $CGI-&gt;{mv_todo}     = 'return';
        $CGI-&gt;{mv_nextpage} = 'special/cannot_spell_check';
    }
    return;
    [/perl]
    [/set]
</PRE>
<P>
<HR>

<P ALIGN=CENTER><H3><A HREF="index.html">Index</A>&nbsp;&nbsp;<A HREF="11.00.FORMS_AND_MINIVEND.html">Up</A>&nbsp;&nbsp;<A HREF="11.02.Form_Actions.html">&lt;&lt;</A>&nbsp;&nbsp;<A HREF="11.04.Checks_and_Selections.html">&gt;&gt;</A>&nbsp;&nbsp;</H3></BODY></HTML>
