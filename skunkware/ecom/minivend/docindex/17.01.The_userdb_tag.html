<HTML>
<HEAD>
<TITLE>The [userdb ...] tag</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF">
<H3><A HREF="index.html">Index</A>&nbsp;&nbsp;<A HREF="17.00.USER_DATABASE.html">Up</A>&nbsp;&nbsp;<A HREF="17.02.Setting_defaults_with_the_UserDB.html">&gt;&gt;</A>&nbsp;&nbsp;</H3>
<HR>
<H2><A NAME="The_userdb_tag">The [userdb ...] tag</A></H2>
<P>
MiniVend provides a <A HREF="#item__userdb_">[userdb ...]</A> tag to access the UserDB functions.

<P>
<PRE> [userdb
        function=function_name
        username=&quot;username&quot;*
        assign_username=1
        username_mask=REGEX*
        password=&quot;password&quot;*
        verify=&quot;password&quot;*
        oldpass=&quot;old password&quot;*
        crypt=&quot;1|0&quot;*
        shipping=&quot;fields for shipping save&quot;
        billing=&quot;fields for billing save&quot;
        preferences=&quot;fields for preferences save&quot;
        ignore_case=&quot;1|0&quot;*
        force_lower=1
        param1=value*
        param2=value*
        ...
        ]
</PRE>
<P>
* Optional

<P>
It is normally called in an <CODE>mv_click</CODE> or <CODE>mv_check</CODE> setting, as in:

<P>
<PRE>    [set Login]
    mv_todo=return
    mv_nextpage=welcome
    [userdb function=login]
    [/set]
</PRE>
<P>
<PRE>    &lt;FORM ACTION=&quot;[process-target]&quot; METHOD=POST&gt;
    &lt;INPUT TYPE=hidden NAME=mv_click VALUE=Login&gt;
    Username &lt;INPUT NAME=mv_username SIZE=10&gt;
    Password &lt;INPUT NAME=mv_password SIZE=10&gt;
    &lt;/FORM&gt;
</PRE>
<P>
There are several global parameters that apply to any use of the <A HREF="#item_userdb">userdb</A> functions. Most importantly, by default the database table is set to be <EM>userdb</EM>. If you must use another table name, then you should include a <CODE>database=table</CODE> parameter with any call to <A HREF="#item_userdb">userdb</A>. The global parameters (default in parens):

<P>
<PRE>    database     Sets user database table (userdb)
    show         Show the return value of certain functions
                 or the error message, if any (0)
    force_lower  Force possibly upper-case database fields
                 to lower case session variable names (0)
    billing      Set the billing fields (see Accounts)
    shipping     Set the shipping fields (see Address Book)
    preferences  Set the preferences fields (see Preferences)
    bill_field   Set field name for accounts (accounts)
    addr_field   Set field name for address book (address_book)
    pref_field   Set field name for preferences (preferences)
    cart_field   Set field name for cart storage (carts)
    pass_field   Set field name for password (password)
    time_field   Set field for storing last login time (time)
    expire_field Set field for expiration date (expire_date)
    acl          Set field for simple access control storage (acl)
    file_acl     Set field for file access control storage (file_acl)
    db_acl       Set field for database access control storage (db_acl)
</PRE>
<P>
By default the system <CODE>crypt()</CODE> call will be used to compare the
password. This is best for security, but the passwords in the user database
will not be human readable.

<P>
If you don't keep critical information and don't do MiniVend administration
via the <CODE>UserDB</CODE> capability, then you may wish to use the &lt;UserDB&gt; directive
(described below) to set encryption off by default:

<P>
<PRE>    UserDB   default   crypt   0
</PRE>
<P>
That will set encryption off by default. You can still set encryption on by
passing <CODE>crypt=1</CODE> with any call to a <A HREF="#item_new_account">new_account</A>, <A HREF="#item_change_pass">change_pass</A>, or <A HREF="#item_login">login</A> call.

<P>
<HR>

<P ALIGN=CENTER><H3><A HREF="index.html">Index</A>&nbsp;&nbsp;<A HREF="17.00.USER_DATABASE.html">Up</A>&nbsp;&nbsp;<A HREF="17.02.Setting_defaults_with_the_UserDB.html">&gt;&gt;</A>&nbsp;&nbsp;</H3></BODY></HTML>
