  <HTML>
  <HEAD>
  <!-- This HTML file has been created by texi2html 1.52 (hacked by david@detron.se)
     from manual.texi on 11 January 2000 -->

  <TITLE>MySQL Reference Manual for version 3.23.9-alpha.</TITLE>
  </HEAD>
  <BODY BGCOLOR=#FFFFFF TEXT=#000000 LINK=#101090 VLINK=#7030B0>
<H1><STRONG>MySQL</STRONG> Reference Manual for version 3.23.9-alpha.</H1>
<P>
<P><HR><P>
<IMG SRC="Img/mysql-logo.gif">


<H1><A NAME="Introduction" HREF="manual_toc.html#Introduction">1  General Information about MySQL</A></H1>

<P>
This is the <STRONG>MySQL</STRONG> reference manual; it documents <STRONG>MySQL</STRONG>
version 3.23.9-alpha.

</P>

<P>
<STRONG>MySQL</STRONG> is a very fast, multi-threaded, multi-user and robust SQL
(Structured Query Language) database server.

</P>
<P>
For Unix and OS/2 platforms, <STRONG>MySQL</STRONG> is basically free; for Microsoft
platforms you must get a <STRONG>MySQL</STRONG> license after a trial time of 30
days. See section <A HREF="manual.html#Licensing_and_Support">3  MySQL licensing and support</A>.

</P>
<P>
<a HREF="http://www.mysql.com/"> The <STRONG>MySQL</STRONG> home page</a>
provides the latest information about <STRONG>MySQL</STRONG>.

</P>
<P>
For a discussion of <STRONG>MySQL</STRONG>'s capabilities, see section <A HREF="manual.html#Features">1.5  The main features of MySQL</A>.

</P>
<P>
For installation instructions, see section <A HREF="manual.html#Installing">4  Installing MySQL</A>. For tips on porting
<STRONG>MySQL</STRONG> to new machines or operating systems, see section <A HREF="manual.html#Porting">G  Comments on porting to other systems</A>.

</P>
<P>
For information about upgrading from a 3.21 release, see
section <A HREF="manual.html#Upgrading-from-3.21">4.16.2  Upgrading from a 3.21 version to 3.22</A>.

</P>
<P>
For a tutorial introduction to MySQL, see
section <A HREF="manual.html#Tutorial">8  MySQL Tutorial</A>.

</P>
<P>
For examples of SQL and benchmarking information, see the benchmarking
directory (<TT>`sql-bench'</TT> in the distribution).

</P>
<P>
For a history of new features and bug fixes, see section <A HREF="manual.html#News">D  MySQL change history</A>.

</P>
<P>
For a list of currently known bugs and misfeatures, see section <A HREF="manual.html#Bugs">E  Known errors and design deficiencies in MySQL</A>.

</P>
<P>
For future plans, see section <A HREF="manual.html#TODO">F  List of things we want to add to MySQL in the future (The TODO)</A>.

</P>
<P>
For a list of all the contributors to this project, see section <A HREF="manual.html#Credits">C  Contributors to MySQL</A>.

</P>
<P>
<STRONG>IMPORTANT:</STRONG>

</P>
<P>
Send error (often called bugs) reports, questions and comments to the
mailing list at <a HREF="mailto:mysql@lists.mysql.com">mysql@lists.mysql.com</a>.  See section <A HREF="manual.html#Bug_reports">2.3  How to report bugs or problems</A>.

</P>
<P>
For source distributions, the <CODE>mysqlbug</CODE> script can be found in the
<TT>`scripts'</TT> directory.  For binary distributions, <CODE>mysqlbug</CODE> can
be found in the <TT>`bin'</TT> directory.

</P>
<P>
If you have any suggestions concerning additions or corrections to this
manual, please send them to the manual team at
(<a HREF="mailto:docs@mysql.com">docs@mysql.com</a>).

</P>
<P>
<A NAME="IDX1"></A>


<H2><A NAME="What-is" HREF="manual_toc.html#What-is">1.1  What is MySQL?</A></H2>

<P>
<STRONG>MySQL</STRONG> is a true multi-user, multi-threaded SQL database
server. SQL (Structured Query Language) is the most popular and
standardized database language in the world. <STRONG>MySQL</STRONG> is a
client/server implementation that consists of a server daemon
<CODE>mysqld</CODE> and many different client programs and libraries.

</P>
<P>
SQL is a standardized language that makes it easy to store, update and
access information. For example, you can use SQL to retrieve product
information and store customer information for a web site.
<STRONG>MySQL</STRONG> is also fast and flexible enough to allow you to store
logs and pictures in it.

</P>
<P>
The main goals of <STRONG>MySQL</STRONG> are speed, robustness and ease of use.
<STRONG>MySQL</STRONG> was originally developed because we needed a SQL server
that could handle very large databases an order of magnitude faster than
what any database vendor could offer to us on inexpensive hardware. We
have now been using <STRONG>MySQL</STRONG> since 1996 in an environment with
more than 40 databases containing 10,000 tables, of which more than 500
have more than 7 million rows. This is about 100 gigabytes of
mission-critical data.

</P>
<P>
The base upon which <STRONG>MySQL</STRONG> is built is a set of routines that
have been used in a highly demanding production environment for many
years.  Although <STRONG>MySQL</STRONG> is still under development, it already
offers a rich and highly useful function set.

</P>
<P>
<A NAME="IDX2"></A>
<A NAME="IDX3"></A>
The official way to pronounce <STRONG>MySQL</STRONG> is ``My Ess Que Ell'' (Not
MY-SEQUEL).

</P>
<P>
<A NAME="IDX4"></A>


<H2><A NAME="Manual-info" HREF="manual_toc.html#Manual-info">1.2  About this manual</A></H2>

<P>
This manual is currently available in Texinfo, plain text, Info, HTML,
PostScript and PDF versions.  Because of their size, PostScript and PDF
versions are not included with the main <STRONG>MySQL</STRONG> distribution, but
are available for separate download at
<a HREF="http://www.mysql.com">http://www.mysql.com</a>.

</P>
<P>
The primary document is the Texinfo file. The HTML version is produced
automatically with a modified version of <CODE>texi2html</CODE>. The plain
text and Info versions are produced with <CODE>makeinfo</CODE>. The Postscript
version is produced using <CODE>texi2dvi</CODE> and <CODE>dvips</CODE>. The PDF
version is produced with <CODE>pdftex</CODE>.

</P>
<P>
This manual is written and maintained by David Axmark, Michael (Monty)
Widenius and Paul DuBois. For other contributors, see section <A HREF="manual.html#Credits">C  Contributors to MySQL</A>.

</P>


<H3><A NAME="Manual_conventions" HREF="manual_toc.html#Manual_conventions">1.2.1  Conventions used in this manual</A></H3>

<P>
This manual uses certain typographical conventions:

</P>
<DL COMPACT>

<DT><CODE>constant</CODE>
<DD>
Constant-width font is used for command names and options; SQL statements;
database, table and column names; C and Perl code; and environment variables.
Example: ``To see how <CODE>mysqladmin</CODE> works, invoke it with the
<CODE>--help</CODE> option.''

<DT><TT>`filename'</TT>
<DD>
Constant-width font with surrounding quotes is used for filenames and
pathnames.  Example: ``The distribution is installed under the
<TT>`/usr/local/'</TT> directory.''

<DT><SAMP>`c'</SAMP>
<DD>
Constant-width font with surrounding quotes is also used to indicate
character sequences.  Example: ``To specify a wildcard, use the <SAMP>`%'</SAMP>
character.''

<DT><EM>italic</EM>
<DD>
Italic font is used for emphasis, <EM>like this</EM>.

<DT><STRONG>boldface</STRONG>
<DD>
Boldface font is used for access privilege names (e.g., ``do not grant the
<STRONG>process</STRONG> privilege lightly'') and to convey <STRONG>especially strong
emphasis</STRONG>.
</DL>

<P>
When commands are shown that are meant to be executed by a particular
program, the program is indicated by the prompt shown with the command.  For
example, <CODE>shell&#62;</CODE> indicates a command that you execute from your login
shell, and <CODE>mysql&#62;</CODE> indicates a command that you execute from the
<CODE>mysql</CODE> client:

</P>

<PRE>
shell&#62; type a shell command here
mysql&#62; type a mysql command here
</PRE>

<P>
Shell commands are shown using Bourne shell syntax.  If you are using a
<CODE>csh</CODE>-style shell, you may need to issue commands slightly differently.
For example, the sequence to set an environment variable and run a command
looks like this in Bourne shell syntax:

</P>

<PRE>
shell&#62; VARNAME=value some_command
</PRE>

<P>
For <CODE>csh</CODE>, you would execute the sequence like this:

</P>

<PRE>
shell&#62; setenv VARNAME value
shell&#62; some_command
</PRE>

<P>
Database, table and column names often must be substituted into commands.  To
indicate that such substitution is necessary, this manual uses
<CODE>db_name</CODE>, <CODE>tbl_name</CODE> and <CODE>col_name</CODE>.  For example, you might
see a statement like this:

</P>

<PRE>
mysql&#62; SELECT col_name FROM db_name.tbl_name;
</PRE>

<P>
This means that if you were to enter a similar statement, you would supply
your own database, table and column names, perhaps like this:

</P>

<PRE>
mysql&#62; SELECT author_name FROM biblio_db.author_list;
</PRE>

<P>
SQL statements may be written in uppercase or lowercase.  When this manual
shows a SQL statement, uppercase is used for particular keywords if those
keywords are under discussion (to emphasize them) and lowercase is used for
the rest of the statement.  So you might see the following in a discussion of
the <CODE>SELECT</CODE> statement:

</P>

<PRE>
mysql&#62; SELECT count(*) FROM tbl_name;
</PRE>

<P>
On the other hand, in a discussion of the <CODE>COUNT()</CODE> function, the
statement would be written like this:

</P>

<PRE>
mysql&#62; select COUNT(*) from tbl_name;
</PRE>

<P>
If no particular emphasis is intended, all keywords are written uniformly
in uppercase.

</P>
<P>
In syntax descriptions, square brackets (<SAMP>`['</SAMP> and <SAMP>`]'</SAMP>) are used
to indicate optional words or clauses:

</P>

<PRE>
DROP TABLE [IF EXISTS] tbl_name
</PRE>

<P>
When a syntax element consists of a number of alternatives, the alternatives
are separated by vertical bars (<SAMP>`|'</SAMP>).  When one member from a set of
choices may be chosen, the alternatives are listed within square brackets.
When one member from a set of choices must be chosen, the alternatives are
listed within braces (<SAMP>`{'</SAMP> and <SAMP>`}'</SAMP>):

</P>

<PRE>
TRIM([[BOTH | LEADING | TRAILING] [remstr] FROM] str)
{DESCRIBE | DESC} tbl_name {col_name | wild}
</PRE>

<P>
<A NAME="IDX5"></A>


<H2><A NAME="History" HREF="manual_toc.html#History">1.3  History of MySQL</A></H2>

<P>
We once started off with the intention of using <CODE>mSQL</CODE> to connect to our
tables using our own fast low-level (ISAM) routines. However, after some
testing we came to the conclusion that <CODE>mSQL</CODE> was not fast enough or
flexible enough for our needs. This resulted in a new SQL interface to our
database but with almost the same API interface as <CODE>mSQL</CODE>. This API was
chosen to ease porting of third-party code.

</P>
<P>
The derivation of the name <STRONG>MySQL</STRONG> is not perfectly clear.  Our base
directory and a large number of our libraries and tools have had the prefix
``my'' for well over 10 years. However, Monty's daughter (some years younger)
is also named My. So which of the two gave its name to <STRONG>MySQL</STRONG> is
still a mystery, even for us.

</P>


<H2><A NAME="MySQL-Books" HREF="manual_toc.html#MySQL-Books">1.4  Books about MySQL</A></H2>

<P>
While this manual is still the right place for up to date techical
information, its primary goal is to contain everything there is to know
about <STRONG>MySQL</STRONG>. And it is sometimes nice to have a bound book to read
in bed or while you travel. Here are a list of books about MySQL (in
English).

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD>Title </TD><TD> <a HREF="http://www2.newriders.com/cfm/prod_book.cfm?RecordID=584">MySQL</a>
</TR NOSAVE>
<TR><TD>Publisher </TD><TD> New Riders
</TR NOSAVE>
<TR><TD>Author </TD><TD> Paul DuBois
</TR NOSAVE>
<TR><TD>Pub Date </TD><TD> 1st Edition December 1999
</TR NOSAVE>
<TR><TD>ISBN </TD><TD> 0735709211
</TR NOSAVE>
<TR><TD>Pages </TD><TD> 800
</TR NOSAVE>
<TR><TD>Price </TD><TD> $49.99 US
</TR NOSAVE>
<TR><TD>Downloadable examples </TD><TD> <a HREF="http://www.mysql.com/Contrib/Examples/samp_db.tar.gz"> samp_db.tar.gz</a>
</TR>
</TABLE>
<P>
Foreword by Michael "Monty" Widenius, MySQL Moderator 

</P>
<P>
In MySQL, Paul DuBois provides you with a comprehensive guide to
one of the most popular relational database systems. Paul has
contributed to the online documentation for MySQL, and is an
active member of the MySQL community. The principal MySQL
developer, Monty Widenius, and a network of his fellow developers
reviewed the manuscript, providing Paul with the kind of insight
no one else could supply. 

</P>
<P>
Instead of merely giving you a general overview of MySQL, Paul
teaches you how to make the most of its capabilities. Through two
sample database applications that run throughout the book, he
gives you solutions to problems you're sure to face. He helps you
integrate MySQL efficiently with third-party tools, such as PHP
and Perl, enabling you to generate dynamic Web pages through
database queries. He teaches you to write programs that access
MySQL databases, and also provides a comprehensive set of
references to column types, operators, functions, SQL syntax,
MySQL programming, C API, Perl DBI, and PHP API. MySQL simply
gives you the kind of information you won't find anywhere else. 

</P>
<P>
If you use MySQL, this book provides you with: 

<UL>
<LI>

An introduction to MySQL and SQL 
<LI>

Coverage of MySQL's data types and how to use them 
<LI>

Thorough treatment of how to write client programs in C 
<LI>

A guide to using the Perl DBI and PHP APIs for developing
command-line and Web-based applications 
<LI>

Tips on administrative issues such as user accounts, backup,
crash recovery, and security 
<LI>

Help in choosing an ISP for MySQL access 
<LI>

A comprehensive reference for MySQL's data types, operators,
functions, and SQL statements and utilities 
<LI>

Complete reference guides for MySQL's C API, the Perl DBI API,
and PHP's MySQL-related functions
</UL>

<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD>Title </TD><TD> <a HREF="http://www.oreilly.com/catalog/msql/noframes.html">MySQL &#38; mSQL</a>
</TR NOSAVE>
<TR><TD>Publisher </TD><TD> O'Reilly
</TR NOSAVE>
<TR><TD>Authors </TD><TD> Randy Jay Yarger, George Reese &#38; Tim King
</TR NOSAVE>
<TR><TD>Pub Date </TD><TD> 1st Edition July 1999
</TR NOSAVE>
<TR><TD>ISBN </TD><TD> 1-56592-434-7, Order Number: 4347
</TR NOSAVE>
<TR><TD>Pages </TD><TD> 506
</TR NOSAVE>
<TR><TD>Price </TD><TD> $34.95
</TR>
</TABLE>

<P>
This book teaches you how to use MySQL and mSQL, two popular and
robust database products that support key subsets of SQL on both Linux
and UNIX systems. Anyone who knows basic C, Java, Perl, or Python can
write a program to interact with a database, either as a stand-alone
application or through a Web page. This book takes you through the
whole process, from installation and configuration to programming
interfaces and basic administration.  Includes ample tutorial
material.

</P>


<H2><A NAME="Features" HREF="manual_toc.html#Features">1.5  The main features of MySQL</A></H2>

<P>
The following list describes some of the important characteristics
of <STRONG>MySQL</STRONG>:

</P>

<UL>
<LI>

Fully multi-threaded using kernel threads. That means it easily can
use multiple CPUs if available.

<LI>

C, C++, Eiffel, Java, Perl, PHP, Python and TCL APIs. See section <A HREF="manual.html#Clients">20  MySQL client tools and APIs</A>.

<LI>

Works on many different platforms. See section <A HREF="manual.html#Which_OS">4.2  Operating systems supported by MySQL</A>.

<LI>

Many column types: signed/unsigned integers 1, 2, 3, 4 and 8 bytes
long, <CODE>FLOAT</CODE>, <CODE>DOUBLE</CODE>, <CODE>CHAR</CODE>, <CODE>VARCHAR</CODE>,
<CODE>TEXT</CODE>, <CODE>BLOB</CODE>, <CODE>DATE</CODE>, <CODE>TIME</CODE>, <CODE>DATETIME</CODE>,
<CODE>TIMESTAMP</CODE>, <CODE>YEAR</CODE>, <CODE>SET</CODE> and <CODE>ENUM</CODE> types. See section <A HREF="manual.html#Column_types">7.3  Column types</A>.

<LI>

Very fast joins using an optimized one-sweep multi-join.

<LI>

Full operator and function support in the <CODE>SELECT</CODE> and <CODE>WHERE</CODE>
parts of queries. Example:

<PRE>
mysql&#62; SELECT CONCAT(first_name, " ", last_name) FROM tbl_name
           WHERE income/dependents &#62; 10000 AND age &#62; 30;
</PRE>

<LI>

SQL functions are implemented through a highly-optimized class library and
should be as fast as they can get! Usually there shouldn't be any memory
allocation at all after query initialization.

<LI>

Full support for SQL <CODE>GROUP BY</CODE> and <CODE>ORDER BY</CODE>
clauses. Support for group functions (<CODE>COUNT()</CODE>,
<CODE>COUNT(DISTINCT)</CODE>, <CODE>AVG()</CODE>, <CODE>STD()</CODE>, <CODE>SUM()</CODE>,
<CODE>MAX()</CODE> and <CODE>MIN()</CODE>).

<LI>

Support for <CODE>LEFT OUTER JOIN</CODE> with ANSI SQL and ODBC syntax.

<LI>

You can mix tables from different databases in the same query (as of
version 3.22).

<LI>

A privilege and password system which is very flexible and secure, and
which allows host-based verification.  Passwords are secure since all
password traffic when connecting to a server is encrypted.

<LI>

ODBC (Open-DataBase-Connectivity) for Windows95 (with source). All ODBC
2.5 functions and many others.  You can, for example, use Access to
connect to your <STRONG>MySQL</STRONG> server. See section <A HREF="manual.html#ODBC">16  MySQL ODBC Support</A>.

<LI>

Very fast B-tree disk tables with index compression.

<LI>

16 indexes per table are allowed. Each index may consist of 1 to 16 columns
or parts of columns. The maximum index length is 256 bytes (this may be
changed when compiling <STRONG>MySQL</STRONG>). An index may use a prefix of a
<CODE>CHAR</CODE> or <CODE>VARCHAR</CODE> field.

<LI>

Fixed-length and variable-length records.

<LI>

In-memory hash tables which are used as temporary tables.

<LI>

Handles large databases.  We are using <STRONG>MySQL</STRONG> with some
databases that contain 50,000,000 records.

<LI>

All columns have default values.  You can use <CODE>INSERT</CODE> to insert a
subset of a table's columns; those columns that are not explicitly given
values are set to their default values.

<LI>

Uses GNU Automake, Autoconf, and <CODE>libtool</CODE> for portability.

<LI>

Written in C and C++. Tested with a broad range of different compilers.

<LI>

A very fast thread-based memory allocation system.

<LI>

No memory leaks. Tested with a commercial memory leakage detector
(<CODE>purify</CODE>).

<LI>

Includes <CODE>myisamchk</CODE>, a very fast utility for table checking, optimization
and repair.
See section <A HREF="manual.html#Maintenance">13  Maintaining a MySQL installation</A>.

<LI>

Full support for the ISO-8859-1 Latin1 character set. For example, the
Scandinavian characters @ringaccent{a}, @"a and @"o are allowed in table and
column names.

<LI>

All data are saved in ISO-8859-1 Latin1 format. All comparisons for normal
string columns are case insensitive.

<LI>

Sorting is done according to the ISO-8859-1 Latin1 character set (the Swedish
way at the moment). It is possible to change this in the source by adding new
sort order arrays. To see an example of very advanced sorting, look at the
Czech sorting code. <STRONG>MySQL</STRONG> supports many different character sets
that can be specified at compile time.

<LI>

Aliases on tables and columns as in the SQL92 standard.

<LI>

<CODE>DELETE</CODE>, <CODE>INSERT</CODE>, <CODE>REPLACE</CODE>, and <CODE>UPDATE</CODE> return
how many rows were changed (affected).

<LI>

Function names do not clash with table or column names. For example, <CODE>ABS</CODE>
is a valid column name. The only restriction is that for a function call, no
spaces are allowed between the function name and the <SAMP>`('</SAMP> that follows it.
See section <A HREF="manual.html#Reserved_words">7.31  Is MySQL picky about reserved words?</A>.

<LI>

All <STRONG>MySQL</STRONG> programs can be invoked with the <CODE>--help</CODE> or <CODE>-?</CODE>
options to obtain online assistance.

<LI>

The server can provide error messages to clients in many
languages. See section <A HREF="manual.html#Languages">9.1  What languages are supported by MySQL?</A>.

<LI>

Clients connect to the <STRONG>MySQL</STRONG> server using TCP/IP connections or Unix
sockets, or named pipes under NT.

<LI>

The <STRONG>MySQL</STRONG>-specific <CODE>SHOW</CODE> command can be used to retrieve
information about databases, tables and indexes. The <CODE>EXPLAIN</CODE> command
can be used to determine how the optimizer resolves a query.
</UL>

<P>
<A NAME="IDX6"></A>


<H2><A NAME="Stability" HREF="manual_toc.html#Stability">1.6  How stable is MySQL?</A></H2>

<P>
This section addresses the questions, ``how stable is
<STRONG>MySQL</STRONG>?'' and, ``can I depend on <STRONG>MySQL</STRONG> in this project?''
Here we will try to clarify some issues and to answer some of the more
important questions that seem to concern many people.  This section has been
put together from information gathered from the mailing list (which is very
active in reporting bugs).

</P>
<P>
At TcX, <STRONG>MySQL</STRONG> has worked without any problems in our projects since
mid-1996. When <STRONG>MySQL</STRONG> was released to a wider public, we noticed that
there were some pieces of ``untested code'' that were quickly found by the
new users who made queries in a manner different than our own.  Each new
release has had fewer portability problems than the previous one (even though
each has had many new features), and we hope that it will be possible to label
one of the next releases ``stable''.

</P>
<P>
Each release of <STRONG>MySQL</STRONG> has been usable and there have been problems
only when users start to use code from ``the gray zones''. Naturally, outside
users can't know what the gray zones are; this section attempts to indicate
those that are currently known.  The descriptions deal with the 3.22.x
version of <STRONG>MySQL</STRONG>. All known and reported bugs are fixed in the
latest version, with the exception of the bugs listed in the bugs section,
which are things that are ``design''-related.  See section <A HREF="manual.html#Bugs">E  Known errors and design deficiencies in MySQL</A>.

</P>
<P>
<STRONG>MySQL</STRONG> is written in multiple layers and different independent
modules.  These modules are listed below with an indication of how
well-tested each of them is:

</P>
<DL COMPACT>

<DT><STRONG>The ISAM table handler -- Stable</STRONG>
<DD>
This manages storage and retrieval of all data in <STRONG>MySQL</STRONG> 3.22
and earlier versions. In all <STRONG>MySQL</STRONG> releases there hasn't been a
single (reported) bug in this code. The only known way to get a
corrupted table is to kill the server in the middle of an update.  Even
that is unlikely to destroy any data beyond rescue, because all data are
flushed to disk between each query.  There hasn't been a single bug
report about lost data because of bugs in <STRONG>MySQL</STRONG>, either.

<DT><STRONG>The MyISAM table handler -- Beta</STRONG>
<DD>
This is new in <STRONG>MySQL</STRONG> 3.23. It's largely based on the ISAM table code
but has a lot of new very useful features.

<DT><STRONG>The parser and lexical analyser -- Stable</STRONG>
<DD>
There hasn't been a single reported bug in this system for a long time.

<DT><STRONG>The C client code -- Stable</STRONG>
<DD>
No known problems. In early 3.20 releases, there were some limitations in
the send/receive buffer size. As of 3.21.x, the buffer size is now dynamic up
to a default of 24M.

<DT><STRONG>Standard client programs -- Stable</STRONG>
<DD>
These include <CODE>mysql</CODE>, <CODE>mysqladmin</CODE> and <CODE>mysqlshow</CODE>,
<CODE>mysqldump</CODE>, and <CODE>mysqlimport</CODE>.

<DT><STRONG>Basic SQL -- Stable</STRONG>
<DD>
The basic SQL function system and string classes and dynamic memory
handling. Not a single reported bug in this system.

<DT><STRONG>Query optimizer -- Stable</STRONG>
<DD>
<DT><STRONG>Range optimizer -- Gamma</STRONG>
<DD>
<DT><STRONG>Join optimizer -- Stable</STRONG>
<DD>
<DT><STRONG>Locking -- Gamma</STRONG>
<DD>
This is very system-dependent. On some systems there are big problems
using standard OS locking (<CODE>fcntl()</CODE>).  In these cases, you should run the
<STRONG>MySQL</STRONG> daemon with the <CODE>--skip-locking</CODE> flag.  Problems are known
to occur on some Linux systems and on SunOS when using NFS-mounted file
systems.

<DT><STRONG>Linux threads -- Gamma</STRONG>
<DD>
The only problem found has been with the <CODE>fcntl()</CODE> call, which is fixed
by using the <CODE>--skip-locking</CODE> option to <CODE>mysqld</CODE>. Some people
have reported lockup problems with the 0.5 release.

<DT><STRONG>Solaris 2.5+ pthreads -- Stable</STRONG>
<DD>
We use this for all our production work.

<DT><STRONG>MIT-pthreads (Other systems) -- Gamma</STRONG>
<DD>
There have been no reported bugs since 3.20.15 and no known bugs since
3.20.16. On some systems, there is a ``misfeature'' where some operations are
quite slow (a 1/20 second sleep is done between each query). Of course,
MIT-pthreads may slow down everything a bit, but index-based <CODE>SELECT</CODE>
statements are usually done in one time frame so there shouldn't be a mutex
locking/thread juggling.

<DT><STRONG>Other thread implementions -- Alpha - Beta</STRONG>
<DD>
The ports to other systems are still very new and may have bugs, possibly
in <STRONG>MySQL</STRONG>, but most often in the thread implementation itself.

<DT><STRONG><CODE>LOAD DATA ...</CODE>, <CODE>INSERT ... SELECT</CODE> -- Stable</STRONG>
<DD>
Some people have thought they have found bugs here, but these usually have
turned out to be misunderstandings. Please check the manual before reporting
problems!

<DT><STRONG><CODE>ALTER TABLE</CODE> -- Stable</STRONG>
<DD>
Small changes in 3.22.12.

<DT><STRONG>DBD -- Stable</STRONG>
<DD>
Now maintained by Jochen Wiedmann

<DT><STRONG><CODE>mysqlaccess</CODE> -- Stable</STRONG>
<DD>
Written and maintained by Yves Carlier

<DT><STRONG><CODE>GRANT</CODE> -- Gamma</STRONG>
<DD>
Big changes made in <STRONG>MySQL</STRONG> 3.22.12.

<DT><STRONG><STRONG>MyODBC</STRONG> (uses ODBC SDK 2.5) -- Gamma</STRONG>
<DD>
It seems to work well with some programs.
</DL>

<P>
TcX provides email support for paying customers, but the <STRONG>MySQL</STRONG>
mailing list usually provides answers to common questions. Bugs are
usually fixed right away with a patch; for serious bugs, there is almost
always a new release.

</P>
<P>
<A NAME="IDX7"></A>


<H2><A NAME="Year_2000_compliance" HREF="manual_toc.html#Year_2000_compliance">1.7  Year 2000 compliance</A></H2>

<P>
<STRONG>MySQL</STRONG> itself has no problems with Year 2000 (Y2K) compliance:

</P>

<UL>
<LI>

<STRONG>MySQL</STRONG> uses Unix time functions and has no problems with dates
until <CODE>2069</CODE>; all 2-digit years are regarded to be in the range
<CODE>1970</CODE> to <CODE>2069</CODE>, which means that if you store <CODE>01</CODE> in a
<CODE>year</CODE> column, <STRONG>MySQL</STRONG> treats it as <CODE>2001</CODE>.

<LI>

All <STRONG>MySQL</STRONG> date
functions are stored in one file <TT>`sql/time.cc'</TT> and coded very carefully
to be year 2000-safe.

<LI>

In <STRONG>MySQL</STRONG> 3.22 and later versions, the new <CODE>YEAR</CODE> column type
can store years <CODE>0</CODE> and <CODE>1901</CODE> to <CODE>2155</CODE> in 1 byte and display
them using 2 or 4 digits.
</UL>

<P>
You may run into problems with applications that use <STRONG>MySQL</STRONG> in a
way that is not Y2K-safe.  For example, many old applications store
or manipulate years using 2-digit values (which are ambiguous) rather than
4-digit values.  This problem may be compounded by applications that use
values such as <CODE>00</CODE> or <CODE>99</CODE> as ``missing'' value indicators.

</P>
<P>
Unfortunately, these problems may be difficult to fix, since different
applications may be written by different programmers, each of whom may
use a different set of conventions and date-handling functions.

</P>
<P>
Here is a simple demonstration illustrating that <STRONG>MySQL</STRONG> doesn't have
any problems with dates until the year 2030!

</P>

<PRE>
mysql&#62; DROP TABLE IF EXISTS y2k;
mysql&#62; CREATE TABLE y2k (date date, date_time datetime, time_stamp timestamp);
mysql&#62; INSERT INTO y2k VALUES ("1998-12-31","1998-12-31 23:59:59",19981231235959);
mysql&#62; INSERT INTO y2k VALUES ("1999-01-01","1999-01-01 00:00:00",19990101000000);
mysql&#62; INSERT INTO y2k VALUES ("1999-09-09","1999-09-09 23:59:59",19990909235959);
mysql&#62; INSERT INTO y2k VALUES ("2000-01-01","2000-01-01 00:00:00",20000101000000);
mysql&#62; INSERT INTO y2k VALUES ("2000-02-28","2000-02-28 00:00:00",20000228000000);
mysql&#62; INSERT INTO y2k VALUES ("2000-02-29","2000-02-29 00:00:00",20000229000000);
mysql&#62; INSERT INTO y2k VALUES ("2000-03-01","2000-03-01 00:00:00",20000301000000);
mysql&#62; INSERT INTO y2k VALUES ("2000-12-31","2000-12-31 23:59:59",20001231235959);
mysql&#62; INSERT INTO y2k VALUES ("2001-01-01","2001-01-01 00:00:00",20010101000000);
mysql&#62; INSERT INTO y2k VALUES ("2004-12-31","2004-12-31 23:59:59",20041231235959);
mysql&#62; INSERT INTO y2k VALUES ("2005-01-01","2005-01-01 00:00:00",20050101000000);
mysql&#62; INSERT INTO y2k VALUES ("2030-01-01","2030-01-01 00:00:00",20300101000000);
mysql&#62; INSERT INTO y2k VALUES ("2050-01-01","2050-01-01 00:00:00",20500101000000);
mysql&#62; SELECT * FROM y2k;
+------------+---------------------+----------------+
| date       | date_time           | time_stamp     |
+------------+---------------------+----------------+
| 1998-12-31 | 1998-12-31 23:59:59 | 19981231235959 |
| 1999-01-01 | 1999-01-01 00:00:00 | 19990101000000 |
| 1999-09-09 | 1999-09-09 23:59:59 | 19990909235959 |
| 2000-01-01 | 2000-01-01 00:00:00 | 20000101000000 |
| 2000-02-28 | 2000-02-28 00:00:00 | 20000228000000 |
| 2000-02-29 | 2000-02-29 00:00:00 | 20000229000000 |
| 2000-03-01 | 2000-03-01 00:00:00 | 20000301000000 |
| 2000-12-31 | 2000-12-31 23:59:59 | 20001231235959 |
| 2001-01-01 | 2001-01-01 00:00:00 | 20010101000000 |
| 2004-12-31 | 2004-12-31 23:59:59 | 20041231235959 |
| 2005-01-01 | 2005-01-01 00:00:00 | 20050101000000 |
| 2030-01-01 | 2030-01-01 00:00:00 | 20300101000000 |
| 2050-01-01 | 2050-01-01 00:00:00 | 00000000000000 |
+------------+---------------------+----------------+

13 rows in set (0.00 sec)
</PRE>

<P>
This shows that the <CODE>DATE</CODE> and <CODE>DATETIME</CODE> types are will not
give any problems with future dates (they handle dates until the year
9999).

</P>
<P>
The <CODE>TIMESTAMP</CODE> type, that is used to store the current time, has a
range up to only <CODE>2030-01-01</CODE>. <CODE>TIMESTAMP</CODE> has a range of
<CODE>1970</CODE> to <CODE>2030</CODE> on 32-bit machines (signed value). On 64-bit
machines it handles times up to <CODE>2106</CODE> (unsigned value).

</P>
<P>
Even though <STRONG>MySQL</STRONG> is Y2K-compliant, it is your responsibility to
provide unambiguous input.  See section <A HREF="manual.html#Y2K_issues">7.3.6.1  Y2K issues and date types</A> for <STRONG>MySQL</STRONG>'s rules
for dealing with ambiguous date input data (data containing 2-digit year
values).

</P>


<H2><A NAME="General-SQL" HREF="manual_toc.html#General-SQL">1.8  General SQL information and tutorials</A></H2>

<P>
This book has been recommended by a several people on the <STRONG>MySQL</STRONG>
mailing list:

</P>

<PRE>
Judith S. Bowman, Sandra L. Emerson and Marcy Darnovsky
The Practical SQL Handbook: Using Structured Query Language
Second Edition
Addison-Wesley
ISBN 0-201-62623-3
http://www.awl.com
</PRE>

<P>
This book has also received some recommendations by MySQL users:

</P>

<PRE>
Martin Gruber
Understanding SQL
ISBN 0-89588-644-8
Publisher Sybex 510 523 8233
Alameda, CA USA
</PRE>

<P>
A SQL tutorial is available on the net at
http://www.geocities.com/SiliconValley/Vista/2207/sql1.html

</P>
<P>
SQL in 21 Tagen (online book in German language):
http://www.mut.de/leseecke/buecher/sql/inhalt.htm

</P>


<H2><A NAME="Useful_Links" HREF="manual_toc.html#Useful_Links">1.9  Useful MySQL-related links</A></H2>


<H3>1.9.1  Tutorials</H3>

<UL>

<LI><a HREF="http://www.devshed.com/resource/advanced/mysql/index.html"> A

beginner's tutoral of how to start using <STRONG>MySQL</STRONG></a>

<LI><a HREF="http://www.analysisandsolutions.com/code/mybasic.htm">http://www.analysisandsolutions.com/code/mybasic.htm</a>

Beginners <STRONG>MySQL</STRONG> Tutorial on how to install and set up
<STRONG>MySQL</STRONG> on a Windows machine.

<LI><a HREF="http://www.devshed.com/Server_Side/MySQL/"> A lot of <STRONG>MySQL</STRONG> tutorials</a>

<LI><a HREF="http://www.linuxplanet.com/linuxplanet/tutorials/1046/1/">

Setting Up a MySQL Based Website</a>

<LI><a HREF="http://www.hotwired.com/webmonkey/backend/tutorials/tutorial1.html"> <STRONG>MySQL</STRONG>-perl tutorial</a>

<LI><a HREF="http://www.hotwired.com/webmonkey/databases/tutorials/tutorial4.html"> PHP/MySQL Tutorial</a>

</UL>


<H3>1.9.2  Porting MySQL / Using MySQL on different systems</H3>

<UL>
<LI><a HREF="http://xclave.macnn.com/MySQL/">The MacOS Xclave</a>.

Running MySQL on MacOSX
<LI><a HREF="http://www.prnet.de/RegEx/mysql.html"> MySql for MacOSX Server</a>

<LI><a HREF="http://www.lilback.com/macsql/"> Client libraries for the Macintosh</a>

</UL>


<H3>1.9.3  Perl related links</H3>

<UL>
<LI>

<a HREF="http://haven.e-cactus.com/dbi_mysql"> Perl DBI with MySQL FAQ</a>
</UL>


<H3>1.9.4  MySQL discussion forums</H3>

<UL>
<LI>

<a HREF="http://webdev.weberdev.com/"> Examples using <STRONG>MySQL</STRONG>; (check Top 20)</a>
</UL>


<H3>1.9.5  Commercial applications that support MySQL</H3>

<UL>
<LI>

<a HREF="http://www.supportwizard.com/"> SupportWizard; Interactive helpdesk
on the web (This product includes a licensed copy of MySQL)</a>
<LI>

<a HREF="http://www.rightnowtech.com/"> Right Now Web; Web automation for customer service</a>
<LI>

<a HREF="http://www.icaap.org/Bazaar/"> Bazaar; Interactive Discussion Forums with web interface</a>
<LI>

<a HREF="http://www.phonesweep.com/"> PhoneSweepT</a> is the world's first
commercial Telephone Scanner. Many break-ins in recent years have come
not through the Internet, but through unauthorized dial-up
modems. PhoneSweep lets you find these modems by repeatedly placing
phone calls to every phone number that your organization
controls. PhoneSweep has a built-in expert system that can recognize
more than 250 different kinds of remote-access programs, including
Carbon CopyT, pcANYWHERET, and Windows NT RAS. All information is stored
in the SQL database. It then generates a comprehensive report detailing
which services were discovered on which dial-up numbers in your
organization.
</UL>


<H3>1.9.6  SQL Clients/Report writers</H3>


<UL>
<LI>

<a HREF="http://www.urbanresearch.com/software/utils/urbsql/index.html">
<STRONG>MySQL</STRONG> Editor/Utility for MS Windows Platforms.</a>
<LI>

<a HREF="http://www.xnot.com/kmysql"> KDE MySQL client</a>
<LI>

<a HREF="http://www.penguinpowered.com/~kmysql"> KMySQL</a>
KMySQL is a database client for KDE that primarily supports <STRONG>MySQL</STRONG>.
<LI>

<a HREF="http://www.icaap.org/software/kiosk/"> Kiosk; a MySQL client for
database management</a>. Written in Perl. Will be a part of Bazaar.
<LI>

<a HREF="http://www.geocities.com/SiliconValley/Ridge/4280/GenericReportWriter/grwhome.html"> A free report writer in Java</a>
</UL>


<H3>1.9.7  Web development tools that support <STRONG>MySQL</STRONG></H3>


<UL>
<LI>

<a HREF="http://www.php.net/"> PHP: A server-side HTML-embedded scripting
language</a>
<LI>

<a HREF="http://www.midgard-project.org"> The Midgard Application Server; a
powerful Web development environment based on MySQL and PHP</a>
<LI>

<a HREF="http://www.smartworker.org"> SmartWorker is a platform for web application development</a>
<LI>

<a HREF="http://xsp.lentus.se/"> XSP: e(X)tendible (s)erver (p)ages and is a
HTML embedded tag language written in Java (previously known as XTAGS)</a>
<LI>

<a HREF="http://www.dbServ.de/"> dbServ</a> is an extension to a web server to
integrate databases output into your HTML code. You may use any HTML
function in your output. Only the client will stop you. It works as
standalone server or as JAVA servlet.
<LI>

<a HREF="http://www.chilisoft.com/"> Platform independent ASP from Chili!Soft</a>
<LI>

<a HREF="http://www.wernhart.priv.at/php/"> <STRONG>MySQL</STRONG> + PHP demos</a>
<LI>

<a HREF="http://www.dbwww.com/"> ForwardSQL: HTML interface to manipulate <STRONG>MySQL</STRONG> databases</a>
<LI>

<a HREF="http://www.daa.com.au/~james/www-sql/"> WWW-SQL: Display database
information</a>
<LI>

<a HREF="http://www.minivend.com/minivend/"> Minivend: A Web shopping cart</a>
<LI>

<a HREF="http://www.heitml.com/"> HeiTML: A server-side extension of HTML and
a 4GL language at the same time</a>
<LI>

<a HREF="http://www.metahtml.com/"> Metahtml: A Dynamic Programming Language
for WWW Applications</a>
<LI>

<a HREF="http://www.binevolve.com/"> VelocityGen for Perl and TCL</a>
<LI>

<a HREF="http://hawkeye.net/"> Hawkeye Internet Server Suite</a>
<LI>

<a HREF="http://www.fastflow.com/"> Network Database Connection For Linux</a>
<LI>

<a HREF="http://www.wdbi.net/">
WDBI: Web browser as a universal front end to databases which supports
<STRONG>MySQL</STRONG> well.</a>
<LI>

<a HREF="http://www.webgroove.com/"> WebGroove Script: HTML compiler and server-side scripting language</a>
<LI>

<a HREF="http://www.ihtml.com/"> A server-side web site scripting language</a>
<LI>

<a HREF="ftp://ftp.igc.apc.org/pub/myodbc/README"> How to use <STRONG>MySQL</STRONG> with Coldfusion on Solaris</a>
<LI>

<a HREF="http://calistra.com/MySQL/">Calistra's ODBC <STRONG>MySQL</STRONG> Administrator</a>
<LI>

<a HREF="http://www.webmerger.com"> Webmerger</a>
This CGI tool interprets files and generates dynamic output
based on a set of simple tags. Ready-to-run drivers for <STRONG>MySQL</STRONG> and PostgreSQL
through ODBC.
<LI>

<a HREF="http://phpclub.unet.ru/index_e.php3"> PHPclub</a>. Tips and tricks for PHP
<LI>

<a HREF="http://www.penguinservices.com/scripts"> MySQL and Perl Scripts</a>
<LI>

<a HREF="http://www.widgetchuck.com"> The Widgetchuck; Web Site Tools and Gadgets</a>
<LI>

<a HREF="http://www.adcycle.com/"> AdCycle</a> advertising management software
<LI>

<a HREF="http://www.bidsystems.com/pwPage"> pwPage</a> provides an extremely
fast and simple approach to the creation of data base forms.  That is,
if a data base table exists and an HTML page has been constructed using
a few simple guidelines, pwPage can be immediately used for table data
selections, insertions, updates, deletions and selectable table content
reviewing.
</UL>


<H3>1.9.8  Databse design tools with MySQL support</H3>

<UL>
<LI>

<a HREF="http://www.heraut.demon.nl/dezign/dezign.html"> "Dezign for
databases" is a database development tool using an
rick&#62; entity relationship diagram (ERD).</a>
</UL>


<H3>1.9.9  Web servers with <STRONG>MySQL</STRONG> tools</H3>


<UL>
<LI>

<a HREF="http://bourbon.netvision.net.il/mysql/mod_auth_mysql/"> An Apache
authentication module</a>
<LI>

<a HREF="http://www.roxen.com/"> The Roxen Challenger Web server</a>
</UL>


<H3>1.9.10  Extensions for other programs</H3>


<UL>
<a HREF="http://www.fichtner.net/delphi/mysql.delphi.phtml"> A Delphi
interface to <STRONG>MySQL</STRONG>.</a> With source code. By Matthias Fichtner.
<LI>

<a HREF="http://www.productivity.org/projects/mysql/"> <STRONG>TmySQL</STRONG>; A library to use <STRONG>MySQL</STRONG> with Delphi</a>
<LI>

<a HREF="http://www.geocities.com/CapeCanaveral/2064/mysql.html"> Delphi TDataset-component</a>
<LI>

<a HREF="http://www.seawood.org/msql_bind/"> <STRONG>MySQL</STRONG> support for BIND
(The Internet Domain Name Server)</a>
<LI>

<a HREF="http://www.inet-interactive.com/sendmail"> MySQL support for
Sendmail and Procmail</a>
</UL>


<H3>1.9.11  Using <CODE>MySQL</CODE> with other programs</H3>


<UL>
<LI>

<a HREF="http://www.iserver.com/support/addonhelp/database/mysql/msaccess.html"> Using MySQL with Access</a>
</UL>


<H3>1.9.12  <STRONG>ODBC</STRONG> related links</H3>


<UL>
<LI>

<a HREF="http://www.iodbc.org/">Popular iODBC Driver Manager (libiodbc) now available in Open Source format</a>
<LI>

<a HREF="http://users.ids.net/~bjepson/freeODBC/">The FreeODBC Pages</a>
<LI>

<a HREF="http:/http://genix.net/unixODBC/">unixodbc</a> 
The unixODBC Project goals are to develop and promote unixODBC to be the
definitive standard for ODBC on the Linux platform.
This is to include GUI support for KDE. 
</UL>


<H3>1.9.13  <STRONG>API</STRONG> related links</H3>


<UL>
<LI>

<a HREF="http://www.jppp.com"> www.jppp.com</a>
Partially implemented TDataset-compatible components for <STRONG>MySQL</STRONG>.
<LI>

<a HREF="http://www.riverstyx.net/qpopmysql/">qpopmysql</a>
A patch to allow POP3 authentication from a <STRONG>MySQL</STRONG> database.
There's also a link to Paul Khavkine's patch for Procmail to allow
any MTA to deliver to users in a <STRONG>MySQL</STRONG> database.  
<LI>

<a HREF="http://www.pbc.ottawa.on.ca">Visual Basic class generator for Active X</a>
<LI>

<a HREF="http://www.lilback.com/macsql/"> Client libraries for the Macintosh</a>
<LI>

<a HREF="http://tfdec1.fys.kuleuven.ac.be/~michael/fpc-linux/mysql">
<STRONG>MySQL</STRONG> binding to Free Pascal</a>
<LI>

<a HREF="http://www.dedecker.net/jessie/scmdb/"> SCMDB</a>.
SCMDB is an add-on for SCM that ports the mysql C library to scheme (SCM).
With this library scheme developers can make connections to a mySQL
database and use embedded SQL in their programs.
</UL>


<H3>1.9.14  Other <STRONG>MySQL</STRONG>-related links</H3>


<UL>
<LI>

<a HREF="http://www.wix.com/mysql-hosting"> Registry of Web providers who
support <STRONG>MySQL</STRONG></a>
<a HREF="http://www.softagency.co.jp/mysql/index.en.phtml"> Links about using
<STRONG>MySQL</STRONG> in Japan/Asia</a>
<LI>

<a HREF="http://www.open.com.au/products.html"> Commercial Web defect tracking
system</a>
<LI>

<a HREF="http://www.stonekeep.com/pts/"> PTS: Project Tracking System</a>
<LI>

<a HREF="http://tomato.nvgc.vt.edu/~hroberts/mot"> Job and software tracking
system</a>
<LI>

<a HREF="http://www.cynergi.net/non-secure/exportsql/"> ExportSQL: A script
to export data from Access95+</a>
<LI>

<a HREF="http://SAL.KachinaTech.COM/H/1/MYSQL.html"> SAL (Scientific
Applications on Linux) <STRONG>MySQL</STRONG> entry</a>
<LI>

<a HREF="http://www.infotech-nj.com/itech/index.shtml"> A consulting company
which mentions <STRONG>MySQL</STRONG> in the right company</a>
<LI>

<a HREF="http://www.pmpcs.com/"> PMP Computer Solutions. Database developers using
<STRONG>MySQL</STRONG> and <CODE>mSQL</CODE></a>
<LI>

<a HREF="http://www.aewa.org"> Airborne Early Warning Association </a>
<LI>

<a HREF="http://abattoir.cc.ndsu.nodak.edu/~nem/mysql/udf/"> <STRONG>MySQL</STRONG> UDF Registry</a>
<LI>

<a HREF="http://21ccs.com/~gboersm/y2kmatrix/"> Y2K tester</a>
</UL>


<H3>1.9.15  SQL and database interfaces</H3>

<UL>
<LI>

<a HREF="http://java.sun.com/products/jdbc/"> The JDBC database access API</a>
<LI>

<a HREF="http://www.gagme.com/mysql"> Patch for <CODE>mSQL</CODE> TCL</a>
<LI>

<a HREF="http://www.amsoft.ru/easysql/"> EasySQL: An ODBC-like driver manager</a>
<LI>

<a HREF="http://www.lightlink.com/hessling/rexxsql.html"> A REXX interface to SQL databases</a>
<LI>

<a HREF="http://www.binevolve.com/~tdarugar/tcl-sql"> TCL interface</a>
</UL>


<H3>1.9.16  Examples of MySQL use</H3>


<UL>
<LI>

<a HREF="http://www.little6.com/about/linux/"> Little6 Inc</a> An online contract and job finding site that is powered by <STRONG>MySQL</STRONG>, PHP3 and Linux.
<LI>

<a HREF="http://www.delec.com/is/products/prep/examples/BookShelf/index.html"> DELECis</a> A tool which makes it very easy to create an automatically generated table documentation. They have used <STRONG>MySQL</STRONG> as an example.
<LI>

<a HREF="http://shredder.elen.utah.edu/steve.html"> Steve Fambro</a>
Uses <STRONG>MySQL</STRONG> and webmerger. There is an employee database, and a
license plate database with all of the registered Utah vehicles (over
1.2 million). The License plate field is indexed.....so the *searches*
are instantaneous.
<LI>

<a HREF="http://www.worldrecords.com"> World Records</a> A search engine for information about music that uses <STRONG>MySQL</STRONG> and PHP.
<LI>

<a HREF="http://www.webtechniques.com/archives/1998/01/note/">
A Contact Database using <STRONG>MySQL</STRONG> and PHP</a>
<LI>

<a HREF="http://modems.rosenet.net/mysql/"> Web based interface and Community Calender with PHP</a>
<LI>

<a HREF="http://www.odbsoft.com/cook/sources.htm"> Perl package to generate html from a SQL table structure and for generating SQL statements from an html form.</a>
<LI>

<a HREF="http://www.gusnet.cx/proj/telsql/">Basic telephone database using <CODE>DBI</CODE>/<CODE>DBD</CODE></a>.
<LI>

<a HREF="http://www.iserver.com/support/contrib/perl5/modules.html">Installing new Perl modules that require locally installed modules</a>
<LI>

<a HREF="http://tecfa.unige.ch/guides/java/staf2x/ex/jdbc/coffee-break"> JDBC examples by Daniel K. Schneider</a>
<LI>

<a HREF="http://www.spade.com/linux/howto/PostgreSQL-HOWTO-41.html">SQL BNF</a>
<LI>

<a HREF="http://www.ooc.com/"> Object Oriented Concepts Inc; CORBA applications with examples in source</a>
<LI>

<a HREF="http://www.pbc.ottawa.on.ca/">DBWiz; Includes an example of how to manage own cursors in VB</a>
<LI>

<a HREF="http://keilor.cs.umass.edu/pluribus/"> Pluribus</a>
Pluribus, is a free search engine that learns to improve
the quality of its results over time. Pluribus works by recording
which pages a user prefers among those returned for a query. A user
votes for a page by selecting it; Pluribus then uses that knowledge
to improve the quality of the results when someone else submits the
same (or similar) query. Uses PHP and <STRONG>MySQL</STRONG>.
<LI>

<a HREF="http://www.stopbit.com/"> Stopbit</a>
A technology news site using <STRONG>MySQL</STRONG> and PHP
<LI>

<a HREF="http://www.jokes2000.com/scripts/"> Example scripts at Jokes2000</a>
<LI>

<a HREF="http://futurerealm.com/forum/futureforum.cgi"> FutureForum Web Discussion Software</a>
<LI>

<a HREF="http://www.linuxsupportline.com/~kalendar/ KDE based calendar manager">http://www.linuxsupportline.com/~kalendar/ KDE based calendar manager</a>
The calendar manager has both single user (file based) and multi user
(<STRONG>MySQL</STRONG> database) support.
<LI>

<a HREF="http://tim.desert.net/~tim/imger/">Example of storing/retrieving images with <STRONG>MySQL</STRONG> and CGI</a>
<LI>

<a HREF="http://www.penguinservices.com/scripts"> Online shopping cart system</a>
<LI>

<a HREF="http://www.city-gallery.com/album/"> Old Photo Album</a>
The album is a collaborative popular history of photography project that
generates all pages from data stored in a <STRONG>MySQL</STRONG> database. Pages are
dynamically generated through a php3 interface to the database content.
Users contribute images and descriptions. Contributed images are stored
on the web server to avoid storing them in the database as BLOBs. All
other information is stored in on the shared <STRONG>MySQL</STRONG> server.
</UL>


<H3>1.9.17  General database links</H3>

<UL>
<LI>

<a HREF="http://www.pcslink.com/~ej/dbweb.html"> Database Jump Site</a>
<LI>

<a HREF="http://black.hole-in-the.net/guy/webdb/"> Homepage of the webdb-l
(Web Databases) mailing list.</a>
<LI>

<a HREF="http://www.symbolstone.org/technology/perl/DBI/index.html">
Perl <CODE>DBI</CODE>/<CODE>DBD</CODE> modules homepage</a>
<LI>

<a HREF="http://www.student.uni-koeln.de/cygwin/"> Cygwin tools. UNIX on top of Windows</a>
<LI>

<a HREF="http://dbasecentral.com/"> dbasecentral.com; Development and distribution of powerful and easy-to-use database applications and systems.</a>
<LI>

<a HREF="http://www.Tek-Tips.com"> Tek-Tips Forums</a> Tek-Tips Forums are 800+
independent peer-to-peer non-commercial support forums for Computer
Professionals.  Features include automatic e-mail notification of
responses, a links library, and member confidentiality guaranteed.
</UL>

<P>
There are also many web pages that use
<STRONG>MySQL</STRONG>. See section <A HREF="manual.html#Users">A  Some MySQL users</A>. Send any additions to this list to
<STRONG>MySQL</STRONG> logo somewhere (It is okay to have it on a ``used tools'' page
or something similar) to be added.

</P>
<P>
<A NAME="IDX8"></A>
<A NAME="IDX9"></A>


<H1><A NAME="Questions" HREF="manual_toc.html#Questions">2  MySQL mailing lists and how to ask questions or report errors (bugs)</A></H1>



<H2><A NAME="Mailing-list" HREF="manual_toc.html#Mailing-list">2.1  The MySQL mailing lists</A></H2>

<P>
To subscribe to the main <STRONG>MySQL</STRONG> mailing list, send a message to the
electronic mail address <a HREF="mailto:mysql-subscribe@lists.mysql.com">mysql-subscribe@lists.mysql.com</a>.

</P>
<P>
To unsubscribe from the main <STRONG>MySQL</STRONG> mailing list, send a message to
the electronic mail address <a HREF="mailto:mysql-unsubscribe@lists.mysql.com">mysql-unsubscribe@lists.mysql.com</a>.

</P>
<P>
Only the address to which you send your messages is significant.  The
subject line and the body of the message are ignored.

</P>
<P>
If your reply address is not valid, you can specify your address explicitly.
Adding a hyphen to the subscribe or unsubscribe command word, followed by
your address with the <SAMP>`@'</SAMP> character in your address replaced by a
<SAMP>`='</SAMP>.  For example, to subscribe <CODE>john@host.domain</CODE>, send a message
to <CODE>mysql-subscribe-john=host.domain@lists.mysql.com</CODE>.

</P>
<P>
Mail to <a HREF="mailto:mysql-subscribe@lists.mysql.com">mysql-subscribe@lists.mysql.com</a> or
ezmlm mailing list processor.  Information about ezmlm is available at
<a HREF="http://www.ezmlm.org">the ezmlm Website</a>.

</P>
<P>
To post a message to the list itself, send your message to
<CODE>mysql@lists.mysql.com</CODE>.  However, please <EM>do not</EM> send mail about
subscribing or unsubscribing to <a HREF="mailto:mysql@lists.mysql.com">mysql@lists.mysql.com</a>, since any
mail sent to that address is distributed automatically to thousands of other
users.

</P>
<P>
Your local site may have many subscribers to <a HREF="mailto:mysql@lists.mysql.com">mysql@lists.mysql.com</a>.
If so, it may have a local mailing list, so that messages sent from
<CODE>lists.mysql.com</CODE> to your site are propagated to the local list. In such
cases, please contact your system administrator to be added to or dropped
from the local <STRONG>MySQL</STRONG> list.

</P>
<P>
The following <STRONG>MySQL</STRONG> mailing lists exist:

</P>
<DL COMPACT>

<DT><CODE>announce</CODE>
<DD>
This is for announcement of new versions of <STRONG>MySQL</STRONG> and related
programs. This is a low volume list that we think all <STRONG>MySQL</STRONG>
users should be on.

<DT><CODE>mysql</CODE>
<DD>
The main list for general <STRONG>MySQL</STRONG> discussion. Please note that some
topics are better discussed on the more-specialized lists. If you post to the
wrong list, you may not get an answer!

<DT><CODE>mysql-digest</CODE>
<DD>
The <CODE>mysql</CODE> list in digest form. That means you get all individual
messages, sent as one large mail message once a day.

<DT><CODE>java</CODE>
<DD>
Discussion about <STRONG>MySQL</STRONG> and Java. Mostly about the JDBC drivers.

<DT><CODE>java-digest</CODE>
<DD>
A digest version of the <CODE>java</CODE> list.

<DT><CODE>win32</CODE>
<DD>
All things concerning <STRONG>MySQL</STRONG> on Microsoft operating systems such as
Windows NT.

<DT><CODE>win32-digest</CODE>
<DD>
A digest version of the <CODE>win32</CODE> list.

<DT><CODE>myodbc</CODE>
<DD>
All things concerning connecting to <STRONG>MySQL</STRONG> with ODBC.

<DT><CODE>myodbc-digest</CODE>
<DD>
A digest version of the <CODE>myodbc</CODE> list.

<DT><CODE>msql-mysql-modules</CODE>
<DD>
A list about the Perl support in <STRONG>MySQL</STRONG>.

<DT><CODE>msql-mysql-modules-digest</CODE>
<DD>
A digest version of the <CODE>msql-mysql-modules</CODE> list.

<DT><CODE>developer</CODE>
<DD>
A list for people who work on the <STRONG>MySQL</STRONG> code.

<DT><CODE>developer-digest</CODE>
<DD>
A digest version of the <CODE>developer</CODE> list.
</DL>

<P>
You subscribe or unsubscribe to all lists in the same way as described
above.  In your subscribe or unsubscribe message, just put the appropriate
mailing list name rather than <CODE>mysql</CODE>.  For example, to subscribe to or
unsubscribe from the <CODE>myodbc</CODE> list, send a message to

</P>
<P>
<A NAME="IDX10"></A>


<H2><A NAME="Asking_questions" HREF="manual_toc.html#Asking_questions">2.2  Asking questions or reporting bugs</A></H2>

<P>
Before posting a bug report or question, please do the following:

</P>

<UL>
<LI>

Start by searching the <STRONG>MySQL</STRONG> online manual at:


<PRE>
<a HREF="http://www.mysql.com/Manual_chapter/manual_toc.html">http://www.mysql.com/Manual_chapter/manual_toc.html</a>
</PRE>

We try to keep the manual up to date by
updating it frequently with solutions to newly found problems!

<LI>

Search the <STRONG>MySQL</STRONG> mailing list archives:


<PRE>
<a HREF="http://www.mysql.com/doc.html">http://www.mysql.com/doc.html</a>
</PRE>

<LI>

You can also use <a HREF="http://www.mysql.com/search.html">http://www.mysql.com/search.html</a> to search all the
web pages (including the manual) that are located at
<a HREF="http://www.mysql.com/">http://www.mysql.com/</a>.
</UL>

<P>
If you can't find an answer in the manual or the archives, check with your
local <STRONG>MySQL</STRONG> expert. If you still can't find an answer to your
question, go ahead and read the next section about how to send mail to

</P>
<P>
<A NAME="IDX11"></A>
<A NAME="IDX12"></A>


<H2><A NAME="Bug_reports" HREF="manual_toc.html#Bug_reports">2.3  How to report bugs or problems</A></H2>

<P>
Writing a good bug report takes patience, but doing it right the first time
saves time for us and for you. This section will help you write your report
correctly so that you don't waste your time doing things that may not help us
much or at all.

</P>
<P>
We encourage everyone to use the <CODE>mysqlbug</CODE> script to generate a bug
report (or a report about any problem), if possible.  <CODE>mysqlbug</CODE> can be
found in the <TT>`scripts'</TT> directory in the source distribution, or, for a
binary distribution, in the <TT>`bin'</TT> directory under your <STRONG>MySQL</STRONG>
installation directory.  If you are unable to use <CODE>mysqlbug</CODE>, you should
still include all the necessary information listed in this section.

</P>
<P>
The <CODE>mysqlbug</CODE> script helps you generate a report by determining much
of the following information automatically, but if something important is
missing, please include it with your message! Please read this section
carefully and make sure that all the information described here is included
in your report.

</P>
<P>
Remember that it is possible to respond to a message containing too much
information, but not to one containing too little.  Often people omit facts
because they think they know the cause of a problem and assume that some
details don't matter.  A good principle is: if you are in doubt about stating
something, state it!  It is a thousand times faster and less troublesome to
write a couple of lines more in your report than to be forced to ask again
and wait for the answer because you didn't include enough information the
first time.

</P>
<P>
The most common errors are that people don't indicate the version number of
the <STRONG>MySQL</STRONG> distribution they are using, or don't indicate what
platform they have <STRONG>MySQL</STRONG> installed on (including the platform
version number).  This is highly relevant information and in 99 cases out of
100 the bug report is useless without it!  Very often we get questions like
``Why doesn't this work for me?''  and then we find that the feature
requested wasn't implemented in that <STRONG>MySQL</STRONG> version, or that a bug
described in a report has been fixed already in newer <STRONG>MySQL</STRONG>
versions.  Sometimes the error is platform dependent; in such cases, it is
next to impossible to fix anything without knowing the operating system and
the version number of the platform.

</P>
<P>
Remember also to provide information about your compiler, if it is related to
the problem.  Often people find bugs in compilers and think the problem is
<STRONG>MySQL</STRONG> related. Most compilers are under development all the time and
become better version by version, too.  To determine whether or not your
problem depends on your compiler, we need to know what compiler is used.
Note that every compiling problem should be regarded as a bug report and
reported accordingly.

</P>
<P>
It is most helpful when a good description of the problem is included in the
bug report.  That is, a good example of all the things you did that led to
the problem and the problem itself exactly described.  The best reports are
those that include a full example showing how to reproduce the bug or
problem.

</P>
<P>
If a program produces an error message, it is very important to include the
message in your report! If we try to search for something from the archives
using programs, it is better that the error message reported exactly matches
the one that the program produces.  (Even the case sensitivity should be
observed!) You should never try to remember what the error message was;
instead, copy and paste the entire message into your report!

</P>
<P>
If you have a problem with MyODBC, you should try to genereate a MyODBC
trace file. See section <A HREF="manual.html#MyODBC_bug_report">16.6  Reporting problems with MyODBC</A>.

</P>
<P>
Please remember that many of the people who will read your report will
do so using an 80-column display.  When generating reports or examples
using the <CODE>mysql</CODE> command line tool, you should therefore use
the <CODE>--vertical</CODE> option (or the <CODE>\G</CODE> statement terminator)
for output which would exceed the available width for such a display
(for example, with the <CODE>EXPLAIN SELECT</CODE> statement; see the
example below).

</P>
<P>
Please include the following information in your report:

</P>

<UL>
<LI>

The version number of the <STRONG>MySQL</STRONG> distribution you are using (for
example, <STRONG>MySQL</STRONG> 3.22.22). You can find out which version you are
running by executing <CODE>mysqladmin version</CODE>. <CODE>mysqladmin</CODE> can be
found in the <TT>`bin'</TT> directory under your <STRONG>MySQL</STRONG> installation
directory.

<LI>

The manufacturer and model of the machine you are working on.

<LI>

The operating system name and version. For most operating systems, you can
get this information by executing the Unix command <CODE>uname -a</CODE>.

<LI>

Sometimes the amount of memory (real and virtual) is relevant.
If in doubt, include these values.

<LI>

If you are using a source distribution of <STRONG>MySQL</STRONG>, the name and
version number of the compiler used is needed.
If you have a binary distribution, the distribution name is needed.

<LI>

If the problem occurs during compilation, include the exact error
message(s) and also a few lines of context around the offending code in the
file where the error occurred.

<LI>

If any database table is related to the problem, include the output from
<CODE>mysqldump --no-data db_name tbl_name1 tbl_name2 ...</CODE> This is very easy
to do and is a powerful way to get information about any table in a database
that will help us create a situation matching the one you have.

<LI>

For speed-related bugs or problems with <CODE>SELECT</CODE> statements, you should
always include the output of <CODE>EXPLAIN SELECT ...</CODE>, and at least the
number of rows that the <CODE>SELECT</CODE> statement produces.  The more
information you give about your situation, the more likely it is that someone
can help you!  For example, the following is an example of a very good bug
report (it should of course be posted with the <CODE>mysqlbug</CODE> script):

Example run using the <CODE>mysql</CODE> command line tool (note the use of the
<CODE>\G</CODE> statement terminator for statements whose output width would
otherwise exceed that of an 80-column display device):


<PRE>
mysql&#62; SHOW VARIABLES;
mysql&#62; SHOW COLUMNS FROM ...\G
       &#60;output-from-SHOW-COLUMNS&#62;
mysql&#62; EXPLAIN SELECT ...\G
       &#60;output-from-EXPLAIN&#62;
mysql&#62; FLUSH STATUS;
mysql&#62; SELECT ...;
       &#60;A short version of the output from SELECT,
       including the time taken to run the query&#62;
mysql&#62; SHOW STATUS;
       &#60;output from SHOW STATUS&#62;
</PRE>

<LI>

If a bug or problem occurs while running <STRONG>MySQL</STRONG>, try to provide an
input script that will reproduce the anomaly. This script should include any
necessary source files. The more closely the script can reproduce your
situation, the better.

If you can't provide a script, you should at least include the output
from <CODE>mysqladmin variables extended-status processlist</CODE> in your mail to
provide some information of how your system is performing!

<LI>

If you think that <STRONG>MySQL</STRONG> produces a strange result from a query,
include not only the result, but also your opinion of what the result
should be and an account describing the basis for your opinion.

<LI>

When giving an example of the problem, it's better to use the variable names,
table names, etc., that exist in your actual situation than to come up with
new names. The problem could be related to the name of a variable, table,
etc.!  These cases are rare, perhaps, but it is better to be safe than
sorry.  After all, it should be easier for you to provide an example that
uses your actual situation and it is by all means better for us.  In case you
have data you don't want to show to others, you can use <CODE>ftp</CODE> to
transfer it to <a HREF="ftp://www.mysql.com/pub/mysql/secret/">ftp://www.mysql.com/pub/mysql/secret/</a>.  If the data are
really top secret and you don't want to show them even to us, then go ahead
and provide an example using other names, but please regard this as the last
choice.

<LI>

Include all the options given to the relevant programs, if possible.  For
example, indicate the options that you use when you start the <CODE>mysqld</CODE>
daemon and that you use to run any <STRONG>MySQL</STRONG> client programs.  The
options to programs like <CODE>mysqld</CODE> and <CODE>mysql</CODE>, and to the
<CODE>configure</CODE> script are often keys to answers and very relevant!  It is
never a bad idea to include them anyway!  If you use any modules, such as
Perl or PHP, please include the version number(s) of those as well.

<LI>

If you can't produce a test case in a few rows, or if the test table
is too big to be mailed to the mailing list (more than 10 rows), you should
dump your tables using <CODE>mysqldump</CODE> and create a <TT>`README'</TT> file
that describes your problem.

Create a compressed archive of your files using
<CODE>tar</CODE> and <CODE>gzip</CODE> or <CODE>zip</CODE>, and use <CODE>ftp</CODE>
to transfer the archive to <a HREF="ftp://www.mysql.com/pub/mysql/secret/">ftp://www.mysql.com/pub/mysql/secret/</a>.
Then send a short description of the problem to <a HREF="mailto:mysql@lists.mysql.com">mysql@lists.mysql.com</a>.

<LI>

If your question is related to the privilege system, please include the
output of <CODE>mysqlaccess</CODE>, the output of <CODE>mysqladmin reload</CODE> and all
the error messages you get when trying to connect!  When you test your
privileges, you should first run <CODE>mysqlaccess</CODE>. After this, execute
<CODE>mysqladmin reload version</CODE>, and last you should try to connect with the
program that gives you trouble.  <CODE>mysqlaccess</CODE> can be found in the
<TT>`bin'</TT> directory under your <STRONG>MySQL</STRONG> installation directory.

<LI>

If you have a patch for a bug, that is good.  But don't assume the patch is
all we need or that we will use it even if you don't provide some necessary
information such as test cases showing the bug that your patch fixes.  We
might find problems with your patch or we might not understand it at all; if
so, we can't use it.

If we can't verify exactly what the patch is meant for, we won't use it.
Test cases will help us here.  Show that the patch will handle all the
situations that may occur. If we find a borderline case (even a rare one)
where the patch won't work, the patch may be useless.

<LI>

Guesses about what the bug is, why it occurs, or what it depends on,
are usually wrong. Even we can't guess such things without first
using a debugger to determine the real cause of a bug.

<LI>

Indicate in your mail message that you have checked the reference manual
and mail archive so others know that you have tried to solve your
problem yourself.

<LI>

If you get a <CODE>parse error</CODE>, please check your syntax closely! If
you can't find something wrong with it, it's extremely likely that your
current version of <STRONG>MySQL</STRONG> doesn't support the query you are
using.  If you are using the current version and the manual at
<a HREF="http://www.mysql.com/doc.html">http://www.mysql.com/doc.html</a> doesn't cover the syntax you are
using, <STRONG>MySQL</STRONG> doesn't support your query.  In this case, your
only options are to implement the syntax yourself or email

If the manual covers the syntax you are using, but you have an older version
of <STRONG>MySQL</STRONG>, you should check the <STRONG>MySQL</STRONG> change history to see
when the syntax was implemented.  See section <A HREF="manual.html#News">D  MySQL change history</A>.  In this case, you have the
option of upgrading to a newer version of <STRONG>MySQL</STRONG>.

<LI>

If you have a problem such that your data appears corrupt or you get
errors when you access some particular table, you should first check and then
try repairing your tables with <CODE>myisamchk</CODE>.
See section <A HREF="manual.html#Maintenance">13  Maintaining a MySQL installation</A>.

<LI>

If you often get corrupted tables you should try to find out when and
why this happens!  In this case, the
<TT>`mysql-data-directory/'hostname'.err'</TT> file may contain some
information about what happened.  Please include any relevant
information from this file in your bug report!  Normally <CODE>mysqld</CODE> should
<STRONG>NEVER</STRONG> crash a table if nothing killed it in the middle of an
update!  If you can find the source of why <CODE>mysqld</CODE> dies, it's much
easier for us to provide you with a fix for the problem!

<LI>

If possible, download the most recent version of <STRONG>MySQL</STRONG> and check
whether or not it solves your problem.  All versions of <STRONG>MySQL</STRONG> are
thoroughly tested and should work without problems!  We believe in making
everything as backward compatible as possible and you should be able to
switch <STRONG>MySQL</STRONG> versions in minutes!  See section <A HREF="manual.html#Which_version">4.3  Which MySQL version to use</A>.
</UL>

<P>
If you are a support customer, please cross-post the bug report to
the appropriate mailing list to see if someone else has experienced (and
perhaps solved) the problem.

</P>
<P>
For information on reporting bugs in <STRONG>MyODBC</STRONG>, see section <A HREF="manual.html#ODBC_Problems">16.3  How to report problems with MyODBC</A>.

</P>
<P>
For solutions to some common problems, see See section <A HREF="manual.html#Problems">18  Problems and common errors</A>.

</P>
<P>
When answers are sent to you individually and not to the mailing list,
it is considered good etiquette to summarize the answers and send the
summary to the mailing list so that others may have the benefit of
responses you received that helped you solve your problem!

</P>
<P>
<A NAME="IDX13"></A>


<H2><A NAME="Answering_questions" HREF="manual_toc.html#Answering_questions">2.4  Guidelines for answering questions on the mailing list</A></H2>

<P>
If you consider your answer to have broad interest, you may want to post it
to the mailing list instead of replying directly to the individual who
asked.  Try to make your answer general enough that people other than the
original poster may benefit from it.  When you post to the list, please make
sure that your answer is not a duplication of a previous answer.

</P>
<P>
Try to summarize the essential part of the question in your reply; don't feel
obliged to quote the entire original message.

</P>
<P>
Please don't post mail messages from your browser with HTML mode turned on!
Many users doesn't read mail with a browser!

</P>
<P>
<A NAME="IDX14"></A>
<A NAME="IDX15"></A>


<H1><A NAME="Licensing_and_Support" HREF="manual_toc.html#Licensing_and_Support">3  MySQL licensing and support</A></H1>

<P>
This chapter describes <STRONG>MySQL</STRONG> licensing and support arrangements,
including:

</P>

<UL>
<LI>

Our licensing policies for non-Microsoft and Microsoft operating systems

<LI>

The copyrights under which <STRONG>MySQL</STRONG> is distributed
(see section <A HREF="manual.html#Copyright">3.2  Copyrights used by MySQL</A>)

<LI>

Sample situations illustrating when a license is required
(see section <A HREF="manual.html#Licensing_examples">3.4  Example licensing situations</A>)

<LI>

Licensing and support costs (see section <A HREF="manual.html#Cost">3.5  MySQL licensing and support costs</A>), and
support benefits (see section <A HREF="manual.html#Support">3.6  Types of commercial support</A>)
</UL>

<P>
<A NAME="IDX16"></A>


<H2><A NAME="Licensing_policy" HREF="manual_toc.html#Licensing_policy">3.1  MySQL licensing policy</A></H2>

<P>
The formal terms of the license for non-Microsoft operating systems such as
Unix or OS/2 are specified in section <A HREF="manual.html#Public_license">J  The MySQL server license for non Microsoft operating systems</A>.  Basically, our licensing
policy is as follows:

</P>

<UL>
<LI>

For normal internal use, <STRONG>MySQL</STRONG> generally costs nothing.  You do not
have to pay us if you do not want to.

<LI>

A license is required if:


<UL>
<LI>

You sell the <STRONG>MySQL</STRONG> server directly or as a part of another product
or service

<LI>

You charge for installing and maintaining a <STRONG>MySQL</STRONG> server at some
client site

<LI>

You include <STRONG>MySQL</STRONG> in a distribution that is non redistributable
and you charge for some part of that distribution
</UL>

<LI>

For circumstances under which a <STRONG>MySQL</STRONG> license is required, you need
a license per machine that runs the <CODE>mysqld</CODE> server.  However, a
multiple-CPU machine counts as a single machine, and there is no restriction
on the number of <STRONG>MySQL</STRONG> servers that run on one machine, or on the
number of clients concurrently connected to a server running on that
machine!

<LI>

You do not need a license to include client code in commercial programs.  The
client access part of <STRONG>MySQL</STRONG> is in the public domain. The
<CODE>mysql</CODE> command line client includes code from the <CODE>readline</CODE>
library that is under the GNU Public License.

<LI>

<A NAME="IDX17"></A>
For customers who have purchased 1 license or MySQL support, we provide
additional functionality.  Currently, this means we provide the
<CODE>myisampack</CODE> utility for creating fast compressed read-only
databases.  (The server includes support for reading such databases but
not the packing tool used to create them.)  When support agreements
generate sufficient revenue, we will release this tool under the same
license as the <STRONG>MySQL</STRONG> server.

<LI>

If your use of <STRONG>MySQL</STRONG> does not require a license, but you like
<STRONG>MySQL</STRONG> and want to encourage further development, you are certainly
welcome to purchase a license anyway.

<LI>

If you use <STRONG>MySQL</STRONG> in a commercial context such that
you profit by its use, we ask that you further the development of
<STRONG>MySQL</STRONG> by purchasing some level of support.  We feel that if
<STRONG>MySQL</STRONG> helps your business, it is reasonable to ask that you help
<STRONG>MySQL</STRONG>.  (Otherwise, if you ask us support questions, you are not
only using for free something into which we've put a lot a work, you're
asking us to provide free support, too.)
</UL>

<P>
For use under Microsoft operating systems (Win95/Win98/WinNT), you need a
<STRONG>MySQL</STRONG> license after a trial period of 30 days, with the exception
that licenses may be obtained upon request at no cost for educational
use or for university- or government-sponsored research settings.  See section <A HREF="manual.html#Win_license">K  The MySQL license for Microsoft operating systems</A>. A shareware version of <STRONG>MySQL</STRONG>-Win32 that you can try before
buying is available at <a HREF="http://www.mysql.com/mysql_w32.htmy">http://www.mysql.com/mysql_w32.htmy</a>.  After
you have paid, you will get a password that will enable you to access
the newest <STRONG>MySQL</STRONG>-Win32 version.

</P>
<P>
If you have any questions as to whether or not a license is required for your
particular use of <STRONG>MySQL</STRONG>, please contact us.
See section <A HREF="manual.html#Contact_information">3.5.2  Contact information</A>.

</P>
<P>
If you require a <STRONG>MySQL</STRONG> license, the easiest way to pay for it is to
use the license form at TcX's secure server at
https://www.mysql.com/license.htmy.  Other forms of payment are discussed
in section <A HREF="manual.html#Payment_information">3.5.1  Payment information</A>.

</P>
<P>
<A NAME="IDX18"></A>


<H2><A NAME="Copyright" HREF="manual_toc.html#Copyright">3.2  Copyrights used by MySQL</A></H2>

<P>
There are several different copyrights on the <STRONG>MySQL</STRONG> distribution:

</P>

<OL>
<LI>

The <STRONG>MySQL</STRONG>-specific source needed to build the <CODE>mysqlclient</CODE>
library and programs in the <TT>`client'</TT> directory is in the public
domain. Each file that is in the public domain has a header which clearly
states so. This includes everything in the <TT>`client'</TT> directory and some parts of
the <CODE>mysys</CODE>, <CODE>mystring</CODE> and <CODE>dbug</CODE> libraries.

<LI>

Some small parts of the source (GNU <CODE>getopt</CODE>) are covered by the
``GNU LIBRARY LIBRARY GENERAL PUBLIC LICENSE''.  See the
<TT>`mysys/COPYING.LIB'</TT> file.

<LI>

Some small parts of the source (GNU <CODE>readline</CODE>) are covered by the
``GNU GENERAL PUBLIC LICENSE''. See the <TT>`readline/COPYING'</TT> file.

<LI>

Some parts of the source (the <CODE>regexp</CODE> library) are covered by a Berkeley
style copyright.

<LI>

The other source needed for the <STRONG>MySQL</STRONG> server on non-Microsoft
platforms is covered by the ``MySQL FREE PUBLIC LICENSE'', which is based on
the ``Aladdin FREE PUBLIC LICENSE.'' See section <A HREF="manual.html#Public_license">J  The MySQL server license for non Microsoft operating systems</A>. When running
<STRONG>MySQL</STRONG> on any Microsoft operating system, other licensing applies.
</OL>

<P>
The following points set forth the philosophy behind our copyright policy:

</P>

<UL>
<LI>

The SQL client library should be totally free so that it can be included in
commercial products without limitations.

<LI>

People who want free access to the software into which we have put a lot of
work can have it, so long as they do not try to make money directly by
distributing it for profit.

<LI>

People who want the right to keep their own software proprietary, but also
want the value from our work, can pay for the privilege.

<LI>

That means normal in-house use is FREE. But if you use <STRONG>MySQL</STRONG> for
something important to you, you may want to help further its development by
purchasing a license or a support contract.  See section <A HREF="manual.html#Support">3.6  Types of commercial support</A>.
</UL>



<H3><A NAME="Copyright_changes" HREF="manual_toc.html#Copyright_changes">3.2.1  Possible future copyright changes</A></H3>

<P>
We may choose to distribute older versions of <STRONG>MySQL</STRONG> with the GPL in
the future. However, these versions will be identified as <STRONG>GNU MySQL</STRONG>.
Also, all copyright notices in the relevant files will be changed to the
GPL.

</P>


<H2><A NAME="Commercial_use" HREF="manual_toc.html#Commercial_use">3.3  Distributing MySQL commercially</A></H2>

<P>
This section is a clarification of the license terms that are set forth in
the ``MySQL FREE PUBLIC LICENSE'' (FPL).  See section <A HREF="manual.html#Public_license">J  The MySQL server license for non Microsoft operating systems</A>.

</P>
<P>
<STRONG>MySQL</STRONG> may be <STRONG>used</STRONG> freely, including by commercial
entities for evaluation or unsupported internal use. However,
<STRONG>distribution</STRONG> for commercial purposes of <STRONG>MySQL</STRONG>, or
anything containing or derived from <STRONG>MySQL</STRONG> in whole or in part,
requires a written commercial license from TcX AB, the sole entity
authorized to grant such licenses.

</P>
<P>
You may not include <STRONG>MySQL</STRONG> ``free'' in a package containing
anything for which a charge is being made, except as noted below.

</P>
<P>
The intent of the exception provided in the second clause of the license is
to allow commercial organizations operating an FTP server or a bulletin board
to distribute <STRONG>MySQL</STRONG> freely from it, provided that:

</P>

<OL>
<LI>

The organization complies with the other provisions of the FPL, which
include among other things a requirement to distribute the full source
code of <STRONG>MySQL</STRONG> and of any derived work, and to distribute the
FPL itself along with <STRONG>MySQL</STRONG>;

<LI>

The only charge for downloading <STRONG>MySQL</STRONG> is a charge based on the
distribution service and not one based on the content of the information
being retrieved (i.e., the charge would be the same for retrieving a
random collection of bits of the same size);

<LI>

The server or BBS is accessible to the general public, i.e., the phone
number or IP address is not kept secret, and anyone may obtain access to
the information (possibly by paying a subscription or access fee that is
not dependent on or related to purchasing anything else).
</OL>

<P>
If you want to distribute software in a commercial context that incorporates
<STRONG>MySQL</STRONG> and you do <STRONG>not</STRONG> want to meet these conditions, you
should contact TcX AB to find out about commercial licensing, which involves
a payment. The only ways you legally can distribute <STRONG>MySQL</STRONG> or
anything containing <STRONG>MySQL</STRONG> are by distributing <STRONG>MySQL</STRONG> under
the requirements of the FPL, or by getting a commercial license from TcX AB.

</P>


<H2><A NAME="Licensing_examples" HREF="manual_toc.html#Licensing_examples">3.4  Example licensing situations</A></H2>

<P>
This section describes some situations illustrating whether or not you must
license the <STRONG>MySQL</STRONG> server.  Generally these examples involve
providing <STRONG>MySQL</STRONG> as part of a product or service that you are selling
to a customer, or requiring that <STRONG>MySQL</STRONG> be used in conjunction with
your product.  In such cases, it is your responsibility to obtain a license
for the customer if one is necessary.  (This requirement is waived if your
customer already has a <STRONG>MySQL</STRONG> license.  But the seller must send
customer information and the license number to TcX, and the license must be a
full license, not an OEM license.)

</P>
<P>
Note that a single <STRONG>MySQL</STRONG> license covers any number of
CPUs/users/customers/<CODE>mysqld</CODE> servers on a machine!

</P>


<H3><A NAME="Products_that_use_MySQL" HREF="manual_toc.html#Products_that_use_MySQL">3.4.1  Selling products that use MySQL</A></H3>

<P>
To determine whether or not you need a <STRONG>MySQL</STRONG> license when selling
your application, you should ask whether the proper functioning of your
application is contingent on the use of <STRONG>MySQL</STRONG> and whether you
include <STRONG>MySQL</STRONG> with your product.  There are several cases to
consider:

</P>

<UL>
<LI>

Does your application require <STRONG>MySQL</STRONG> to function properly?

If your product requires <STRONG>MySQL</STRONG>, you need a license for any machine
that runs the <CODE>mysqld</CODE> server.  For example, if you've designed your
application around <STRONG>MySQL</STRONG>, then you've really made a commercial
product that requires the engine, so you need a license.

If your application does not require <STRONG>MySQL</STRONG>, you need not obtain a
license.  For example, if <STRONG>MySQL</STRONG> just added some new optional
features to your product (such as adding logging to a database if
<STRONG>MySQL</STRONG> is used rather than logging to a text file), it should fall
within normal use, and a license would not be required.

In other words, you need a license if you sell a product designed
specifically for use with <STRONG>MySQL</STRONG> or that requires the <STRONG>MySQL</STRONG>
server to function at all.  This is true whether or not you provide
<STRONG>MySQL</STRONG> for your client as part of your product distribution.

It also depends on what you're doing for the client.  Do you plan to provide
your client with detailed instructions on installing <STRONG>MySQL</STRONG> with your
software?  Then your product may be contingent on the use of <STRONG>MySQL</STRONG>;
if so, you need to buy a license.  If you are simply tying into a database
that you expect already to have been installed by the time your software is
purchased, then you probably don't need a license.

<LI>

Do you include <STRONG>MySQL</STRONG> in a distribution and charge for that
distribution?

If you include <STRONG>MySQL</STRONG> with a distribution that you sell to customers,
you will need a license for any machine that runs the <CODE>mysqld</CODE> server,
because in this case you are selling a system that includes <STRONG>MySQL</STRONG>.

This is true whether the use of <STRONG>MySQL</STRONG> with your product
is required or optional.

<LI>

Do you neither require for your product nor include <STRONG>MySQL</STRONG> with it?

Suppose you want to sell a product that is designed generally to use ``some
database'' and that can be configured to use any of several supported
alternative database systems (<STRONG>MySQL</STRONG>, PostgreSQL, or something
else).  That is, your product does not not require <STRONG>MySQL</STRONG>, but can
support any database with a base level of functionality, and you don't rely
on anything that only <STRONG>MySQL</STRONG> supports.  Does one of you owe us money
if your customer actually does choose to use <STRONG>MySQL</STRONG>?

In this case, if you don't provide, obtain or set up <STRONG>MySQL</STRONG> for the
customer should the customer decide to use it, neither of you need a
license.  If you do perform that service, see section <A HREF="manual.html#MySQL_services">3.4.2  Selling MySQL-related services</A>.
</UL>



<H3><A NAME="MySQL_services" HREF="manual_toc.html#MySQL_services">3.4.2  Selling MySQL-related services</A></H3>

<P>
If you perform <STRONG>MySQL</STRONG> installation on a client's machine and any
money changes hands for the service (directly or indirectly), then you must
buy a <STRONG>MySQL</STRONG> license.

</P>
<P>
If you sell an application for which <STRONG>MySQL</STRONG> is not strictly required
but can be used, a license may be indicated, depending on how <STRONG>MySQL</STRONG>
is set up.  Suppose your product neither requires <STRONG>MySQL</STRONG> nor includes
it in your product distribution, but can be configured to use <STRONG>MySQL</STRONG>
for those customers who so desire.  (This would be the case, for example, if
your product can use any of a number of database engines.)

</P>
<P>
If the customer obtains and installs <STRONG>MySQL</STRONG>, no license is needed.
If you perform that service for your customer, then a license is needed
because then you are selling a service that includes <STRONG>MySQL</STRONG>.

</P>


<H3><A NAME="ISP" HREF="manual_toc.html#ISP">3.4.3  ISP MySQL services</A></H3>

<P>
Internet Service Providers (ISPs) often host <STRONG>MySQL</STRONG> servers for
their customers.

</P>
<P>
If you are an ISP that allows customers to install and administer
<STRONG>MySQL</STRONG> for themselves on your machine with no assistance from you,
neither you nor your customer need a <STRONG>MySQL</STRONG> license.

</P>
<P>
If you charge for <STRONG>MySQL</STRONG> installation and administrative support as
part of your customer service, then you need a license because you are selling
a service that includes <STRONG>MySQL</STRONG>.

</P>


<H3><A NAME="Web_server" HREF="manual_toc.html#Web_server">3.4.4  Running a web server using MySQL</A></H3>

<P>
If you use <STRONG>MySQL</STRONG> in conjunction with a web server, you don't have to
pay for a license.

</P>
<P>
This is true even if you run a commercial web server that uses
<STRONG>MySQL</STRONG>, since you are not selling <STRONG>MySQL</STRONG> itself.  However, in
this case we would like you to purchase <STRONG>MySQL</STRONG> support, because
<STRONG>MySQL</STRONG> is helping your enterprise.

</P>
<P>
<A NAME="IDX19"></A>
<A NAME="IDX20"></A>
<A NAME="IDX21"></A>


<H2><A NAME="Cost" HREF="manual_toc.html#Cost">3.5  MySQL licensing and support costs</A></H2>

<P>
Our current license prices are shown below. All prices are in US
Dollars. If you pay by credit card, the currency is EURO (European Union Euro)
so the prices will differ slightly.

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><STRONG>Number of licenses</STRONG> </TD><TD> <STRONG>Price per copy</STRONG> </TD><TD> <STRONG>Total</STRONG>
</TR NOSAVE>
<TR><TD>1 </TD><TD> US $200 </TD><TD> US $200
</TR NOSAVE>
<TR><TD>10 pack </TD><TD> US $150 </TD><TD> US $1500
</TR NOSAVE>
<TR><TD>50 pack </TD><TD> US $120 </TD><TD> US $6000
</TR>
</TABLE>

<P>
For high volume (OEM) purchases, the following prices apply:

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><STRONG>Number of licenses</STRONG> </TD><TD> <STRONG>Price per copy</STRONG> </TD><TD> <STRONG>Minimum at one time</STRONG> </TD><TD> <STRONG>Minimum payment</STRONG>
</TR NOSAVE>
<TR><TD>100-999 </TD><TD> US $40 </TD><TD> 100 </TD><TD> US $4000
</TR NOSAVE>
<TR><TD>1000-2499 </TD><TD> US $25 </TD><TD> 200 </TD><TD> US $5000
</TR NOSAVE>
<TR><TD>2500-4999 </TD><TD> US $20 </TD><TD> 400 </TD><TD> US $8000
</TR>
</TABLE>

<P>
For OEM purchases, you must act as the middle-man for eventual problems
or extension requests from your users. We also require that OEM
customers have at least an extended email support contract.

</P>
<P>
If you have a low-margin high-volume product, you can always talk to us
about other terms (for example, a percent of the sale price). If you do,
please be informative about your product, pricing, market and any other
information that may be relevant.

</P>
<P>
<A NAME="IDX22"></A>
After buying 1 <STRONG>MySQL</STRONG> license, you will get a personal copy of
the <CODE>myisampack</CODE> utility.  You are not allowed to redistribute this
utility but you can distribute tables packed with it.

</P>
<P>
A full-price license is not a support agreement and includes very minimal
support. This means that we try to answer any relevant question. If the
answer is in the documentation, we will direct you to the appropriate
section. If you have not purchased a license or support, we probably will not
answer at all.

</P>
<P>
If you discover what we consider a real bug, we are likely to fix it in
any case. But if you pay for support we will notify you about the fix
status instead of just fixing it in a later release.

</P>
<P>
More comprehensive support is sold separately.  Descriptions of what each
level of support includes are given in section <A HREF="manual.html#Support">3.6  Types of commercial support</A>.  Costs for the various
types of commercial support are shown below.  Support level prices are in
EURO (European Union Euro). One EURO is about 1.17 USD.

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><STRONG>Type of support</STRONG> </TD><TD> <STRONG>Cost per year</STRONG>
</TR NOSAVE>
<TR><TD>Basic email support </TD><TD> EURO 170
</TR NOSAVE>
<TR><TD>Extended email support </TD><TD> EURO 1000
</TR NOSAVE>
<TR><TD>Login support </TD><TD> EURO 2000
</TR NOSAVE>
<TR><TD>Extended login support </TD><TD> EURO 5000
</TR>
</TABLE>

<P>
You may upgrade from any
lower level of support to a higher level of support for the difference
between the prices of the two support levels.

</P>
<P>
<A NAME="IDX23"></A>


<H3><A NAME="Payment_information" HREF="manual_toc.html#Payment_information">3.5.1  Payment information</A></H3>

<P>
Currently we can take SWIFT payments, cheques or credit cards.

</P>
<P>
Payment should be made to:

<PRE>
Postgirot Bank AB
105 06 STOCKHOLM, SWEDEN

TCX DataKonsult AB
BOX 6434
11382 STOCKHOLM, SWEDEN

SWIFT address: PGSI SESS
Account number: 96 77 06 - 3
</PRE>

<P>
Specify: license and/or support and your name and email address.

</P>
<P>
In Europe and Japan you can use EuroGiro (that should be less expensive) to the
same account.

</P>
<P>
If you want to pay by cheque, make it payable to ``Monty Program KB'' and
mail it to the address below:

</P>

<PRE>
TCX DataKonsult AB
BOX 6434, Torsgatan 21
11382 STOCKHOLM, SWEDEN
</PRE>

<P>
If you want to pay by credit card over the Internet, you can use
<a HREF="https://www.mysql.com/license.htmy"> TcX's secure license form</a>.

</P>
<P>
You can also print a copy of the license form, fill it in and send it by fax
to:

</P>
<P>
+46-8-729 69 05

</P>
<P>
If you want us to bill you, you can use the license form and write ``bill
us'' in the comment field.  You can also mail a message to
with your company information and ask us to bill you.

</P>
<P>
<A NAME="IDX24"></A>


<H3><A NAME="Contact_information" HREF="manual_toc.html#Contact_information">3.5.2  Contact information</A></H3>

<P>
For commercial licensing, or if you have any questions about any of the
information in this section, please contact the <STRONG>MySQL</STRONG> licensing
team. The much preferred method is by E-Mail to
these may take much longer (Fax +46-8-729 69 05).

</P>

<PRE>
David Axmark
Detron HB
Kungsgatan 65 B
753 21 UPPSALA
SWEDEN
Voice Phone +46-18-10 22 80     (Timezone GMT+1. Swedish and English spoken)
</PRE>

<P>
<A NAME="IDX25"></A>
<A NAME="IDX26"></A>


<H2><A NAME="Support" HREF="manual_toc.html#Support">3.6  Types of commercial support</A></H2>



<H3><A NAME="Basic_email_support" HREF="manual_toc.html#Basic_email_support">3.6.1  Basic email support</A></H3>

<P>
Basic email support is a very inexpensive support option and should be
thought of more as a way to support our development of <STRONG>MySQL</STRONG> than as
a real support option.

</P>
<P>
At this support level, the <STRONG>MySQL</STRONG> mailing lists are the preferred
means of communication.  Questions normally should be mailed to the primary
mailing list (<a HREF="mailto:mysql@lists.mysql.com">mysql@lists.mysql.com</a>) or one of the other regular
lists (for example, <a HREF="mailto:mysql-win32@lists.mysql.com">mysql-win32@lists.mysql.com</a> for Windows-related
<STRONG>MySQL</STRONG> questions), as someone else already may have experienced and
solved the problem you have.  See section <A HREF="manual.html#Asking_questions">2.2  Asking questions or reporting bugs</A>.

</P>
<P>
However, by purchasing basic email support, you also have access to the
support address <a HREF="mailto:mysql-support@mysql.com">mysql-support@mysql.com</a>, which is not available as part
of the minimal support that you get by purchasing a <STRONG>MySQL</STRONG> license.
This means that for especially critical questions, you can cross-post your
message to <a HREF="mailto:mysql-support@mysql.com">mysql-support@mysql.com</a>.  (If the message contains sensitive
data, you should post only to <a HREF="mailto:mysql-support@mysql.com">mysql-support@mysql.com</a>.)

</P>
<P>
<EM>REMEMBER!</EM> to ALWAYS include your registration number and
expiration date when you send a message to

</P>
<P>
Basic email support includes the following types of service:

</P>

<UL>
<LI>

If your question is already answered in the manual, we will inform you of the
correct section in which you can find the answer.  If the answer is not in
the manual, we will point you in the right direction to solve your problem.

<LI>

We guarantee a timely answer for your email messages.  We can't guarantee
that we can solve any problem, but at least you will receive an answer if we
can contact you by email.

<LI>

We will help with unexpected problems when you install <STRONG>MySQL</STRONG> from a
binary distribution on supported platforms.  This level of support does not
cover installing <STRONG>MySQL</STRONG> from a source distribution.  ``Supported''
platforms are those for which <STRONG>MySQL</STRONG> is known to work.
See section <A HREF="manual.html#Which_OS">4.2  Operating systems supported by MySQL</A>.

<LI>

We will help you with bugs and missing features. Any bugs that are found are
fixed for the next <STRONG>MySQL</STRONG> release. If the bug is critical for
you, we will mail you a patch for it as soon the bug is fixed.  Critical
bugs always have the highest priority for us, to ensure that they are
fixed as soon as possible.

<LI>

Your suggestions for the further development of <STRONG>MySQL</STRONG> will be
taken into consideration. By taking email support you have already
helped the further development of <STRONG>MySQL</STRONG>. If you want to have
more input, upgrade to a higher level of support.

<LI>

If you want us to help optimize your system, you must upgrade to a
higher level of support.

<LI>

<A NAME="IDX27"></A>
We include a binary version of the <CODE>myisampack</CODE> packing tool for
creating fast compressed read-only databases. The current server includes
support for reading such databases but not the packing tool used to
create them.
</UL>



<H3><A NAME="Extended_email_support" HREF="manual_toc.html#Extended_email_support">3.6.2  Extended email support</A></H3>

<P>
Extended email support includes everything in basic email support with
these additions:

</P>

<UL>
<LI>

Your email will be dealt with before mail from basic email support users and
non-registered users.

<LI>

Your suggestions for the further development of <STRONG>MySQL</STRONG> will
receive strong consideration. Simple extensions that suit the basic
goals of <STRONG>MySQL</STRONG> are implemented in a matter of days. By taking
extended email support you have already helped the further development
of <STRONG>MySQL</STRONG>.

<LI>

Typical questions that are covered by extended email support are:


<UL>
<LI>

We will answer and (within reason) solve questions that relate to possible
bugs in <STRONG>MySQL</STRONG>.  As soon as the bug is found and corrected, we
will mail a patch for it.

<LI>

We will help with unexpected problems when you install <STRONG>MySQL</STRONG> from a
source or binary distribution on supported platforms.

<LI>

We will answer questions about missing features and offer hints how to work
around them.

<LI>

We will provide hints on optimizing <CODE>mysqld</CODE> for your situation.
</UL>

<LI>

You are allowed to influence the priority of items on the <STRONG>MySQL</STRONG>
TODO. This will ensure that the features you really need will be implemented
sooner than they might be otherwise.
</UL>



<H3><A NAME="Login_support" HREF="manual_toc.html#Login_support">3.6.3  Login support</A></H3>

<P>
Login support includes everything in extended email support with
these additions:

</P>

<UL>
<LI>

Your email will be dealt with even before mail from extended email
support users.

<LI>

Your suggestions for the further development of <STRONG>MySQL</STRONG> will
be taken into very high consideration.  Realistic extensions that can be
implemented in a couple of hours and that suit the basic goals of
<STRONG>MySQL</STRONG> will be implemented as soon as possible.

<LI>

If you have a very specific problem, we can try to log in on your system
to solve the problem ``in place.''

<LI>

Like any database vendor, we can't guarantee that we can rescue any data from
crashed tables, but if the worst happens we will help you rescue as much as
possible. <STRONG>MySQL</STRONG> has proven itself very reliable, but anything is
possible due to circumstances beyond our control (for example, if your system
crashes or someone kills the server by executing a <CODE>kill -9</CODE> command).

<LI>

We will provide hints on optimizing your system and your queries.

<LI>

You are allowed to call a <STRONG>MySQL</STRONG> developer (in moderation) and
discuss your <STRONG>MySQL</STRONG>-related problems.
</UL>



<H3><A NAME="Extended_login_support" HREF="manual_toc.html#Extended_login_support">3.6.4  Extended login support</A></H3>

<P>
Extended login support includes everything in login support with these
additions:

</P>

<UL>
<LI>

Your email has the highest possible priority.

<LI>

We will actively examine your system and help you optimize it and your
queries. We may also optimize and/or extend <STRONG>MySQL</STRONG> to better
suit your needs.

<LI>

You may also request special extensions just for you. For example:

<PRE>
mysql&#62; select MY_CALCULATION(col_name1,col_name2) from tbl_name;
</PRE>

<LI>

We will provide a binary distribution of all important <STRONG>MySQL</STRONG>
releases for your system, as long as we can get an account on a
similar system. In the worst case, we may require access to your system
to be able to create a binary distribution.

<LI>

If you can provide accommodations and pay for traveler fares, you can even
get a <STRONG>MySQL</STRONG> developer to visit you and offer you help with your
troubles. Extended login support entitles you to one personal
encounter per year, but we are as always very flexible towards our customers!
</UL>



<H1><A NAME="Installing" HREF="manual_toc.html#Installing">4  Installing MySQL</A></H1>

<P>
This chapter describes how to obtain and install <STRONG>MySQL</STRONG>:

</P>

<UL>
<LI>

For a list of sites from which you can obtain <STRONG>MySQL</STRONG>, see
section <A HREF="manual.html#Getting_MySQL">4.1  How to get MySQL</A>.

<LI>

To see which platforms are supported, see section <A HREF="manual.html#Which_OS">4.2  Operating systems supported by MySQL</A>.

<LI>

Several versions of
<STRONG>MySQL</STRONG> are available, in both binary and source distributions.
To determine which version and type of distribution
you should use, see section <A HREF="manual.html#Many_versions">4.4  How and when updates are released</A>.

<LI>

Installation instructions for binary and source distributions are described
in section <A HREF="manual.html#Installing_binary">4.6  Installing a MySQL binary distribution</A>, and section <A HREF="manual.html#Installing_source">4.7  Installing a MySQL source distribution</A>.  Each set of
instructions includes a section on system-specific problems you may run
into.

<LI>

For post-installation procedures, see section <A HREF="manual.html#Post-installation">4.15  Post-installation setup and testing</A>.  These
procedures apply whether you install <STRONG>MySQL</STRONG> using a binary or
source distribution.
</UL>

<P>
<A NAME="IDX28"></A>
<A NAME="IDX29"></A>
<A NAME="IDX30"></A>
<A NAME="IDX31"></A>


<H2><A NAME="Getting_MySQL" HREF="manual_toc.html#Getting_MySQL">4.1  How to get MySQL</A></H2>

<P>
Check the <a HREF="http://www.mysql.com/"> <STRONG>MySQL</STRONG> home page</a> for
information about the current version and for downloading instructions.

</P>
<P>
However, the Internet connection at TcX is not so fast; we would
<EM>prefer</EM> that you do the actual downloading from one of the mirror sites
listed below.

</P>
<P>
Please report bad or out of date mirrors to <a HREF="mailto:webmaster@mysql.com">webmaster@mysql.com</a>.

</P>

<P>
<STRONG>Europe:</STRONG>

</P>

<UL>
<LI>

<IMG SRC="Img/austria.gif"> Austria [Univ. of Technology/Vienna]  
<a HREF="http://gd.tuwien.ac.at/db/mysql/"> WWW</a>
<a HREF="ftp://gd.tuwien.ac.at/db/mysql/"> FTP</a>
<LI>

<IMG SRC="Img/bulgaria.gif"> Bulgaria [Naturella]  
<a HREF="ftp://ftp.ntrl.net/pub/mirror/mysql"> FTP</a>
<LI>

<IMG SRC="Img/croatia.gif"> Croatia [HULK]  
<a HREF="http://ftp.linux.hr/pub/mysql/"> WWW</a>
<a HREF="ftp://ftp.linux.hr/pub/mysql/"> FTP</a>
<LI>

<IMG SRC="Img/czech-republic.gif"> Czech Republic [Masaryk University in Brno]  
<a HREF="http://mysql.linux.cz/index.html"> WWW</a>
<a HREF="ftp://ftp.fi.muni.cz/pub/mysql/"> FTP</a>
<LI>

<IMG SRC="Img/czech-republic.gif"> Czech Republic [www.sopik.cz]  
<a HREF="http://www.mysql.cz/"> WWW</a>
<LI>

<IMG SRC="Img/denmark.gif"> Denmark [Borsen]  
<a HREF=" http://mysql.borsen.dk/"> WWW</a>
<LI>

<IMG SRC="Img/denmark.gif"> Denmark [SunSITE]  
<a HREF="http://SunSITE.auc.dk/mysql/"> WWW</a>
<a HREF="ftp://SunSITE.auc.dk/pub/databases/mysql/"> FTP</a>
<LI>

<IMG SRC="Img/estonia.gif"> Estonia [OKinteractive]  
<a HREF="http://mysql.mirror.ok.ee"> WWW</a>
<LI>

<IMG SRC="Img/france.gif"> France [minet]  
<a HREF="http://www.minet.net/devel/mysql/"> WWW</a>
<LI>

<IMG SRC="Img/finland.gif"> Finland [EUnet] 
<a HREF="http://mysql.eunet.fi/"> WWW</a>
<LI>

<IMG SRC="Img/finland.gif"> Finland [clinet] 
<a HREF="ftp://ftp.clinet.fi/mirrors/ftp.mysql.org/pub/mysql/"> FTP</a>
<LI>

<IMG SRC="Img/germany.gif"> Germany [Bonn University, Bonn]  
<a HREF="http://www.wipol.uni-bonn.de/MySQL//"> WWW</a>
<a HREF="ftp://ftp.wipol.uni-bonn.de/pub/mirror/MySQL/"> FTP</a>
<LI>

<IMG SRC="Img/germany.gif"> Germany [Wolfenbuettel]  
<a HREF="http://www.fh-wolfenbuettel.de/ftp/pub/database/mysql/"> WWW</a>
<a HREF="ftp://ftp.fh-wolfenbuettel.de/pub/database/mysql/"> FTP</a>
<LI>

<IMG SRC="Img/germany.gif"> Germany [Staufen]  
<a HREF="http://mysql.staufen.de/"> WWW</a>
<LI>

<IMG SRC="Img/germany.gif"> Germany [Cable &#38; Wireless]  
<a HREF="ftp://ftp.ecrc.net/pub/database/mysql/"> FTP</a>
<LI>

<IMG SRC="Img/greece.gif"> Greece [NTUA, Athens]  
<a HREF="http://www.ntua.gr/mysql/"> WWW</a>
<a HREF="ftp://ftp.ntua.gr/pub/databases/mysql/"> FTP</a>
<LI>

<IMG SRC="Img/iceland.gif"> Island [GM]  
<a HREF="http://mysql.gm.is/"> WWW</a>
<a HREF="ftp://ftp.gm.is/pub/mysql"> WWW</a>
<LI>

<IMG SRC="Img/italy.gif"> Italy [Teta Srl]  
<a HREF="http://www.teta.it/mysql/"> WWW</a>
<LI>

<IMG SRC="Img/ireland.gif"> Ireland [Ireland On-Line/Dublin]  
<a HREF="http://mysql.iol.ie"> WWW</a>
<a HREF="ftp://ftp.iol.ie/pub/mysql"> FTP</a>
<LI>

<IMG SRC="Img/poland.gif"> Poland [Sunsite]  
<a HREF="http://sunsite.icm.edu.pl/mysql/"> WWW</a>
<a HREF="ftp://sunsite.icm.edu.pl/pub/unix/mysql/"> FTP</a>
<LI>

<IMG SRC="Img/portugal.gif"> Portugal [lerianet]  
<a HREF="http://mysql.leirianet.pt"> WWW</a>
<a HREF="ftp://ftp.leirianet.pt/pub/mysql/">FTP</a>
<LI>

<IMG SRC="Img/russia.gif"> Russia [DirectNet]  
<a HREF="http://mysql.directnet.ru"> WWW</a>
<LI>

<IMG SRC="Img/russia.gif"> Russia [IZHCOM]  
<a HREF="http://mysql.udm.net/"> WWW</a>
<a HREF="ftp://ftp.izhcom.ru/pub/mysql/">FTP</a>
<LI>

<IMG SRC="Img/russia.gif"> Russia [Scientific Center/Chernogolovka]  
<a HREF="ftp://ftp.chg.ru/pub/databases/mysql/"> FTP</a>
<LI>

<IMG SRC="Img/romania.gif"> Romania [Timisoara]  
<a HREF="http://www.dnttm.ro/mysql"> WWW</a>
<a HREF="ftp://ftp.dnttm.ro/pub/mysql"> FTP</a>
<LI>

<IMG SRC="Img/romania.gif"> Romania [Bucharest]  
<a HREF="http://www.lbi.ro/MySQL"> WWW</a>
<a HREF="ftp://ftp.lbi.ro/mirrors/ftp.tcx.se"> FTP</a>

<LI>

<IMG SRC="Img/spain.gif"> Spain [MasterD]
<a HREF="http://mysql.masterd.es"> WWW</a>

<LI>

<IMG SRC="Img/sweden.gif"> Sweden [Sunet]  
<a HREF="http://ftp.sunet.se/pub/unix/databases/relational/mysql/"> WWW</a>
<a HREF="ftp://ftp.sunet.se/pub/unix/databases/relational/mysql/"> FTP</a>

<LI>

<IMG SRC="Img/switzerland.gif"> Switzerland [Sunsite]  
<a HREF="http://sunsite.cnlab-switch.ch/ftp/mirror/mysql/"> WWW</a>
<a HREF="ftp://sunsite.cnlab-switch.ch/mirror/mysql/"> FTP</a>

<LI>

<IMG SRC="Img/great-britain.gif"> UK [Omnipotent/UK]  
<a HREF="http://mysql.omnipotent.net/"> WWW</a>
<a HREF="ftp://mysql.omnipotent.net/"> FTP</a>

<LI>

<IMG SRC="Img/great-britain.gif"> UK [PLiG/UK]  
<a HREF="http://ftp.plig.org/pub/mysql/"> WWW</a>
<a HREF="ftp://ftp.plig.org/pub/mysql/"> FTP</a>

<LI>

<IMG SRC="Img/great-britain.gif"> UK [SunSITE] 
<a HREF="http://sunsite.org.uk/packages/mysql/"> WWW</a>
<a HREF="ftp://sunsite.org.uk/packages/mysql/"> FTP</a>

<LI>

<IMG SRC="Img/ukraine.gif"> Ukraine [PACO] 
<a HREF="http://mysql.paco.net.ua"> WWW</a>
<a HREF="ftp://mysql.paco.net.ua/"> FTP</a>

</UL>

<P>
<STRONG>North America:</STRONG>

</P>

<UL>

<LI>

<IMG SRC="Img/canada.gif"> Canada [Tryc]  
<a HREF="http://web.tryc.on.ca/mysql/"> WWW</a>

<LI>

<IMG SRC="Img/canada.gif"> Canada [Cyberus]  
<a HREF="http://mysql.cyberus.ca/"> WWW</a>
<a HREF="ftp://mysql.cyberus.ca/"> FTP</a> 

<LI>

<IMG SRC="Img/usa.gif"> USA [Hurricane Electric/San Jose]  
<a HREF="http://mysql.he.net"> WWW</a>

<LI>

<IMG SRC="Img/usa.gif"> USA [Meltzer/New York State]  
<a HREF="ftp://ftp.meltzer.org/pub/mysql/"> FTP</a>

<LI>

<IMG SRC="Img/usa.gif"> USA [Circle Net/North Carolina]  
<a HREF="http://www.mysql.net"> WWW</a>

<LI>

<IMG SRC="Img/usa.gif"> USA [Gina net/Florida]  
<a HREF="http://www.gina.net/mysql/"> WWW</a>

<LI>

<IMG SRC="Img/usa.gif"> USA [Wisconsin University/Wisconsin] 
<a HREF="http://mirror.sit.wisc.edu/mysql/"> WWW</a>
<a HREF="ftp://mirror.sit.wisc.edu/mirrors/mysql/"> FTP</a>

<LI>

<IMG SRC="Img/usa.gif"> USA [DIGEX]  
<a HREF="ftp://ftp.digex.net/pub/packages/database/mysql/"> FTP</a>

</UL>

<P>
<STRONG>South America:</STRONG>

</P>

<UL>
<LI>

<IMG SRC="Img/brazil.gif"> Brazil [Matrix]  
<a HREF="http://mysql.matrix.com.br"> WWW</a>
<LI>

<IMG SRC="Img/chile.gif"> Chile [Vision]  
<a HREF="http://mysql.vision.cl/"> WWW</a>

</UL>

<P>
<STRONG>Asia:</STRONG>

</P>

<UL>
<LI>

<IMG SRC="Img/china.gif"> China [Freecode]  
<a HREF="http://mysql.freecode.com.cn"> WWW</a>

<LI>

<IMG SRC="Img/china.gif"> China [Netfirm]  
<a HREF="http://mysql.netfirm.net"> WWW</a>

<LI>

<IMG SRC="Img/south-korea.gif"> Korea [KREONet]  
<a HREF="http://linux.kreonet.re.kr/mysql/"> WWW</a>

<LI>

<IMG SRC="Img/japan.gif"> Japan [Soft Agency]  
<a HREF="http://www.softagency.co.jp/MySQL"> WWW</a>

<LI>

<IMG SRC="Img/japan.gif"> Japan [Nagoya Syouka University]  
<a HREF="http://mirror.nucba.ac.jp/mirror/mysql"> WWW</a>
<a HREF="ftp://mirror.nucba.ac.jp/mirror/mysql"> FTP</a>

<LI>

<IMG SRC="Img/singapore.gif"> Singapore [HJC] 
<a HREF="http://mysql.hjc.edu.sg"> WWW</a>
<a HREF="ftp://ftp.hjc.edu.sg/mysql"> FTP</a>

<LI>

<IMG SRC="Img/taiwan.gif"> Taiwan [HT]  
<a HREF="http://mysql.ht.net.tw"> WWW</a>
</UL>

<P>
<STRONG>Australia:</STRONG>

</P>

<UL>
<LI>

<IMG SRC="Img/australia.gif"> Australia [AARNet/Queensland]  
<a HREF="http://mirror.aarnet.edu.au/mysql"> WWW</a>
<a HREF="ftp://mirror.aarnet.edu.au/pub/mysql"> FTP</a>

<LI>

<IMG SRC="Img/australia.gif"> Australia [Blue Planet/Melbourne]  
<a HREF="http://mysql.bluep.com/"> WWW</a>

<LI>

<IMG SRC="Img/australia.gif"> Australia [ITworks Consulting/Victoria]  
<a HREF="http://mysql.itworks.com.au"> WWW</a>

</UL>

<P>
<STRONG>Africa:</STRONG>

</P>

<UL>

<LI>

<IMG SRC="Img/south-africa1.gif"> South-Africa [Mweb/]  
<a HREF="http://www.mysql.mweb.co.za"> WWW</a>

<LI>

<IMG SRC="Img/south-africa1.gif"> South-Africa [The Internet Solution/Johannesburg]  
<a HREF="ftp://ftp.is.co.za/linux/mysql/"> FTP</a>

</UL>



<H2><A NAME="Which_OS" HREF="manual_toc.html#Which_OS">4.2  Operating systems supported by MySQL</A></H2>

<P>
We use GNU Autoconf so it is possible to port <STRONG>MySQL</STRONG> to all modern
systems with working Posix threads and a C++ compiler. (To compile only the
client code, a C++ compiler is required but not threads.)  We use and develop
the software ourselves primarily on Sun Solaris (versions 2.5 &#38; 2.6) and to a
lesser extent on RedHat Linux 5.0.

</P>
<P>
<STRONG>MySQL</STRONG> has been reported to compile sucessfully on the following
operating system/thread package combinations.  Note that for many operating
systems, the native thread support works only in the latest versions.

</P>

<UL>
<LI>

AIX 4.x with native threads
<LI>

BSDI 2.x with the included MIT-pthreads package
<LI>

BSDI 3.0, 3.1 and 4.x with native threads
<LI>

DEC UNIX 4.x with native threads
<LI>

FreeBSD 2.x with the included MIT-pthreads package
<LI>

FreeBSD 3.x with native threads
<LI>

HP-UX 10.20 with the included MIT-pthreads package
<LI>

HP-UX 11.x with the native threads.
<LI>

Linux 2.0+ with LinuxThreads 0.7.1 or <CODE>glibc</CODE> 2.0.7
<LI>

MacOS X Server
<LI>

NetBSD 1.3/1.4 Intel and NetBSD 1.3 Alpha (Requires GNU make)
<LI>

OpenBSD &#62; 2.5 with native therads. OpenBSD &#60; 2.5 with the included
MIT-pthreads package
<LI>

OS/2 Warp 3, FixPack 29 and OS/2 Warp 4, FixPack 4
<LI>

SGI Irix 6.x with native threads
<LI>

Solaris 2.5, 2.6 and 2.7 with native threads on SPARC and x86
<LI>

SunOS 4.x with the included MIT-pthreads package
<LI>

SCO OpenServer with a recent port of the FSU Pthreads package
<LI>

SCO UnixWare 7.0.1
<LI>

Tru64 Unix
<LI>

Win95, Win98 and NT (the newest version is currently available only for
users with a <STRONG>MySQL</STRONG> license or <STRONG>MySQL</STRONG> email support).
For those who wish to test before they buy, we have released
<a HREF="http://www.mysql.com/mysql_w32.htmy"><STRONG>MySQL</STRONG> 3.21.29</a> (an
older version) as shareware.
</UL>

<P>
<A NAME="IDX32"></A>
<A NAME="IDX33"></A>
<A NAME="IDX34"></A>
<A NAME="IDX35"></A>
<A NAME="IDX36"></A>


<H2><A NAME="Which_version" HREF="manual_toc.html#Which_version">4.3  Which MySQL version to use</A></H2>

<P>
The first decision to make is whether you want to use the latest development
release or the last stable release:

</P>

<UL>
<LI>

Normally, if you are beginning to use <STRONG>MySQL</STRONG> for the first time or
trying to port it to some system for which there is no binary distribution,
we recommend going with the development release (currently 3.22.x). This is
because there are usually no really serious bugs in the development release,
and you can easily test it on your machine with the <CODE>crash-me</CODE> and
benchmark tests.
See section <A HREF="manual.html#Benchmarks">10.8  Using your own benchmarks</A>.

<LI>

Otherwise, if you are running an old system and want to upgrade, but don't
want to take chances with 3.22, you should upgrade to 3.21.33.  We have tried
to fix only fatal bugs and make small, relatively safe changes to that
version.
</UL>

<P>
The second decision to make is whether you want to use a source distribution or
a binary distribution:

</P>

<UL>
<LI>

If you want to run <STRONG>MySQL</STRONG> on a platform for which a current binary
distribution exists, use that.  Generally, it will be easier to install
than a source distribution.

<LI>

If you want to read (and/or modify) the C and C++ code that makes up
<STRONG>MySQL</STRONG>, you should get a source distribution. The source code is
always the ultimate manual. Source distributions also contain more
tests and examples than binary distributions.
</UL>

<P>
The <STRONG>MySQL</STRONG> naming scheme uses release numbers that consist of three
numbers and a suffix.  For example, a release name like
<CODE>mysql-3.21.17-beta</CODE> is interpreted like this:

</P>

<UL>
<LI>

The first number (<CODE>3</CODE>) describes the file format.  All
version 3 releases have the same file format. When a version 4 appears, every
table will have to be converted to the new format (nice tools for this will
be included, of course).

<LI>

The second number (<CODE>21</CODE>) is the release level. Normally there are two to
choose from. One is the release/stable branch (currently <CODE>21</CODE>) and the
other is the development branch (currently <CODE>22</CODE>) . Normally both are
stable, but the development version may have quirks, missing documentation on
new features or may fail to compile on some systems.

<LI>

The third number (<CODE>17</CODE>) is the version number within the
release level. This is incremented for each new distribution. Usually you
want the latest version for the release level you have choosen.

<LI>

The suffix (<CODE>beta</CODE>) indicates the stability level of
the release.  The possible suffixes are:


<UL>
<LI><CODE>alpha</CODE> indicates that the release contains some large section of

new code that hasn't been 100% tested.  Known bugs (usually there are none)
should be documented in the News section.  See section <A HREF="manual.html#News">D  MySQL change history</A>.  There are also new
commands and extensions in most alpha releases.

<LI>

<CODE>beta</CODE> means that all new code has been tested. No major new features
were added. There should be no known bugs.

<LI>

<CODE>gamma</CODE> is a beta that has been around a while and seems to work fine.
This is what many other companies call a release.

<LI>

If there is no suffix, it means that the version has been run for a while
at many different sites with no reports of bugs other than platform-specific
bugs.  This is what we call a stable release.
</UL>

</UL>

<P>
All versions of <STRONG>MySQL</STRONG> are run through our standard tests and
benchmarks to ensure that they are relatively safe to use.  Since the standard
tests are extended over time to check for all previously found bugs,
the test suite keeps getting better.

</P>
<P>
Note that all releases have been tested at least with:

</P>
<DL COMPACT>

<DT>An internal test suite
<DD>
This is part of a production system for a customer. It has many tables with
hundreds of megabytes of data.

<DT>The <STRONG>MySQL</STRONG> benchmark suite
<DD>
This runs a range of common queries. It is also a test to see whether the
latest batch of optimizations actually made the code faster.
See section <A HREF="manual.html#Benchmarks">10.8  Using your own benchmarks</A>.

<DT>The <CODE>crash-me</CODE> test
<DD>
This tries to determine what features the database supports and what its
capabilities and limitations are.
See section <A HREF="manual.html#Benchmarks">10.8  Using your own benchmarks</A>.
</DL>

<P>
Another test is that we use the newest <STRONG>MySQL</STRONG> version in our internal
production environment, on at least one machine.  We have more than 100
gigabytes of data to work with.

</P>


<H2><A NAME="Many_versions" HREF="manual_toc.html#Many_versions">4.4  How and when updates are released</A></H2>

<P>
<STRONG>MySQL</STRONG> is evolving quite rapidly here at TcX and we want
to share this with other <STRONG>MySQL</STRONG> users. We try to make a release
when we have very useful features that others seem to have a need for.

</P>
<P>
We also try to help out users who request features that are easy to
implement. We also take note of what our licensed users want to have and
we especially take note of what our extended email supported customers
want and try to help them out.

</P>
<P>
No one has to download a new release. The News section will tell you if
the new release has something you really want. See section <A HREF="manual.html#News">D  MySQL change history</A>.

</P>
<P>
We use the following policy when updating <STRONG>MySQL</STRONG>:

</P>

<UL>
<LI>

For each minor update, the last number in the version string is incremented.
When there are major new features or minor incompatibilities with previous
versions, the second number in the version string is incremented. When the
file format changes, the first number is increased.

<LI>

Stable tested releases are meant to appear about 1-2 times a year, but
if small bugs are found, a release with only bug-fixes will be released.

<LI>

Working releases are meant to appear about every 1-8 weeks.

<LI>

Binary distributions for some platforms will be made by us for major releases.
Other people may make binary distributions for other systems but probably
less frequently.

<LI>

We usually make patches available as soon as we have located and fixed
small bugs.

<LI>

For non-critical but annoying bugs, we will make patches available if they
are sent to us. Otherwise we will combine many of them into a larger
patch.

<LI>

If there is, by any chance, a fatal bug in a release we will make a new
release as soon as possible. We would like other companies to do this,
too. :)
</UL>

<P>
The current stable release is 3.22; We have already moved active
development to 3.23. Bugs will still be fixed in the stable version. We
don't believe in a complete freeze, as this also leaves out bug fixes
and things that ``must be done''. ``Somewhat frozen'' means that we may
add small things that ``almost surely will not affect anything that's
already working''.

</P>


<H2><A NAME="Installation_layouts" HREF="manual_toc.html#Installation_layouts">4.5  Installation layouts</A></H2>

<P>
This section describes the default layout of the directories created by
installing binary and source distributions.

</P>
<P>
A binary distribution is installed by unpacking it at the installation
location you choose (typically <TT>`/usr/local/mysql'</TT>) and creates the
following directories in that location:

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><STRONG>Directory</STRONG> </TD><TD> <STRONG>Contents of directory</STRONG>
</TR NOSAVE>
<TR><TD><TT>`bin'</TT> </TD><TD> Client programs and the <CODE>mysqld</CODE> server
</TR NOSAVE>
<TR><TD><TT>`data'</TT> </TD><TD> Log files, databases
</TR NOSAVE>
<TR><TD><TT>`include'</TT> </TD><TD> Include (header) files
</TR NOSAVE>
<TR><TD><TT>`lib'</TT> </TD><TD> Libraries
</TR NOSAVE>
<TR><TD><TT>`scripts'</TT> </TD><TD> <CODE>mysql_install_db</CODE>
</TR NOSAVE>
<TR><TD><TT>`share/mysql'</TT> </TD><TD> Error message files
</TR NOSAVE>
<TR><TD><TT>`sql-bench'</TT> </TD><TD> Benchmarks
</TR>
</TABLE>

<P>
A source distribution is installed after you configure and compile it.  By
default, the installation step installs files under <TT>`/usr/local'</TT>, in the
following subdirectories:

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><STRONG>Directory</STRONG> </TD><TD> <STRONG>Contents of directory</STRONG>
</TR NOSAVE>
<TR><TD><TT>`bin'</TT> </TD><TD> Client programs and scripts
</TR NOSAVE>
<TR><TD><TT>`include/mysql'</TT> </TD><TD> Include (header) files
</TR NOSAVE>
<TR><TD><TT>`info'</TT> </TD><TD> Documentation in Info format
</TR NOSAVE>
<TR><TD><TT>`lib/mysql'</TT> </TD><TD> Libraries
</TR NOSAVE>
<TR><TD><TT>`libexec'</TT> </TD><TD> The <CODE>mysqld</CODE> server
</TR NOSAVE>
<TR><TD><TT>`share/mysql'</TT> </TD><TD> Error message files
</TR NOSAVE>
<TR><TD><TT>`sql-bench'</TT> </TD><TD> Benchmarks and <CODE>crash-me</CODE> test
</TR NOSAVE>
<TR><TD><TT>`var'</TT> </TD><TD> Databases and log files.
</TR>
</TABLE>

<P>
Within an installation directory, the layout of a source installation differs
from that of a binary installation in the following ways:

</P>

<UL>
<LI>

The <CODE>mysqld</CODE> server is installed in the <TT>`libexec'</TT>
directory rather than in the <TT>`bin'</TT> directory.

<LI>

The data directory is <TT>`var'</TT> rather than <TT>`data'</TT>.

<LI>

<CODE>mysql_install_db</CODE> is installed in the <TT>`/usr/local/bin'</TT> directory
rather than in <TT>`/usr/local/mysql/scripts'</TT>.

<LI>

The header file and library directories are <TT>`include/mysql'</TT> and
<TT>`lib/mysql'</TT> rather than <TT>`include'</TT> and <TT>`lib'</TT>.
</UL>



<H2><A NAME="Installing_binary" HREF="manual_toc.html#Installing_binary">4.6  Installing a MySQL binary distribution</A></H2>

<P>
You need the following tools to install a <STRONG>MySQL</STRONG> binary distribution:

</P>

<UL>
<LI>

GNU <CODE>gunzip</CODE> to uncompress the distribution.

<LI>

A reasonable <CODE>tar</CODE> to unpack the distribution. GNU <CODE>tar</CODE> is
known to work.
</UL>

<P>
<A NAME="IDX37"></A>
<A NAME="IDX38"></A>
An alternative installation method under Linux is to use RPM (RedHat Package
Manager) distributions. See section <A HREF="manual.html#Linux-RPM">4.6.1  Linux RPM notes</A>.

</P>
<P>
If you run into problems, <STRONG>PLEASE ALWAYS USE</STRONG> <CODE>mysqlbug</CODE> when
posting questions to <a HREF="mailto:mysql@lists.mysql.com">mysql@lists.mysql.com</a>.  Even if the problem
isn't a bug, <CODE>mysqlbug</CODE> gathers system information that will help others
solve your problem.  By not using <CODE>mysqlbug</CODE>, you lessen the likelihood
of getting a solution to your problem!  You will find <CODE>mysqlbug</CODE> in the
<TT>`bin'</TT> directory after you unpack the distribution.  See section <A HREF="manual.html#Bug_reports">2.3  How to report bugs or problems</A>.

</P>
<P>
The basic commands you must execute to install and use a <STRONG>MySQL</STRONG>
binary distribution are:

</P>

<PRE>
shell&#62; gunzip &#60; mysql-VERSION-OS.tar.gz | tar xvf -
shell&#62; ln -s mysql-VERSION-OS mysql
shell&#62; cd mysql
shell&#62; scripts/mysql_install_db
shell&#62; bin/safe_mysqld &#38;
</PRE>

<P>
You can add new users using the <CODE>bin/mysql_setpermission</CODE> script if
you install the <CODE>DBI</CODE> and <CODE>Msql-Mysql-modules</CODE> Perl modules.

</P>
<P>
Here follows a more detailed description:

</P>
<P>
To install a binary distribution, follow the steps below, then proceed
to section <A HREF="manual.html#Post-installation">4.15  Post-installation setup and testing</A>, for post-installation setup and testing:

</P>

<OL>
<LI>

Pick the directory under which you want to unpack the distribution, and move
into it.  In the example below, we unpack the distribution under
<TT>`/usr/local'</TT> and create a directory <TT>`/usr/local/mysql'</TT> into which
<STRONG>MySQL</STRONG> is installed.  (The following instructions therefore assume
you have permission to create files in <TT>`/usr/local'</TT>.  If that directory
is protected, you will need to perform the installation as <CODE>root</CODE>.)

<LI>

Obtain a distribution file from one of the sites listed in
section <A HREF="manual.html#Getting_MySQL">4.1  How to get MySQL</A>.

<STRONG>MySQL</STRONG> binary distributions are provided as compressed <CODE>tar</CODE>
archives and have names like <TT>`mysql-VERSION-OS.tar.gz'</TT>, where
<CODE>VERSION</CODE> is a number (e.g., <CODE>3.21.15</CODE>), and <CODE>OS</CODE> indicates
the type of operating system for which the distribution is intended (e.g.,
<CODE>pc-linux-gnu-i586</CODE>).

<LI>

Unpack the distribution and create the installation directory:


<PRE>
shell&#62; gunzip &#60; mysql-VERSION-OS.tar.gz | tar xvf -
shell&#62; ln -s mysql-VERSION-OS mysql
</PRE>

The first command creates a directory named <TT>`mysql-VERSION-OS'</TT>.  The
second command makes a symbolic link to that directory.  This lets you refer
more easily to the installation directory as <TT>`/usr/local/mysql'</TT>.

<LI>

Change into the installation directory:


<PRE>
shell&#62; cd mysql
</PRE>

You will find several files and subdirectories in the <CODE>mysql</CODE> directory.
The most important for installation purposes are the <TT>`bin'</TT> and
<TT>`scripts'</TT> subdirectories.

<DL COMPACT>

<DT><TT>`bin'</TT>
<DD>
<A NAME="IDX39"></A>
<A NAME="IDX40"></A>
This directory contains client programs and the server
You should add the full pathname of this directory to your
<CODE>PATH</CODE> environment variable so that your shell finds the <STRONG>MySQL</STRONG>
programs properly.
<DT><TT>`scripts'</TT>
<DD>
This directory contains the <CODE>mysql_install_db</CODE> script used to initialize
the server access permissions.
</DL>

<LI>

If you would like to use <CODE>mysqlaccess</CODE> and have the <STRONG>MySQL</STRONG>
distribution in some nonstandard place, you must change the location where
<CODE>mysqlaccess</CODE> expects to find the <CODE>mysql</CODE> client. Edit the
<TT>`bin/mysqlaccess'</TT> script at approximately line 18. Search for a line
that looks like this:


<PRE>
$MYSQL     = '/usr/local/bin/mysql';    # path to mysql executable
</PRE>

Change the path to reflect the location where <CODE>mysql</CODE> actually is
stored on your system.  If you do not do this, you will get a <CODE>broken
pipe</CODE> error when you run <CODE>mysqlaccess</CODE>.

<LI>

Create the <STRONG>MySQL</STRONG> grant tables (necessary only if you haven't
installed <STRONG>MySQL</STRONG> before):

<PRE>
shell&#62; scripts/mysql_install_db
</PRE>

Note that <STRONG>MySQL</STRONG> versions older than 3.22.10 started the
<STRONG>MySQL</STRONG> server when you run <CODE>mysql_install_db</CODE>.  This is no
longer true!

<LI>

If you want to install support for the Perl <CODE>DBI</CODE>/<CODE>DBD</CODE> interface,
see section <A HREF="manual.html#Perl_support">4.10  Perl installation comments</A>.

<LI>

If you would like <STRONG>MySQL</STRONG> to start automatically when you boot your
machine, you can copy <CODE>support-files/mysql.server</CODE> to the location where
your system has its startup files. More information can be found in the
<CODE>support-files/mysql.server</CODE> script itself, and in section <A HREF="manual.html#Automatic_start">4.15.3  Starting and stopping MySQL automatically</A>.

</OL>

<P>
After everything has been unpacked and installed, you should initialize
and test your distribution.

</P>
<P>
You can start the <STRONG>MySQL</STRONG> server with the following command:

</P>

<PRE>
shell&#62; bin/safe_mysqld &#38;
</PRE>

<P>
See section <A HREF="manual.html#Post-installation">4.15  Post-installation setup and testing</A>.

</P>
<P>
<A NAME="IDX41"></A>
<A NAME="IDX42"></A>


<H3><A NAME="Linux-RPM" HREF="manual_toc.html#Linux-RPM">4.6.1  Linux RPM notes</A></H3>

<P>
The recommended way to install <STRONG>MySQL</STRONG> on Linux is by using an RPM
file. The <STRONG>MySQL</STRONG> RPMs are currently being built on a RedHat 5.2
system but should work on other versions of Linux that support <CODE>rpm</CODE> and
use <CODE>glibc</CODE>.

</P>
<P>
If you have problems with an RPM file, for example <CODE>Sorry, the host
'xxxx' could not be looked up</CODE>, see section <A HREF="manual.html#Binary_notes-Linux">4.6.3.1  Linux notes</A>.

</P>
<P>
The RPM files you may want to use are:

</P>

<UL>
<LI><CODE>MySQL-VERSION.i386.rpm</CODE>

The <STRONG>MySQL</STRONG> server.  You will need this unless you only want to
connect to another <STRONG>MySQL</STRONG> server running on another machine.

<LI><CODE>MySQL-client-VERSION.i386.rpm</CODE>

The standard <STRONG>MySQL</STRONG> client programs. You probably always want to
install this package.

<LI><CODE>MySQL-bench-VERSION.i386.rpm</CODE>

Tests and benchmarks. Requires Perl and msql-mysql-modules RPMs.

<LI><CODE>MySQL-devel-VERSION.i386.rpm</CODE>

Libraries and include files needed if you want to compile other
<STRONG>MySQL</STRONG> clients, such as the Perl modules.

<LI><CODE>MySQL-VERSION.src.rpm</CODE>

This contains the source code for all of the above packages. It can also
be used to try to build RPMs for other architectures (for example, Alpha
or SPARC).
</UL>

<P>
To see all files in an RPM package:

<PRE>
shell&#62; rpm -qpl MySQL-VERSION.i386.rpm
</PRE>

<P>
To perform a standard minimal installation, run this command:

</P>

<PRE>
shell&#62; rpm -i MySQL-VERSION.i386.rpm MySQL-client-VERSION.i386.rpm
</PRE>

<P>
To install just the client package:

</P>

<PRE>
shell&#62; rpm -i MySQL-client-VERSION.i386.rpm
</PRE>

<P>
The RPM places data in <TT>`/var/lib/mysql'</TT>. The RPM also creates the
appropriate entries in <TT>`/etc/rc.d/'</TT> to start the server automatically
at boot time.  (This means that if you have performed a previous
installation, you may want to make a copy of your previously-installed
<STRONG>MySQL</STRONG> startup file if you made any changes to it, so you don't lose
your changes.)

</P>
<P>
After installing the RPM file(s), the <TT>`mysqld'</TT> demon should be running
and you should now be able to start using MySQL.
See section <A HREF="manual.html#Post-installation">4.15  Post-installation setup and testing</A>.

</P>
<P>
If something goes wrong, can find more information in the binary
installation chapter. See section <A HREF="manual.html#Installing_binary">4.6  Installing a MySQL binary distribution</A>.

</P>

<P>
<A NAME="IDX43"></A>
<A NAME="IDX44"></A>


<H3><A NAME="Building_clients" HREF="manual_toc.html#Building_clients">4.6.2  Building client programs</A></H3>

<P>
If you compile <STRONG>MySQL</STRONG> clients that you've written yourself or that
you obtain from a third party, they must be linked using the
<CODE>-lmysqlclient</CODE> option on the link command.  You may also need to
specify a <CODE>-L</CODE> option to tell the linker where to find the library.  For
example, if the library is installed in <TT>`/usr/local/mysql/lib'</TT>, use
<CODE>-L/usr/local/mysql/lib -lmysqlclient</CODE> on the link command.

</P>
<P>
For clients that use <STRONG>MySQL</STRONG> header files, you may need to specify a
<CODE>-I</CODE> option when you compile them (for example,
<CODE>-I/usr/local/mysql/include</CODE>), so the compiler can find the header
files.

</P>


<H3><A NAME="Binary_install_system_issues" HREF="manual_toc.html#Binary_install_system_issues">4.6.3  System-specific issues</A></H3>

<P>
The following sections indicate some of the issues that have been observed to
occur on particular systems when installing <STRONG>MySQL</STRONG> from a binary
distribution.

</P>


<H4><A NAME="Binary_notes-Linux" HREF="manual_toc.html#Binary_notes-Linux">4.6.3.1  Linux notes</A></H4>

<P>
<STRONG>MySQL</STRONG> needs at least Linux 2.0.

</P>
<P>
The binary release is linked with <CODE>-static</CODE>, which means you not
normally need not worry about which version of the system libraries you
have. You need not install LinuxThreads, either.  A program linked with
<CODE>-static</CODE> is slightly bigger than a dynamically-linked program but
also slightly faster (3-5%).  One problem however is that you can't use
user definable functions (UDFs) with a statically-linked program.  If
you are going to write or use UDF functions (this is something only for
C or C++ programmers) you must compile <STRONG>MySQL</STRONG> yourself, using
dynamic linking.

</P>
<P>
If you are using a <CODE>libc</CODE>-based system (instead of a <CODE>glibc2</CODE>
system), you will probably get some problems with hostname resolving and
getpwnam() with the binary release. (This is because <CODE>glibc</CODE>
unfortunately depends on some external libraries to resolve hostnames
and getwpent() , even when compiled with <CODE>-static</CODE>). In this case
you probably get the following error message when you run
<CODE>mysql_install_db</CODE>:

</P>

<PRE>
Sorry, the host 'xxxx' could not be looked up
</PRE>

<P>
or the following error when you try to run mysqld with the <CODE>--user</CODE>
option:

</P>

<PRE>
getpwnam: No such file or directory
</PRE>

<P>
You can solve this problem one of the following ways:

</P>

<UL>
<LI>

Get a <STRONG>MySQL</STRONG> source distribution (an RPM or the <CODE>tar</CODE>
distribution) and install this instead.
<LI>

Execute <CODE>mysql_install_db --force</CODE>; This will not execute the
<CODE>resolveip</CODE> test in <CODE>mysql_install_db</CODE>.  The downside is that
you can't use host names in the grant tables; you must use IP numbers
instead (except for <CODE>localhost</CODE>).  If you are using an old <STRONG>MySQL</STRONG>
release that doesn't support <CODE>--force</CODE> you have to remove the
<CODE>resolveip</CODE> test in <CODE>mysql_install</CODE> with an editor.
<LI>

Start mysqld with <CODE>su</CODE> instead of using <CODE>--user</CODE>.
</UL>

<P>
The Linux-Intel binary and RPM releases of <STRONG>MySQL</STRONG> are configured
for the highest possible speed. We are always trying to use the fastest
stable compiler available.

</P>
<P>
<STRONG>MySQL</STRONG> Perl support requires Perl 5.004_03 or newer.

</P>


<H4><A NAME="Binary_notes-HP-UX" HREF="manual_toc.html#Binary_notes-HP-UX">4.6.3.2  HP-UX notes</A></H4>

<P>
Some of the binary distributions of <STRONG>MySQL</STRONG> for HP-UX is
distributed as an HP depot file and as a tar file.  To use the depot
file you must be running at least HP-UX 10.x to have access to HP's
software depot tools.

</P>
<P>
The HP version of <STRONG>MySQL</STRONG> was compiled on an HP 9000/8xx server
under HP-UX 10.20, and uses MIT-pthreads. It is known to work
well under this configuration.
<STRONG>MySQL</STRONG> 3.22.26 and newer can also be built with HP's native
thread package.

</P>
<P>
Other configurations that may work:

</P>

<UL>
<LI>

HP 9000/7xx running HP-UX 10.20+
<LI>

HP 9000/8xx running HP-UX 10.30
</UL>

<P>
The following configurations almost definitely won't work:

</P>

<UL>
<LI>

HP 9000/7xx or 8xx running HP-UX 10.x where x &#60; 2
<LI>

HP 9000/7xx or 8xx running HP-UX 9.x
</UL>

<P>
To install the distribution, use one of the commands below, where
<CODE>/path/to/depot</CODE> is the full pathname of the depot file:

</P>

<UL>
<LI>

To install everything, including the server, client and development tools:


<PRE>
shell&#62; /usr/sbin/swinstall -s /path/to/depot mysql.full
</PRE>

<LI>

To install only the server:


<PRE>
shell&#62; /usr/sbin/swinstall -s /path/to/depot mysql.server
</PRE>

<LI>

To install only the client package:


<PRE>
shell&#62; /usr/sbin/swinstall -s /path/to/depot mysql.client
</PRE>

<LI>

To install only the development tools:


<PRE>
shell&#62; /usr/sbin/swinstall -s /path/to/depot mysql.developer
</PRE>

</UL>

<P>
The depot places binaries and libraries in <TT>`/opt/mysql'</TT> and data in
<TT>`/var/opt/mysql'</TT>. The depot also creates the appropriate entries in
<TT>`/sbin/init.d'</TT> and <TT>`/sbin/rc2.d'</TT> to start the server automatically
at boot time. Obviously, this entails being <CODE>root</CODE> to install.

</P>
<P>
To install the HP-UX tar distribution, you must have a copy of GNU <CODE>tar</CODE>.

</P>


<H2><A NAME="Installing_source" HREF="manual_toc.html#Installing_source">4.7  Installing a MySQL source distribution</A></H2>

<P>
You need the following tools to build and install <STRONG>MySQL</STRONG> from source:

</P>

<UL>
<LI>

GNU <CODE>gunzip</CODE> to uncompress the distribution.

<LI>

A reasonable <CODE>tar</CODE> to unpack the distribution. GNU <CODE>tar</CODE> is
known to work.

<LI>

A working ANSI C++ compiler. <CODE>gcc</CODE> &#62;= 2.8.1, <CODE>egcs</CODE> &#62;=
1.0.2, SGI C++ and SunPro C++ are some of the compilers that are known to
work.  <CODE>libg++</CODE> is not needed when using <CODE>gcc</CODE>.  <CODE>gcc</CODE>
2.7.x has a bug that makes it impossible to compile some perfectly legal
C++ files, such as <TT>`sql/sql_base.cc'</TT>. If you only have <CODE>gcc</CODE> 2.7.x,
you must upgrade your <CODE>gcc</CODE> to be able to compile <STRONG>MySQL</STRONG>.

<LI>

A good <CODE>make</CODE> program.  GNU <CODE>make</CODE> is always recommended and is
sometimes required.  If you have problems, we recommend trying GNU
<CODE>make</CODE> 3.75 or newer.
</UL>

<P>
If you run into problems, <STRONG>PLEASE ALWAYS USE <CODE>mysqlbug</CODE></STRONG> when
posting questions to <a HREF="mailto:mysql@lists.mysql.com">mysql@lists.mysql.com</a>.  Even if the problem
isn't a bug, <CODE>mysqlbug</CODE> gathers system information that will help others
solve your problem.  By not using <CODE>mysqlbug</CODE>, you lessen the likelihood
of getting a solution to your problem!  You will find <CODE>mysqlbug</CODE> in the
<TT>`scripts'</TT> directory after you unpack the distribution.  See section <A HREF="manual.html#Bug_reports">2.3  How to report bugs or problems</A>.

</P>



<H3><A NAME="Quick_install" HREF="manual_toc.html#Quick_install">4.7.1  Quick installation overview</A></H3>

<P>
The basic commands you must execute to install a <STRONG>MySQL</STRONG> source
distribution are (from an unpacked <CODE>tar</CODE> file):

</P>

<PRE>
shell&#62; configure
shell&#62; make
shell&#62; make install
shell&#62; scripts/mysql_install_db
shell&#62; /usr/local/mysql/bin/safe_mysqld &#38;
</PRE>

<P>
If you start from a source RPM, then do the following.

</P>

<PRE>
shell&#62; rpm --rebuild MySQL-VERSION.src.rpm
</PRE>

<P>
This will make a binary RPM that you can install.

</P>
<P>
You can add new users using the <CODE>bin/mysql_setpermission</CODE> script if
you install the <CODE>DBI</CODE> and <CODE>Msql-Mysql-modules</CODE> Perl modules.

</P>
<P>
Here follows a more detailed description:

</P>
<P>
To install a source distribution, follow the steps below, then proceed
to section <A HREF="manual.html#Post-installation">4.15  Post-installation setup and testing</A>, for post-installation initialization and testing.

</P>

<OL>
<LI>

Pick the directory under which you want to unpack the distribution, and move
into it.

<LI>

Obtain a distribution file from one of the sites listed in
section <A HREF="manual.html#Getting_MySQL">4.1  How to get MySQL</A>.

<STRONG>MySQL</STRONG> source distributions are provided as compressed <CODE>tar</CODE>
archives and have names like <TT>`mysql-VERSION.tar.gz'</TT>, where
<CODE>VERSION</CODE> is a number like 3.23.9-alpha.

<LI>

Unpack the distribution into the current directory:

<PRE>
shell&#62; gunzip &#60; mysql-VERSION.tar.gz | tar xvf -
</PRE>

This command creates a directory named <TT>`mysql-VERSION'</TT>.

<LI>

Change into the top-level directory of the unpacked distribution:

<PRE>
shell&#62; cd mysql-VERSION
</PRE>

<LI>

Configure the release and compile everything:

<PRE>
shell&#62; ./configure --prefix=/usr/local/mysql
shell&#62; make
</PRE>

When you run <CODE>configure</CODE>, you might want to specify some options.
Run <CODE>./configure --help</CODE> for a list of options.
section <A HREF="manual.html#configure_options">4.7.3  Typical <CODE>configure</CODE> options</A>, discusses some of the
more useful options.

If <CODE>configure</CODE> fails, and you are going to send mail to
lines from <TT>`config.log'</TT> that you think can help solve the problem.  Also
include the last couple of lines of output from <CODE>configure</CODE> if
<CODE>configure</CODE> aborts. Post the bug report using the <CODE>mysqlbug</CODE>
script.  See section <A HREF="manual.html#Bug_reports">2.3  How to report bugs or problems</A>.

If the compile fails, see section <A HREF="manual.html#Compilation_problems">4.8  Problems compiling?</A>, for help with
a number of common problems.

<LI>

Install everything:

<PRE>
shell&#62; make install
</PRE>

You might need to run this command as <CODE>root</CODE>.

<LI>

Create the <STRONG>MySQL</STRONG> grant tables (necessary only if you haven't
installed <STRONG>MySQL</STRONG> before):

<PRE>
shell&#62; scripts/mysql_install_db
</PRE>

Note that <STRONG>MySQL</STRONG> versions older than 3.22.10 started the
<STRONG>MySQL</STRONG> server when you run <CODE>mysql_install_db</CODE>.  This is no
longer true!

<LI>

If you want to install support for the Perl <CODE>DBI</CODE>/<CODE>DBD</CODE> interface,
see section <A HREF="manual.html#Perl_support">4.10  Perl installation comments</A>.

<LI>

If you would like <STRONG>MySQL</STRONG> to start automatically when you boot your
machine, you can copy <CODE>support-files/mysql.server</CODE> to the location where
your system has its startup files. More information can be found in the
<CODE>support-files/mysql.server</CODE> script itself, and in section <A HREF="manual.html#Automatic_start">4.15.3  Starting and stopping MySQL automatically</A>.
</OL>

<P>
After everything has been installed, you should initialize and test your
distribution.

</P>
<P>
You can start the <STRONG>MySQL</STRONG> server with the following command,
where <CODE>BINDIR</CODE> is the directory in which <CODE>safe_mysqld</CODE> is
installed (<TT>`/usr/local/bin'</TT> by default):

</P>

<PRE>
shell&#62; BINDIR/safe_mysqld &#38;
</PRE>

<P>
If that command fails immediately with <CODE>mysqld daemon ended</CODE> then you can
find some information in the file
<TT>`mysql-data-directory/'hostname'.err'</TT>.  The likely reason is that
you already have another <CODE>mysqld</CODE> server running.  See section <A HREF="manual.html#Multiple_servers">19.3  Running multiple MySQL servers on the same machine</A>.

</P>
<P>
See section <A HREF="manual.html#Post-installation">4.15  Post-installation setup and testing</A>.

</P>


<H3><A NAME="Applying_patches" HREF="manual_toc.html#Applying_patches">4.7.2  Applying patches</A></H3>

<P>
Sometimes patches appear on the mailing list or are placed in the
<a HREF="ftp://www.mysql.com/pub/mysql/Downloads/Patches">patches area</a> of the
<STRONG>MySQL</STRONG> FTP site.

</P>
<P>
To apply a patch from the mailing list, save the message in which the patch
appears in a file, change into the top-level directory of your <STRONG>MySQL</STRONG>
source tree and run these commands:

</P>

<PRE>
shell&#62; patch -p1 &#60; patch-file-name
shell&#62; rm config.cache
shell&#62; make clean
</PRE>

<P>
Patches from the FTP site are distributed as plain text files or as files
compressed with <CODE>gzip</CODE> files.  Apply a plain patch as shown above for
mailing list patches.  To apply a compressed patch, change into the
top-level directory of your <STRONG>MySQL</STRONG> source tree and run these
commands:

</P>

<PRE>
shell&#62; gunzip &#60; patch-file-name.gz | patch -p1
shell&#62; rm config.cache
shell&#62; make clean
</PRE>

<P>
After applying a patch, follow the instructions for a normal source install,
beginning with the <CODE>./configure</CODE> step.  After running the <CODE>make
install</CODE> step, restart your <STRONG>MySQL</STRONG> server.

</P>
<P>
You may need to bring down any currently running server before you run
<CODE>make install</CODE>.  (Use <CODE>mysqladmin shutdown</CODE> to do this.)  Some
systems do not allow you to install a new version of a program if it replaces
the version that is currently executing.

</P>


<H3><A NAME="configure_options" HREF="manual_toc.html#configure_options">4.7.3  Typical <CODE>configure</CODE> options</A></H3>

<P>
The <CODE>configure</CODE> script gives you a great deal of control over how you
configure your <STRONG>MySQL</STRONG> distribution.  Typically you do this using
options on the <CODE>configure</CODE> command line.  You can also affect
<CODE>configure</CODE> using certain environment variables.  For a list of options
supported by <CODE>configure</CODE>, run this command:

</P>

<PRE>
shell&#62; ./configure --help
</PRE>

<P>
Some of the more commonly-used <CODE>configure</CODE> options are described below:

</P>

<UL>
<LI>

To compile just the <STRONG>MySQL</STRONG> client libraries and client programs and
not the server, use the <CODE>--without-server</CODE> option:


<PRE>
shell&#62; ./configure --without-server
</PRE>

If you don't have a C++ compiler, <CODE>mysql</CODE> will not compile (it is the
one client program that requires C++).  In this case,
you can remove the code in <CODE>configure</CODE> that tests for the C++ compiler
and then run <CODE>./configure</CODE> with the <CODE>--without-server</CODE> option. The
compile step will still try to build <CODE>mysql</CODE>, but you can ignore any
warnings about <TT>`mysql.cc'</TT>.  (If <CODE>make</CODE> stops, try <CODE>make -k</CODE>
to tell it to continue with the rest of the build even if errors occur.)

<LI>

If you don't want your log files and database directories located under
<TT>`/usr/local/var'</TT>, use a <CODE>configure</CODE> command something like one
of these:

<PRE>
shell&#62; ./configure --prefix=/usr/local/mysql
shell&#62; ./configure --prefix=/usr/local \
           --localstatedir=/usr/local/mysql/data
</PRE>

The first command changes the installation prefix so that everything is
installed under <TT>`/usr/local/mysql'</TT> rather than the default of
<TT>`/usr/local'</TT>.  The second command preserves the default installation
prefix, but overrides the default location for database directories
(normally <TT>`/usr/local/var'</TT>) and changes it to
<CODE>/usr/local/mysql/data</CODE>.

<LI>

If you are using Unix and you want the <STRONG>MySQL</STRONG> socket located somewhere
other than the default location (normally in the directory <TT>`/tmp'</TT> or
<TT>`/var/run'</TT>, use a <CODE>configure</CODE> command like this:

<PRE>
shell&#62; ./configure --with-unix-socket-path=/usr/local/mysql/tmp/mysql.sock
</PRE>

Note that the given file must be an absolute pathname!

<LI>

If you want to compile statically-linked programs (e.g., to make a binary
distribution, to get more speed or to work around problems with some RedHat
distributions), run <CODE>configure</CODE> like this:


<PRE>
shell&#62; ./configure --with-client-ldflags=-all-static \
           --with-mysqld-ldflags=-all-static
</PRE>

<LI>

If you are using <CODE>gcc</CODE> and don't have <CODE>libg++</CODE> or <CODE>libstdc++</CODE>
installed, you can tell <CODE>configure</CODE> to use <CODE>gcc</CODE> as your C++
compiler:

<A NAME="IDX45"></A>
<A NAME="IDX46"></A>
<A NAME="IDX47"></A>
<A NAME="IDX48"></A>

<PRE>
shell&#62; CC=gcc CXX=gcc ./configure
</PRE>

When you use <CODE>gcc</CODE> as your C++ compiler, it will not attempt to link in
<CODE>libg++</CODE> or <CODE>libstdc++</CODE>.

If the build fails and produces errors about your compiler or linker not
being able to create the shared library <TT>`libmysqlclient.so.#'</TT> (<SAMP>`#'</SAMP>
is a version number), you can work around this problem by giving the
<CODE>--disable-shared</CODE> option to <CODE>configure</CODE>.  In this case,
<CODE>configure</CODE> will not build a shared <CODE>libmysqlclient.so.#</CODE> library.

<LI>

You can configure <STRONG>MySQL</STRONG> not to use <CODE>DEFAULT</CODE> column values for
non-<CODE>NULL</CODE> columns (i.e., columns that are not allowed to be
<CODE>NULL</CODE>).  This causes <CODE>INSERT</CODE> statements to generate an error
unless you explicitly specify values for all columns that require a
non-<CODE>NULL</CODE> value.  To suppress use of default values, run
<CODE>configure</CODE> like this:

<A NAME="IDX49"></A>
<A NAME="IDX50"></A>

<PRE>
shell&#62; CXXFLAGS=-DDONT_USE_DEFAULT_FIELDS ./configure
</PRE>

<LI>

By default, <STRONG>MySQL</STRONG> uses the ISO-8859-1 (Latin1) character set. To
change the default set, use the <CODE>--with-charset</CODE> option:

<PRE>
shell&#62; ./configure --with-charset=CHARSET
</PRE>

<CODE>CHARSET</CODE> may be one of <CODE>big5</CODE>, <CODE>cp1251</CODE>, <CODE>cp1257</CODE>,
<CODE>czech</CODE>, <CODE>danish</CODE>,<CODE>dec8</CODE>, <CODE>dos</CODE>, <CODE>euc_kr</CODE>,
<CODE>gb2312</CODE> <CODE>gbk</CODE>, <CODE>german1</CODE>, <CODE>hebrew</CODE>, <CODE>hp8</CODE>,
<CODE>hungarian</CODE>, <CODE>koi8_ru</CODE>, <CODE>koi8_ukr</CODE>, <CODE>latin1</CODE>, <CODE>latin2</CODE>,
<CODE>sjis</CODE>, <CODE>swe7</CODE>, <CODE>tis620</CODE>, <CODE>ujis</CODE>, <CODE>usa7</CODE>,
<CODE>win1251</CODE> or <CODE>win1251ukr</CODE>.
See section <A HREF="manual.html#Character_sets">9.1.1  The character set used for data and sorting</A>.

Note that if you want to change the character set, you must do a <CODE>make
distclean</CODE> between configurations!

If you want to convert characters between the server and the client,
you should take a look at the <CODE>SET OPTION CHARACTER SET</CODE> command.
See section <A HREF="manual.html#SET_OPTION">7.25  <CODE>SET OPTION</CODE> syntax</A>.

<A NAME="IDX51"></A>
<STRONG>Warning:</STRONG> If you change character sets after having created any
tables, you will have to run <CODE>myisamchk -r -q</CODE> on every table. Your
indexes may be sorted incorrectly otherwise.  (This can happen if you
install <STRONG>MySQL</STRONG>, create some tables, then reconfigure
<STRONG>MySQL</STRONG> to use a different character set and reinstall it.)

<LI>

To configure
<STRONG>MySQL</STRONG> with debugging code, use the <CODE>--with-debug</CODE> option:

<PRE>
shell&#62; ./configure --with-debug
</PRE>

This causes a safe memory allocator to be included that can find some errors
and that provides output about what is happening.
See section <A HREF="manual.html#Debugging_server">G.1  Debugging a MySQL server</A>.

<LI>

Options that pertain to particular systems can be found in the
system-specific sections later in this chapter.
See section <A HREF="manual.html#Source_install_system_issues">4.11  System-specific issues</A>.
</UL>



<H2><A NAME="Compilation_problems" HREF="manual_toc.html#Compilation_problems">4.8  Problems compiling?</A></H2>

<P>
All <STRONG>MySQL</STRONG> programs compile cleanly for us with no warnings on
Solaris using <CODE>gcc</CODE>. On other systems, warnings may occur due to
differences in system include files. See section <A HREF="manual.html#MIT-pthreads">4.9  MIT-pthreads notes</A>, for warnings
that may occur when using MIT-pthreads.  For other problems, check the list
below.

</P>
<P>
The solution to many problems involves reconfiguring.  If you do need to
reconfigure, take note of the following:

</P>
<P>
<A NAME="IDX52"></A>
<A NAME="IDX53"></A>

<UL>
<LI>

If <CODE>configure</CODE> is run after it already has been run, it may use
information that was gathered during its previous invocation.  This
information is stored in <TT>`config.cache'</TT>.  When <CODE>configure</CODE> starts
up, it looks for that file and reads its contents if it exists, on the
assumption that the information is still correct.  That assumption is invalid
when you reconfigure.
<LI>

Each time you run <CODE>configure</CODE>, you must run <CODE>make</CODE> again
to recompile.  However, you may want to remove old object files from previous
builds first, since they were compiled using different configuration options.
</UL>

<P>
To prevent old configuration information or object files from being used,
run these commands before rerunning <CODE>configure</CODE>:

</P>

<PRE>
shell&#62; rm config.cache
shell&#62; make clean
</PRE>

<P>
Alternatively, you can run <CODE>make distclean</CODE>.

</P>
<P>
The list below describes some of the problems compiling <STRONG>MySQL</STRONG>
that have been found to occur most often:

</P>

<UL>
<LI>

<A NAME="IDX54"></A>
<A NAME="IDX55"></A>
<A NAME="IDX56"></A>
<A NAME="IDX57"></A>
<A NAME="IDX58"></A>
If you get errors when compiling <TT>`sql_yacc.cc'</TT> such as the ones shown
below, you have probably run out of memory or swap space:


<PRE>
Internal compiler error: program cc1plus got fatal signal 11
  or
Out of virtual memory
  or
Virtual memory exhausted
</PRE>

The problem is that <CODE>gcc</CODE> requires huge amounts of memory to compile
<TT>`sql_yacc.cc'</TT> with inline functions.  Try running <CODE>configure</CODE> with
the <CODE>--with-low-memory</CODE> option:


<PRE>
shell&#62; ./configure --with-low-memory
</PRE>

This option causes <CODE>-fno-inline</CODE> to be added to the compile line if you
are using <CODE>gcc</CODE> and <CODE>-O0</CODE> if you are using something else.  You
should try the <CODE>--with-low-memory</CODE> option even if you have so much
memory and swap space that you think you can't possibly have run out.  This
problem has been observed to occur even on systems with generous hardware
configurations, and the <CODE>--with-low-memory</CODE> option usually fixes it.

<LI>

By default, <CODE>configure</CODE> picks <CODE>c++</CODE> as the compiler name and
GNU <CODE>c++</CODE> links with <CODE>-lg++</CODE>.  If you are using <CODE>gcc</CODE>,
that behavior can cause problems during configuration such as this:

<A NAME="IDX59"></A>

<PRE>
configure: error: installation or configuration problem:
C++ compiler cannot create executables.
</PRE>

<A NAME="IDX60"></A>
<A NAME="IDX61"></A>
You might also observe problems during compilation related to
<CODE>g++</CODE>, <CODE>libg++</CODE> or <CODE>libstdc++</CODE>.

One cause of these problems is that you may not have <CODE>g++</CODE>, or you may
have <CODE>g++</CODE> but not <CODE>libg++</CODE> or <CODE>libstdc++</CODE>.  Take a look at
the <TT>`config.log'</TT> file.  It should contain the exact reason why your c++
compiler didn't work!  To work around these problems, you can use <CODE>gcc</CODE>
as your C++ compiler.  Try setting the environment variable <CODE>CXX</CODE> to
<CODE>"gcc -O3"</CODE>.  For example:

<A NAME="IDX62"></A>
<A NAME="IDX63"></A>

<PRE>
shell&#62; CXX="gcc -O3" ./configure
</PRE>

This works because <CODE>gcc</CODE> compiles C++ sources as well as <CODE>g++</CODE>
does, but does not link in <CODE>libg++</CODE> or <CODE>libstdc++</CODE> by default.

Another way to fix these problems, of course, is to install <CODE>g++</CODE>,
<CODE>libg++</CODE> and <CODE>libstdc++</CODE>.

<LI>

If your compile fails with errors such as any of the following,
you must upgrade your version of <CODE>make</CODE> to GNU <CODE>make</CODE>:


<PRE>
making all in mit-pthreads
make: Fatal error in reader: Makefile, line 18:
Badly formed macro assignment
  or
make: file `Makefile' line 18: Must be a separator (:
  or
pthread.h: No such file or directory
</PRE>

<A NAME="IDX64"></A>
<A NAME="IDX65"></A>
<A NAME="IDX66"></A>
<A NAME="IDX67"></A>
Solaris and FreeBSD are known to have troublesome <CODE>make</CODE> programs.

GNU <CODE>make</CODE> version 3.75 is known to work.

<A NAME="IDX68"></A>
<A NAME="IDX69"></A>
<A NAME="IDX70"></A>
<A NAME="IDX71"></A>
<A NAME="IDX72"></A>
<A NAME="IDX73"></A>
<A NAME="IDX74"></A>
<A NAME="IDX75"></A>
<LI>

If you want to define flags to be used by your C or C++ compilers, do so by
adding the flags to the <CODE>CFLAGS</CODE> and <CODE>CXXFLAGS</CODE> environment
variables.  You can also specify the compiler names this way using <CODE>CC</CODE>
and <CODE>CXX</CODE>.  For example:


<PRE>
shell&#62; CC=gcc
shell&#62; CFLAGS=-O6
shell&#62; CXX=gcc
shell&#62; CXXFLAGS=-O6
shell&#62; export CC CFLAGS CXX CXXFLAGS
</PRE>

See section <A HREF="manual.html#TcX_binaries">4.14  TcX binaries</A>, for a list of flag definitions that have been found
to be useful on various systems.

<LI>

If you get an error message like this,
you need to upgrade your <CODE>gcc</CODE> compiler:


<PRE>
client/libmysql.c:273: parse error before `__attribute__'
</PRE>

<CODE>gcc</CODE> 2.8.1 is known to work, but we recommend using <CODE>egcs</CODE>
1.0.3a or newer instead.

<LI>

If you get errors such as those shown below when compiling <CODE>mysqld</CODE>,
<CODE>configure</CODE> didn't correctly detect the type of the last argument to
<CODE>accept()</CODE>, <CODE>getsockname()</CODE> or <CODE>getpeername()</CODE>:


<PRE>
cxx: Error: mysqld.cc, line 645: In this statement, the referenced
     type of the pointer value "&#38;length" is "unsigned long", which
     is not compatible with "int".
new_sock = accept(sock, (struct sockaddr *)&#38;cAddr, &#38;length);
</PRE>

To fix this, edit the <TT>`config.h'</TT> file (which is generated by
<CODE>configure</CODE>).  Look for these lines:


<PRE>
/* Define as the base type of the last arg to accept */
#define SOCKET_SIZE_TYPE XXX
</PRE>

Change <CODE>XXX</CODE> to <CODE>size_t</CODE> or <CODE>int</CODE>, depending on your
operating system.  (Note that you will have to do this each time you run
<CODE>configure</CODE>, since <CODE>configure</CODE> regenerates <TT>`config.h'</TT>.)

<LI>

The <TT>`sql_yacc.cc'</TT> file is generated from <TT>`sql_yacc.yy'</TT>.  Normally
the build process doesn't need to create <TT>`sql_yacc.cc'</TT>, because
<STRONG>MySQL</STRONG> comes with an already-generated copy.  However, if you do need
to recreate it, you might encounter this error:


<PRE>
"sql_yacc.yy", line xxx fatal: default action causes potential...
</PRE>

This is a sign that your version of <CODE>yacc</CODE> is deficient.
You probably need to install <CODE>bison</CODE> (the GNU version of <CODE>yacc</CODE>)
and use that instead.

<LI>

If you need to debug <CODE>mysqld</CODE> or a <STRONG>MySQL</STRONG> client, run
<CODE>configure</CODE> with the <CODE>--with-debug</CODE> option, then recompile and
link your clients with the new client library.
See section <A HREF="manual.html#Debugging_client">G.2  Debugging a MySQL client</A>.
</UL>



<H2><A NAME="MIT-pthreads" HREF="manual_toc.html#MIT-pthreads">4.9  MIT-pthreads notes</A></H2>

<P>
This section describes some of the issues involved in using MIT-pthreads.

</P>
<P>
Note that on Linux you should NOT use MIT-pthreads but install LinuxThreads!
See section <A HREF="manual.html#Linux">4.11.5  Linux notes (all Linux versions)</A>.

</P>
<P>
If your system does not provide native thread support, you will need to
build <STRONG>MySQL</STRONG> using the MIT-pthreads package.  This includes
most FreeBSD systems, SunOS 4.x, Solaris 2.4 and earlier, and some others.
See section <A HREF="manual.html#Which_OS">4.2  Operating systems supported by MySQL</A>.

</P>

<UL>
<LI>

On most systems, you can force MIT-pthreads to be used by running
<CODE>configure</CODE> with the <CODE>--with-mit-threads</CODE> option:


<PRE>
shell&#62; ./configure --with-mit-threads
</PRE>

Building in a non-source directory is not supported when using
MIT-pthreads, because we want to minimize our changes to this code.

<LI>

MIT-pthreads doesn't support the <CODE>AF_UNIX</CODE> protocol used to implement
Unix sockets.  This means that if you compile using MIT-pthreads, all
connections must be made using TCP/IP (which is a little slower).  If you
find after building <STRONG>MySQL</STRONG> that you cannot connect to the local
server, it may be that your client is attempting to connect to
<CODE>localhost</CODE> using a Unix socket as the default. Try making a TCP/IP
connection with <CODE>mysql</CODE> by using a host option (<CODE>-h</CODE> or
<CODE>--host</CODE>) to specify the local host name explicitly.

<LI>

The checks that determine whether or not to use MIT-pthreads occur only
during the part of the configuration process that deals with the server
code.  If you have configured the distribution using <CODE>--without-server</CODE>
to build only the client code, clients will not know whether or not
MIT-pthreads is being used and will use Unix socket connections by default.
Since Unix sockets do not work under MIT-pthreads, this means you will need
to use <CODE>-h</CODE> or <CODE>--host</CODE> when you run client programs.

<LI>

When <STRONG>MySQL</STRONG> is compiled using MIT-pthreads, system locking is
disabled by default for performance reasons. You can tell the server to use
system locking with the <CODE>--use-locking</CODE> option.

<LI>

Sometimes the pthread <CODE>bind()</CODE> command fails to bind to a socket without
any error message (at least on Solaris). The result is that all connections
to the server fail.  For example:


<PRE>
shell&#62; mysqladmin version
mysqladmin: connect to server at '' failed;
error: 'Can't connect to mysql server on localhost (146)'
</PRE>

The solution to this is to kill the <CODE>mysqld</CODE> server and restart it.
This has only happened to us when we have forced the server down and done
a restart immediately.

<LI>

With MIT-pthreads, the <CODE>sleep()</CODE> system call isn't interruptible with
<CODE>SIGINT</CODE> (break). This is only noticeable when you run <CODE>mysqladmin
--sleep</CODE>.  You must wait for the <CODE>sleep()</CODE> call to terminate before the
interrupt is served and the process stops.

<LI>

When linking you may receive warning messages like these (at least on
Solaris); they can be ignored:


<PRE>
ld: warning: symbol `_iob' has differing sizes:
    (file /my/local/pthreads/lib/libpthread.a(findfp.o) value=0x4;
file /usr/lib/libc.so value=0x140);
    /my/local/pthreads/lib/libpthread.a(findfp.o) definition taken
ld: warning: symbol `__iob' has differing sizes:
    (file /my/local/pthreads/lib/libpthread.a(findfp.o) value=0x4;
file /usr/lib/libc.so value=0x140);
    /my/local/pthreads/lib/libpthread.a(findfp.o) definition taken
</PRE>

<LI>

Some other warnings also can be ignored:


<PRE>
implicit declaration of function `int strtoll(...)'
implicit declaration of function `int strtoul(...)'
</PRE>

<LI>

We haven't gotten <CODE>readline</CODE> to work with MIT-pthreads. (This isn't
needed, but may be interesting for someone.)
</UL>



<H2><A NAME="Perl_support" HREF="manual_toc.html#Perl_support">4.10  Perl installation comments</A></H2>



<H3><A NAME="Perl_installation" HREF="manual_toc.html#Perl_installation">4.10.1  Installing Perl on Unix</A></H3>

<P>
Perl support for <STRONG>MySQL</STRONG> is provided by means of the
<CODE>DBI</CODE>/<CODE>DBD</CODE> client interface.  See section <A HREF="manual.html#Perl">20.5  MySQL Perl API</A>.  The Perl
<CODE>DBD</CODE>/<CODE>DBI</CODE> client code requires Perl 5.004 or later.  The
interface <EM>will not work</EM> if you have an older version of Perl.

</P>
<P>
<STRONG>MySQL</STRONG> Perl support also requires that you've installed
<STRONG>MySQL</STRONG> client programming support.  If you installed <STRONG>MySQL</STRONG>
from RPM files, client programs are in the client RPM, but client programming
support is in the developer RPM.  Make sure you've installed the latter RPM.

</P>
<P>
As of release 3.22.8, Perl support is distributed separately from the main
<STRONG>MySQL</STRONG> distribution.  If you want to install Perl support, the files
you will need can be obtained from <a HREF="http://www.mysql.com/Contrib">http://www.mysql.com/Contrib</a>.

</P>
<P>
The Perl distributions are provided as compressed <CODE>tar</CODE> archives and
have names like <TT>`MODULE-VERSION.tar.gz'</TT>, where <CODE>MODULE</CODE> is the
module name and <CODE>VERSION</CODE> is the version number.  You should get the
<CODE>Data-Dumper</CODE>, <CODE>DBI</CODE>, and <CODE>Msql-Mysql-modules</CODE> distributions
and install them in that order.  The installation procedure is shown below.
The example shown is for the <CODE>Data-Dumper</CODE> module, but the procedure is
the same for all three distributions.

</P>

<OL>
<LI>

Unpack the distribution into the current directory:

<PRE>
shell&#62; gunzip &#60; Data-Dumper-VERSION.tar.gz | tar xvf -
</PRE>

This command creates a directory named <TT>`Data-Dumper-VERSION'</TT>.

<LI>

Change into the top-level directory of the unpacked distribution:

<PRE>
shell&#62; cd Data-Dumper-VERSION
</PRE>

<LI>

Build the distribution and compile everything:

<PRE>
shell&#62; perl Makefile.PL
shell&#62; make
shell&#62; make test
shell&#62; make install
</PRE>

</OL>

<P>
The <CODE>make test</CODE> command is important, because it verifies that the
module is working.  Note that when you run that command during the
<CODE>Msql-Mysql-modules</CODE> installation to exercise the interface code, the
<STRONG>MySQL</STRONG> server must be running or the test will fail.

</P>
<P>
It is a good idea to rebuild and reinstall the <CODE>Msql-Mysql-modules</CODE>
distribution whenever you install a new release of <STRONG>MySQL</STRONG>,
particularly if you notice symptoms such as all your <CODE>DBI</CODE> scripts
dumping core after you upgrade <STRONG>MySQL</STRONG>.

</P>
<P>
If you don't have the right to install Perl modules in the system directory
or if you to install local Perl modules, the following reference may help
you:

</P>

<PRE>
<a HREF="http://www.iserver.com/support/contrib/perl5/modules.html">http://www.iserver.com/support/contrib/perl5/modules.html</a>
</PRE>

<P>
Look under the heading
<CODE>Installing New Modules that Require Locally Installed Modules</CODE>.

</P>


<H3><A NAME="ActiveState_Perl" HREF="manual_toc.html#ActiveState_Perl">4.10.2  Installing ActiveState Perl on Win32</A></H3>

<P>
To install the <STRONG>MySQL</STRONG> <CODE>DBD</CODE> module with ActiveState Perl on
Win32, you should do the following:

</P>

<UL>
<LI>Open a DOS shell.

<LI>If required, set the HTTP_proxy variable. For example, you might try:

<CODE>set HTTP_proxy=my.proxy.com:3128</CODE>
<LI>Start the PPM program: <CODE>C:\perl\bin\ppm.pl</CODE>

<LI>If you have not already done so, install <CODE>DBI</CODE>: <CODE>install DBI</CODE>

<LI>If this succeeds, install <CODE>DBD::mysql:</CODE>

<CODE>http://www.mysql.com/Contrib/ppd/DBD-mysql.ppd</CODE>
</UL>

<P>
If you can't get the above to work, you should instead install the
<STRONG>MyODBC</STRONG> driver and connect to <STRONG>MySQL</STRONG> server through
ODBC.

</P>

<PRE>
use DBI;
$dbh= DBI-&#62;connect("DBI:ODBC:$dsn","$user","$password") || 
  die "Got error $DBI::errstr when connecting to $dsn\n";
</PRE>



<H3><A NAME="Win32_Perl" HREF="manual_toc.html#Win32_Perl">4.10.3  Installing the MySQL Perl distribution on Win32</A></H3>

<P>
The <STRONG>MySQL</STRONG> Perl distribution contains <CODE>DBI</CODE>,
<CODE>DBD:MySQL</CODE> and <CODE>DBD:ODBC</CODE>.

</P>

<UL>
<LI>Get the Perl distribution for Win32 from

<a HREF="http://www.mysql.com/download.html">http://www.mysql.com/download.html</a>.
<LI>Unzip the distribution in <CODE>C:</CODE> so that you get a <TT>`C:\PERL'</TT> directory.

<LI>Add the directory <TT>`C:\PERL\BIN'</TT> to your path.

<LI>Add the directory <TT>`C:\PERL\BIN\MSWin32-x86-thread'</TT> or

<TT>`C:\PERL\BIN\MSWin32-x86'</TT> to your path.
<LI>Test that <CODE>perl</CODE> works by executing <CODE>perl -v</CODE> in a DOS shell.

</UL>



<H3><A NAME="Perl_support_problems" HREF="manual_toc.html#Perl_support_problems">4.10.4  Problems using the Perl <CODE>DBI</CODE>/<CODE>DBD</CODE> interface</A></H3>

<P>
If Perl reports that it can't find the <CODE>../mysql/mysql.so</CODE> module,
then the problem is probably that Perl can't locate the shared library
<TT>`libmysqlclient.so'</TT>.

</P>
<P>
You can fix this by any of the following methods:

</P>

<UL>
<LI>

Compile the <CODE>Msql-Mysql-modules</CODE> distribution with <CODE>perl
Makefile.PL -static -config</CODE> rather than <CODE>perl Makefile.PL</CODE>

<LI>

Copy <CODE>libmysqlclient.so</CODE> to the directory where your other shared
libraries are located (probably <TT>`/usr/lib'</TT> or <TT>`/lib'</TT>).

<LI>

On <CODE>Linux</CODE> you can add the pathname of the directory where
<CODE>libmysqlclient.so</CODE> is located to the <TT>`/etc/ld.so.conf'</TT> file.

<LI>

<A NAME="IDX76"></A>
<A NAME="IDX77"></A>
Add the pathname of the directory where <CODE>libmysqlclient.so</CODE> is located
to the <CODE>LD_RUN_PATH</CODE> environment variable.
</UL>

<P>
If you get the following errors from <CODE>DBD-mysql</CODE>,
you are probably using <CODE>gcc</CODE> (or using an old binary compiled with
<CODE>gcc</CODE>):

</P>

<PRE>
/usr/bin/perl: can't resolve symbol '__moddi3'
/usr/bin/perl: can't resolve symbol '__divdi3'
</PRE>

<P>
Add <CODE>-L/usr/lib/gcc-lib/... -lgcc</CODE> to the link command when the
<TT>`mysql.so'</TT> library gets built (check the output from <CODE>make</CODE> for
<TT>`mysql.so'</TT> when you compile the Perl client).  The <CODE>-L</CODE> option
should specify the pathname of the directory where <TT>`libgcc.a'</TT> is located
on your system.

</P>
<P>
Another cause of this problem may be that Perl and <STRONG>MySQL</STRONG> aren't both
compiled with <CODE>gcc</CODE>.  In this case, you can solve the mismatch by
compiling both with <CODE>gcc</CODE>.

</P>
<P>
If you want to use the Perl module on a system that doesn't support dynamic
linking (like SCO) you can generate a static version of Perl that includes
<CODE>DBI</CODE> and <CODE>DBD-mysql</CODE>.  The way this works is that you generate a
version of Perl with the <CODE>DBI</CODE> code linked in and install it on top of
your current Perl.  Then you use that to build a version of Perl that
additionally has the <CODE>DBD</CODE> code linked in, and install that.

</P>
<P>
On SCO, you must have the following environment variables set:

</P>

<PRE>
shell&#62; LD_LIBRARY_PATH=/lib:/usr/lib:/usr/local/lib:/usr/progressive/lib
or
shell&#62; LD_LIBRARY_PATH=/usr/lib:/lib:/usr/local/lib:/usr/ccs/lib:/usr/progressive/lib:/usr/skunk/lib
shell&#62; LIBPATH=/usr/lib:/lib:/usr/local/lib:/usr/ccs/lib:/usr/progressive/lib:/usr/skunk/lib
shell&#62; MANPATH=scohelp:/usr/man:/usr/local1/man:/usr/local/man:/usr/skunk/man:
</PRE>

<P>
First, create a Perl that includes a statically-linked <CODE>DBI</CODE> by running
these commands in the directory where your <CODE>DBI</CODE> distribution is
located:

</P>

<PRE>
shell&#62; perl Makefile.PL -static -config
shell&#62; make
shell&#62; make install
shell&#62; make perl
</PRE>

<P>
Then you must install the new Perl. The output of <CODE>make perl</CODE> will
indicate the exact <CODE>make</CODE> command you will need to execute to perform
the installation.  On SCO, this is <CODE>make -f Makefile.aperl inst_perl
MAP_TARGET=perl</CODE>.

</P>
<P>
Next, use the just-created Perl to create another Perl that also includes a
statically-linked <CODE>DBD::mysql</CODE> by running these commands in the
directory where your <CODE>Msql-Mysql-modules</CODE> distribution is located:

</P>

<PRE>
shell&#62; perl Makefile.PL -static -config
shell&#62; make
shell&#62; make install
shell&#62; make perl
</PRE>

<P>
Finally, you should install this new Perl.  Again, the output of <CODE>make
perl</CODE> indicates the command to use.

</P>


<H2><A NAME="Source_install_system_issues" HREF="manual_toc.html#Source_install_system_issues">4.11  System-specific issues</A></H2>

<P>
The following sections indicate some of the issues that have been observed to
occur on particular systems when installing <STRONG>MySQL</STRONG> from a source
distribution.

</P>



<H3><A NAME="Solaris" HREF="manual_toc.html#Solaris">4.11.1  Solaris notes</A></H3>

<P>
On Solaris, you may run into trouble even before you get the <STRONG>MySQL</STRONG>
distribution unpacked!  Solaris <CODE>tar</CODE> can't handle long file names, so
you may see an error like this when you unpack <STRONG>MySQL</STRONG>:

</P>

<PRE>
x mysql-3.22.12-beta/bench/Results/ATIS-mysql_odbc-NT_4.0-cmp-db2,informix,ms-sql,mysql,oracle,solid,sybase, 0 bytes, 0 tape blocks
tar: directory checksum error
</PRE>

<P>
In this case, you must use GNU <CODE>tar</CODE> (<CODE>gtar</CODE>) to unpack the
distribution.  You can find a precompiled copy for Solaris at
<a HREF="http://www.mysql.com/Downloads/">http://www.mysql.com/Downloads/</a>.

</P>
<P>
Sun native threads work only on Solaris 2.5 and higher. For 2.4 and
earlier versions, <STRONG>MySQL</STRONG> will automatically use
MIT-pthreads. See section <A HREF="manual.html#MIT-pthreads">4.9  MIT-pthreads notes</A>.

</P>
<P>
If you get the following error from configure:

</P>

<PRE>
checking for restartable system calls... configure: error can not run test
programs while cross compiling
</PRE>

<P>
This means that you have something wrong with your compiler installation!
In this case you should upgrade your compiler to a newer version.  You may
also be able to solve this problem by inserting the following row into the
<CODE>config.cache</CODE> file:

</P>

<PRE>
ac_cv_sys_restartable_syscalls=${ac_cv_sys_restartable_syscalls='no'}
</PRE>

<P>
If you are using Solaris on a SPARC, the recommended compiler is <CODE>egcs</CODE>
1.1.2 or newer.  You can find this at <a HREF="http://egcs.cygnus.com/">http://egcs.cygnus.com/</a>.
Note that <CODE>egs</CODE> 1.1.1 and <CODE>gcc</CODE> 2.8.1 don't work reliably on SPARC!

</P>
<P>
The recommended <CODE>configure</CODE> line when using <CODE>egcs</CODE> 1.1.2 is:

</P>

<PRE>
shell&#62; CC=gcc CFLAGS="-O6" \
       CXX=gcc CXXFLAGS="-O6 -felide-constructors -fno-exceptions -fno-rtti" \
       ./configure --prefix=/usr/local/mysql --with-low-memory
</PRE>

<P>
If you have the Sun Workshop 4.2 compiler, you can run <CODE>configure</CODE> like
this:

</P>
<P>
CC=cc CFLAGS="-xstrconst -Xa -xO4 -native -mt" CXX=CC CXXFLAGS="-xO4 -native -noex -mt" ./configure --prefix=/usr/local/mysql

</P>

<PRE>
shell&#62; CC=cc CFLAGS="-Xa -fast -xO4 -native -xstrconst -mt" \
       CXX=CC CXXFLAGS="-noex -XO4 -mt" \
       ./configure
</PRE>

<P>
You may also have to edit the <CODE>configure</CODE> script to change this line:

</P>

<PRE>
#if !defined(__STDC__) || __STDC__ != 1
</PRE>

<P>
to this:

</P>

<PRE>
#if !defined(__STDC__)
</PRE>

<P>
If you turn on <CODE>__STDC__</CODE> with the <CODE>-Xc</CODE> option, the Sun compiler
can't compile with the Solaris <TT>`pthread.h'</TT> header file. This is a Sun
bug (broken compiler or broken include file).

</P>
<P>
If <CODE>mysqld</CODE> issues the error message shown below when you run it, you have
tried to compile <STRONG>MySQL</STRONG> with the Sun compiler without enabling the
multi-thread option (<CODE>-mt</CODE>):

</P>

<PRE>
libc internal error: _rmutex_unlock: rmutex not held
</PRE>

<P>
Add <CODE>-mt</CODE> to <CODE>CFLAGS</CODE> and <CODE>CXXFLAGS</CODE> and try again.

</P>
<P>
If you get the following error when compiling <STRONG>MySQL</STRONG> with <CODE>gcc</CODE>,
it means that your <CODE>gcc</CODE> is not configured for your version of Solaris!

</P>

<PRE>
shell&#62; gcc -O3 -g -O2 -DDBUG_OFF  -o thr_alarm ...
./thr_alarm.c: In function `signal_hand':
./thr_alarm.c:556: too many arguments to function `sigwait'
</PRE>

<P>
The proper thing to do in this case is to get the newest version of
<CODE>egcs</CODE> and compile it with your current <CODE>gcc</CODE> compiler!  At
least for Solaris 2.5, almost all binary versions of <CODE>gcc</CODE> have
old, unusable include files that will break all programs that use
threads (and possibly other programs)!

</P>
<P>
Solaris doesn't provide static versions of all system libraries
(<CODE>libpthreads</CODE> and <CODE>libdl</CODE>), so you can't compile <STRONG>MySQL</STRONG>
with <CODE>--static</CODE>.  If you try to do so, you will get the error:

</P>

<PRE>
ld: fatal: library -ldl: not found
</PRE>

<P>
If too many processes try to connect very rapidly to <CODE>mysqld</CODE>, you will
see this error in the <STRONG>MySQL</STRONG> log:

</P>

<PRE>
Error in accept: Protocol error
</PRE>

<P>
You might try starting the server with the <CODE>--set-variable back_log=50</CODE>
option as a workaround for this.

</P>
<P>
If you are linking your own <STRONG>MySQL</STRONG> client, you might get the
following error when you try to execute it:

</P>

<PRE>
ld.so.1: ./my: fatal: libmysqlclient.so.#: open failed: No such file or directory
</PRE>

<P>
The problem can be avoided by one of the following methods:

</P>

<UL>
<LI>

Link the client with the following flag (instead of <CODE>-Lpath</CODE>):
<CODE>-Wl,r/full-path-to-libmysqlclient.so</CODE>.
<LI>

Copy <CODE>libmysqclient.so</CODE> to <TT>`/usr/lib'</TT>.
<LI>

<A NAME="IDX78"></A>
<A NAME="IDX79"></A>
Add the pathname of the directory where <CODE>libmysqlclient.so</CODE> is located
to the <CODE>LD_RUN_PATH</CODE> environment variable before running your client.
</UL>



<H3><A NAME="Solaris_2.7" HREF="manual_toc.html#Solaris_2.7">4.11.2  Solaris 2.7 notes</A></H3>

<P>
You can normally use a Solaris 2.6 binary on Solaris 2.7.  Most of the
Solaris 2.6 issues also apply for Solaris 2.7.

</P>
<P>
Note that <STRONG>MySQL</STRONG> 3.23.4 and above should be able to autodetect Solaris
2.7 and enable workarounds for the following problems!

</P>
<P>
Solaris 2.7 has some bugs in the include files. You may see the following
error when you use <CODE>gcc</CODE>:

</P>

<PRE>
/usr/include/widec.h:42: warning: `getwc' redefined
/usr/include/wchar.h:326: warning: this is the location of the previous
definition
</PRE>

<P>
If this occurs, you can do the following to fix the problem:

</P>
<P>
Copy <CODE>/usr/include/widec.h</CODE> to
<CODE>.../lib/gcc-lib/os/gcc-version/include</CODE> and change line 41 from:

</P>

<PRE>
#if     !defined(lint) &#38;& !defined(__lint)

to

#if     !defined(lint) &#38;& !defined(__lint) &#38;& !defined(getwc)
</PRE>

<P>
Alternatively, you can edit <TT>`/usr/include/widec.h'</TT> directly.  Either
way, after you make the fix, you should remove <TT>`config.cache'</TT> and run
<CODE>configure</CODE> again!

</P>
<P>
If you get errors like this when you run <CODE>make</CODE>, it's because <CODE>configure</CODE>
didn't detect the <TT>`curses.h'</TT> file (probably because of the error in
<CODE>/usr/include/widec.h</CODE>:

</P>

<PRE>
In file included from mysql.cc:50:
/usr/include/term.h:1060: syntax error before `,'
/usr/include/term.h:1081: syntax error before `;'
</PRE>

<P>
The solution to this is to do one of the following steps:

</P>

<UL>
<LI>

Edit <TT>`/usr/include/widec.h'</TT> as indicted above and rerun configure
<LI>

Remove the <CODE>#define HAVE_TERM</CODE> line from <TT>`config.h'</TT> file and
run <CODE>make</CODE> again.
<LI>

Configure with <CODE>CFLAGS=-DHAVE_CURSES CXXFLAGS=-DHAVE_CURSES ./configure</CODE>
</UL>



<H3><A NAME="Solaris_x86" HREF="manual_toc.html#Solaris_x86">4.11.3  Solaris x86 notes</A></H3>

<P>
If you are using <CODE>gcc</CODE> or <CODE>egcs</CODE> on Solaris x86 and you
experience problems with core dumps under load, you should use the
following <CODE>configure</CODE> command:

</P>

<PRE>
shell&#62; CC=gcc CFLAGS="-O6 -fomit-frame-pointer" \
       CXX=gcc \
       CXXFLAGS="-O6 -fomit-frame-pointer -felide-constructors -fno-exceptions -fno-rtti" \
       ./configure --prefix=/usr/local/mysql
</PRE>

<P>
This will avoid problems with the <CODE>libstdc++</CODE> library and with C++
exceptions.

</P>
<P>
If this doesn't help, you should compile a debug version and run
it with a trace file or under <CODE>gdb</CODE>.  See section <A HREF="manual.html#Debugging_server">G.1  Debugging a MySQL server</A>.

</P>


<H3><A NAME="SunOS" HREF="manual_toc.html#SunOS">4.11.4  SunOS 4 notes</A></H3>

<P>
On SunOS 4, MIT-pthreads is needed to compile <STRONG>MySQL</STRONG>, which in turn
means you will need GNU <CODE>make</CODE>.

</P>
<P>
Some SunOS 4 systems have problems with dynamic libraries and
<CODE>libtool</CODE>. You can use the following <CODE>configure</CODE> line to avoid
this problem:

</P>

<PRE>
shell&#62; ./configure --disable-shared --with-mysqld-ldflags=-all-static
</PRE>

<P>
When compiling <CODE>readline</CODE>, you may get warnings about duplicate defines.
These may be ignored.

</P>
<P>
When compiling <CODE>mysqld</CODE>, there will be some <CODE>implicit declaration
of function</CODE> warnings. These may be ignored.

</P>


<H3><A NAME="Linux" HREF="manual_toc.html#Linux">4.11.5  Linux notes (all Linux versions)</A></H3>

<P>
<STRONG>MySQL</STRONG> uses LinuxThreads on Linux.  If you are using an old Linux
version that doesn't have <CODE>glibc2</CODE>, you must install LinuxThreads before
trying to compile
<STRONG>MySQL</STRONG>. <a HREF="http://www.mysql.com/Downloads/Linux">http://www.mysql.com/Downloads/Linux</a>

</P>
<P>
Note that <CODE>glibc</CODE> versions before and including 2.1.1 has a fatal bug in
<CODE>pthread_mutex_timedwait</CODE> handling, which is used when you do <CODE>INSERT
DELAYED</CODE>. If you are using <CODE>INSERT DELAYED</CODE>, you <STRONG>MUST</STRONG>
add the following patch to your glibc library: 
<a HREF="http://www.mysql.com/Downloads/Patches/glibc-pthread_cond_timedwait.patch">http://www.mysql.com/Downloads/Patches/glibc-pthread_cond_timedwait.patch</a>.
<STRONG>MySQL</STRONG> 3.23.7 contains a temporary workaround for this bug. 

</P>
<P>
If you can't start <CODE>mysqld</CODE> or if <CODE>mysql_install_db</CODE> doesn't work,
please continue reading!  This only happens on Linux system with problems in
the LinuxThreads or <CODE>libc</CODE>/<CODE>glibc</CODE> libraries. There are a lot of
simple workarounds to get <STRONG>MySQL</STRONG> to work!  The simplest is to use the
binary version of <STRONG>MySQL</STRONG> (not the RPM) for Linux x86.  One nice
aspect of this version is that it's probably 10% faster than any version you
would compile yourself!  See section <A HREF="manual.html#Compile_and_link_options">10.2.1  How compiling and linking affects the speed of MySQL</A>.

</P>
<P>
One known problem with the binary distribution is that with older Linux
systems that use <CODE>libc</CODE> (like RedHat 4.x or Slackware), you will get
some non-fatal problems with hostname resolution
See section <A HREF="manual.html#Binary_notes-Linux">4.6.3.1  Linux notes</A>.

</P>
<P>
<CODE>myisamchk</CODE> hangs with <CODE>libc.so.5.3.12</CODE>. Upgrading to the newest
<CODE>libc</CODE> fixes this problem.

</P>
<P>
When using LinuxThreads you will see a minimum of three processes
running. These are in fact threads. There will be one thread for the
LinuxThreads manager, one thread to handle connections, and one thread
to handle alarms and signals.

</P>
<P>
If you see a dead <CODE>mysqld</CODE> daemon process with <CODE>ps</CODE>, this usually
means that you have found a bug in <STRONG>MySQL</STRONG> or you have got a corrupted
table. See section <A HREF="manual.html#Crashing">18.1  What to do if MySQL keeps crashing</A>.

</P>
<P>
If you are using LinuxThreads and <CODE>mysqladmin shutdown</CODE> doesn't work,
you must upgrade to LinuxThreads 0.7.1 or newer.

</P>
<P>
If you are using RedHat, you might get errors like this:

</P>

<PRE>
/usr/bin/perl is needed...
/usr/sh is needed...
/usr/sh is needed...
</PRE>

<P>
If so, you should upgrade your version of <CODE>rpm</CODE> to
<TT>`rpm-2.4.11-1.i386.rpm'</TT> and <TT>`rpm-devel-2.4.11-1.i386.rpm'</TT> (or later).

</P>
<P>
You can get the upgrades of libraries to RedHat 4.2 from
<a HREF="ftp://ftp.redhat.com/updates/4.2/i386">ftp://ftp.redhat.com/updates/4.2/i386</a>. Or
<a HREF="http://www.sunsite.unc.edu/pub/Linux/distributions/redhat/code/rpm/">http://www.sunsite.unc.edu/pub/Linux/distributions/redhat/code/rpm/</a>
for other distributions.

</P>
<P>
If you are linking your own <STRONG>MySQL</STRONG> client and get the error:

</P>

<PRE>
ld.so.1: ./my: fatal: libmysqlclient.so.4: open failed: No such file or directory
</PRE>

<P>
when executing them, the problem can be avoided by one of the following
methods:

</P>

<UL>
<LI>

Link the client with the following flag (instead of <CODE>-Lpath</CODE>):
<CODE>-Wl,r/path-libmysqlclient.so</CODE>.
<LI>

Copy <CODE>libmysqclient.so</CODE> to <TT>`/usr/lib'</TT>.
<LI>

<A NAME="IDX80"></A>
<A NAME="IDX81"></A>
Add the pathname of the directory where <CODE>libmysqlclient.so</CODE> is located
to the <CODE>LD_RUN_PATH</CODE> environment variable before running your client.
</UL>

<P>
If you are using the Fujitsu compiler <CODE>(fcc / FCC)</CODE> you will have
some problems compiling <STRONG>MySQL</STRONG> because the Linux header files are very
<CODE>gcc</CODE> oriented.

</P>
<P>
The following <CODE>configure</CODE> line should work with <CODE>fcc/FCC</CODE>:

</P>

<PRE>
CC=fcc CFLAGS="-O -K fast -K lib -K omitfp -Kpreex -D_GNU_SOURCE -DCONST=const -DNO_STRTOLL_PROTO" CXX=FCC CXXFLAGS="-O -K fast -K lib  -K omitfp -K preex --no_exceptions --no_rtti -D_GNU_SOURCE -DCONST=const -Dalloca=__builtin_alloca -DNO_STRTOLL_PROTO '-D_EXTERN_INLINE=static __inline'" ./configure --prefix=/usr/local/mysql --enable-assembler --with-mysqld-ldflags=-all-static --disable-shared --with-low-memory
</PRE>



<H4><A NAME="Linux-x86" HREF="manual_toc.html#Linux-x86">4.11.5.1  Linux-x86 notes</A></H4>

<P>
<STRONG>MySQL</STRONG> requires <CODE>libc</CODE> version 5.4.12 or newer. It's known to
work with <CODE>libc</CODE> 5.4.46. <CODE>glibc</CODE> version 2.0.6 and later should
also work. There have been some problems with the <CODE>glibc</CODE> RPMs from
RedHat so if you have problems, check whether or not there are any updates!
The <CODE>glibc</CODE> 2.0.7-19 and 2.0.7-29 RPMs are known to work.

</P>
<P>
On some older Linux distributions, <CODE>configure</CODE> may produce an error
like this:

</P>

<PRE>
Syntax error in sched.h. Change _P to __P in the /usr/include/sched.h file.
See the Installation chapter in the Reference Manual.
</PRE>

<P>
Just do what the error message says and add an extra underscore to the
<CODE>_P</CODE> macro that has only one underscore, then try again.

</P>
<P>
You may get some warnings when compiling; those shown below can be ignored:

</P>

<PRE>
mysqld.cc -o objs-thread/mysqld.o
mysqld.cc: In function `void init_signals()':
mysqld.cc:315: warning: assignment of negative value `-1' to `long unsigned int'
mysqld.cc: In function `void * signal_hand(void *)':
mysqld.cc:346: warning: assignment of negative value `-1' to `long unsigned int'
</PRE>

<P>
In Debian GNU/Linux, if you want <STRONG>MySQL</STRONG> to start automatically when
the system boots, do the following:

</P>

<PRE>
shell&#62; cp support-files/mysql.server /etc/init.d/mysql.server
shell&#62; /usr/sbin/update-rc.d mysql.server defaults 99
</PRE>

<P>
<CODE>mysql.server</CODE> can be found in the <TT>`share/mysql'</TT> directory
under the <STRONG>MySQL</STRONG> installation directory, or in the
<TT>`support-files'</TT> directory of the <STRONG>MySQL</STRONG> source tree.

</P>
<P>
If <CODE>mysqld</CODE> always core dumps when it starts up, the problem may be that
you have an old <TT>`/lib/libc.a'</TT>.  Try renaming it, then remove
<TT>`sql/mysqld'</TT> and do a new <CODE>make install</CODE> and try again.  This
problem has been reported on some Slackware installations. RedHat 5.0 has
also a similar problem with some new <CODE>glibc</CODE> versions.
See section <A HREF="manual.html#Linux-RedHat50">4.11.5.2  RedHat 5.0 notes</A>.

</P>
<P>
If you get the following error when linking <CODE>mysqld</CODE>,
it means that your <TT>`libg++.a'</TT> is not installed correctly:

</P>

<PRE>
/usr/lib/libc.a(putc.o): In function `_IO_putc':
putc.o(.text+0x0): multiple definition of `_IO_putc'
</PRE>

<P>
You can avoid using <TT>`libg++.a'</TT> by running <CODE>configure</CODE> like this:

</P>

<PRE>
shell&#62; CXX=gcc ./configure
</PRE>



<H4><A NAME="Linux-RedHat50" HREF="manual_toc.html#Linux-RedHat50">4.11.5.2  RedHat 5.0 notes</A></H4>

<P>
If you have any problems with <STRONG>MySQL</STRONG> on RedHat, you should start by
upgrading <CODE>glibc</CODE> to the newest possible version!

</P>
<P>
If you install all the official RedHat patches (including
<CODE>glibc-2.0.7-19</CODE> and <CODE>glibc-devel-2.0.7-19</CODE>), both the
binary and source distributions of <STRONG>MySQL</STRONG> should work without
any trouble!

</P>
<P>
The updates are needed since there is a bug in <CODE>glibc</CODE> 2.0.5 in how
<CODE>pthread_key_create</CODE> variables are freed. With <CODE>glibc</CODE> 2.0.5, you
must use a statically-linked <STRONG>MySQL</STRONG> binary distribution. If you
want to compile from source, you must install the corrected version of
LinuxThreads from <a HREF="http://www.mysql.com/Downloads/Linux">http://www.mysql.com/Downloads/Linux</a> or upgrade your
<CODE>glibc</CODE>.

</P>
<P>
If you have an incorrect version of <CODE>glibc</CODE> or LinuxThreads, the symptom
is that <CODE>mysqld</CODE> crashes after each connection. For example,
<CODE>mysqladmin version</CODE> will crash <CODE>mysqld</CODE> when it finishes!

</P>
<P>
Another symptom of incorrect libraries is that <CODE>mysqld</CODE> crashes at
once when it starts. On some Linux systems, this can be fixed by configuring
like this:

</P>

<PRE>
shell&#62; ./configure --with-mysqld-ldflags=-all-static
</PRE>

<P>
On Redhat 5.0, the easy way out is to install the <CODE>glibc</CODE> 2.0.7-19 RPM
and run <CODE>configure</CODE> <STRONG>without</STRONG> the
<CODE>--with-mysqld-ldflags=-all-static</CODE> option.

</P>
<P>
For the source distribution of <CODE>glibc</CODE> 2.0.7, a patch that is easy to
apply and is tested with <STRONG>MySQL</STRONG> may be found at:

<PRE>
<a HREF="http://www.mysql.com/Download/Linux/glibc-2.0.7-total-patch.tar.gz">http://www.mysql.com/Download/Linux/glibc-2.0.7-total-patch.tar.gz</a>
</PRE>

<P>
If you experience crashes like these when you build <STRONG>MySQL</STRONG>, you can
always download the newest binary version of <STRONG>MySQL</STRONG>.  This is
statically-linked to avoid library conflicts and should work on all Linux
systems!

</P>
<P>
<STRONG>MySQL</STRONG> comes with an internal debugger that can generate
trace files with a lot of information that can be used to find and solve a
wide range of different problems.
See section <A HREF="manual.html#Debugging_server">G.1  Debugging a MySQL server</A>.

</P>


<H4><A NAME="Linux-RedHat51" HREF="manual_toc.html#Linux-RedHat51">4.11.5.3  RedHat 5.1 notes</A></H4>

<P>
The <CODE>glibc</CODE> of RedHat 5.1 (<CODE>glibc</CODE> 2.0.7-13) has a memory leak, so
to get a stable <STRONG>MySQL</STRONG> version, you must upgrade <CODE>glibc</CODE> to
2.0.7-19, downgrade <CODE>glibc</CODE> or use a binary version of <CODE>mysqld</CODE>. If
you don't do this, you will encounter memory problems (out of memory, etc.,
etc.).  The most common error in this case is:

</P>

<PRE>
Can't create a new thread (errno 11). If you are not out of available
memory, you can consult the manual for any possible OS dependent bug
</PRE>

<P>
After you have upgraded to <CODE>glibc</CODE> 2.0.7-19, you can configure
<STRONG>MySQL</STRONG> with dynamic linking (the default), but you <STRONG>cannot</STRONG>
run <CODE>configure</CODE> with the <CODE>--with-mysqld-ldflags=-all-static</CODE> option
until you have installed <CODE>glibc</CODE> 2.0.7-19 from source!

</P>
<P>
You can check which version of <CODE>glibc</CODE> you have with <CODE>rpm -q glibc</CODE>.

</P>


<H4><A NAME="Linux-SPARC" HREF="manual_toc.html#Linux-SPARC">4.11.5.4  Linux-SPARC notes</A></H4>

<P>
In some implementations, <CODE>readdir_r()</CODE> is broken.  The symptom is that
<CODE>SHOW DATABASES</CODE> always returns an empty set.  This
can be fixed by removing <CODE>HAVE_READDIR_R</CODE> from <TT>`config.h'</TT> after
configuring and before compiling.

</P>
<P>
Some problems will require patching your Linux installation.  The patch can
be found at
<a HREF="http://www.mysql.com/patches/Linux-sparc-2.0.30.diff">http://www.mysql.com/patches/Linux-sparc-2.0.30.diff</a>. This patch is
against the Linux distribution <TT>`sparclinux-2.0.30.tar.gz'</TT> that is
available at <CODE>vger.rutgers.edu</CODE> (a version of Linux that was
never merged with the official 2.0.30).  You must also install
LinuxThreads 0.6 or newer.

</P>
<P>
Thanks to <a HREF="mailto:jacques@solucorp.qc.ca">jacques@solucorp.qc.ca</a> for this information.

</P>


<H4><A NAME="Linux-Alpha" HREF="manual_toc.html#Linux-Alpha">4.11.5.5  Linux-Alpha notes</A></H4>

<P>
The big problem on Linux-Alpha is that there are still some problems with
threads in <CODE>glibc</CODE> on this platform.  You should start by getting the
newest <CODE>glibc</CODE> version you can find.

</P>
<P>
Note that before you run any programs that use threads (like <CODE>mysqld</CODE>,
<CODE>thr_alarm</CODE> or <CODE>thr_lock</CODE>), you should raise the shared memory
limit (with <CODE>ulimit</CODE>). The <STRONG>MySQL</STRONG> benchmarks are known to fail
if you forget to do this!

</P>

<P>
Configure <STRONG>MySQL</STRONG> with the following command:

</P>

<PRE>
shell&#62; CC=gcc CCFLAGS="-Dalpha_linux_port" \
       CXX=gcc CXXFLAGS="-O3 -Dalpha_linux_port -felide-constructors -fno-exceptions -fno-rtti" \
       ./configure --prefix=/usr/local/mysql
</PRE>

<P>
Try to compile <CODE>mysys/thr_lock</CODE> and <CODE>mysys/thr_alarm</CODE>.
Test that these programs work!  (Invoke each one with no arguments.
Each should end with <CODE>test_succeeded</CODE> if everything
was okay.)

</P>
<P>
After installing <STRONG>MySQL</STRONG>, uncomment the <CODE>ulimit</CODE> command in
<CODE>safe_mysqld</CODE> and add options to increase shared memory.

</P>
<P>
Note that Linux-Alpha is still an alpha-quality platform for <STRONG>MySQL</STRONG>.
With the newest <CODE>glibc</CODE>, you have a very good chance of it working.

</P>
<P>
If you have problems with signals (<STRONG>MySQL</STRONG> dies unexpectedly
under high load) you may have found an OS bug with threads and
signals. In this case you can tell <STRONG>MySQL</STRONG> not to use signals by
configuring with:

</P>

<PRE>
shell&#62; CFLAGS=-DDONT_USE_THR_ALARM \
       CXXFLAGS=-DDONT_USE_THR_ALARM \
       ./configure ...
</PRE>

<P>
This doesn't affect the performance of <STRONG>MySQL</STRONG>, but has the side
effect that you can't kill clients that are ``sleeping'' on a connection with
<CODE>mysqladmin kill</CODE> or <CODE>mysqladmin shutdown</CODE>.  Instead, the client
will die when it issues its next command.

</P>


<H4><A NAME="MKLinux" HREF="manual_toc.html#MKLinux">4.11.5.6  MkLinux notes</A></H4>

<P>
<STRONG>MySQL</STRONG> should work on MkLinux with the newest <CODE>glibc</CODE> package
(tested with <CODE>glibc</CODE> 2.0.7).

</P>


<H4><A NAME="Qube2" HREF="manual_toc.html#Qube2">4.11.5.7  Qube2 Linux notes</A></H4>

<P>
To get <STRONG>MySQL</STRONG> to work on Qube2, (Linux Mips), you need the newest
<CODE>glibc</CODE> libraries (<CODE>glibc-2.0.7-29C2</CODE> is known to work). You must also use
the <CODE>egcs</CODE> C++ compiler (<CODE>egcs-1.0.2-9</CODE> or newer).

</P>


<H3><A NAME="Alpha-DEC-Unix" HREF="manual_toc.html#Alpha-DEC-Unix">4.11.6  Alpha-DEC-Unix notes</A></H3>

<P>
When compiling threaded programs under Digital UNIX, the documentation
recommends using the <CODE>-pthread</CODE> option for <CODE>cc</CODE> and <CODE>cxx</CODE> and
the libraries <CODE>-lmach -lexc</CODE> (in addition to <CODE>-lpthread</CODE>).  You
should run <CODE>configure</CODE> something like this:

</P>

<PRE>
shell&#62; CC="cc -pthread" CXX="cxx -pthread -O" \
       ./configure --with-named-thread-libs="-lpthread -lmach -lexc -lc"
</PRE>

<P>
When compiling <CODE>mysqld</CODE>, you may see a couple of warnings like this:

</P>

<PRE>
mysqld.cc: In function void handle_connections()':
mysqld.cc:626: passing long unsigned int *' as argument 3 of
accept(int,sockadddr *, int *)'
</PRE>

<P>
You can safely ignore these warnings. They occur because <CODE>configure</CODE>
can detect only errors, not warnings.

</P>
<P>
If you start the server directly from the command line, you may have problems
with it dying when you log out.  (When you log out, your outstanding processes
receive a <CODE>SIGHUP</CODE> signal.)  If so, try starting the server like this:

</P>

<PRE>
shell&#62; nohup mysqld [options] &#38;
</PRE>

<P>
<CODE>nohup</CODE> causes the command following it to ignore any <CODE>SIGHUP</CODE>
signal sent from the terminal.  Alternatively, start the server by running
<CODE>safe_mysqld</CODE>, which invokes <CODE>mysqld</CODE> using <CODE>nohup</CODE> for you.

</P>


<H3><A NAME="Alpha-DEC-OSF1" HREF="manual_toc.html#Alpha-DEC-OSF1">4.11.7  Alpha-DEC-OSF1 notes</A></H3>

<P>
If you have problems compiling and have DEC <CODE>CC</CODE> and <CODE>gcc</CODE>
installed, try running <CODE>configure</CODE> like this:

</P>

<PRE>
shell&#62; CC=cc CFLAGS=-O CXX=gcc CXXFLAGS=-O3 \
       ./configure --prefix=/usr/local/mysql
</PRE>

<P>
If you get problems with the <TT>`c_asm.h'</TT> file, you can create and use
a 'dummy' <TT>`c_asm.h'</TT> file with:

</P>

<PRE>
shell&#62; touch include/c_asm.h
shell&#62; CC=gcc CFLAGS=-I./include \
       CXX=gcc CXXFLAGS=-O3 \
       ./configure --prefix=/usr/local/mysql
</PRE>

<P>
On OSF1 V4.0D and compiler "DEC C V5.6-071 on Digital UNIX V4.0 (Rev. 878)"
the compiler had some strange behavior (undefined <CODE>asm</CODE> symbols).
<CODE>/bin/ld</CODE> also appears to be broken (problems with <CODE>_exit
undefined</CODE> errors occuring while linking <CODE>mysqld</CODE>).  On this system, we
have managed to compile <STRONG>MySQL</STRONG> with the following <CODE>configure</CODE>
line, after replacing <CODE>/bin/ld</CODE> with the version from OSF 4.0C:

</P>

<PRE>
shell&#62; CC=gcc CXX=gcc CXXFLAGS=-O3 ./configure --prefix=/usr/local/mysql
</PRE>

<P>
With the Digital compiler "C++ V6.1-029", the following should work:

</P>

<PRE>
CC=cc -pthread
CFLAGS=-O4 -ansi_alias -ansi_args -fast -inline speed -speculate all -arch host
CXX=cxx -pthread
CXXFLAGS=-O4 -ansi_alias -ansi_args -fast -inline speed -speculate all -arch host
export CC CFLAGS CXX CXXFLAGS
./configure --prefix=/usr/mysql/mysql --with-low-memory --enable-large-files --with-mysqld-ldflags=-all-static --disable-shared --with-named-thread-libs="-lmach -lexc -lc"
</PRE>

<P>
In some versions of OSF1, the <CODE>alloca()</CODE> function is broken. Fix
this by removing the line in <TT>`config.h'</TT> that defines <CODE>'HAVE_ALLOCA'</CODE>.

</P>
<P>
The <CODE>alloca()</CODE> function also may have an incorrect prototype in
<CODE>/usr/include/alloca.h</CODE>.  This warning resulting from this can be ignored.

</P>
<P>
<CODE>configure</CODE> will use the following thread libraries automatically:
<CODE>--with-named-thread-libs="-lpthread -lmach -lexc -lc"</CODE>.

</P>
<P>
When using <CODE>gcc</CODE>, you can also try running <CODE>configure</CODE> like this:

</P>

<PRE>
shell&#62; CFLAGS=-D_PTHREAD_USE_D4 CXX=gcc CXXFLAGS=-O3 ./configure ....
</PRE>

<P>
If you have problems with signals (<STRONG>MySQL</STRONG> dies unexpectedly
under high load) you may have found an OS bug with threads and
signals. In this case you can tell <STRONG>MySQL</STRONG> not to use signals by
configuring with:

</P>

<PRE>
shell&#62; CFLAGS=-DDONT_USE_THR_ALARM \
       CXXFLAGS=-DDONT_USE_THR_ALARM \
       ./configure ...
</PRE>

<P>
This doesn't affect the performance of <STRONG>MySQL</STRONG>, but has the side
effect that you can't kill clients that are ``sleeping'' on a connection with
<CODE>mysqladmin kill</CODE> or <CODE>mysqladmin shutdown</CODE>.  Instead, the client
will die when it issues its next command.

</P>
<P>
With <CODE>gcc</CODE> 2.95.2, you will probably run into the following compile error:

</P>

<PRE>
sql_acl.cc:1456: Internal compiler error in `scan_region', at except.c:2566
Please submit a full bug report.
</PRE>

<P>
To fix this you should change to the <CODE>sql</CODE> directory and do a 'cut
and paste' of the last <CODE>gcc</CODE> line, but change <CODE>-O3</CODE> to <CODE>-O0</CODE> (or add
<CODE>-O0</CODE> immediately after <CODE>gcc</CODE> if you don't have any <CODE>-O</CODE>
option on your compile line. After this is done you can just change back to
the top level directly and run <CODE>make</CODE> again.

</P>


<H3><A NAME="SGI-Irix" HREF="manual_toc.html#SGI-Irix">4.11.8  SGI-Irix notes</A></H3>

<P>
You may have to undefine some things in <TT>`config.h'</TT> after running
<CODE>configure</CODE> and before compiling.

</P>
<P>
In some Irix implementations, the <CODE>alloca()</CODE> function is broken. If the
<CODE>mysqld</CODE> server dies on some <CODE>SELECT</CODE> statements, remove the lines
from <TT>`config.h'</TT> that define <CODE>HAVE_ALLOC</CODE> and <CODE>HAVE_ALLOCA_H</CODE>.
If <CODE>mysqladmin create</CODE> doesn't work, remove the line from
<TT>`config.h'</TT> that defines <CODE>HAVE_READDIR_R</CODE>. You may have to remove
the <CODE>HAVE_TERM_H</CODE> line as well.

</P>
<P>
SGI recommends that you install all of the patches on this page as a set:
http://support.sgi.com/surfzone/patches/patchset/6.2_indigo.rps.html

</P>
<P>
At the very minimum, you should install the latest kernel rollup, the
latest <CODE>rld</CODE> rollup, and the latest <CODE>libc</CODE> rollup.

</P>
<P>
You definately need all the POSIX patches on this page, for pthreads support:

</P>
<P>
http://support.sgi.com/surfzone/patches/patchset/6.2_posix.rps.html

</P>
<P>
If you get the something like the following error when compiling
<TT>`mysql.cc'</TT>:

</P>

<PRE>
"/usr/include/curses.h", line 82: error(1084): invalid combination of type
</PRE>

<P>
Then type the following in the top-level directory of your <STRONG>MySQL</STRONG>
source tree:

</P>

<PRE>
shell&#62; extra/replace bool curses_bool &#60; /usr/include/curses.h &#62; include/curses.h
shell&#62; make
</PRE>

<P>
There have also been reports of scheduling problems.  If only one thread is
running, things go slow. Avoid this by starting another client. This may lead
to a 2-to-10-fold increase in execution speed thereafter for the other
thread.  This is a poorly-understood problem with Irix threads; you may have
to improvise to find solutions until this can be fixed.

</P>
<P>
If you are compiling with <CODE>gcc</CODE>, you can use the following
<CODE>configure</CODE> command:

</P>

<PRE>
shell&#62; CC=gcc CXX=gcc CXXFLAGS=-O3 \
       ./configure --prefix=/usr/local/mysql --with-thread-safe-client --with-named-thread-libs=-lpthread
</PRE>



<H3><A NAME="FreeBSD" HREF="manual_toc.html#FreeBSD">4.11.9  FreeBSD notes</A></H3>

<P>
FreeBSD 3.x is recommended for running MySQL since it the thread package
is much more integrated.

</P>
<P>
The easiest and therefor the preferred way to install is to use the
mysql-server and mysql-client ports available on
<a HREF="http://www.freebsd.org">http://www.freebsd.org</a>

</P>
<P>
Using these gives you:

<UL>
<LI>

A working <STRONG>MySQL</STRONG> with all optimizations known to work on your version
of FreeBSD enabled.
<LI>

Automatic configuration and build.
<LI>

Startup scripts installed in /usr/local/etc/rc.d
<LI>

Ability to see which files that are installed with pkg_info -L. And to
remove them all with pkg_delete if you no longer want <STRONG>MySQL</STRONG> on that
machine.
</UL>

<P>
It is recomended to use MIT-pthreads on FreeBSD 2.x and native threads on
versions 3 and up. It is possible to run with with native threads on some late
2.2.x versions but you may encounter problems shutting down mysqld.

</P>
<P>
Be sure to have your name resolver setup correct. Otherwise you may
experience resolver delays or failures when connecting to mysqld.

</P>
<P>
Make sure that the <CODE>localhost</CODE> entry in the <TT>`/etc/hosts'</TT> file is
correct (otherwise you will have problems connecting to the database).  The
<TT>`/etc/hosts'</TT> file should start with a line:

</P>

<PRE>
127.0.0.1       localhost localhost.your.domain
</PRE>

<P>
If you notice that <CODE>configure</CODE> will use MIT-pthreads, you should read
the MIT-pthreads notes. See section <A HREF="manual.html#MIT-pthreads">4.9  MIT-pthreads notes</A>.

</P>
<P>
If you get an error from <CODE>make install</CODE> that it can't find
<TT>`/usr/include/pthreads'</TT>, <CODE>configure</CODE> didn't detect that you need
MIT-pthreads. This is fixed by executing these commands:

</P>

<PRE>
shell&#62; rm config.cache
shell&#62; ./configure --with-mit-threads
</PRE>

<P>
The behavior of FreeBSD <CODE>make</CODE> is slightly different from that of GNU
<CODE>make</CODE>. If you have <CODE>make</CODE>-related problems, you should install GNU
<CODE>make</CODE>.

</P>
<P>
FreeBSD is also known to have a very low default file handle limit.
See section <A HREF="manual.html#Not_enough_file_handles">18.11  File not found</A>. Uncomment the ulimit -n section in
safe_mysqld or raise the limits for the mysqld user in /etc/login.conf
(and rebuild it witg cap_mkdb /etc/login.conf) also be sure you set the
appropriate Class for this user in the password file if you are not
using the default (use: chpass mysqld-user-name)

</P>
<P>
<A NAME="IDX82"></A>
<A NAME="IDX83"></A>
<A NAME="IDX84"></A>
If you have a problem with <CODE>SELECT NOW()</CODE> returning values in GMT and
not your local time, you have to set the <CODE>TZ</CODE> environment variable to
your current timezone.  This should be done for the environment in which
the server runs, for example, in <CODE>safe_mysqld</CODE> or <CODE>mysql.server</CODE>.

</P>
<P>
To get a secure and stable system you should only use FreeBSD kernels
that are marked <CODE>-STABLE</CODE>

</P>


<H3><A NAME="NetBSD" HREF="manual_toc.html#NetBSD">4.11.10  NetBSD notes</A></H3>

<P>
To compile on NetBSD you need GNU <CODE>make</CODE>. Otherwise the compile will crash
when <CODE>make</CODE> tries to run <CODE>lint</CODE> on C++ files.

</P>


<H3><A NAME="OpenBSD" HREF="manual_toc.html#OpenBSD">4.11.11  OpenBSD 2.5 notes</A></H3>

<P>
On OpenBSD 2.5, you can compile <STRONG>MySQL</STRONG> with native threads with the
following options:

</P>

<PRE>
CFLAGS=-pthread CXXFLAGS=-pthread ./configure --with-mit-threads=no
</PRE>



<H3><A NAME="BSDI" HREF="manual_toc.html#BSDI">4.11.12  BSD/OS notes</A></H3>



<H4><A NAME="BSDI2" HREF="manual_toc.html#BSDI2">4.11.12.1  BSD/OS 2.x notes</A></H4>

<P>
If you get the following error when compiling <STRONG>MySQL</STRONG>, your
<CODE>ulimit</CODE> value for virtual memory is too low:

</P>

<PRE>
item_func.h: In method `Item_func_ge::Item_func_ge(const Item_func_ge &#38;)':
item_func.h:28: virtual memory exhausted
make[2]: *** [item_func.o] Error 1
</PRE>

<P>
Try using <CODE>ulimit -v 80000</CODE> and run <CODE>make</CODE> again.  If this
doesn't work and you are using <CODE>bash</CODE>, try switching to <CODE>csh</CODE>
or <CODE>sh</CODE>; some BSDI users have reported problems with <CODE>bash</CODE>
and <CODE>ulimit</CODE>.

</P>
<P>
If you are using <CODE>gcc</CODE>, you may also use have to use the
<CODE>--with-low-memory</CODE> flag for <CODE>configure</CODE> to be able to compile
<TT>`sql_yacc.cc'</TT>.

</P>
<P>
<A NAME="IDX85"></A>
<A NAME="IDX86"></A>
<A NAME="IDX87"></A>
If you have a problem with <CODE>SELECT NOW()</CODE> returning values in GMT and
not your local time, you have to set the <CODE>TZ</CODE> environment variable to
your current timezone.  This should be done for the environment in which
the server runs, for example in <CODE>safe_mysqld</CODE> or <CODE>mysql.server</CODE>.

</P>


<H4><A NAME="BSDI3" HREF="manual_toc.html#BSDI3">4.11.12.2  BSD/OS 3.x notes</A></H4>

<P>
Upgrade to BSD/OS 3.1. If that is not possible, install BSDIpatch M300-038.

</P>
<P>
Use the following command when configuring <STRONG>MySQL</STRONG>:

</P>

<PRE>
shell&#62; env CXX=shlicc++ CC=shlicc2 \
       ./configure \
           --prefix=/usr/local/mysql \
           --localstatedir=/var/mysql \
           --without-perl \
           --with-unix-socket-path=/var/mysql/mysql.sock
</PRE>

<P>
The following is also known to work:

</P>

<PRE>
shell&#62; env CC=gcc CXX=gcc CXXFLAGS=-O3 \
       ./configure \
           --prefix=/usr/local/mysql \
           --with-unix-socket-path=/var/mysql/mysql.sock
</PRE>

<P>
You can change the directory locations if you wish, or just use the
defaults by not specifying any locations.

</P>
<P>
If you have problems with performance under heavy load, try using the
<CODE>--skip-thread-priority</CODE> option to <CODE>safe_mysqld</CODE>!  This will run
all threads with the same priority; on BSDI 3.1, this gives better
performance (at least until BSDI fixes their thread scheduler).

</P>
<P>
If you get the error <CODE>virtual memory exhausted</CODE> while compiling,
you should try using <CODE>ulimit -v 80000</CODE> and run <CODE>make</CODE> again.
If this doesn't work and you are using <CODE>bash</CODE>, try switching to
<CODE>csh</CODE> or <CODE>sh</CODE>; some BSDI users have reported problems with
<CODE>bash</CODE> and <CODE>ulimit</CODE>.

</P>


<H4><A NAME="BSDI4" HREF="manual_toc.html#BSDI4">4.11.12.3  BSD/OS 4.x notes</A></H4>

<P>
BSDI 4.x has some thread related bugs.  If you want to use <STRONG>MySQL</STRONG>
on this, you should install all thread related patches. At least
M400-023 should be installed.

</P>
<P>
On some BSDI 4.x system you may get problems with shared libraries. The
symptom is that you can't execute any client programs, like for example
<CODE>mysqladmin</CODE>.  In this case you need to reconfigure to not use
shared libraries with the <CODE>--disable-shared</CODE> option to configure.

</P>


<H3><A NAME="SCO" HREF="manual_toc.html#SCO">4.11.13  SCO notes</A></H3>

<P>
The current port is tested only on a ``sco3.2v5.0.4'' and
``sco3.2v5.0.5'' system.  There has also been a lot of progress on a
port to ``sco 3.2v4.2''.

</P>
<P>
For the moment the recommended compiler on OpenServer is gcc 2.95.2. With this
you should be able to compile <CODE>MySQL</CODE> with just:

</P>

<PRE>
CC=gcc CXX=gcc ./configure ... (options)
</PRE>


<OL>
<LI>

For OpenServer 5.0.X you need to use GDS in Skunkware 95 (95q4c).  This
is necessary because GNU <CODE>gcc</CODE> 2.7.2 in Skunkware 97 does not have
GNU <CODE>as</CODE>.  You can also use <CODE>egcs</CODE> 1.1.2 or newer
<a HREF="http://www.egcs.com/">http://www.egcs.com/</a>.  If you are using <CODE>egcs</CODE> 1.1.2 you have
to execute the following command:


<PRE>
shell&#62; cp -p /usr/include/pthread/stdtypes.h /usr/local/lib/gcc-lib/i386-pc-sco3.2v5.0.5/egcs-2.91.66/include/pthread/
</PRE>

<LI>

You need the port of GCC 2.5.? for this product and the Development
system.  They are required on this version of SCO UNIX.  You cannot
just use the GCC Dev system.
<LI>

You should get the FSU Pthreads package and install it first.  This can be
found at
<a HREF="http://www.cs.wustl.edu/~schmidt/ACE_wrappers/FSU-threads.tar.gz">http://www.cs.wustl.edu/~schmidt/ACE_wrappers/FSU-threads.tar.gz</a>.
You can also get a precompiled package from
<a HREF="ftp://www.mysql.com/pub/mysql/Downloads/SCO/FSU-threads-3.5c.tar.gz">ftp://www.mysql.com/pub/mysql/Downloads/SCO/FSU-threads-3.5c.tar.gz</a>.
<LI>

FSU Pthreads can be compiled with SCO UNIX 4.2 with tcpip.  Or
OpenServer 3.0 or Open Desktop 3.0 (OS 3.0 ODT 3.0), with the SCO
Development System installed using a good port of GCC 2.5.X ODT or OS
3.0 you will need a good port of GCC 2.5.? There are a lot of problems
without a good port.  The port for this product requires the SCO UNIX
Development system.  Without it, you are missing the libraries and the
linker that is needed.
<LI>

To build FSU Pthreads on your system, do the following:

<OL>
<LI>

Run <CODE>./configure</CODE> in the <TT>`threads/src'</TT> directory and select
the SCO OpenServer option. This command copies <TT>`Makefile.SCO5'</TT> to
<TT>`Makefile'</TT>.
<LI>

Run <CODE>make</CODE>.
<LI>

To install in the default <TT>`/usr/include'</TT> directory, login as root,
then <CODE>cd</CODE> to the <TT>`thread/src'</TT> directory, and run <CODE>make
install</CODE>.
</OL>

<LI>

Remember to use GNU <CODE>make</CODE> when making <STRONG>MySQL</STRONG>.
<LI>

On OSR 5.0.5, you should use the following configure line:

<PRE>
shell&#62; CC="gcc -DSCO" CXX="gcc -DSCO" ./configure
</PRE>

The <CODE>-DSCO</CODE> is needed to help configure detect some thread
functions properly.  If you forget <CODE>-DSCO</CODE>, you will get the following
error message while compiling:

<PRE>
my_pthread.c: In function `my_pthread_mutex_init':
my_pthread.c:374: `pthread_mutexattr_default' undeclared (first use this function)
</PRE>

<LI>

If you don't start <CODE>safe_mysqld</CODE> as root, you probably will get only the
default 110 open files per process.  <CODE>mysqld</CODE> will write a note about this
in the log file.
<LI>

With SCO 3.2V5.0.5, you should use a FSU Pthreads version 3.5c or newer.
The following <CODE>configure</CODE> command should work:

<PRE>
shell&#62; CC="gcc -belf" ./configure --prefix=/usr/local/mysql --disable-shared
</PRE>

<LI>

With SCO 3.2V4.2, you should use a FSU Pthreads version 3.5c or newer.
The following <CODE>configure</CODE> command should work:

<PRE>
shell&#62; CFLAGS="-D_XOPEN_XPG4" CXX=gcc CXXFLAGS="-D_XOPEN_XPG4" \
       ./configure \
           --with-debug --prefix=/usr/local/mysql \
           --with-named-thread-libs="-lgthreads -lsocket -lgen -lgthreads" \
           --with-named-curses-libs="-lcurses"
</PRE>

You may get some problems with some include files. In this case, you can
find new SCO-specific include files at
<a HREF="ftp://www.mysql.com/pub/mysql/Downloads/SCO/SCO-3.2v4.2-includes.tar.gz">ftp://www.mysql.com/pub/mysql/Downloads/SCO/SCO-3.2v4.2-includes.tar.gz</a>.
You should unpack this file in the <TT>`include'</TT>
directory of your <STRONG>MySQL</STRONG> source tree.
</OL>

<P>
SCO development notes:

</P>

<UL>
<LI>

<STRONG>MySQL</STRONG> should automatically detect FSU Pthreads and link <CODE>mysqld</CODE>
with <CODE>-lgthreads -lsocket -lgthreads</CODE>.
<LI>

The SCO development libraries are reentrant in FSU Pthreads. SCO claims
that its libraries' functions are reentrant, so they must be reentrant with
FSU Pthreads. FSU Pthreads on OpenServer tries to use the SCO scheme to
make reentrant library.
<LI>

FSU Pthreads (at least the version at <CODE>www.mysql.com</CODE>) comes linked with
GNU <CODE>malloc</CODE>.  If you encounter problems with memory usage, make sure that
<TT>`gmalloc.o'</TT>
is included in <TT>`libgthreads.a'</TT> and <TT>`libgthreads.so'</TT>.
<LI>

In FSU Pthreads, the following system calls are pthreads-aware: <CODE>read()</CODE>,
<CODE>write()</CODE>, <CODE>getmsg()</CODE>, <CODE>connect()</CODE>, <CODE>accept()</CODE>,
<CODE>select()</CODE> and <CODE>wait()</CODE>.
</UL>

<P>
If you want to install DBI on SCO, you have to edit the <TT>`Makefiles'</TT> in
DBI-xxx and each subdirectory:

</P>

<PRE>
OLD:                                  NEW:
CC = cc                               CC = gcc -belf
CCCDLFLAGS = -KPIC -W1,-Bexport       CCCDLFLAGS = -fpic
CCDLFLAGS = -wl,-Bexport              CCDLFLAGS =

LD = ld                               LD = gcc -belf -G -fpic
LDDLFLAGS = -G -L/usr/local/lib       LDDLFLAGS = -L/usr/local/lib
LDFLAGS = -belf -L/usr/local/lib      LDFLAGS = -L/usr/local/lib

LD = ld                               LD = gcc -belf -G -fpic
OPTIMISE = -Od         		      OPTIMISE = -O1

OLD:
CCCFLAGS = -belf -dy -w0 -U M_XENIX -DPERL_SCO5 -I/usr/local/include

NEW:
CCFLAGS = -U M_XENIX -DPERL_SCO5 -I/usr/local/include
</PRE>

<P>
This is because the Perl dynaloader will not load the <CODE>DBI</CODE> modules
if they were compiled with <CODE>icc</CODE> or <CODE>cc</CODE>.

</P>
<P>
Perl works best when compiled with <CODE>cc</CODE>.

</P>


<H3><A NAME="SCO_Unixware" HREF="manual_toc.html#SCO_Unixware">4.11.14  SCO Unixware 7.0 notes</A></H3>

<P>
You must use a version of <STRONG>MySQL</STRONG> at least as recent as 3.22.13, since
that version fixes some portability problems under Unixware.

</P>
<P>
We have been able to compile <STRONG>MySQL</STRONG> with the following <CODE>configure</CODE>
command on UnixWare 7.0.1:

</P>

<PRE>
shell&#62; CC=cc CXX=CC ./configure --prefix=/usr/local/mysql
</PRE>

<P>
If you want to use gcc, you must use gcc 2.95.2 or newer.

</P>


<H3><A NAME="IBM-AIX" HREF="manual_toc.html#IBM-AIX">4.11.15  IBM-AIX notes</A></H3>

<P>
Automatic detection of <CODE>xlC</CODE> is missing from Autoconf, so a
<CODE>configure</CODE> command something like this is needed when using the IBM
compiler:

</P>

<PRE>
shell&#62; CC="xlc_r -ma -O3 -qstrict -DHAVE_INT_8_16_32" \
       CXX="xlC_r -ma -O3 -qstrict -DHAVE_INT_8_16_32" \
       ./configure
</PRE>

<P>
If you change the <CODE>-O3</CODE> to <CODE>-O2</CODE> in the above configure line,
you must also remove the <CODE>-qstrict</CODE> option (this is a limitation in
the IBM C compiler).

</P>
<P>
If you are using <CODE>egcs</CODE> to compile <STRONG>MySQL</STRONG>, you
<STRONG>MUST</STRONG> use the <CODE>-fno-exceptions</CODE> flag, as the exception
handling in <CODE>egcs</CODE> is not thread-safe!  (This is tested with
<CODE>egcs</CODE> 1.1.)  We recommend the following <CODE>configure</CODE> line with
<CODE>egcs</CODE> and <CODE>gcc</CODE> on AIX:

</P>

<PRE>
shell&#62; CXX=gcc \
       CXXFLAGS="-felide-constructors -fno-exceptions -fno-rtti" \
       ./configure --prefix=/home/monty --with-debug --with-low-memory
</PRE>

<P>
If you have problems with signals (<STRONG>MySQL</STRONG> dies unexpectedly
under high load) you may have found an OS bug with threads and
signals. In this case you can tell <STRONG>MySQL</STRONG> not to use signals by
configuring with:

</P>

<PRE>
shell&#62; CFLAGS=-DDONT_USE_THR_ALARM CXX=gcc \
       CXXFLAGS="-felide-constructors -fno-exceptions -fno-rtti -DDONT_USE_THR_ALARM" \
       ./configure --prefix=/home/monty --with-debug --with-low-memory
</PRE>

<P>
This doesn't affect the performance of <STRONG>MySQL</STRONG>, but has the side
effect that you can't kill clients that are ``sleeping'' on a connection with
<CODE>mysqladmin kill</CODE> or <CODE>mysqladmin shutdown</CODE>.  Instead, the client
will die when it issues its next command.

</P>
<P>
On some versions of AIX, linking with <CODE>libbind.a</CODE> makes <CODE>getservbyname</CODE> core
dump. This is an AIX bug and should be reported to IBM.

</P>


<H3><A NAME="HP-UX_10.20" HREF="manual_toc.html#HP-UX_10.20">4.11.16  HP-UX 10.20 notes</A></H3>

<P>
There are a couple of ``small'' problems when compiling <STRONG>MySQL</STRONG> on
HP-UX.  We recommend that you use <CODE>gcc</CODE> instead of the HP-UX native
compiler, because <CODE>gcc</CODE> produces better code!

</P>
<P>
We recommend one to use gcc 2.95 on HP-UX.  Don't use high optimization
flags (like -O6) as this may not be safe on HP-UX.

</P>
<P>
Note that MIT-pthreads can't be compiled with the HP-UX compiler,
because it can't compile <CODE>.S</CODE> (assembler) files.

</P>
<P>
The following configure line should work:

</P>

<PRE>
CFLAGS="-DHPUX -I/opt/dce/include" CXXFLAGS="-DHPUX -I/opt/dce/include -felide-constructors -fno-exceptions -fno-rtti" CXX=gcc ./configure --with-pthread --with-named-thread-libs='-ldce' --prefix=/usr/local/mysql --disable-shared
</PRE>

<P>
If you are compiling <CODE>gcc</CODE> 2.95 yourself, you should NOT link it with
the DCE libraries (<CODE>libdce.a</CODE> or <CODE>libcma.a</CODE>) if you want to compile
<STRONG>MySQL</STRONG> with MIT-pthreads.  If you mix the DCE and MIT-pthreads
packages you will get a <CODE>mysqld</CODE> to which you cannot connect.  Remove
the DCE libraries while you compile <CODE>gcc</CODE> 2.95!

</P>


<H3><A NAME="HP-UX_11.x" HREF="manual_toc.html#HP-UX_11.x">4.11.17  HP-UX 11.x notes</A></H3>

<P>
Here is some information that a HP-UX 11.x user sent us:

</P>
<P>
Note that some of these things are already fixed in <STRONG>MySQL</STRONG> 3.23.

</P>
<P>
Note: binary distribution for hp-ux 10.20 pa1.1 dumps core on
hp-ux 11.0 pa2.0 during <CODE>scripts/mysql_install_db</CODE>. As such, I
feel it necessary to build from scratch. This was a mildly
painful process so I am sharing my work so others may benefit.

</P>

<UL>
<LI>


<PRE>
 Environment:
      proper compilers.
         setenv CC cc
         setenv CXX aCC
      flags
         setenv CFLAGS -D_REENTRANT
         setenv CXXFLAGS -D_REENTRANT
         setenv CPPFLAGS -D_REENTRANT
     % aCC -V
     aCC: HP ANSI C++ B3910B X.03.14.06
     % cc -V /tmp/empty.c
     cpp.ansi: HP92453-01 A.11.02.00 HP C Preprocessor (ANSI)
     ccom: HP92453-01 A.11.01.00 HP C Compiler
     cc: "/tmp/empty.c", line 1: warning 501: Empty source file.
</PRE>

<LI>


<PRE>
  configuration:
     ./configure  --with-pthread        \
     --prefix=/source-control/mysql     \
     --with-named-thread-libs=-lpthread \
     --with-low-memory
</PRE>

<LI>

    added '#define _CTYPE_INCLUDED' to include/m_ctype.h. This
    symbol is the one defined in HP's /usr/include/ctype.h:


<PRE>
     /* Don't include std ctype.h when this is included */
     #define _CTYPE_H
     #define __CTYPE_INCLUDED
     #define _CTYPE_INCLUDED
     #define _CTYPE_USING   /* Don't put names in global namespace. */
</PRE>

<LI>

I had to use the compile-time flag <CODE>-D_REENTRANT</CODE> to get the
compiler to recognize the prototype for
<CODE>localtime_r</CODE>. Alternatively I could have supplied the
prototype for <CODE>localtime_r</CODE>. But I wanted to catch other bugs
without needing to run into them. I wasn't sure where I
needed it so I added it to all flags.
<LI>

The optimization flags used by <STRONG>MySQL</STRONG> (-O3) are not recognized
by HP's compilers. I did not change the flags.
<LI>

<STRONG>MySQL</STRONG> uses implicit conversion of string literals to <CODE>char
*</CODE>. This is a deprecated feature. I did not change the
behaviour.
</UL>

<P>
Comments from another user that built <STRONG>MySQL</STRONG> with the GCC 2.95.1:

</P>

<UL>
If you get the error:


<PRE>
In file included from /usr/include/unistd.h:11,
                 from ../include/global.h:125,
                 from mysql_priv.h:15,
                 from item.cc:19:
/usr/include/sys/unistd.h:184: declaration of C function `int pthread_atfork(void (*)(...), void (*)
(...), void (*)(...))' conflicts with
/usr/include/sys/pthread.h:440: previous declaration `int pthread_atfork(void (*)(), void (*)(), voi
d (*)())' here
In file included from item.h:306,
                 from mysql_priv.h:158,
                 from item.cc:19:
</PRE>

The problem is that, HPUX doesn't define pthreads_atfork() consistently
amoung itself.  It has conflicting prototypes in
<TT>`/usr/include/sys/unistd.h'</TT>:184 and
<TT>`/usr/include/sys/pthread.h'</TT>:440 (I post the details below).

My solution was to copy <TT>`/usr/include/sys/unistd.h'</TT> into
<TT>`mysql/include'</TT> and edit <TT>`unistd.h'</TT> and change the it to match
the definition in <TT>`pthread.h'</TT>.  Here's the diff:


<PRE>
183,184c183,184
&#60;      extern int pthread_atfork(void (*prepare)(), void (*parent)(),
&#60;                                                                  void (*child)());
---
&#62;      extern int pthread_atfork(void (*prepare)(void), void (*parent)(void),
&#62;                                                                  void (*child)(void));
</PRE>

</UL>



<H3><A NAME="MaxOSX" HREF="manual_toc.html#MaxOSX">4.11.18  MacOS X notes</A></H3>

<P>
You can get <STRONG>MySQL</STRONG> to work on MacOS X by following the links to
the MacOS X ports. See section <A HREF="manual.html#Useful_Links">1.9  Useful MySQL-related links</A>.

</P>
<P>
<STRONG>MySQL</STRONG> 3.23.7 should include all patches necessary to configure
it on MacOSX. You must however first install the pthread package from
<a HREF="http://www.prnet.de/RegEx/mysql.html">MySql for MacOSX Server</a> 
before configuring MySQL.

</P>
<P>
You might want to also add aliases to your shell's resource file to
access <CODE>mysql</CODE> and <CODE>mysqladmin</CODE> from the command line.

</P>

<PRE>
alias mysql '/usr/local/mysql/bin/mysql'
alias mysqladmin '/usr/local/mysql/libexec/mysqladmin'
</PRE>



<H2><A NAME="Win32" HREF="manual_toc.html#Win32">4.12  Win32 notes</A></H2>

<P>
This section describes installation and use of <STRONG>MySQL</STRONG> on Win32.  This
is also described in the <TT>`README'</TT> file that comes with the
<STRONG>MySQL</STRONG> Win32 distribution.

</P>



<H3><A NAME="Win32_installation" HREF="manual_toc.html#Win32_installation">4.12.1  Installing MySQL on Win32</A></H3>

<P>
If you don't have a registered version of <STRONG>MySQL</STRONG>, you should first
download the shareware version from:

</P>
<P>
<a HREF="http://www.mysql.com/mysql_w32.htmy"><STRONG>MySQL</STRONG> 3.21.29</a>

</P>
<P>
If you plan to connect to <STRONG>MySQL</STRONG> from some other program, you will
probably also need the <STRONG>MyODBC</STRONG> driver. You can find this at the
<a HREF="http://www.mysql.com/download.htmy"><STRONG>MySQL</STRONG> download page</a>.

</P>
<P>
To install either distribution, unzip it in some empty directory and run the
<CODE>Setup.exe</CODE> program.

</P>
<P>
By default, <STRONG>MySQL</STRONG>-Win32 is configured to be installed in
<TT>`C:\mysql'</TT>.  If you want to install <STRONG>MySQL</STRONG> elsewhere, install it
in <TT>`C:\mysql'</TT>, then move the installation to where you want it.  If you
do move <STRONG>MySQL</STRONG>, you must tell <CODE>mysqld</CODE> where everything is by
supplying options to <CODE>mysqld</CODE>. Use <CODE>C:\mysql\bin\mysqld --help</CODE> to
display all options!  For example, if you have moved the <STRONG>MySQL</STRONG>
distribution to <TT>`D:\programs\mysql'</TT>, you must start <CODE>mysqld</CODE> with:
<CODE>D:\programs\mysql\bin\mysqld --basedir D:\programs\mysql</CODE>

</P>
<P>
With the registered version of <STRONG>MySQL</STRONG>, you can also create a
<TT>`C:\my.cnf'</TT> file that holds any default options for the
<STRONG>MySQL</STRONG> server.  Copy the file <TT>`\mysql\my-example.cnf'</TT> to
<TT>`C:\my.cnf'</TT> and edit this to suit your setup.  Note that you should
specify all paths with <CODE>/</CODE> instead of <CODE>\</CODE>. If you use
<CODE>\</CODE>, you need to specify this twice, as <CODE>\</CODE> is the escape
character in <STRONG>MySQL</STRONG>.
See section <A HREF="manual.html#Option_files">4.15.4  Option files</A>.

</P>


<H3><A NAME="Win95_start" HREF="manual_toc.html#Win95_start">4.12.2  Starting MySQL on Win95 / Win98</A></H3>

<P>
<STRONG>MySQL</STRONG> uses TCP/IP to connect a client to a server. (This will
allow any machine on your network to connect to your <STRONG>MySQL</STRONG>
server). Because of this, you must install TCP/IP on your machine before
starting <STRONG>MySQL</STRONG>.  You can find TCP/IP on your Windows CD-ROM.

</P>
<P>
Note that if you are using an old Win95 release (for example OSR2), it's
likely that you have an old Winsock package!  <STRONG>MySQL</STRONG> requires
Winsock 2!  You can get the newest Winsock from
<a HREF="http://www.microsoft.com">Microsoft</a>.  Win98 has as default the new
Winsock 2 library, so the above doesn't apply for Win98.

</P>
<P>
There are 2 different <STRONG>MySQL</STRONG> servers you can use:

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><CODE>mysqld</CODE> </TD><TD> Compiled with full debugging and automatic memory allocation checking
</TR NOSAVE>
<TR><TD><CODE>mysqld-opt</CODE> </TD><TD> Optimized for a Pentium processor.
</TR>
</TABLE>

<P>
Both of the above should work on any Intel processor &#62;= i386.

</P>
<P>
To start the <CODE>mysqld</CODE> server, you should start a MS-DOS window and type:

</P>

<PRE>
C:\mysql\bin\mysqld
</PRE>

<P>
This will start <CODE>mysqld</CODE> in the background without a window.

</P>
<P>
You can kill the <STRONG>MySQL</STRONG> server by executing:

</P>

<PRE>
C:\mysql\bin\mysqladmin -u root shutdown
</PRE>

<P>
Note that Win95/Win98 don't support creation of named pipes.  On
Win95/Win98, you can only use named pipes to connect to a remote
<STRONG>MySQL</STRONG> running on an NT server.

</P>
<P>
If <CODE>mysqld</CODE> doesn't start please check if the
<TT>`\mysql\mysql.err'</TT> file contains any reason for this.  You can also
try to start it with <CODE>mysqld --standalone</CODE>;  In this case you may
get some useful information on the screen that may help solve this.

</P>
<P>
The last option is to start <CODE>mysqld</CODE> with <CODE>--debug</CODE>.  In this
case <CODE>mysqld</CODE> will write a log file in <TT>`\mysqld.trace'</TT>
that should contain the reason why <CODE>mysqld</CODE> doesn't start.  If you
make a bug report about this, please only send the lines where something
seams to go wrong to the mailing list!

</P>


<H3><A NAME="NT_start" HREF="manual_toc.html#NT_start">4.12.3  Starting MySQL on NT</A></H3>

<P>
The Win95/Win98 section also applies to <STRONG>MySQL</STRONG> on NT, with the
following differences:

</P>
<P>
To get <STRONG>MySQL</STRONG> to work with TCP/IP, you must install service pack 3
(or newer)! 

</P>
<P>
For NT, the server name is <CODE>mysqld-nt</CODE>.  Normally you should install
<STRONG>MySQL</STRONG> as a service on NT:

</P>

<PRE>
C:\mysql\bin\mysqld-nt --install
</PRE>

<P>
(You could use the <CODE>mysqld</CODE> or <CODE>mysqld-opt</CODE> servers on NT,
but those cannot be started as a service or use named pipes.)

</P>
<P>
You can start and stop the <STRONG>MySQL</STRONG> service with:

</P>

<PRE>
NET START mysql
NET STOP mysql
</PRE>

<P>
Note that in this case you can't use any other options for <CODE>mysqld-nt</CODE>!

</P>
<P>
You can also run <CODE>mysqld-nt</CODE> as a standalone program on NT if you need
to start <CODE>mysqld-nt</CODE> with any options!  If you start <CODE>mysqld-nt</CODE>
without options on NT, <CODE>mysqld-nt</CODE> tries to starts itself as a service
with the default service options.  If you have stopped <CODE>mysqld-nt</CODE>, you
have to start it with <CODE>NET START mysql</CODE>.

</P>
<P>
The service is installed with the name <CODE>MySql</CODE>. Once installed, it must
be started using Services Control Manager (SCM) Utility (found in Control
Panel) or by using the <CODE>NET START MySQL</CODE> command. If any options are
desired, they must be specified as "Startup parameters" in the SCM utility
before you start the <STRONG>MySQL</STRONG> service.  Once running, <CODE>mysqld-nt</CODE>
can be stopped using <CODE>mysqladmin</CODE> or from the SCM utility or by using
the command <CODE>NET STOP MySQL</CODE>. If you use SCM to stop <CODE>mysqld-nt</CODE>,
there is a strange message from SCM about <CODE>mysqld shutdown normally</CODE>.
When run as a service, <CODE>mysqld-nt</CODE> has no access to a console and so no
messages can be seen.

</P>
<P>
On NT you can get the following service error messages:

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD>Permission Denied </TD><TD> Means that it cannot find <CODE>mysqld-nt.exe</CODE>
</TR NOSAVE>
<TR><TD>Cannot Register </TD><TD> Means that the path is incorrect
</TR>
</TABLE>

<P>
If you have problems installing <CODE>mysqld-nt</CODE> as a service, try starting
it with the full path:

</P>

<PRE>
C:\mysql\bin\mysqld-nt --install
</PRE>

<P>
If this doesn't work, you can get <CODE>mysqld-nt</CODE> to start properly by fixing
the path in the registry!

</P>
<P>
If you don't want to start <CODE>mysqld-nt</CODE> as a service, you can start it as
follows:

</P>

<PRE>
C:\mysql\bin\mysqld-nt --standalone
</PRE>

<P>
or

</P>

<PRE>
C:\mysql\bin\mysqld --standalone --debug
</PRE>

<P>
The last version gives you a debug trace in <TT>`C:\mysqld.trace'</TT>.

</P>


<H3><A NAME="Win32_running" HREF="manual_toc.html#Win32_running">4.12.4  Running MySQL on Win32</A></H3>

<P>
<STRONG>MySQL</STRONG> supports TCP/IP on all Win32 platforms and named pipes on NT.
The default is to use named pipes for local connections on NT and TCP/IP for
all other cases if the client has TCP/IP installed.  The host name specifies
which protocol is used:

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<STRONG>Host name</STRONG> </TD><TD> <STRONG>protocol</STRONG>
<TR><TD>NULL (none) </TD><TD> On NT, try named pipes first; if that doesn't work, use TCP/IP. On Win95/Win98, TCP/IP is used.
</TR NOSAVE>
<TR><TD>. </TD><TD> Named pipes
</TR NOSAVE>
<TR><TD>localhost </TD><TD> TCP/IP to current host
</TR NOSAVE>
<TR><TD>hostname </TD><TD> TCP/IP
</TR>
</TABLE>

<P>
You can force a <STRONG>MySQL</STRONG> client to use named pipes by specifying the
<CODE>--pipe</CODE> option.  Use the <CODE>--socket</CODE> option to specify the name of
the pipe.

</P>
<P>
You can test whether or not <STRONG>MySQL</STRONG> is working by executing the
following commands:

</P>

<PRE>
C:\mysql\bin\mysqlshow
C:\mysql\bin\mysqlshow -u root mysql
C:\mysql\bin\mysqladmin version status proc
C:\mysql\bin\mysql test
</PRE>

<P>
If <CODE>mysqld</CODE> is slow to answer to connections on Win95/Win98, there is
probably a problem with your DNS. In this case, start <CODE>mysqld</CODE> with
<CODE>--skip-name-resolve</CODE> and use only <CODE>localhost</CODE> and IP numbers in
the <STRONG>MySQL</STRONG> grant tables.  You can also avoid DNS when connecting to a
<CODE>mysqld-nt</CODE> <STRONG>MySQL</STRONG> server running on NT by using the
<CODE>--pipe</CODE> argument to specify use of named pipes.  This works for most
<STRONG>MySQL</STRONG> clients.

</P>
<P>
There are two versions of the <STRONG>MySQL</STRONG> command line tool:
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><CODE>mysql</CODE> </TD><TD> Compiled on native Win32, which offers very limited text
editing capabilities.
</TR NOSAVE>
<TR><TD><CODE>mysqlc</CODE> </TD><TD> Compiled with the Cygnus GNU compiler and libraries, which offers <CODE>readline</CODE> editing.
</TR>
</TABLE>

</P>
<P>
If you want to use <CODE>mysqlc.exe</CODE>, you must copy
<TT>`C:\mysql\lib\cygwinb19.dll'</TT> to <TT>`\windows\system'</TT> (or similar
place).

</P>
<P>
The default privileges on Win32 give all local users full privileges
to all databases.  To make <STRONG>MySQL</STRONG> more secure, you
should set a password for all users and remove the row in the
<CODE>mysql.user</CODE> table that has <CODE>Host='localhost'</CODE> and
<CODE>User=''</CODE>.

</P>
<P>
You should also add a password for the <CODE>root</CODE> user:
(The following example starts by removing the anonymous user, that allows
anyone to access the 'test' database)

</P>

<PRE>
C:\mysql\bin\mysql mysql
mysql&#62; DELETE FROM user WHERE Host='localhost' AND User='';
mysql&#62; QUIT
C:\mysql\bin\mysqladmin reload
C:\mysql\bin\mysqladmin -u root password your_password
</PRE>

<P>
After you've set the password, if you want to take down the <CODE>mysqld</CODE>
server, you can do so using this command:

</P>

<PRE>
mysqladmin --user=root --password=your_password shutdown
</PRE>

<P>
If you are using the shareware version of <STRONG>MySQL</STRONG> under windows,
the above command will fail with an error: <CODE>parse error near 'SET
OPTION password'</CODE>.  This is because the shareware version, which is
based on MySQL 3.21, doesn't have the <CODE>SET PASSWORD</CODE> command.

</P>
<P>
With the shareware version you can set the password for the root user as
follows:

</P>

<PRE>
C:\mysql\bin\mysql mysql
mysql&#62; UPDATE user SET password=PASSWORD('your password') WHERE user='root';
mysql&#62; QUIT
C:\mysql\bin\mysqladmin reload
</PRE>

<P>
With the registered <STRONG>MySQL</STRONG> version you can easily add new users
and change privileges with <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> commands.
See section <A HREF="manual.html#GRANT">7.26  <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> syntax</A>.  With the Windows shareware version on has to use
<CODE>INSERT</CODE>, <CODE>UPDATE</CODE> and <CODE>DELETE</CODE> one the tables in the
<CODE>mysql</CODE> database to manage users and their privileges.
See section <A HREF="manual.html#Access_denied">6.15  Causes of <CODE>Access denied</CODE> errors</A>.

</P>


<H3><A NAME="Win32_and_SSH" HREF="manual_toc.html#Win32_and_SSH">4.12.5  Connecting to a remote MySQL from Win32 with SSH</A></H3>

<P>
Here is a note about how to connect to get a secure connection to remote MySQL
server with SSH (by David Carlson).

</P>

<UL>
<LI>

Install SSH client on your windows machine - I used a free SSH client
from <a HREF="http://www.doc.ic.ac.uk/~ci2/ssh/">http://www.doc.ic.ac.uk/~ci2/ssh/</a>.
Other useful links:
<a HREF="http://www.npaci.edu/Security/npaci_security_software.html">http://www.npaci.edu/Security/npaci_security_software.html</a> and
<a HREF="http://www.npaci.edu/Security/samples/ssh32_windows/index.html">http://www.npaci.edu/Security/samples/ssh32_windows/index.html</a>.
<LI>

Start SSH. Set Host Name = yourmysqlserver name or IP address. Set
userid=your userid to log in to your server
<LI>

Click on "local forwards". Set <CODE>local port: 3306</CODE>,
<CODE>host: localhost</CODE>, <CODE>remote port: 3306</CODE>
<LI>

Save everything, otherwise you'll have to redo it the next time.
<LI>

Log in to your server with SSH.
<LI>

Start some ODBC application (for example Access)
<LI>

Create a new file and link to mySQL using the ODBC driver the same way
you normally do except for server, user "localhost".
</UL>

<P>
That's it. It works very well with a direct Internet connection. I'm
having problems with SSH conflicting with my Win95 network and Wingate -
but that'll be the topic of a posting on another software company's
usegroup!

</P>


<H3><A NAME="Win32_vs._Unix" HREF="manual_toc.html#Win32_vs._Unix">4.12.6  MySQL-Win32 compared to Unix MySQL</A></H3>

<P>
<STRONG>MySQL</STRONG>-Win32 has by now proven itself to be very stable. This version
of <STRONG>MySQL</STRONG> has the same features as the corresponding Unix version
with the following exceptions:

</P>
<DL COMPACT>

<DT><STRONG>Win95 and threads</STRONG>
<DD>
Win95 leaks about 200 bytes of main memory for each thread creation.  Because
of this, you shouldn't run <CODE>mysqld</CODE> for an extended time on Win95 if
you do many connections, since each connection in <STRONG>MySQL</STRONG> creates
a new thread!  WinNT and Win98 don't suffer from this bug.

<DT><STRONG>Blocking read</STRONG>
<DD>
<STRONG>MySQL</STRONG> uses a blocking read for each connection.
This means that:


<UL>
<LI>

A connection will not be disconnected automatically after 8 hours, as happens
with the Unix version of <STRONG>MySQL</STRONG>.

<LI>

If a connection ``hangs,'' it's impossible to break it without killing
<STRONG>MySQL</STRONG>.

<LI>

<CODE>mysqladmin kill</CODE> will not work on a sleeping connection.

<LI>

<CODE>mysqladmin shutdown</CODE> can't abort as long as there are sleeping
connections.
</UL>

We plan to fix this in the near future.

<DT><STRONG>UDF functions</STRONG>
<DD>
For the moment, <STRONG>MySQL</STRONG>-Win32 does not support user definable functions.

<DT><STRONG><CODE>DROP DATABASE</CODE></STRONG>
<DD>
You can't drop a database that is in use by some thread.

<DT><STRONG>Killing <STRONG>MySQL</STRONG> from the task manager</STRONG>
<DD>
You can't kill <STRONG>MySQL</STRONG> from the task manager or with the shutdown
utility in Windows95. You must take it down with <CODE>mysqladmin shutdown</CODE>.

<DT><STRONG>Case-insensitive names</STRONG>
<DD>
Filenames are case insensitive on Win32, so database and table names
are also case insensitive in <STRONG>MySQL</STRONG> for Win32.  The only restriction is
that database and table names must be given in the same case throughout a
given statement.  The following query would not work because it refers to
a table both as <CODE>my_table</CODE> and as <CODE>MY_TABLE</CODE>:

<PRE>
SELECT * FROM my_table WHERE MY_TABLE.col=1;
</PRE>

<DT><STRONG>The <SAMP>`\'</SAMP> directory character</STRONG>
<DD>
Pathname components in Win95 are separated by <SAMP>`\'</SAMP> characters, which is
also the escape character in <STRONG>MySQL</STRONG>.  If you are using <CODE>LOAD
DATA INFILE</CODE> or <CODE>SELECT ... INTO OUTFILE</CODE>, you must double the <SAMP>`\'</SAMP>
character or use Unix style filenames <SAMP>`/'</SAMP> characters:

<PRE>
LOAD DATA INFILE "C:\\tmp\\skr.txt" INTO TABLE skr;
SELECT * FROM skr INTO OUTFILE 'C:/tmp/skr.txt';
</PRE>

<DT><STRONG><CODE>Can't open named pipe</CODE> error</STRONG>
<DD>
If you use the shareware version of <STRONG>MySQL</STRONG>-Win32 on NT with the
newest mysql-clients you will get the following error:


<PRE>
error 2017: can't open named pipe to host: . pipe...
</PRE>

<A NAME="IDX88"></A>
This is because the release version of <STRONG>MySQL</STRONG> uses
named pipes on NT by default.  You can avoid this error by using the
<CODE>--host=localhost</CODE> option to the new <STRONG>MySQL</STRONG> clients
or create a file <TT>`C:\my.cnf'</TT> that contains the following information:


<PRE>
[client]
host = localhost
</PRE>

<DT><STRONG><CODE>Access denied for user</CODE> error</STRONG>
<DD>
If you get the error <CODE>Access denied for user: 'some-user@unknown'
to database 'mysql'</CODE> when accessing a <STRONG>MySQL</STRONG> server on the same
machine, this means that <STRONG>MySQL</STRONG> can't resolve your host name
properly.

To fix this, you should create a file <TT>`\windows\hosts'</TT> with the
following information:


<PRE>
127.0.0.1       localhost
</PRE>

</DL>

<P>
Here are some open issues for anyone who might want to help us with the Win32
release:

</P>

<UL>
<LI>

Make a single user <CODE>MYSQL.DLL</CODE> server.  This should include everything in
a standard <STRONG>MySQL</STRONG> server, except thread creation.  This will make
<STRONG>MySQL</STRONG> much easier to use in applications that don't need a true
client/server and don't need to access the server from other hosts.

<LI>

Add some nice ``start'' and ``shutdown'' icons to the <STRONG>MySQL</STRONG> installation.

<LI>

Create a tool to manage registry entries for the <STRONG>MySQL</STRONG> startup
options.  The registry entry reading is already coded into <CODE>mysqld.cc</CODE>,
but it should be recoded to be more ``parameter'' oriented.
The tool should also be able to update the <TT>`\my.cnf'</TT> file if the user
would prefer to use this instead of the registry.

<LI>

When registering <CODE>mysqld</CODE> as a service with <CODE>--install</CODE> (on NT)
it would be nice if you could also add default options on the command line.
For the moment, the workaround is to update the <TT>`C:\my.cnf'</TT> file
instead.

<LI>

When you suspend a laptop running Win95, the <CODE>mysqld</CODE>
daemon doesn't accept new connections when the laptop is resumed.
We don't know if this is a problem with Win95, TCP/IP or <STRONG>MySQL</STRONG>.

<LI>

It would be real nice to be able to kill <CODE>mysqld</CODE> from the
task manager.  For the moment, you must use <CODE>mysqladmin shutdown</CODE>.

<LI>

Port <CODE>readline</CODE> to Win32 for use in the <CODE>mysql</CODE> command line tool.

<LI>

GUI versions of the standard <STRONG>MySQL</STRONG> clients (<CODE>mysql</CODE>,
<CODE>mysqlshow</CODE>, <CODE>mysqladmin</CODE>, and <CODE>mysqldump</CODE>) would be nice.

<LI>

It would be nice if the socket ``read'' and ``write'' functions in
<TT>`net.c'</TT> were interruptible. This would make it possible to kill open
threads with <CODE>mysqladmin kill</CODE> on Win32.

<LI>

Documentation of which Windows programs work with
<STRONG>MySQL</STRONG>-Win32/<STRONG>MyODBC</STRONG> and what must be done to get them working.

<LI>

<CODE>mysqld</CODE> always starts in the "C" locale and not in the default locale.
We would like to have <CODE>mysqld</CODE> use the current locale for the sort order.

<LI>

Port <CODE>sqlclient</CODE> to Win32 (almost done) and add more features to it!

<LI>

Add more options to MysqlManager.

<LI>

Change the communication protocol between the server and client to use Windows
internal communication instead of sockets and TCP/IP.

<LI>

Implement UDF functions with <CODE>.DLL</CODE>s.

<LI>

Add macros to use the faster thread-safe increment/decrement methods
provided by Win32.

</UL>

<P>
Other Win32-specific issues are described in the <TT>`README'</TT> file that comes
with the <STRONG>MySQL</STRONG>-Win32 distribution.

</P>


<H2><A NAME="OS_2" HREF="manual_toc.html#OS_2">4.13  OS/2 notes</A></H2>

<P>
<STRONG>MySQL</STRONG> uses quite a few open files. Because of this, you
should add something like the following to your <TT>`CONFIG.SYS'</TT> file:

</P>

<PRE>
SET EMXOPT=-c -n -h1024
</PRE>

<P>
If you don't do this, you will probably run into the following error:

</P>

<PRE>
File 'xxxx' not found (Errcode: 24)
</PRE>

<P>
When using <STRONG>MySQL</STRONG> with OS/2 Warp 3, FixPack 29 or above is
required.  With OS/2 Warp 4, FixPack 4 or above is required. This is a
requirement of the Pthreads library.  <STRONG>MySQL</STRONG> must be installed
in a partition that supports long file names such as HPFS, FAT32, etc.

</P>
<P>
The <TT>`INSTALL.CMD'</TT> script must be run from OS/2's own <TT>`CMD.EXE'</TT>
and may not work with replacement shells such as <TT>`4OS2.EXE'</TT>.

</P>
<P>
The <TT>`scripts/mysql-install-db'</TT> script has been renamed: it is now called
<TT>`install.cmd'</TT> and is a REXX script which will set up the default
<STRONG>MySQL</STRONG> security settings and create the WorkPlace Shell icons
for <STRONG>MySQL</STRONG>.

</P>
<P>
Dynamic module support is compiled in but not fully tested. Dynamic
modules should be compiled using the Pthreads runtime library.

</P>

<PRE>
gcc -Zdll -Zmt -Zcrtdll=pthrdrtl -I../include -I../regex -I.. \
    -o example udf_example.cc -L../lib -lmysqlclient udf_example.def
mv example.dll example.udf
</PRE>

<P>
<STRONG>Note:</STRONG> Due to limitations in OS/2, UDF module name stems must not
exceed 8 characters. Modules are stored in the <TT>`/mysql2/udf'</TT>
directory; the <CODE>safe-mysqld.cmd</CODE> script will put this directory in
the <CODE>BEGINLIBPATH</CODE> environment variable. When using UDF modules,
specified extensions are ignored -- it is assumed to be <TT>`.udf'</TT>.
For example, in Unix, the shared module might be named <TT>`example.so'</TT>
and you would load a function from it like this:

</P>

<PRE>
CREATE FUNCTION metaphon RETURNS STRING SONAME "example.so";
</PRE>

<P>
Is OS/2, the module would be named <TT>`example.udf'</TT>, but you would not
specify the module extension:

</P>

<PRE>
CREATE FUNCTION metaphon RETURNS STRING SONAME "example";
</PRE>



<H2><A NAME="TcX_binaries" HREF="manual_toc.html#TcX_binaries">4.14  TcX binaries</A></H2>

<P>
As a service, TcX provides a set of binary distributions of <STRONG>MySQL</STRONG>
that are compiled at TcX or at sites where customers kindly have given us
access to their machines.

</P>
<P>
These distributions
are generated with <CODE>scripts/make_binary_distribution</CODE> and are
configured with the following compilers and options:

</P>
<DL COMPACT>

<DT>SunOS 4.1.4 2 sun4c with <CODE>gcc</CODE> 2.7.2.1
<DD>
<CODE>CC=gcc CXX=gcc CXXFLAGS=-O3 ./configure --prefix=/usr/local/mysql --disable-shared</CODE>

<DT>SunOS 5.5.1 sun4u with <CODE>egcs</CODE> 1.0.3a
<DD>
<CODE>CC=gcc CFLAGS="-O6 -fomit-frame-pointer" CXX=gcc CXXFLAGS="-O6 -fomit-frame-pointer -felide-constructors -fno-exceptions -fno-rtti" ./configure --prefix=/usr/local/mysql --with-low-memory</CODE>

<DT>SunOS 5.6 sun4u with <CODE>egcs</CODE> 2.90.27
<DD>
<CODE>CC=gcc CFLAGS="-O6 -fomit-frame-pointer" CXX=gcc CXXFLAGS="-O6 -fomit-frame-pointer -felide-constructors -fno-exceptions -fno-rtti" ./configure --prefix=/usr/local/mysql --with-low-memory</CODE>

<DT>SunOS 5.6 i86pc with <CODE>gcc</CODE> 2.8.1
<DD>
<CODE>CC=gcc CXX=gcc CXXFLAGS=-O3 ./configure --prefix=/usr/local/mysql --with-low-memory</CODE>

<DT>Linux 2.0.33 i386 with <CODE>pgcc</CODE> 2.90.29 (<CODE>egcs</CODE> 1.0.3a)
<DD>
<CODE>CFLAGS="-O6 -mpentium -mstack-align-double -fomit-frame-pointer" CXX=gcc CXXFLAGS="-O6 -mpentium -mstack-align-double -fomit-frame-pointer -felide-constructors -fno-exceptions -fno-rtti" ./configure --prefix=/usr/local/mysql --enable-assembler --with-mysqld-ldflags=-all-static</CODE>

<DT>SCO 3.2v5.0.4 i386 with <CODE>gcc</CODE> 2.7-95q4
<DD>
<CODE>CC=gcc CXX=gcc CXXFLAGS=-O3 ./configure --prefix=/usr/local/mysql</CODE>

<DT>AIX 2 4 with <CODE>gcc</CODE> 2.7.2.2
<DD>
<CODE>CC=gcc CXX=gcc CXXFLAGS=-O3 ./configure --prefix=/usr/local/mysql</CODE>

<DT>OSF1 V4.0 564 alpha with <CODE>gcc</CODE> 2.8.1
<DD>
<CODE>CC=gcc CFLAGS=-O CXX=gcc CXXFLAGS=-O3 ./configure --prefix=/usr/local/mysql --with-low-memory</CODE>

<DT>Irix 6.3 IP32 with <CODE>gcc</CODE> 2.8.0
<DD>
<CODE>CC=gcc CXX=gcc CXXFLAGS=-O3 ./configure --prefix=/usr/local/mysql</CODE>

<DT>BSDI BSD/OS 3.1 i386 with <CODE>gcc</CODE> 2.7.2.1
<DD>
<CODE>CC=gcc CXX=gcc CXXFLAGS=-O ./configure --prefix=/usr/local/mysql</CODE>

<DT>BSDI BSD/OS 2.1 i386 with <CODE>gcc</CODE> 2.7.2
<DD>
<CODE>CC=gcc CXX=gcc CXXFLAGS=-O3 ./configure --prefix=/usr/local/mysql</CODE>
</DL>

<P>
Anyone who has more optimal options for any of the configurations listed
above can always mail them to the developer's mailing list at

</P>
<P>
RPM distributions prior to <STRONG>MySQL</STRONG> 3.22 are user-contributed.
Beginning with 3.22, some RPMs are TcX-generated.

</P>


<H2><A NAME="Post-installation" HREF="manual_toc.html#Post-installation">4.15  Post-installation setup and testing</A></H2>

<P>
Once you've installed <STRONG>MySQL</STRONG> (from either a binary or source
distribution), you need to initialize the grant tables, start the server
and make sure that the server works okay.  You may also wish to arrange
for the server to be started and stopped automatically when your system
starts up and shuts down.

</P>
<P>
Normally you install the grant tables and start the server like this
for installation from a source distribution:

</P>

<PRE>
shell&#62; ./scripts/mysql_install_db
shell&#62; cd mysql_installation_directory
shell&#62; ./bin/safe_mysqld &#38;
</PRE>

<P>
For a binary distribution, do this:

</P>

<PRE>
shell&#62; cd mysql_installation_directory
shell&#62; ./bin/mysql_install_db
shell&#62; ./bin/safe_mysqld &#38;
</PRE>

<P>
Testing is most easily done from the top-level directory of the <STRONG>MySQL</STRONG>
distribution.  For a binary distribution, this is your installation directory
(typically something like <TT>`/usr/local/mysql'</TT>).  For a source
distribution, this is the main directory of your <STRONG>MySQL</STRONG> source tree.

</P>
<P>
In the commands shown below in this section and in the following
subsections, <CODE>BINDIR</CODE> is the path to the location in which programs
like <CODE>mysqladmin</CODE> and <CODE>safe_mysqld</CODE> are installed.  For a
binary distribution, this is the <TT>`bin'</TT> directory within the
distribution.  For a source distribution, <CODE>BINDIR</CODE> is probably
<TT>`/usr/local/bin'</TT>, unless you specified an installation directory
other than <TT>`/usr/local'</TT> when you ran <CODE>configure</CODE>.
<CODE>EXECDIR</CODE> is the location in which the <CODE>mysqld</CODE> server is
installed.  For a binary distribution, this is the same as
<CODE>BINDIR</CODE>.  For a source distribution, <CODE>EXECDIR</CODE> is probably
<TT>`/usr/local/libexec'</TT>.

</P>
<P>
Testing is described in detail below:

</P>

<OL>
<LI>

If necessary, start the <CODE>mysqld</CODE> server and set up the initial
<STRONG>MySQL</STRONG> grant tables containing the privileges that determine how
users are allowed to connect to the server.  This is normally done with the
<CODE>mysql_install_db</CODE> script:


<PRE>
shell&#62; scripts/mysql_install_db
</PRE>

Typically, <CODE>mysql_install_db</CODE> needs to be run only the first time you
install <STRONG>MySQL</STRONG>.  Therefore, if you are upgrading an existing
installation, you can skip this step. (However, <CODE>mysql_install_db</CODE> is
quite safe to use and will not update any tables that already exist, so if
you are unsure what to do, you can always run <CODE>mysql_install_db</CODE>.)

<CODE>mysql_install_db</CODE> creates six tables (<CODE>user</CODE>, <CODE>db</CODE>,
<CODE>host</CODE>, <CODE>tables_priv</CODE>, <CODE>columns_priv</CODE> and <CODE>func</CODE>) in the
<CODE>mysql</CODE> database.  A description of the initial privileges is given in
section <A HREF="manual.html#Default_privileges">6.12  Setting up the initial MySQL privileges</A>.  Briefly, these privileges allow the <STRONG>MySQL</STRONG>
<CODE>root</CODE> user to do anything, and allow anybody to create or use databases
with a name of <CODE>'test'</CODE> or starting with <CODE>'test_'</CODE>.

If you don't set up the grant tables, the following error will appear in the
log file when you start the server:

<A NAME="IDX89"></A>

<PRE>
mysqld: Can't find file: 'host.frm'
</PRE>

The above may also happens with a binary <STRONG>MySQL</STRONG> distribution if you
don't start <STRONG>MySQL</STRONG> by executing exactly <CODE>./bin/safe_mysqld</CODE>!

You might need to run <CODE>mysql_install_db</CODE> as <CODE>root</CODE>.  However,
if you prefer, you can run the <STRONG>MySQL</STRONG> server as an unprivileged
(non-<CODE>root</CODE>) user, provided that user can read and write files in
the database directory.  Instructions for running <STRONG>MySQL</STRONG> as an
unprivileged user are given in section <A HREF="manual.html#Changing_MySQL_user">18.8  How to run MySQL as a normal user</A>.

If you have problems with <CODE>mysql_install_db</CODE>, see
section <A HREF="manual.html#mysql_install_db">4.15.1  Problems running <CODE>mysql_install_db</CODE></A>.

There are some alternatives to running the <CODE>mysql_install_db</CODE>
script as it is provided in the <STRONG>MySQL</STRONG> distribution:


<UL>
<LI>

You may want to edit <CODE>mysql_install_db</CODE> before running it, to
change the initial privileges that are installed into the grant tables.
This is useful if you want to install <STRONG>MySQL</STRONG> on a lot of machines
with the same privileges.  In this case you probably should need only to add
a few extra <CODE>INSERT</CODE> statements to the <CODE>mysql.user</CODE> and
<CODE>mysql.db</CODE> tables!

<LI>

If you want to change things in the grant tables after installing them, you
can run <CODE>mysql_install_db</CODE>, then use <CODE>mysql -u root mysql</CODE> to
connect to the grant tables as the <STRONG>MySQL</STRONG> <CODE>root</CODE> user and issue
SQL statements to modify the grant tables directly.

<LI>

It is possible to recreate the grant tables completely after they have
already been created.  You might want to do this if you've already installed
the tables but then want to recreate them after editing
<CODE>mysql_install_db</CODE>.
</UL>

For more information about these alternatives, see section <A HREF="manual.html#Default_privileges">6.12  Setting up the initial MySQL privileges</A>.

<LI>

Start the <STRONG>MySQL</STRONG> server like this:

<PRE>
shell&#62; cd mysql_installation_directory
shell&#62; bin/safe_mysqld &#38;
</PRE>

If you have problems starting the server, see section <A HREF="manual.html#Starting_server">4.15.2  Problems starting the MySQL server</A>.

<LI>

Use <CODE>mysqladmin</CODE> to verify that the server is running.  The following
commands provide a simple test to check that the server is up and responding
to connections:


<PRE>
shell&#62; BINDIR/mysqladmin version
shell&#62; BINDIR/mysqladmin variables
</PRE>

The output from <CODE>mysqladmin version</CODE> varies slightly depending on your
platform and version of <STRONG>MySQL</STRONG>, but should be similar to that shown
below:


<PRE>
shell&#62; BINDIR/mysqladmin version
mysqladmin  Ver 6.3 Distrib 3.22.9-beta, for pc-linux-gnu on i686
TCX Datakonsult AB, by Monty

Server version          3.22.9-beta
Protocol version        10
Connection              Localhost via UNIX socket
TCP port                3306
UNIX socket             /tmp/mysql.sock
Uptime:                 16 sec

Running threads: 1  Questions: 20  Reloads: 2  Open tables: 3
</PRE>

To get a feeling for what else you can do with <CODE>BINDIR/mysqladmin</CODE>,
invoke it with the <CODE>--help</CODE> option.

<LI>

Verify that you can shut down the server:


<PRE>
shell&#62; BINDIR/mysqladmin -u root shutdown
</PRE>

<LI>

Verify that you can restart the server.  Do this using <CODE>safe_mysqld</CODE> or
by invoking <CODE>mysqld</CODE> directly.  For example:


<PRE>
shell&#62; BINDIR/safe_mysqld --log &#38;
</PRE>

If <CODE>safe_mysqld</CODE> fails, try running it from the <STRONG>MySQL</STRONG>
installation directory (if you are not already there).  If that doesn't work,
see section <A HREF="manual.html#Starting_server">4.15.2  Problems starting the MySQL server</A>.

<LI>

Run some simple tests to verify that the server is working.
The output should be similar to what is shown below:


<PRE>
shell&#62; BINDIR/mysqlshow
+-----------+
| Databases |
+-----------+
| mysql     |
+-----------+

shell&#62; BINDIR/mysqlshow mysql
Database: mysql
+--------------+
|    Tables    |
+--------------+
| columns_priv |
| db           |
| func         |
| host         |
| tables_priv  |
| user         |
+--------------+

shell&#62; BINDIR/mysql -e "select host,db,user from db" mysql
+------+--------+------+
| host | db     | user |
+------+--------+------+
| %    | test   |      |
| %    | test_% |      |
+------+--------+------+
</PRE>

There is also a benchmark suite in the <TT>`sql-bench'</TT> directory (under the
<STRONG>MySQL</STRONG> installation directory) that you can use to compare how
<STRONG>MySQL</STRONG> performs on different platforms. The <TT>`sql-bench/Results'</TT>
directory contains the results from many runs against different databases and
platforms.  To run all tests, execute these commands:


<PRE>
shell&#62; cd sql-bench
shell&#62; run-all-tests
</PRE>

If you don't have the <TT>`sql-bench'</TT> directory, you are probably using an
RPM for a binary distribution.  (Source distribution RPMs include the
benchmark directory.) In this case, you must first install the benchmark
suite before you can use it.  Beginning with <STRONG>MySQL</STRONG> 3.22, there are
benchmark RPM files named <TT>`mysql-bench-VERSION-i386.rpm'</TT> that contain
benchmark code and data.

If you have a source distribution, you can also run the tests in the
<TT>`tests'</TT> subdirectory. For example, to run <TT>`auto_increment.tst'</TT>, do
this:


<PRE>
shell&#62; BINDIR/mysql -vvf test &#60; ./tests/auto_increment.tst
</PRE>

The expected results are shown in the <TT>`./tests/auto_increment.res'</TT> file.
</OL>



<H3><A NAME="mysql_install_db" HREF="manual_toc.html#mysql_install_db">4.15.1  Problems running <CODE>mysql_install_db</CODE></A></H3>

<P>
This section lists problems you might encounter when you run
<CODE>mysql_install_db</CODE>:

</P>
<DL COMPACT>

<DT><STRONG><CODE>mysql_install_db</CODE> doesn't install the grant tables</STRONG>
<DD>
You may find that <CODE>mysql_install_db</CODE> fails to install the grant
tables and terminates after displaying the following messages:


<PRE>
starting mysqld daemon with databases from XXXXXX
mysql daemon ended
</PRE>

In this case, you should examine the log file very carefully!  The log
should be located in the directory <TT>`XXXXXX'</TT> named by the error message,
and should indicate why <CODE>mysqld</CODE> didn't start.  If you don't understand
what happened, include the log when you post a bug report using
<CODE>mysqlbug</CODE>!
See section <A HREF="manual.html#Bug_reports">2.3  How to report bugs or problems</A>.

<DT><STRONG>There is already a <CODE>mysqld</CODE> daemon running</STRONG>
<DD>
In this case, you have probably don't have to run <CODE>mysql_install_db</CODE> at
all.  You have to run <CODE>mysql_install_db</CODE> only once, when you install
<STRONG>MySQL</STRONG> the first time.

<DT><STRONG>Installing a second <CODE>mysqld</CODE> daemon doesn't work when one daemon is running</STRONG>
<DD>
This can happen when you already have an existing <STRONG>MySQL</STRONG>
installation, but want to put a new installation in a different place (e.g.,
for testing, or perhaps you simply want to run two installations at the same
time).  Generally the problem that occurs when you try to run the second
server is that it tries to use the same socket and port as the old one.  In
this case you will get the error message: <CODE>Can't start server: Bind on
TCP/IP port: Address already in use</CODE> or <CODE>Can't start server : Bind on
unix socket...</CODE>  You can start the new server with a different socket and
port as follows:

<A NAME="IDX90"></A>
<A NAME="IDX91"></A>
<A NAME="IDX92"></A>
<A NAME="IDX93"></A>

<PRE>
shell&#62; MYSQL_UNIX_PORT=/tmp/mysqld-new.sock
shell&#62; MYSQL_TCP_PORT=3307
shell&#62; export MYSQL_UNIX_PORT MYSQL_TCP_PORT
shell&#62; scripts/mysql_install_db
shell&#62; bin/safe_mysqld &#38;
</PRE>

After this, you should edit your server boot script to start both daemons
with different sockets and ports.  For example, it could invoke
<CODE>safe_mysqld</CODE> twice, but with different <CODE>--socket</CODE>, <CODE>--port</CODE>
and <CODE>--basedir</CODE> options for each invocation.

<DT><STRONG>You don't have write access to <TT>`/tmp'</TT></STRONG>
<DD>
If you don't have write access to create a socket file at the default place
(in <TT>`/tmp'</TT>) or permission to create temporary files in <TT>`/tmp,'</TT>
you will get an error when running <CODE>mysql_install_db</CODE> or when
starting or using <CODE>mysqld</CODE>.

You can specify a different socket and temporary directory as follows:

<A NAME="IDX94"></A>
<A NAME="IDX95"></A>
<A NAME="IDX96"></A>
<A NAME="IDX97"></A>

<PRE>
shell&#62; TMPDIR=/some_tmp_dir/
shell&#62; MYSQL_UNIX_PORT=/some_tmp_dir/mysqld.sock
shell&#62; export TMPDIR MYSQL_UNIX_PORT
</PRE>

<TT>`some_tmp_dir'</TT> should be the path to some directory for which you
have write permission.

After this you should be able to run <CODE>mysql_install_db</CODE> and start
the server with these commands:


<PRE>
shell&#62; scripts/mysql_install_db
shell&#62; BINDIR/safe_mysqld &#38;
</PRE>

<DT><STRONG><CODE>mysqld</CODE> crashes immediately</STRONG>
<DD>
If you are running RedHat 5.0 with a version of <CODE>glibc</CODE> older than
2.0.7-5, you should make sure you have installed all <CODE>glibc</CODE> patches!
There is a lot of information about this in the <STRONG>MySQL</STRONG> mail
archives.  Links to the mail archives are available at the online
<a HREF="http://www.mysql.com/doc.html"> <STRONG>MySQL</STRONG> documentation page</a>.
Also, see section <A HREF="manual.html#Linux">4.11.5  Linux notes (all Linux versions)</A>.

You can also start <CODE>mysqld</CODE> manually using the <CODE>--skip-grant-tables</CODE>
option and add the privilege information yourself using <CODE>mysql</CODE>:


<PRE>
shell&#62; BINDIR/safe_mysqld --skip-grant-tables &#38;
shell&#62; BINDIR/mysql -u root mysql
</PRE>

From <CODE>mysql</CODE>, manually execute the SQL commands in
<CODE>mysql_install_db</CODE>.  Make sure you run <CODE>mysqladmin
flush-privileges</CODE> or <CODE>mysqladmin reload</CODE> afterward to tell the server to
reload the grant tables.
</DL>



<H3><A NAME="Starting_server" HREF="manual_toc.html#Starting_server">4.15.2  Problems starting the MySQL server</A></H3>

<P>
Generally, you start the <CODE>mysqld</CODE> server in one of three ways:

</P>

<UL>
<LI>

By invoking <CODE>mysql.server</CODE>.  This script is used primarily at
system startup and shutdown, and is described more fully in
section <A HREF="manual.html#Automatic_start">4.15.3  Starting and stopping MySQL automatically</A>.
<LI>

By invoking <CODE>safe_mysqld</CODE>, which tries to determine the proper options
for <CODE>mysqld</CODE> and then runs it with those options.
<LI>

On NT you should install <CODE>mysqld</CODE> as a service as follows:

<PRE>
bin\mysqld-nt --install               # Install MySQL as a service
</PRE>

You can now start/stop <CODE>mysqld</CODE> as follows:

<PRE>
NET START mysql
NET STOP mysql
</PRE>

Note that in this case you can't use any other options for mysqld!
 
You can remove the service as follows:

<PRE>
bin\mysqld-nt --remove                # remove MySQL as a service
</PRE>

<LI>

By invoking <CODE>mysqld</CODE> directly.
</UL>

<P>
Whichever method you use to start the server, if it fails to start up
correctly, check the log file to see if you can find out why.  Log files
are located in the data directory (typically
<TT>`/usr/local/mysql/data'</TT> for a binary distribution,
<TT>`/usr/local/var'</TT> for a source distribution),
<TT>`\mysql\mysql.err'</TT> on windows. .  Look in the data directory for
files with names of the form <TT>`host_name.err'</TT> and
<TT>`host_name.log'</TT> where <CODE>host_name</CODE> is the name of your server
host.  Then check the last few lines of these files:

</P>

<PRE>
shell&#62; tail host_name.err
shell&#62; tail host_name.log
</PRE>

<P>
When the <CODE>mysqld</CODE> daemon starts up, it changes directory to the
data directory.  This is where it expects to write log files and the pid
(process ID) file, and where it expects to find databases.

</P>
<P>
The data directory location is hardwired in when the distribution is
compiled.  However, if <CODE>mysqld</CODE> expects to find the data directory
somewhere other than where it really is on your system, it will not work
properly.  If you have problems with incorrect paths, you can find out
what options <CODE>mysqld</CODE> allows and what the default path settings are by
invoking <CODE>mysqld</CODE> with the <CODE>--help</CODE> option.  You can override the
defaults by specifying the correct pathnames as command-line arguments to
<CODE>mysqld</CODE>.  (These options can be used with <CODE>safe_mysqld</CODE> as well.)

</P>
<P>
Normally you should need to tell <CODE>mysqld</CODE> only the base directory under
which <STRONG>MySQL</STRONG> is installed.  You can do this with the <CODE>--basedir</CODE>
option.  You can also use <CODE>--help</CODE> to check the effect of changing path
options (note that <CODE>--help</CODE> <EM>must</EM> be the final option of the
<CODE>mysqld</CODE> command).  For example:

</P>

<PRE>
shell&#62; EXECDIR/mysqld --basedir=/usr/local --help
</PRE>

<P>
Once you determine the path settings you want, start the server without
the <CODE>--help</CODE> option.

</P>
<P>
If you get the following error, it means that some other program (or another
<CODE>mysqld</CODE> server) is already using the TCP/IP port or socket
<CODE>mysqld</CODE> is trying to use:

</P>

<PRE>
Can't start server: Bind on TCP/IP port: Address already in use
  or
Can't start server : Bind on unix socket...
</PRE>

<P>
Use <CODE>ps</CODE> to make sure that you don't have another <CODE>mysqld</CODE> server
running.  If you can't find another server running, you can try to execute
the command <CODE>telnet your-host-name tcp-ip-port-number</CODE> and press
<CODE>RETURN</CODE> a couple of times.  If you don't get a error message like
<CODE>telnet: Unable to connect to remote host: Connection refused</CODE>,
something is using the TCP/IP port <CODE>mysqld</CODE> is trying to use.
See section <A HREF="manual.html#mysql_install_db">4.15.1  Problems running <CODE>mysql_install_db</CODE></A>, and section <A HREF="manual.html#Multiple_servers">19.3  Running multiple MySQL servers on the same machine</A>.

</P>
<P>
The <CODE>safe_mysqld</CODE> script is written so that it normally is able to start
a server that was installed from either a source or a binary version of
<STRONG>MySQL</STRONG>, even if these install the server in slightly different
locations.  <CODE>safe_mysqld</CODE> expects one of these conditions to be true:

</P>

<UL>
<LI>

The server and databases can be found relative to the directory from which
<CODE>safe_mysqld</CODE> is invoked.  <CODE>safe_mysqld</CODE> looks under its working
directory for <TT>`bin'</TT> and <TT>`data'</TT> directories (for binary
distributions) or for <TT>`libexec'</TT> and <TT>`var'</TT> directories (for source
distributions).  This condition should be met if you execute
<CODE>safe_mysqld</CODE> from your <STRONG>MySQL</STRONG> installation directory (for
example, <TT>`/usr/local/mysql'</TT> for a binary distribution).

<LI>

If the server and databases cannot be found relative to its working directory,
<CODE>safe_mysqld</CODE> attempts to locate them by absolute pathnames.  Typical
locations are <TT>`/usr/local/libexec'</TT> and <TT>`/usr/local/var'</TT>.
The actual locations are determined when the distribution was built from which
<CODE>safe_mysqld</CODE> comes.  They should be correct if
<STRONG>MySQL</STRONG> was installed in a standard location.
</UL>

<P>
Since <CODE>safe_mysqld</CODE> will try to find the server and databases relative
to its own working directory, you can install a binary distribution of
<STRONG>MySQL</STRONG> anywhere, as long as you start <CODE>safe_mysqld</CODE> from the
<STRONG>MySQL</STRONG> installation directory:

</P>

<PRE>
shell&#62; cd mysql_installation_directory
shell&#62; bin/safe_mysqld &#38;
</PRE>

<P>
If <CODE>safe_mysqld</CODE> fails, even when invoked from the <STRONG>MySQL</STRONG>
installation directory, you can modify it to use the path to <CODE>mysqld</CODE>
and the pathname options that are correct for your system.  Note that if you
upgrade <STRONG>MySQL</STRONG> in the future, your modified version of
<CODE>safe_mysqld</CODE> will be overwritten, so you should make a copy of your
edited version that you can reinstall.

</P>
<P>
If <CODE>mysqld</CODE> is currently running, you can find out what path settings
it is using by executing this command:

</P>

<PRE>
shell&#62; mysqladmin variables

or

shell&#62; mysqladmin -h 'your-host-name' variables
</PRE>

<P>
If <CODE>safe_mysqld</CODE> starts the server but you can't connect to it,
you should make sure you have an entry in <TT>`/etc/hosts'</TT> that looks like
this:

</P>

<PRE>
127.0.0.1       localhost
</PRE>

<P>
This problem occurs only on systems that don't have a working thread
library and for which <STRONG>MySQL</STRONG> must be configured to use MIT-pthreads.

</P>
<P>
On Windows, you can try to start mysqld as follows:

</P>

<PRE>
C:\mysql\bin\mysqld --standalone --debug
</PRE>

<P>
This will not run in the background and it should also write a trace in
<TT>`\mysqld.trace'</TT>, which may help you locate the source to your
problems. See section <A HREF="manual.html#Win32">4.12  Win32 notes</A>.

</P>


<H3><A NAME="Automatic_start" HREF="manual_toc.html#Automatic_start">4.15.3  Starting and stopping MySQL automatically</A></H3>

<P>
The <CODE>mysql.server</CODE> script can be used to start or stop the server,
by invoking it with <CODE>start</CODE> or <CODE>stop</CODE> arguments:

</P>

<PRE>
shell&#62; mysql.server start
shell&#62; mysql.server stop
</PRE>

<P>
<CODE>mysql.server</CODE> can be found in the <TT>`share/mysql'</TT> directory
under the <STRONG>MySQL</STRONG> installation directory, or in the <TT>`support-files'</TT>
directory of the <STRONG>MySQL</STRONG> source tree.

</P>
<P>
Before <CODE>mysql.server</CODE> starts the server, it changes directory to
the <STRONG>MySQL</STRONG> installation directory, then invokes
<CODE>safe_mysqld</CODE>.  You might need to edit <CODE>mysql.server</CODE> if you
have a binary distribution that you've installed in a non-standard
location.  Modify it to <CODE>cd</CODE> into the proper directory before it
runs <CODE>safe_mysqld</CODE>. If you want the server to run as some specific
user, you can change the <CODE>mysql_daemon_user=root</CODE> line to use
another user.  You can also modify <CODE>mysql.server</CODE> to pass other
options to <CODE>safe_mysqld</CODE>.

</P>
<P>
<CODE>mysql.server stop</CODE> brings down server by sending a signal to it.
You can take down the server manually by executing <CODE>mysqladmin shutdown</CODE>.

</P>
<P>
You might want to add these start and stop commands to the appropriate places
in your <TT>`/etc/rc*'</TT> files when you start using <STRONG>MySQL</STRONG> for
production applications.  Note that if you modify <CODE>mysql.server</CODE>, then
if you upgrade <STRONG>MySQL</STRONG> sometime, your modified version will be
overwritten, so you should make a copy of your edited version that you can
reinstall.

</P>
<P>
If your system uses <TT>`/etc/rc.local'</TT> to start external scripts, you
should append the following to it:

<PRE>
/bin/sh -c 'cd /usr/local/mysql ; ./bin/safe_mysqld &#38;'
</PRE>

<P>
You can also add options for <CODE>mysql.server</CODE> in a global
<TT>`/etc/my.cnf'</TT> file.  A typical <TT>`/etc/my.cnf'</TT> file might look like
this:

</P>

<PRE>
[mysqld]
datadir=/usr/local/mysql/var
socket=/tmp/mysqld.sock
port=3306

[mysql.server]
user=mysql
basedir=/usr/local/mysql
</PRE>

<P>
The <CODE>mysql.server</CODE> script uses the following variables:
<CODE>user</CODE>, <CODE>datadir</CODE>, <CODE>basedir</CODE>, <CODE>bindir</CODE> and <CODE>pid-file</CODE>.

</P>
<P>
See section <A HREF="manual.html#Option_files">4.15.4  Option files</A>.

</P>
<P>
<A NAME="IDX98"></A>
<A NAME="IDX99"></A>


<H3><A NAME="Option_files" HREF="manual_toc.html#Option_files">4.15.4  Option files</A></H3>

<P>
<STRONG>MySQL</STRONG> 3.22 can read default startup options for the server and
for clients from option files.

</P>
<P>
<STRONG>MySQL</STRONG> reads default options from the following files on Unix:

</P>
<P>
<A NAME="IDX100"></A>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><STRONG>Filename</STRONG> </TD><TD> <STRONG>Purpose</STRONG>
</TR NOSAVE>
<TR><TD><CODE>/etc/my.cnf</CODE> </TD><TD> Global options
</TR NOSAVE>
<TR><TD><CODE>DATADIR/my.cnf</CODE> </TD><TD> Server-specific options
</TR NOSAVE>
<TR><TD><CODE>~/.my.cnf</CODE> </TD><TD> User-specific options
</TR>
</TABLE>

</P>
<P>
<CODE>DATADIR</CODE> is the <STRONG>MySQL</STRONG> data directory (typically
<TT>`/usr/local/mysql/data'</TT> for a binary installation, or
<TT>`/usr/local/var'</TT> for a source installation).  Note that this is the
directory that was specified at configuration time, not the one specified
with <CODE>--datadir</CODE> when <CODE>mysqld</CODE> starts up!  (<CODE>--datadir</CODE> has no
effect on where the server looks for option files, because it looks for them
before it processes any command-line arguments.)

</P>
<P>
<STRONG>MySQL</STRONG> reads default options from the following files on Win32:

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><STRONG>Filename</STRONG> </TD><TD> <STRONG>Purpose</STRONG>
</TR NOSAVE>
<TR><TD><CODE>windows-system-directory\my.ini</CODE>
</TR NOSAVE>
<TR><TD><CODE>C:\my.cnf</CODE> </TD><TD> Global options
</TR NOSAVE>
<TR><TD><CODE>C:\mysql\data\my.cnf</CODE> </TD><TD> Server-specific options
</TR>
</TABLE>

<P>
Note that you on Win32 should specify all paths with <CODE>/</CODE> instead of
<CODE>\</CODE>. If you use <CODE>\</CODE>, you need to specify this twice, as
<CODE>\</CODE> is the escape character in <STRONG>MySQL</STRONG>.

</P>
<P>
<A NAME="IDX101"></A>
<STRONG>MySQL</STRONG> tries to read option files in the order listed above.  If
multiple option files exist, an option specified in a file read later takes
precedence over the same option specified in a file read earlier.  Options
specified on the command line take precedence over options specified in any
option file.  Some options can be specified using environment variables.
Options specified on the command line or in option files take precedence over
environment variable values.

</P>
<P>
The following programs support option files:  <CODE>mysql</CODE>,
<CODE>mysqladmin</CODE>, <CODE>mysqld</CODE>, <CODE>mysqldump</CODE>, <CODE>mysqlimport</CODE>,
<CODE>mysql.server</CODE>, <CODE>myisamchk</CODE> and <CODE>myisampack</CODE>.

</P>
<P>
You can use option files to specify any long option that a program supports!
Run the program with <CODE>--help</CODE> to get a list of available options.

</P>
<P>
An option file can contain lines of the following forms:

</P>
<DL COMPACT>

<DT><CODE>#comment</CODE>
<DD>
Comment lines start with <SAMP>`#'</SAMP> or <SAMP>`;'</SAMP>. Empty lines are ignored.

<DT><CODE>[group]</CODE>
<DD>
<CODE>group</CODE> is the name of the program or group for which you want to set
options.  After a group line, any <CODE>option</CODE> or <CODE>set-variable</CODE> lines
apply to the named group until the end of the option file or another group
line is given.

<DT><CODE>option</CODE>
<DD>
This is equivalent to <CODE>--option</CODE> on the command line.

<DT><CODE>option=value</CODE>
<DD>
This is equivalent to <CODE>--option=value</CODE> on the command line.

<DT><CODE>set-variable = variable=value</CODE>
<DD>
This is equivalent to <CODE>--set-variable variable=value</CODE> on the command line.
This syntax must be used to set a <CODE>mysqld</CODE> variable.
</DL>

<P>
The <CODE>client</CODE> group allows you to specify options that apply to all
<STRONG>MySQL</STRONG> clients (not <CODE>mysqld</CODE>). This is the perfect group to use
to specify the password you use to connect to the server.  (But make
sure the option file is readable and writable only to yourself.)

</P>
<P>
Note that for options and values, all leading and trailing blanks are
automatically deleted.  You may use the escape sequences <SAMP>`\b'</SAMP>,
<SAMP>`\t'</SAMP>, <SAMP>`\n'</SAMP>, <SAMP>`\r'</SAMP>, <SAMP>`\\'</SAMP> and <SAMP>`\s'</SAMP> in your value string
(<SAMP>`\s'</SAMP> == blank).

</P>
<P>
Here is a typical global option file:

</P>

<PRE>
[client]
port=3306
socket=/tmp/mysql.sock

[mysqld]
port=3306
socket=/tmp/mysql.sock
set-variable = key_buffer=16M
set-variable = max_allowed_packet=1M

[mysqldump]
quick
</PRE>

<P>
Here is typical user option file:

</P>

<PRE>
[client]
# The following password will be sent to all standard MySQL clients
password=my_password

[mysql]
no-auto-rehash
</PRE>

<P>
<A NAME="IDX102"></A>
If you have a source distribution, you will find a sample configuration file
named <TT>`my-example.cnf'</TT> in the <TT>`support-files'</TT> directory.  If you
have a binary distribution, look in the <TT>`DIR/share/mysql'</TT> directory,
where <CODE>DIR</CODE> is the pathname to the <STRONG>MySQL</STRONG> installation directory
(typically <TT>`/usr/local/mysql'</TT>). You can copy <TT>`my-example.cnf'</TT> to
your home directory (rename the copy to <TT>`.my.cnf'</TT>) to experiment with.

</P>
<P>
To tell a <STRONG>MySQL</STRONG> program not to read any option files, specify
<CODE>--no-defaults</CODE> as the first option on the command line.  This
<STRONG>MUST</STRONG> be the first option or it will have no effect!
If you want to check which options are used, you can give the option
<CODE>--print-defaults</CODE> as the first option.

</P>
<P>
If you want to force the use of a specific config file, you can use the option
<CODE>--defaults-file=full-path-to-default-file</CODE>. If you do this, only the
specified file will be read.

</P>
<P>
Note for developers:  Option file handling is implemented simply by
processing all matching options (i.e., options in the appropriate group)
before any command line arguments. This works nicely for programs that use
the last instance of an option that is specified multiple times. If you have
an old program that handles multiply-specified options this way but doesn't
read option files, you need add only two lines to give it that capability.
Check the source code of any of the standard <STRONG>MySQL</STRONG> clients to see
how to do this.

</P>


<H2><A NAME="Upgrade" HREF="manual_toc.html#Upgrade">4.16  Is there anything special to do when upgrading/downgrading MySQL?</A></H2>

<P>
You can always move the <STRONG>MySQL</STRONG> form and data files between
different versions on the same architecture as long as you have the same
base version of <STRONG>MySQL</STRONG>. The current base version is
3. If you change the character set by recompiling <STRONG>MySQL</STRONG> (which may
also change the sort order), you must run <CODE>myisamchk -r -q</CODE> on all
tables.  Otherwise your indexes may not be ordered correctly.

</P>
<P>
If you are paranoid and/or afraid of new versions, you can always rename your
old <CODE>mysqld</CODE> to something like <CODE>mysqld</CODE>-'old-version-number'.  If
your new <CODE>mysqld</CODE> then does something unexpected, you can simply shut it
down and restart with your old <CODE>mysqld</CODE>!

</P>
<P>
When you do an upgrade you should also backup your old databases, of course.
Sometimes it's good to be a little paranoid!

</P>
<P>
After an upgrade, if you experience problems with recompiled client programs,
like <CODE>Commands out of sync</CODE> or unexpected core dumps, you probably have
used an old header or library file when compiling your programs.  In this
case you should check the date for your <TT>`mysql.h'</TT> file and
<TT>`libmysqlclient.a'</TT> library to verify that they are from the new
<STRONG>MySQL</STRONG> distribution.  If not, please recompile your programs!

</P>
<P>
If you get some problems that the new <CODE>mysqld</CODE> server doesn't want to
start or that you can't connect without a password, check that you don't
have some old <TT>`my.cnf'</TT> file from your old installation!  You can
check this with: <CODE>program-name --print-defaults</CODE>.  If this outputs
anything other than the program name, you have a active <CODE>my.cnf</CODE>
file that will may affect things!

</P>
<P>
It is a good idea to rebuild and reinstall the <CODE>Msql-Mysql-modules</CODE>
distribution whenever you install a new release of <STRONG>MySQL</STRONG>,
particularly if you notice symptoms such as all your <CODE>DBI</CODE> scripts
dumping core after you upgrade <STRONG>MySQL</STRONG>.

</P>

<P>
<A NAME="IDX103"></A>


<H3><A NAME="Upgrading-from-3.22" HREF="manual_toc.html#Upgrading-from-3.22">4.16.1  Upgrading from a 3.22 version to 3.23</A></H3>

<P>
<STRONG>MySQL</STRONG> 3.23 supports tables of the new <CODE>MyISAM</CODE> type and
the old <CODE>ISAM</CODE> type.  You don't have to convert your old tables to
use these with 3.23.  By default, all new tables will be created with
type <CODE>MyISAM</CODE> (unless you start <CODE>mysqld</CODE> with the
<CODE>--default-table-type=isam</CODE> option. You can change an <CODE>ISAM</CODE>
table to a <CODE>MyISAM</CODE> table with <CODE>ALTER TABLE</CODE> or the Perl script
<CODE>mysql_convert_table_format</CODE>.

</P>
<P>
3.22 and 3.21 clients will work without any problems with a 3.23 server.

</P>
<P>
The following lists what you have to watch out for when upgrading to 3.23:

</P>

<UL>
<LI><CODE>INNER</CODE> and <CODE>DELAYED</CODE> are now reserved words.

<LI><CODE>FLOAT(X)</CODE> is now a true floating point types.

<LI>When declaring <CODE>DECIMAL(length,dec)</CODE> the length argument no

longer includes a place for the sign or the decimal point.
<LI>A <CODE>TIME</CODE> string must now be of one of the following formats:

<CODE>[[[DAYS] [H]H:]MM:]SS[.fraction]</CODE> or
<CODE>[[[[[H]H]H]H]MM]SS[.fraction]</CODE>
<LI><CODE>LIKE</CODE> now compares strings using the same character

comparison rules as <CODE>'='</CODE>.  If you require the old behavior, you
can compile <STRONG>MySQL</STRONG> with the <CODE>CXXFLAGS=-DLIKE_CMP_TOUPPER</CODE>
flag.
<LI><CODE>REGEXP</CODE> is now case insensitive for normal (not binary) strings.

<LI>When you check/repair tables you should use <CODE>myisamchk</CODE> for

<CODE>MyISAM</CODE> tables (<CODE>.MYI</CODE>) and <CODE>isamchk</CODE> for ISAM
(<CODE>.ISM</CODE>) tables.
<LI>If you want your <CODE>mysqldump</CODE>s to be compatible between

<STRONG>MySQL</STRONG> 3.22 and 3.23, you should not use the <CODE>--opt</CODE> or
<CODE>--full</CODE> option to <CODE>mysqldump</CODE>.
<LI>Check all your calls to <CODE>DATE_FORMAT()</CODE> to make sure there is a <SAMP>`%'</SAMP>

before each format character.
<LI>

<CODE>mysql_fetch_fields_direct</CODE> is now a function (it was a macro) and
it returns a pointer to a <CODE>MYSQL_FIELD</CODE> instead of a
<CODE>MYSQL_FIELD</CODE>.
<LI>

<CODE>mysql_num_fields()</CODE> can no longer be used on a <CODE>MYSQL*</CODE> object (it's
now a function that takes <CODE>MYSQL_RES*</CODE> as an argument. You should now
use <CODE>mysql_field_count()</CODE> instead.
<LI>

In <CODE>MySQL</CODE> 3.22, the output of <CODE>SELECT DISTINCT ...</CODE> was
almost always sorted.  In 3.23, you must use <CODE>GROUP BY</CODE> or
<CODE>ORDER BY</CODE> to obtain sorted output.
<LI>

<CODE>SUM()</CODE> now returns <CODE>NULL</CODE>, instead of 0, if there is no matching
rows. This is according to ANSI SQL.
<LI>

New restricted words: <CODE>CASE, THEN, WHEN, ELSE and END</CODE>
</UL>

<P>
<A NAME="IDX104"></A>


<H3><A NAME="Upgrading-from-3.21" HREF="manual_toc.html#Upgrading-from-3.21">4.16.2  Upgrading from a 3.21 version to 3.22</A></H3>

<P>
Nothing that affects compatibility has changed between 3.21 and 3.22.  The
only pitfall is that new tables that are created with <CODE>DATE</CODE> type
columns will use the new way to store the date. You can't access these new
fields from an old version of <CODE>mysqld</CODE>.

</P>
<P>
After installing <STRONG>MySQL</STRONG> 3.22, you should start the new server and
then run the <CODE>mysql_fix_privilege_tables</CODE> script. This will add the new
privileges that you need to use the <CODE>GRANT</CODE> command.  If you forget
this, you will get <CODE>Access denied</CODE> when you try to use <CODE>ALTER
TABLE</CODE>, <CODE>CREATE INDEX</CODE> or <CODE>DROP INDEX</CODE>. If your <STRONG>MySQL</STRONG> root
user requires a password, you should give this as an argument to
<CODE>mysql_fix_privilege_tables</CODE>.

</P>
<P>
The C API interface to <CODE>mysql_real_connect()</CODE> has changed.  If you have
an old client program that calls this function, you must place a <CODE>0</CODE> for
the new <CODE>db</CODE> argument (or recode the client to send the <CODE>db</CODE>
element for faster connections).  You must also call <CODE>mysql_init()</CODE>
before calling <CODE>mysql_real_connect()</CODE>!  This change was done to allow
the new <CODE>mysql_options()</CODE> function to save options in the <CODE>MYSQL</CODE>
handler structure.

</P>


<H3><A NAME="Upgrading-from-3.20" HREF="manual_toc.html#Upgrading-from-3.20">4.16.3  Upgrading from a 3.20 version to 3.21</A></H3>

<P>
If you are running a version older than 3.20.28 and want to
switch to 3.21.x, you need to do the following:

</P>
<P>
You can start the <CODE>mysqld</CODE> 3.21 server with <CODE>safe_mysqld
--old-protocol</CODE> to use it with clients from the 3.20 distribution.
In this case, the new client function <CODE>mysql_errno()</CODE> will not
return any server error, only <CODE>CR_UNKNOWN_ERROR</CODE>, (but it
works for client errors) and the server uses the old password() checking
rather than the new one.

</P>
<P>
If you are <STRONG>NOT</STRONG> using the <CODE>--old-protocol</CODE> option to
<CODE>mysqld</CODE>, you will need to make the following changes:

</P>

<UL>
<LI>

All client code must be recompiled. If you are using ODBC, you must get
the new <STRONG>MyODBC</STRONG> 2.x driver.
<LI>

The script <CODE>scripts/add_long_password</CODE> must be run to convert the
<CODE>Password</CODE> field in the <CODE>mysql.user</CODE> table to <CODE>CHAR(16)</CODE>.
<LI>

All passwords must be reassigned in the <CODE>mysql.user</CODE> table (to get 62-bit
rather than 31-bit passwords).
<LI>

The table format hasn't changed, so you don't have to convert any tables.
</UL>

<P>
<STRONG>MySQL</STRONG> 3.20.28 and above can handle the new <CODE>user</CODE> table format
without affecting clients. If you have a <STRONG>MySQL</STRONG> version earlier than
3.20.28, passwords will no longer work with it if you convert the <CODE>user</CODE>
table. So to be safe, you should first upgrade to at least 3.20.28 and then
upgrade to 3.21.x.

</P>
<P>
<A NAME="IDX105"></A>
The new client code works with a 3.20.x <CODE>mysqld</CODE> server, so
if you experience problems with 3.21.x, you can use the old 3.20.x server
without having to recompile the clients again.

</P>
<P>
If you are not using the <CODE>--old-protocol</CODE> option to <CODE>mysqld</CODE>,
old clients will issue the error message:

</P>

<PRE>
ERROR: Protocol mismatch. Server Version = 10 Client Version = 9
</PRE>

<P>
The new Perl <CODE>DBI</CODE>/<CODE>DBD</CODE> interface also supports the old
<CODE>mysqlperl</CODE> interface.  The only change you have to make if you use
<CODE>mysqlperl</CODE> is to change the arguments to the <CODE>connect()</CODE> function.
The new arguments are: <CODE>host</CODE>, <CODE>database</CODE>, <CODE>user</CODE>,
<CODE>password</CODE> (the <CODE>user</CODE> and <CODE>password</CODE> arguments have changed
places).
See section <A HREF="manual.html#Perl_DBI_Class">20.5.2  The <CODE>DBI</CODE> interface</A>.

</P>
<P>
The following changes may affect queries in old applications:

</P>

<UL>
<LI>

<CODE>HAVING</CODE> must now be specified before any <CODE>ORDER BY</CODE> clause.
<LI>

The parameters to <CODE>LOCATE()</CODE> have been swapped.
<LI>

There are some new reserved words. The most notable are <CODE>DATE</CODE>,
<CODE>TIME</CODE> and <CODE>TIMESTAMP</CODE>.
</UL>



<H3><A NAME="Upgrading-to-arch" HREF="manual_toc.html#Upgrading-to-arch">4.16.4  Upgrading to another architecture</A></H3>

<P>
If you are using <STRONG>MySQL</STRONG> 3.23, you can copy the <CODE>.frm</CODE>, the
<CODE>.MYI</CODE> and the <CODE>.MYD</CODE> files between different architectures
that support the same floating point format.  (<STRONG>MySQL</STRONG> takes care
of any byte swapping issues).

</P>
<P>
The <STRONG>MySQL</STRONG> <CODE>ISAM</CODE> data <TT>`*.ISD'</TT> and the index files
<TT>`*.ISM'</TT> files) are architecture-dependent and in some case
OS-dependent.  If you want to move your applications to another machine
that has a different architecture or OS than your current machine, you
should not try to move a database by simply copying the files to the
other machine. Use <CODE>mysqldump</CODE> instead.

</P>
<P>
By default, <CODE>mysqldump</CODE> will create a file full of SQL statements.
You can then transfer the file to the other machine and feed it as input
to the <CODE>mysql</CODE> client.

</P>
<P>
Try <CODE>mysqldump --help</CODE> to see what options are available.
If you are moving the data to a newer version of <STRONG>MySQL</STRONG>, you should use
<CODE>mysqldump --opt</CODE> with the newer version to get a fast, compact dump.

</P>
<P>
The easiest (although not the fastest) way to move a database between two
machines is to run the following commands on the machine on which the
database is located:

</P>

<PRE>
shell&#62; mysqladmin -h 'other hostname' create db_name
shell&#62; mysqldump --opt db_name \
        | mysql -h 'other hostname' db_name
</PRE>

<P>
If you want to copy a database from a remote machine over a slow network,
you can use:

</P>

<PRE>
shell&#62; mysqladmin create db_name
shell&#62; mysqldump -h 'other hostname' --opt --compress db_name \
        | mysql db_name
</PRE>

<P>
You can also store the result in a file, then transfer the file to the
target machine and load the file into the database there.  For example,
you can dump a database to a file on the source machine like this:

</P>

<PRE>
shell&#62; mysqldump --quick db_name | gzip &#62; db_name.contents.gz
</PRE>

<P>
(The file created in this example is compressed.) Transfer the file
containing the database contents to the target machine and run these commands
there:

</P>

<PRE>
shell&#62; mysqladmin create db_name
shell&#62; gunzip &#60; db_name.contents.gz | mysql db_name
</PRE>

<P>
<A NAME="IDX106"></A>
<A NAME="IDX107"></A>
You can also use <CODE>mysqldump</CODE> and <CODE>mysqlimport</CODE> to accomplish
the database transfer.
For big tables, this is much faster than simply using <CODE>mysqldump</CODE>.
In the commands shown below, <CODE>DUMPDIR</CODE> represents the full pathname
of the directory you use to store the output from <CODE>mysqldump</CODE>.

</P>
<P>
First, create the directory for the output files and dump the database:

</P>

<PRE>
shell&#62; mkdir DUMPDIR
shell&#62; mysqldump --tab=DUMPDIR db_name
</PRE>

<P>
Then transfer the files in the <CODE>DUMPDIR</CODE> directory to some corresponding
directory on the target machine and load the files into <STRONG>MySQL</STRONG>
there:

</P>

<PRE>
shell&#62; mysqladmin create db_name           # create database
shell&#62; cat DUMPDIR/*.sql | mysql db_name   # create tables in database
shell&#62; mysqlimport db_name DUMPDIR/*.txt   # load data into tables
</PRE>

<P>
Also, don't forget to copy the <CODE>mysql</CODE> database, since that's where the
grant tables (<CODE>user</CODE>, <CODE>db</CODE>, <CODE>host</CODE>) are stored.  You may have
to run commands as the <STRONG>MySQL</STRONG> <CODE>root</CODE> user on the new machine
until you have the <CODE>mysql</CODE> database in place.

</P>
<P>
After you import the <CODE>mysql</CODE> database on the new machine, execute
<CODE>mysqladmin flush-privileges</CODE> so that the server reloads the grant table
information.

</P>
<P>
<A NAME="IDX108"></A>


<H1><A NAME="Compatibility" HREF="manual_toc.html#Compatibility">5  How standards-compatible is MySQL?</A></H1>



<H2><A NAME="Extensions_to_ANSI" HREF="manual_toc.html#Extensions_to_ANSI">5.1  MySQL extensions to ANSI SQL92</A></H2>

<P>
<STRONG>MySQL</STRONG> includes some extensions that you probably will not find in
other SQL databases.  Be warned that if you use them, your code will not be
portable to other SQL servers.  In some cases, you can write code that
includes <STRONG>MySQL</STRONG> extensions, but is still portable, by using comments
of the form <CODE>/*! ... */</CODE>.  In this case, <STRONG>MySQL</STRONG> will parse and
execute the code within the comment as it would any other <STRONG>MySQL</STRONG>
statement, but other SQL servers will ignore the extensions.  For example:

</P>

<PRE>
SELECT /*! STRAIGHT_JOIN */ col_name FROM table1,table2 WHERE ...
</PRE>

<P>
If you add a version number after the <CODE>'!'</CODE>, the syntax will only be
executed if the <STRONG>MySQL</STRONG> version is equal or newer than the used
version number:

</P>

<PRE>
CREATE /*!32302 TEMPORARY */ TABLE (a int);
</PRE>

<P>
The above means that if you have 3.23.02 or newer, then <STRONG>MySQL</STRONG> will use
the <CODE>TEMPORARY</CODE> keyword.

</P>
<P>
<STRONG>MySQL</STRONG> extensions are listed below:

</P>

<UL>
<LI>

The field types <CODE>MEDIUMINT</CODE>, <CODE>SET</CODE>, <CODE>ENUM</CODE> and the
different <CODE>BLOB</CODE> and <CODE>TEXT</CODE> types.

<LI>

The field attributes <CODE>AUTO_INCREMENT</CODE>, <CODE>BINARY</CODE>,
<CODE>UNSIGNED</CODE> and <CODE>ZEROFILL</CODE>.

<LI>

All string comparisons are case insensitive by default, with sort
ordering determined by the current character set (ISO-8859-1 Latin1 by
default).  If you don't like this, you should declare your columns with
the <CODE>BINARY</CODE> attribute or use the <CODE>BINARY</CODE> cast, which causes
comparisons to be done according to the ASCII order used on the
<STRONG>MySQL</STRONG> server host.

<LI>

<STRONG>MySQL</STRONG> maps each database to a directory under the <STRONG>MySQL</STRONG>
data directory, and tables within a database to filenames in the database
directory.
This has two implications:


<UL>
<LI>

<A NAME="IDX109"></A>
<A NAME="IDX110"></A>
<A NAME="IDX111"></A>
<A NAME="IDX112"></A>
Database names and table names are case sensitive in <STRONG>MySQL</STRONG> on
operating systems that have case sensitive filenames (like most Unix
systems). If you have a problem remembering table names, adopt a consistent
convention, such as always creating databases and tables using lowercase
names.

<LI>

Database, table, index, column or alias names may begin with a digit
(but may not consist solely of digits).

<LI>

You can use standard system commands to backup, rename, move, delete and copy
tables.  For example, to rename a table, rename the <TT>`.MYD'</TT>, <TT>`.MYI'</TT>
and <TT>`.frm'</TT> files to which the table corresponds.
</UL>

<LI>

In SQL statements, you can access tables from different databases
with the <CODE>db_name.tbl_name</CODE> syntax.  Some SQL servers provide
the same functionality but call this <CODE>User space</CODE>.
<STRONG>MySQL</STRONG> dosen't support tablespaces like in:
<CODE>create table ralph.my_table...IN my_tablespace</CODE>.

<LI>

<CODE>LIKE</CODE> is allowed on numeric columns.

<LI>

Use of <CODE>INTO OUTFILE</CODE> and <CODE>STRAIGHT_JOIN</CODE> in a <CODE>SELECT</CODE>
statement. See section <A HREF="manual.html#SELECT">7.12  <CODE>SELECT</CODE> syntax</A>.

<LI>

The <CODE>SQL_SMALL_RESULT</CODE> option in a <CODE>SELECT</CODE> statement.

<LI>

<CODE>EXPLAIN SELECT</CODE> to get a description on how tables are joined.

<LI>

Use of index names, indexes on a prefix of a field, and use of
<CODE>INDEX</CODE> or <CODE>KEY</CODE> in a <CODE>CREATE TABLE</CODE>
statement. See section <A HREF="manual.html#CREATE_TABLE">7.7  <CODE>CREATE TABLE</CODE> syntax</A>.

<LI>

Use of <CODE>TEMPORARY</CODE> or <CODE>IF NOT EXISTS</CODE> with <CODE>CREATE TABLE</CODE>.

<LI>

Use of <CODE>COUNT(DISTINCT list)</CODE> where 'list' is more than one element.

<LI>

Use of <CODE>CHANGE col_name</CODE>, <CODE>DROP col_name</CODE> or <CODE>DROP INDEX</CODE>
in an <CODE>ALTER TABLE</CODE> statement. See section <A HREF="manual.html#ALTER_TABLE">7.8  <CODE>ALTER TABLE</CODE> syntax</A>.

<LI>

Use of <CODE>IGNORE</CODE> in an <CODE>ALTER TABLE</CODE> statement.

<LI>

Use of multiple <CODE>ADD</CODE>, <CODE>ALTER</CODE>, <CODE>DROP</CODE> or <CODE>CHANGE</CODE>
clauses in an <CODE>ALTER TABLE</CODE> statement.

<LI>

Use of <CODE>DROP TABLE</CODE> with the keywords <CODE>IF EXISTS</CODE>.

<LI>

You can drop multiple tables with a single <CODE>DROP TABLE</CODE> statement.

<LI>

The <CODE>LIMIT</CODE> clause of the <CODE>DELETE</CODE> statement.

<LI>

The <CODE>DELAYED</CODE> clause of the <CODE>INSERT</CODE> and <CODE>REPLACE</CODE>
statements.

<LI>

The <CODE>LOW_PRIORITY</CODE> clause of the <CODE>INSERT</CODE>, <CODE>REPLACE</CODE>,
<CODE>DELETE</CODE> and <CODE>UPDATE</CODE> statements.

<A NAME="IDX113"></A>
<A NAME="IDX114"></A>
<LI>

Use of <CODE>LOAD DATA INFILE</CODE>. In many cases, this syntax is compatible with
Oracle's <CODE>LOAD DATA INFILE</CODE>. See section <A HREF="manual.html#LOAD_DATA">7.16  <CODE>LOAD DATA INFILE</CODE> syntax</A>.

<LI>

The <CODE>OPTIMIZE TABLE</CODE> statement.
See section <A HREF="manual.html#OPTIMIZE_TABLE">7.9  <CODE>OPTIMIZE TABLE</CODE> syntax</A>.

<LI>

The <CODE>SHOW</CODE> statement.
See section <A HREF="manual.html#SHOW">7.21  <CODE>SHOW</CODE> syntax (Get information about tables, columns,...)</A>.

<LI>

Strings may be enclosed by either <SAMP>`"'</SAMP> or <SAMP>`''</SAMP>, not just by <SAMP>`''</SAMP>.

<LI>

Use of the escape <SAMP>`\'</SAMP> character.

<LI>

The <CODE>SET OPTION</CODE> statement. See section <A HREF="manual.html#SET_OPTION">7.25  <CODE>SET OPTION</CODE> syntax</A>.

<LI>

You don't need to name all selected columns in the <CODE>GROUP BY</CODE> part.
This gives better performance for some very specific, but quite normal
queries.
See section <A HREF="manual.html#Group_by_functions">7.4.13  Functions for use with <CODE>GROUP BY</CODE> clauses</A>.

<LI>

To make it easier for users that come from other SQL environments,
<STRONG>MySQL</STRONG> supports aliases for many functions. For example, all
string functions support both ANSI SQL syntax and ODBC syntax.

<LI>

<STRONG>MySQL</STRONG> understands the <CODE>||</CODE> and <CODE>&#38;&</CODE> operators to mean
logical OR and AND, as in the C programming language.  In <STRONG>MySQL</STRONG>,
<CODE>||</CODE> and <CODE>OR</CODE> are synonyms, as are <CODE>&#38;&</CODE> and <CODE>AND</CODE>.
Because of this nice syntax, <STRONG>MySQL</STRONG> doesn't support
the ANSI SQL <CODE>||</CODE> operator for string concatenation; use
<CODE>CONCAT()</CODE> instead. Since <CODE>CONCAT()</CODE> takes any number
of arguments, it's easy to convert use of the <CODE>||</CODE> operator to
<STRONG>MySQL</STRONG>.

<LI>

<CODE>CREATE DATABASE</CODE> or <CODE>DROP DATABASE</CODE>.
See section <A HREF="manual.html#CREATE_DATABASE">7.5  <CODE>CREATE DATABASE</CODE> syntax</A>.

<A NAME="IDX115"></A>
<A NAME="IDX116"></A>
<LI>

The <CODE>%</CODE> operator is a synonym for <CODE>MOD()</CODE>.  That is,
<CODE>N % M</CODE> is equivalent to <CODE>MOD(N,M)</CODE>.  <CODE>%</CODE> is supported
for C programmers and for compatibility with PostgreSQL.

<LI>

The <CODE>=</CODE>, <CODE>&#60;&#62;</CODE>, <CODE>&#60;=</CODE> ,<CODE>&#60;</CODE>, <CODE>&#62;=</CODE>,<CODE>&#62;</CODE>,
<CODE>&#60;&#60;</CODE>, <CODE>&#62;&#62;</CODE>, <CODE>&#60;=&#62;</CODE>, <CODE>AND</CODE>, <CODE>OR</CODE> or <CODE>LIKE</CODE>
operators may be used in column comparisons to the left of the
<CODE>FROM</CODE> in <CODE>SELECT</CODE> statements.  For example:


<PRE>
mysql&#62; SELECT col1=1 AND col2=2 FROM tbl_name;
</PRE>

<LI>

The <CODE>LAST_INSERT_ID()</CODE> function.
See section <A HREF="manual.html#mysql_insert_id">20.4.29  <CODE>mysql_insert_id()</CODE></A>.

<LI>

The <CODE>REGEXP</CODE> and <CODE>NOT REGEXP</CODE> extended regular expression
operators.

<LI>

<CODE>CONCAT()</CODE> or <CODE>CHAR()</CODE> with one argument or more than two
arguments.  (In <STRONG>MySQL</STRONG>, these functions can take any number of
arguments.)

<LI>The <CODE>BIT_COUNT()</CODE>, <CODE>CASE</CODE>, <CODE>ELT()</CODE>,

<CODE>FROM_DAYS()</CODE>, <CODE>FORMAT()</CODE>, <CODE>IF()</CODE>, <CODE>PASSWORD()</CODE>,
<CODE>ENCRYPT()</CODE>, <CODE>md5()</CODE>, <CODE>ENCODE()</CODE>, <CODE>DECODE()</CODE>,
<CODE>PERIOD_ADD()</CODE>, <CODE>PERIOD_DIFF()</CODE>, <CODE>TO_DAYS()</CODE>, or
<CODE>WEEKDAY()</CODE> functions.

<LI>

Use of <CODE>TRIM()</CODE> to trim substrings. ANSI SQL only supports removal
of single characters.

<LI>

The <CODE>GROUP BY</CODE> functions <CODE>STD()</CODE>, <CODE>BIT_OR()</CODE> and
<CODE>BIT_AND()</CODE>.

<LI>

Use of <CODE>REPLACE</CODE> instead of <CODE>DELETE</CODE> + <CODE>INSERT</CODE>.
See section <A HREF="manual.html#REPLACE">7.15  <CODE>REPLACE</CODE> syntax</A>.

<LI>

The <CODE>FLUSH flush_option</CODE> statement.

<LI>

The possiblity to set variables in a statement with <CODE>:=</CODE>:

<PRE>
SELECT @a:=SUM(total),@b=COUNT(*),@a/@b AS avg FROM test_table;
SELECT @t1:=(@t2:=1)+@t3:=4,@t1,@t2,@t3;
</PRE>

</UL>



<H2><A NAME="Ansi_mode" HREF="manual_toc.html#Ansi_mode">5.2  Runnning MySQL in ANSI mode</A></H2>

<P>
If you start mysqld with the <CODE>--ansi</CODE> option, the following behaviour
of <STRONG>MySQL</STRONG> changes.

</P>

<UL>
<LI>

<CODE>||</CODE> is string concatenation instead of <CODE>OR</CODE>.
<LI>

One can have any number of spaces between a function name and the '('. This
makes also all function names reserved words.
<LI>

<CODE>"</CODE> will be a identifier quote character (like the <STRONG>MySQL</STRONG> <CODE>`</CODE>
quote character) and not a string quote character.
<LI>

<CODE>REAL</CODE> will be a synonym for <CODE>FLOAT</CODE> instead of a synonym of
<CODE>DOUBLE</CODE>.
</UL>



<H2><A NAME="Differences_from_ANSI" HREF="manual_toc.html#Differences_from_ANSI">5.3  MySQL differences compared to ANSI SQL92</A></H2>

<P>
We try to make <STRONG>MySQL</STRONG> follow the ANSI SQL standard and the
ODBC SQL standard, but in some cases <STRONG>MySQL</STRONG> does some things
differently:

</P>

<UL>
<LI>

<CODE>--</CODE> is only a comment if followed by a white space. See section <A HREF="manual.html#Missing_comments">5.4.7  <SAMP>`--'</SAMP> as the start of a comment</A>.
<LI>

For <CODE>VARCHAR</CODE> columns, trailing spaces are removed when the value is
stored. See section <A HREF="manual.html#Bugs">E  Known errors and design deficiencies in MySQL</A>.
<LI>

In some cases, <CODE>CHAR</CODE> columns are silently changed to <CODE>VARCHAR</CODE>
columns. See section <A HREF="manual.html#Silent_column_changes">7.7.1  Silent column specification changes</A>.
<LI>

Privileges for a table is not automatically revoked when you delete a
table. You must explicitly issue a <CODE>REVOKE</CODE> to revoke privileges for
a table. See section <A HREF="manual.html#GRANT">7.26  <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> syntax</A>.
</UL>



<H2><A NAME="Missing_functions" HREF="manual_toc.html#Missing_functions">5.4  Functionality missing from MySQL</A></H2>

<P>
The following functionality is missing in the current version of
<STRONG>MySQL</STRONG>.  For a prioritized list indicating when new extensions may be
added to <STRONG>MySQL</STRONG>, you should consult
<a HREF="http://www.mysql.com/Manual_chapter/manual_Todo.html"> the online
<STRONG>MySQL</STRONG> TODO list</a>. That is the latest version of the TODO list in
this manual. See section <A HREF="manual.html#TODO">F  List of things we want to add to MySQL in the future (The TODO)</A>.

</P>



<H3><A NAME="Missing_Sub-selects" HREF="manual_toc.html#Missing_Sub-selects">5.4.1  Sub-selects</A></H3>

<P>
The following will not yet work in <STRONG>MySQL</STRONG>:

</P>

<PRE>
SELECT * FROM table1 WHERE id IN (SELECT id FROM table2);
SELECT * FROM table1 WHERE id NOT IN (SELECT id FROM table2);
</PRE>

<P>
However, in many cases you can rewrite the query without a sub select:

</P>

<PRE>
SELECT table1.* FROM table1,table2 WHERE table1.id=table2.id;
SELECT table1.* FROM table1 LEFT JOIN table2 ON table1.id=table2.id where table2.id IS NULL
</PRE>

<P>
For more complicated subqueries you can often create temporary tables
to hold the subquery.  In some cases, however this option will not
work. The most frequently encountered of these cases arises with
<CODE>DELETE</CODE> statements, for which standard SQL does not support joins
(except in sub-selects).  For this situation there are two options
available until subqueries are supported by <STRONG>MySQL</STRONG>.

</P>
<P>
The first option is to use a procedural programming language (such as
Perl or PHP) to submit a <CODE>SELECT</CODE> query to obtain the primary keys
for the records to be deleted, and then use these values to construct
the <CODE>DELETE</CODE> statement (<CODE>DELETE FROM ... WHERE ... IN (key1, 
key2, ...)</CODE>).

</P>
<P>
The second option is to use interactive SQL to contruct a set of
<CODE>DELETE</CODE> statements automatically, using the <STRONG>MySQL</STRONG>
extension <CODE>CONCAT()</CODE> (in lieu of the standard <CODE>||</CODE> operator).
For example:

</P>

<PRE>
SELECT CONCAT('DELETE FROM tab1 WHERE pkid = ', tab1.pkid, ';')
  FROM tab1, tab2
 WHERE tab1.col1 = tab2.col2;
</PRE>

<P>
You can place this query in a script file and redirect input from it to
the <CODE>mysql</CODE> command-line interpreter, piping its output back to a
second instance of the interpreter:

</P>

<PRE>
prompt&#62; mysql --skip-column-names mydb &#60; myscript.sql | mysql mydb
</PRE>

<P>
<STRONG>MySQL</STRONG> only supports <CODE>INSERT ... SELECT ...</CODE> and
<CODE>REPLACE ... SELECT ...</CODE> Independent sub-selects will be probably
be available in 3.24.0.  You can now use the function <CODE>IN()</CODE> in
other contexts, however.

</P>


<H3><A NAME="Missing_SELECT_INTO_TABLE" HREF="manual_toc.html#Missing_SELECT_INTO_TABLE">5.4.2  <CODE>SELECT INTO TABLE</CODE></A></H3>

<P>
<STRONG>MySQL</STRONG> doesn't yet support the Oracle SQL extension:
<CODE>SELECT ... INTO TABLE ...</CODE>.  <STRONG>MySQL</STRONG> supports instead the
ANSI SQL syntax <CODE>INSERT INTO ... SELECT ...</CODE>, which is basically
the same thing.

</P>
<P>
Alternatively, you can use <CODE>SELECT INTO OUTFILE...</CODE> or <CODE>CREATE
TABLE ... SELECT</CODE> to solve your problem.

</P>


<H3><A NAME="Missing_Transactions" HREF="manual_toc.html#Missing_Transactions">5.4.3  Transactions</A></H3>

<P>
Transactions are not supported. <STRONG>MySQL</STRONG> shortly will support atomic
operations, which are like transactions without rollback. With atomic
operations, you can execute a group of <CODE>INSERT</CODE>/<CODE>SELECT</CODE>/whatever
commands and be guaranteed that no other thread will interfere. In this
context, you won't usually need rollback. Currently, you can prevent
interference from other threads by using the <CODE>LOCK TABLES</CODE> and
<CODE>UNLOCK TABLES</CODE> commands.
See section <A HREF="manual.html#LOCK_TABLES">7.24  <CODE>LOCK TABLES/UNLOCK TABLES</CODE> syntax</A>.

</P>


<H3><A NAME="Missing_Triggers" HREF="manual_toc.html#Missing_Triggers">5.4.4  Stored procedures and triggers</A></H3>

<P>
A stored procedure is a set of SQL commands that can be compiled and stored
in the server. Once this has been done, clients don't need to keep reissuing
the entire query but can refer to the stored procedure. This provides better
performance because the query has to be parsed only once and less information
needs to be sent between the server and the client. You can also raise the
conceptual level by having libraries of functions in the server.

</P>
<P>
A trigger is a stored procedure that is invoked when a particular event
occurs.  For example, you can install a stored procedure that is triggered
each time a record is deleted from a transaction table and that automatically
deletes the corresponding customer from a customer table when all his
transactions are deleted.

</P>
<P>
The planned update language will be able to
handle stored procedures, but without triggers. Triggers usually slow
down everything, even queries for which they are not needed.

</P>
<P>
To see when <STRONG>MySQL</STRONG> might get stored procedures, see section <A HREF="manual.html#TODO">F  List of things we want to add to MySQL in the future (The TODO)</A>.

</P>


<H3><A NAME="Missing_Foreign_Keys" HREF="manual_toc.html#Missing_Foreign_Keys">5.4.5  Foreign Keys</A></H3>

<P>
Note that foreign keys in SQL are not used to join tables, but are used
mostly for checking referential integrity.  If you want to get results from
multiple tables from a <CODE>SELECT</CODE> statement, you do this by joining
tables!

</P>

<PRE>
SELECT * from table1,table2 where table1.id = table2.id;
</PRE>

<P>
See section <A HREF="manual.html#JOIN">7.13  <CODE>JOIN</CODE> syntax</A>. See section <A HREF="manual.html#example-Foreign_keys">8.3.5  Using foreign keys</A>.

</P>
<P>
The <CODE>FOREIGN KEY</CODE> syntax in <STRONG>MySQL</STRONG> exists only for compatibility
with other SQL vendors' <CODE>CREATE TABLE</CODE> commands; it doesn't do
anything.  The <CODE>FOREIGN KEY</CODE> syntax without <CODE>ON DELETE ...</CODE> is
mostly used for documentation purposes. Some ODBC applications may use this
to produce automatic <CODE>WHERE</CODE> clauses, but this is usually easy to
override. <CODE>FOREIGN KEY</CODE> is sometimes used as a constraint check, but
this check is unnecessary in practice if rows are inserted into the tables in
the right order. <STRONG>MySQL</STRONG> only supports these clauses because some
applications require them to exist (regardless of whether or not they
work!).

</P>
<P>
In <STRONG>MySQL</STRONG>, you can work around the problem of <CODE>ON DELETE
...</CODE> not being implemented by adding the appropriate <CODE>DELETE</CODE> statement to
an application when you delete records from a table that has a foreign key.
In practice this is as quick (in some cases quicker) and much more portable
than using foreign keys.

</P>
<P>
In the near future we will extend the <CODE>FOREIGN KEY</CODE> implementation so
that at least the information will be saved in the table specification file
and may be retrieved by <CODE>mysqldump</CODE> and ODBC.

</P>



<H4><A NAME="Broken_Foreign_KEY" HREF="manual_toc.html#Broken_Foreign_KEY">5.4.5.1  Reasons NOT to use foreign keys</A></H4>

<P>
There are so many problems with <CODE>FOREIGN KEY</CODE>s that we don't
know where to start:

</P>

<UL>
<LI>

Foreign keys make life very complicated, because the foreign key definitions
must be stored in a database and implementing them would destroy the whole
``nice approach'' of using files that can be moved, copied and removed.

<LI>

The speed impact is terrible for <CODE>INSERT</CODE> and <CODE>UPDATE</CODE> statements,
and in this case almost all <CODE>FOREIGN KEY</CODE> checks are useless because you
usually insert records in the right tables in the right order, anyway.

<LI>

There is also a need to hold locks on many more tables when updating one
table, because the side effects can cascade through the entire database. It's
MUCH faster to delete records from one table first and subsequently delete
them from the other tables.

<LI>

You can no longer restore a table by doing a full delete from
the table and then restoring all records (from a new source or from a backup).

<LI>

If you have foreign keys you can't dump and restore tables unless you do so
in a very specific order.

<LI>

It's very easy to do ``allowed'' circular definitions that make the
tables impossible to recreate each table with a single create statement, even if
the definition works and is usable.
</UL>

<P>
The only nice aspect of <CODE>FOREIGN KEY</CODE> is that it gives ODBC and some
other client programs the ability to see how a table is connected and to use
this to show connection diagrams and to help in building applicatons.

</P>
<P>
<STRONG>MySQL</STRONG> will soon store <CODE>FOREIGN KEY</CODE> definitions so that
a client can ask for and receive an answer how the original connection was
made. The current <TT>`.frm'</TT> file format does not have any place for it.

</P>


<H3><A NAME="Missing_Views" HREF="manual_toc.html#Missing_Views">5.4.6  Views</A></H3>

<P>
<STRONG>MySQL</STRONG> doesn't support views, but this is on the TODO.

</P>


<H3><A NAME="Missing_comments" HREF="manual_toc.html#Missing_comments">5.4.7  <SAMP>`--'</SAMP> as the start of a comment</A></H3>

<P>
Some other SQL databases use <SAMP>`--'</SAMP> to start comments. <STRONG>MySQL</STRONG>
has <SAMP>`#'</SAMP> as the start comment character, even if the <CODE>mysql</CODE>
command line tool removes all lines that start with <SAMP>`--'</SAMP>.
You can also use the C comment style <CODE>/* this is a comment */</CODE> with
<STRONG>MySQL</STRONG>.
See section <A HREF="manual.html#Comments">7.29  Comment syntax</A>.

</P>
<P>
<STRONG>MySQL</STRONG> 3.23.3 and above supports the <SAMP>`--'</SAMP> comment style
only if the comment is followed by a space.  This is because this
degenerate comment style has caused many problems with automatically
generated SQL queries that have used something like the following code,
where we automatically insert the value of the payment for
<CODE>!payment!</CODE>:

</P>

<PRE>
UPDATE tbl_name SET credit=credit-!payment!
</PRE>

<P>
What do you think will happen when the value of <CODE>payment</CODE> is negative?

</P>
<P>
Because <CODE>1--1</CODE> is legal in SQL, we think it is terrible that
<SAMP>`--'</SAMP> means start comment.

</P>
<P>
In MySQL 3.23 you can however use: <CODE>1-- This is a comment</CODE>

</P>
<P>
The following discussing only concerns you if you are running an
<STRONG>MySQL</STRONG> version earlier than 3.23:

</P>
<P>
If you have a SQL program in a text file that contains <SAMP>`--'</SAMP> comments
you should use:

</P>

<PRE>
shell&#62; replace " --" " #" &#60; text-file-with-funny-comments.sql \
         | mysql database
</PRE>

<P>
instead of the usual:

</P>

<PRE>
shell&#62; mysql database &#60; text-file-with-funny-comments.sql
</PRE>

<P>
You can also edit the command file ``in place'' to change the <SAMP>`--'</SAMP>
comments to <SAMP>`#'</SAMP> comments:

</P>

<PRE>
shell&#62; replace " --" " #" -- text-file-with-funny-comments.sql
</PRE>

<P>
Change them back with this command:

</P>

<PRE>
shell&#62; replace " #" " --" -- text-file-with-funny-comments.sql
</PRE>



<H2><A NAME="Standards" HREF="manual_toc.html#Standards">5.5  What standards does MySQL follow?</A></H2>

<P>
Entry level SQL92. ODBC level 0-2.

</P>


<H2><A NAME="Commit-rollback" HREF="manual_toc.html#Commit-rollback">5.6  How to cope without <CODE>COMMIT</CODE>/<CODE>ROLLBACK</CODE></A></H2>

<P>
<STRONG>MySQL</STRONG> doesn't support <CODE>COMMIT</CODE>-<CODE>ROLLBACK.</CODE> The problem is
that handling <CODE>COMMIT</CODE>-<CODE>ROLLBACK</CODE> efficiently would require a
completely different table layout than <STRONG>MySQL</STRONG> uses today.
<STRONG>MySQL</STRONG> would also need extra threads that do automatic cleanups on
the tables and the disk usage would be much higher. This would make
<STRONG>MySQL</STRONG> about 2-4 times slower than it is today.  <STRONG>MySQL</STRONG> is
much faster than almost all other SQL databases (typically at least 2-3 times
faster).  One of the reasons for this is the lack of
<CODE>COMMIT</CODE>-<CODE>ROLLBACK</CODE>.

</P>
<P>
For the moment, we are much more for implementing the SQL server
language (something like stored procedures). With this you would very
seldom really need <CODE>COMMIT</CODE>-<CODE>ROLLBACK.</CODE> This would also give much
better performance.

</P>
<P>
Loops that need transactions normally can be coded with the help of
<CODE>LOCK TABLES</CODE>, and you don't need cursors when you can update records
on the fly.

</P>
<P>
We have transactions and cursors on the TODO but not quite prioritized. If
we implement these, it will be as an option to <CODE>CREATE TABLE</CODE>. That
means that <CODE>COMMIT</CODE>-<CODE>ROLLBACK</CODE> will work only on those tables,
so that a speed penalty will be imposed on those table only.

</P>
<P>
We at TcX have a greater need for a real fast database than a 100%
general database. Whenever we find a way to implement these features without
any speed loss, we will probably do it. For the moment, there are many more
important things to do. Check the TODO for how we prioritize things at
the moment. (Customers with higher levels of support can alter this, so
things may be reprioritized.)

</P>
<P>
The current problem is actually <CODE>ROLLBACK</CODE>. Without <CODE>ROLLBACK</CODE>, you
can do any kind of <CODE>COMMIT</CODE> action with <CODE>LOCK TABLES</CODE>. To support
<CODE>ROLLBACK</CODE>, <STRONG>MySQL</STRONG> would have to be changed to store all old
records that were updated and revert everything back to the starting point if
<CODE>ROLLBACK</CODE> was issued. For simple cases, this isn't that hard to do (the
current <CODE>isamlog</CODE> could be used for this purpose), but it would be much
more difficult to implement <CODE>ROLLBACK</CODE> for <CODE>ALTER/DROP/CREATE
TABLE</CODE>.

</P>
<P>
To avoid using <CODE>ROLLBACK</CODE>, you can use the following strategy:

</P>

<OL>
<LI>

Use <CODE>LOCK TABLES ...</CODE> to lock all the tables you want to access.
<LI>

Test conditions.
<LI>

Update if everything is okay.
<LI>

Use <CODE>UNLOCK TABLES</CODE> to release your locks.
</OL>

<P>
This is usually a much faster method than using transactions with possible
<CODE>ROLLBACK</CODE>s, although not always. The only situation this solution
doesn't handle is when someone kills the threads in the middle of an
update. In this case, all locks will be released but some of the updates may
not have been executed.

</P>
<P>
You can also use functions to update records in a single operation.
You can get a very efficient application by using the following techniques:

</P>

<UL>
<LI>

Modify fields relative to their current value

<LI>

Update only those fields that actually have changed
</UL>

<P>
For example, when we are doing updates to some customer information, we
update only the customer data that have changed and test only that none of
the changed data, or data that depend on the changed data, have changed
compared to the original row. The test for changed data is done with the
<CODE>WHERE</CODE> clause in the <CODE>UPDATE</CODE> statement. If the record wasn't
updated, we give the client a message: "Some of the data you have changed
have been changed by another user". Then we show the old row versus the new
row in a window, so the user can decide which version of the customer record
he should use.

</P>
<P>
This gives us something that is similar to ``column locking'' but is actually
even better, because we only update some of the columns, using values that
are relative to their current values.  This means that typical <CODE>UPDATE</CODE>
statements look something like these:

</P>

<PRE>
UPDATE tablename SET pay_back=pay_back+'relative change';

UPDATE customer
  SET
    customer_date='current_date',
    address='new address',
    phone='new phone',
    money_he_owes_us=money_he_owes_us+'new_money'
  WHERE
    customer_id=id AND address='old address' AND phone='old phone';
</PRE>

<P>
As you can see, this is very efficient and works even if another client has
changed the values in the <CODE>pay_back</CODE> or <CODE>money_he_owes_us</CODE> columns.

</P>
<P>
<A NAME="IDX117"></A>
<A NAME="IDX118"></A>
In many cases, users have wanted <CODE>ROLLBACK</CODE> and/or <CODE>LOCK
TABLES</CODE> for the purpose of managing unique identifiers for some tables. This
can be handled much more efficiently by using an <CODE>AUTO_INCREMENT</CODE> column
and either the SQL function <CODE>LAST_INSERT_ID()</CODE> or the C API function
<CODE>mysql_insert_id()</CODE>. See section <A HREF="manual.html#mysql_insert_id">20.4.29  <CODE>mysql_insert_id()</CODE></A>.

</P>
<P>
<A NAME="IDX119"></A>
At TcX, we have never had any need for row-level locking because we have
always been able to code around it. Some cases really need row
locking, but they are very few. If you want row-level locking, you
can use a flag column in the table and do something like this:

</P>

<PRE>
UPDATE tbl_name SET row_flag=1 WHERE id=ID;
</PRE>

<P>
<STRONG>MySQL</STRONG> returns 1 for the number of affected rows if the row was
found and <CODE>row_flag</CODE> wasn't already 1 in the original row.

</P>
<P>
You can think of it as <STRONG>MySQL</STRONG> changed the above query to:

</P>

<PRE>
UPDATE tbl_name SET row_flag=1 WHERE id=ID and row_flag &#60;&#62; 1;
</PRE>



<H1><A NAME="Privilege_system" HREF="manual_toc.html#Privilege_system">6  The MySQL access privilege system</A></H1>

<P>
<STRONG>MySQL</STRONG> has an advanced but non-standard security/privilege
system.  This section describes how it works.

</P>



<H2><A NAME="General_security" HREF="manual_toc.html#General_security">6.1  General security</A></H2>

<P>
Anyone using <STRONG>MySQL</STRONG> on a computer connected to the Internet should
read this chapter to avoid mistakes people do.

</P>
<P>
Under "security" we mean that our site, not only <STRONG>MySQL</STRONG> is
protected against all types of applicable attacks: eavesdropping,
altering, playback and Denial of Service. We do not cover all aspects of
availability and fault tolerance here.

</P>
<P>
There are some security logic in <STRONG>MySQL</STRONG>: Access control lists
(ACL-s) and SSL encrypted connections but much more is depending on
overall usage of <STRONG>MySQL</STRONG>. Also most of this chapter isn't
<STRONG>MySQL</STRONG> dependant at all. Same rules apply for most applications.

</P>
<P>
When you running a site, designing software or just doing something with
<STRONG>MySQL</STRONG> then try to follow these rules:

</P>

<UL>
<LI>

Try to understand <STRONG>MySQL</STRONG> ACL system. The <CODE>GRANT/REVOKE</CODE> commands
are for restricting access to <STRONG>MySQL</STRONG>. Do not grant anyone for
more than is must. Never grant all hosts to do something.

Checklist:

<UL>
<LI>

Do <CODE>mysql -u root</CODE>. If you granted a connection without asking password,
then this is bad.
<LI>

Use command <CODE>SHOW GRANTS</CODE> and check who is having access and to what.
</UL>

<LI>

Do not keep any plain passwords in tables when possible. When your
computer gets compromised, intruder can take full list of passwords and
use them in somewhere else place. Instead use <CODE>MD5()</CODE> or other one-way
hashing function.
<LI>

Do not use passwords from dictionaries. There are special programs to
break them. Even passwords like: "xfish98" are very bad.  Much better is
"duag" which is same word "fish" but typed one key left on
keyboard. Another method is to use "Mhall" which is taken from first
characters of sentence "Mary had a little lamb". Easy to type when you
know the system but hard to guess from side.
<LI>

Invest in firewall. This protects for at least 50% of all types of
exploits in any software. Put <STRONG>MySQL</STRONG> behind the firewall or in
demilitarized zone (DMZ).

Checklist:

<UL>
<LI>

Try to scan your ports from Internet. <STRONG>MySQL</STRONG> uses port 3306 by
default. This port should be unaccessible for most cases.
</UL>

<LI>

Do not trust any data entered from user. Users can enter special symbols
from web-forms, URL-s or your custom application. Are you sure that your
application remains secure if user enters something like <CODE>; DROP ALL
DATABASES ;</CODE> into form?

Checklist:

<UL>
<LI>

All WWW applications:

<UL>
<LI>

Try to enter ' and " in all forms on your WWW. If you get any kind of
<STRONG>MySQL</STRONG> error, better take your site down.
<LI>

Try to modify any types of dynamic URL-s by adding %22 ("), %23 (#) and
%27 (') in your URL.
<LI>

Try to modify datatypes in dynamic URL-s from numeric ones to character
ones containing characters from previous example. Your application
should be safe against this.
<LI>

Try to enter characters, spaces, special symbols instead of numbers in
numeric fields. Application should remove them before passing to
<STRONG>MySQL</STRONG> or your application should generate error. Passing wrong
things to <STRONG>MySQL</STRONG> is dangerous!
<LI>

Check data sizes before passing them to <STRONG>MySQL</STRONG>.
</UL>

<LI>

Users of PHP3:

<UL>
<LI>

Check out the addslashes() function
</UL>

<LI>

Users of <STRONG>MySQL</STRONG> C API:

<UL>
<LI>

Check out the <CODE>mysql_escape()</CODE> API call.
</UL>

<LI>

Users of <STRONG>MySQL</STRONG>++:

<UL>
<LI>

Check out the <CODE>escape</CODE> and <CODE>quote</CODE> modifiers (?) for query streams.
</UL>

</UL>

<LI>

Do not transmit plain data over the net. This data is accessible to
everyone who have interest to trap this information and reuse it
somewhere. If you really need this, use encrypted communications like
SSL. <STRONG>MySQL</STRONG> supports internal SSL connections beginning from
version 3.23.9.
<LI>

Learn to use utilities "tcpdump" and "strings". For most cases you can
see unencrypted <STRONG>MySQL</STRONG> data streams issuing command:

<PRE>
tcpdump -l -i eth0 -w - src or dst port 3306 | strings
</PRE>

(This works under linux and should work with small modifications under
another systems).  Warning: If you do not see data this doesn't actually
always mean that it is encrypted. If you need high security you should
consult with security expert.
</UL>



<H2><A NAME="Security" HREF="manual_toc.html#Security">6.2  How to make MySQL secure against crackers</A></H2>

<P>
When you connect to a <STRONG>MySQL</STRONG> server, you should normally use
a password.  The password is not transmitted in clear text over the connection.

</P>
<P>
All other information is transferred as text that can be read by anyone that
is able to watch the connection.  If you are concerned about this, you can
use the compressed protocol (in <STRONG>MySQL</STRONG> 3.22 and above) to make things
much harder.  To make things even more secure you should install <CODE>ssh</CODE>
(see <a HREF="http://www.cs.hut.fi/ssh">http://www.cs.hut.fi/ssh</a>).  With this, you can get an encrypted
TCP/IP connection between a <STRONG>MySQL</STRONG> server and a <STRONG>MySQL</STRONG>
client.

</P>
<P>
To make a <STRONG>MySQL</STRONG> system secure, you should strongly consider the
following suggestions:

</P>

<UL>
<LI>

Use passwords for all <STRONG>MySQL</STRONG> users. Remember that anyone can log in
as any other person as simply as <CODE>mysql -u other_user db_name</CODE> if
<CODE>other_user</CODE> has no password.  It is common behavior with client/server
applications that the client may specify any user name.  You can change the
password of all users by editing the <CODE>mysql_install_db</CODE> script before
you run it, or only the password for the <STRONG>MySQL</STRONG> <CODE>root</CODE> user like
this:


<PRE>
shell&#62; mysql -u root mysql
mysql&#62; UPDATE user SET Password=PASSWORD('new_password')
           WHERE user='root';
mysql&#62; FLUSH PRIVILEGES;
</PRE>

<LI>

Don't run the <STRONG>MySQL</STRONG> daemon as the Unix <CODE>root</CODE> user.
<CODE>mysqld</CODE> can be run as any user.  You can also create a new Unix user
<CODE>mysql</CODE> to make everything even more secure.  If you run <CODE>mysqld</CODE>
as another Unix user, you don't need to change the <CODE>root</CODE> user name in
the <CODE>user</CODE> table, because <STRONG>MySQL</STRONG> user names have nothing to do
with Unix user names.  You can edit the <CODE>mysql.server</CODE> script to start
<CODE>mysqld</CODE> as another Unix user.  Normally this is done with the <CODE>su</CODE>
command.  For more details, see section <A HREF="manual.html#Changing_MySQL_user">18.8  How to run MySQL as a normal user</A>.

<LI>

If you put a password for the Unix <CODE>root</CODE> user in the <CODE>mysql.server</CODE>
script, make sure this script is readable only by <CODE>root</CODE>.

<LI>

Check that the Unix user that <CODE>mysqld</CODE> runs as is the only user with
read/write privileges in the database directories.

<LI>

Don't give the <STRONG>process</STRONG> privilege to all users.  The output of
<CODE>mysqladmin processlist</CODE> shows the text of the currently executing
queries, so any user who is allowed to execute that command might be able to
see if another user issues an <CODE>UPDATE user SET
password=PASSWORD('not_secure')</CODE> query.

<CODE>mysqld</CODE> saves an extra connection for users who have the
<STRONG>process</STRONG> privilege, so that a <STRONG>MySQL</STRONG> <CODE>root</CODE> user can log
in and check things even if all normal connections are in use.

<LI>

Don't give the <STRONG>file</STRONG> privilege to all users.  Any user that has this
privilege can write a file anywhere in the file system with the privileges of
the <CODE>mysqld</CODE> daemon!  To make this a bit safer, all files generated with
<CODE>SELECT ... INTO OUTFILE</CODE> are readable to everyone, and you can't
overwrite existing files.

<A NAME="IDX120"></A>
The <STRONG>file</STRONG> privilege may also be used to read any file accessible
to the Unix user that the server runs as.  This could be abused, for example,
by using <CODE>LOAD DATA</CODE> to load <TT>`/etc/passwd'</TT> into a table, which
can then be read with <CODE>SELECT</CODE>.

<LI>

If you don't trust your DNS, you should use IP numbers instead of hostnames
in the grant tables.  In principle, the <CODE>--secure</CODE> option to
<CODE>mysqld</CODE> should make hostnames safe.  In any case, you should be very
careful about using hostname values that contain wildcards!
</UL>

<P>
The following <CODE>mysqld</CODE> options affect security:

</P>
<DL COMPACT>

<DT><CODE>--secure</CODE>
<DD>
IP numbers returned by the <CODE>gethostbyname()</CODE> system call are checked to
make sure they resolve back to the original hostname. This makes it harder
for someone on the outside to get access by simulating another host.  This
option also adds some sanity checks of hostnames.  The option is turned off
by default in <STRONG>MySQL</STRONG> 3.21 since it sometimes takes a long time to
perform backward resolutions.  <STRONG>MySQL</STRONG> 3.22 caches hostnames and has
this option enabled by default.

<DT><CODE>--skip-grant-tables</CODE>
<DD>
This option causes the server not to use the privilege system at all. This
gives everyone <EM>full access</EM> to all databases!  (You can tell a running
server to start using the grant tables again by executing <CODE>mysqladmin
reload</CODE>.)

<DT><CODE>--skip-name-resolve</CODE>
<DD>
Hostnames are not resolved.  All <CODE>Host</CODE> column values in the grant
tables must be IP numbers or <CODE>localhost</CODE>.

<DT><CODE>--skip-networking</CODE>
<DD>
Don't allow TCP/IP connections over the network.  All connections to
<CODE>mysqld</CODE> must be made via Unix sockets. This option is unsuitable for
systems that use MIT-pthreads, because the MIT-pthreads package doesn't
support Unix sockets.
</DL>



<H2><A NAME="What_Privileges" HREF="manual_toc.html#What_Privileges">6.3  What the privilege system does</A></H2>

<P>
The primary function of the <STRONG>MySQL</STRONG> privilege system is to
authenticate a user connecting from a given host, and to associate that user
with <STRONG>select</STRONG>, <STRONG>insert</STRONG>, <STRONG>update</STRONG> and <STRONG>delete</STRONG>
privileges on a database.

</P>
<P>
Additional functionality includes the ability to have an anonymous user and
to grant privileges for <STRONG>MySQL</STRONG>-specific functions such as <CODE>LOAD
DATA INFILE</CODE> and administrative operations.

</P>


<H2><A NAME="User_names" HREF="manual_toc.html#User_names">6.4  MySQL user names and passwords</A></H2>

<P>
There are several distinctions between the way user names and passwords are
used by <STRONG>MySQL</STRONG>, and the way they are used by Unix or Windows:

</P>

<UL>
<LI>

User names, as used by <STRONG>MySQL</STRONG> for authentication purposes, have
nothing to do with Unix user names (login names) or Windows user names.  Most
<STRONG>MySQL</STRONG> clients by default try to log in using the current Unix user
name as the <STRONG>MySQL</STRONG> user name, but that is for convenience only.
Client programs allow a different name to be specified with the <CODE>-u</CODE> or
<CODE>--user</CODE> options. This means that you can't make a database secure in
any way unless all <STRONG>MySQL</STRONG> user names have passwords.  Anyone may
attempt to connect to the server using any name, and they will succeed if
they specify any name that doesn't have a password.

<LI>

<STRONG>MySQL</STRONG> user names can be up to 16 characters long; Unix user names
typically are limited to 8 characters.

<LI>

<STRONG>MySQL</STRONG> passwords have nothing to do with Unix passwords.  There is no
necessary connection between the password you use to log in to a Unix machine
and the password you use to access a database on that machine.

<LI>

<STRONG>MySQL</STRONG> encrypts passwords using a different algorithm than the one
used during the Unix login process.  See the descriptions of the
<CODE>PASSWORD()</CODE> and <CODE>ENCRYPT()</CODE> functions in section <A HREF="manual.html#Miscellaneous_functions">7.4.12  Miscellaneous functions</A>.
</UL>



<H2><A NAME="Connecting" HREF="manual_toc.html#Connecting">6.5  Connecting to the MySQL server</A></H2>

<P>
<STRONG>MySQL</STRONG> client programs generally require that you specify connection
parameters when you want to access a <STRONG>MySQL</STRONG> server: the host you want
to connect to, your user name and your password.  For example, the
<CODE>mysql</CODE> client can be started like this (optional arguments are enclosed
between <SAMP>`['</SAMP> and <SAMP>`]'</SAMP>):

</P>

<PRE>
shell&#62; mysql [-h host_name] [-u user_name] [-pyour_pass]
</PRE>

<P>
Alternate forms of the <CODE>-h</CODE>, <CODE>-u</CODE> and <CODE>-p</CODE> options are
<CODE>--host=host_name</CODE>, <CODE>--user=user_name</CODE> and
<CODE>--password=your_pass</CODE>.  Note that there is <EM>no space</EM> between
<CODE>-p</CODE> or <CODE>--password=</CODE> and the password following it.

</P>
<P>
<EM>Note:</EM> Specifing a password on the command line is not secure!
Any user on your system may then find out your password by typing a command
like: <CODE>ps auxww</CODE>.  See section <A HREF="manual.html#Option_files">4.15.4  Option files</A>.

</P>
<P>
<CODE>mysql</CODE> uses default values for connection parameters that are missing
from the command line:

</P>

<UL>
<LI>

The default hostname is <CODE>localhost</CODE>.

<LI>

The default user name is your Unix login name.

<LI>

No password is supplied if <CODE>-p</CODE> is missing.
</UL>

<P>
Thus, for a Unix user <CODE>joe</CODE>, the following commands are equivalent:

</P>

<PRE>
shell&#62; mysql -h localhost -u joe
shell&#62; mysql -h localhost
shell&#62; mysql -u joe
shell&#62; mysql
</PRE>

<P>
Other <STRONG>MySQL</STRONG> clients behave similarly.

</P>
<P>
On Unix systems, you can specify different default values to be used when you
make a connection, so that you need not enter them on the command line each
time you invoke a client program.  This can be done in a couple of ways:

</P>

<UL>
<LI>

<A NAME="IDX121"></A>
You can specify connection parameters in the <CODE>[client]</CODE> section of the
<TT>`.my.cnf'</TT> configuration file in your home directory.  The relevant
section of the file might look like this:


<PRE>
[client]
host=host_name
user=user_name
password=your_pass
</PRE>

See section <A HREF="manual.html#Option_files">4.15.4  Option files</A>.

<LI>

<A NAME="IDX122"></A>
<A NAME="IDX123"></A>
<A NAME="IDX124"></A>
<A NAME="IDX125"></A>
<A NAME="IDX126"></A>
<A NAME="IDX127"></A>
You can specify connection parameters using environment values.  The host can
be specified using <CODE>MYSQL_HOST</CODE>.  The <STRONG>MySQL</STRONG> user name can be
specified using <CODE>USER</CODE> (this is for Windows only).  The password can be
specified using <CODE>MYSQL_PWD</CODE> (but this is insecure; see next section).
</UL>

<P>
<A NAME="IDX128"></A>
If connection parameters are specified in multiple ways, values specified on
the command line take precedence over values specified in configuration files
and environment variables, and values in configuration files take precedence
over values in environment variables.

</P>


<H2><A NAME="Password_security" HREF="manual_toc.html#Password_security">6.6  Keeping your password secure</A></H2>

<P>
It is inadvisable to specify your password in a way that exposes it to
discovery by other users.  The methods you can use to specify your password
when you run client programs are listed below, along with an assessment of
the risks of each method:

</P>

<UL>
<LI>

Use a <CODE>-pyour_pass</CODE> or <CODE>--password=your_pass</CODE> option on the command
line.  This is convenient but insecure, since your password becomes visible
to system status programs (such as <CODE>ps</CODE>) that may be invoked by other
users to display command lines.  (<STRONG>MySQL</STRONG> clients typically overwrite
the command line argument with zeroes during their initialization sequence,
but there is still a brief interval during which the value is visible.)

<LI>

Use a <CODE>-p</CODE> or <CODE>--password</CODE> option (with no <CODE>your_pass</CODE> value
specified).  In this case, the client program solicits the password from
the terminal:


<PRE>
shell&#62; mysql -u user_name -p
Enter password: ********
</PRE>

The client echoes <SAMP>`*'</SAMP> characters to the terminal as you enter your
password so that onlookers cannot see it.

It is more secure to enter your password this way than to specify it on the
command line because it is not visible to other users.  However, this method
of entering a password is suitable only for programs that you run
interactively.  If you want to invoke a client from a script that runs
non-interactively, there is no opportunity to enter the password from the
terminal.

<LI>

<A NAME="IDX129"></A>
Store your password in a configuration file.  For example, you can list your
password in the <CODE>[client]</CODE> section of the <TT>`.my.cnf'</TT> file in your
home directory:


<PRE>
[client]
password=your_pass
</PRE>

If you store your password in <TT>`.my.cnf'</TT>, the file should not be group or
world readable or writable.  Make sure the file's access mode is <CODE>400</CODE>
or <CODE>600</CODE>.

See section <A HREF="manual.html#Option_files">4.15.4  Option files</A>.
<LI>

You can store your password in the <CODE>MYSQL_PWD</CODE> environment variable, but
this method must be considered extremely insecure and should not be used.
Some versions of <CODE>ps</CODE> include an option to display the environment of
running processes; your password will be in plain sight for all to see if
you set <CODE>MYSQL_PWD</CODE>.  Even on systems without such a version of
<CODE>ps</CODE>, it is unwise to assume there is no other method to observe process
environments.
</UL>

<P>
All in all, the safest methods are to have the client program prompt for the
password or to specify the password in a properly-protected <TT>`.my.cnf'</TT>
file.

</P>


<H2><A NAME="Privileges_provided" HREF="manual_toc.html#Privileges_provided">6.7  Privileges provided by MySQL</A></H2>

<P>
Privilege information is stored in the <CODE>user</CODE>, <CODE>db</CODE>, <CODE>host</CODE>,
<CODE>tables_priv</CODE> and <CODE>columns_priv</CODE> tables in the <CODE>mysql</CODE>
database (that is, in the database named <CODE>mysql</CODE>).  The <STRONG>MySQL</STRONG>
server reads the contents of these tables when it starts up and under the
circumstances indicated in section <A HREF="manual.html#Privilege_changes">6.11  When privilege changes take effect</A>.

</P>
<P>
The names used in this manual to refer to the privileges provided by
<STRONG>MySQL</STRONG> are shown below, along with the table column name associated
with each privilege in the grant tables and the context in which the
privilege applies:

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><STRONG>Privilege</STRONG> </TD><TD> <STRONG>Column</STRONG> </TD><TD> <STRONG>Context</STRONG>
</TR NOSAVE>
<TR><TD><STRONG>select</STRONG> </TD><TD> <CODE>Select_priv</CODE> </TD><TD> tables
</TR NOSAVE>
<TR><TD><STRONG>insert</STRONG> </TD><TD> <CODE>Insert_priv</CODE> </TD><TD> tables
</TR NOSAVE>
<TR><TD><STRONG>update</STRONG> </TD><TD> <CODE>Update_priv</CODE> </TD><TD> tables
</TR NOSAVE>
<TR><TD><STRONG>delete</STRONG> </TD><TD> <CODE>Delete_priv</CODE> </TD><TD> tables
</TR NOSAVE>
<TR><TD><STRONG>index</STRONG> </TD><TD> <CODE>Index_priv</CODE> </TD><TD> tables
</TR NOSAVE>
<TR><TD><STRONG>alter</STRONG> </TD><TD> <CODE>Alter_priv</CODE> </TD><TD> tables
</TR NOSAVE>
<TR><TD><STRONG>create</STRONG> </TD><TD> <CODE>Create_priv</CODE> </TD><TD> databases, tables or indexes
</TR NOSAVE>
<TR><TD><STRONG>drop</STRONG> </TD><TD> <CODE>Drop_priv</CODE> </TD><TD> databases or tables
</TR NOSAVE>
<TR><TD><STRONG>grant</STRONG> </TD><TD> <CODE>Grant_priv</CODE> </TD><TD> databases or tables
</TR NOSAVE>
<TR><TD><STRONG>references</STRONG> </TD><TD> <CODE>References_priv</CODE> </TD><TD> databases or tables
</TR NOSAVE>
<TR><TD><STRONG>reload</STRONG> </TD><TD> <CODE>Reload_priv</CODE> </TD><TD> server administration
</TR NOSAVE>
<TR><TD><STRONG>shutdown</STRONG> </TD><TD> <CODE>Shutdown_priv</CODE> </TD><TD> server administration
</TR NOSAVE>
<TR><TD><STRONG>process</STRONG> </TD><TD> <CODE>Process_priv</CODE> </TD><TD> server administration
</TR NOSAVE>
<TR><TD><STRONG>file</STRONG> </TD><TD> <CODE>File_priv</CODE> </TD><TD> file access on server
</TR>
</TABLE>

<P>
The <STRONG>select</STRONG>, <STRONG>insert</STRONG>, <STRONG>update</STRONG> and <STRONG>delete</STRONG>
privileges allow you to perform operations on rows in existing tables in
a database.

</P>
<P>
<CODE>SELECT</CODE> statements require the <STRONG>select</STRONG> privilege only if they
actually retrieve rows from a table.  You can execute certain <CODE>SELECT</CODE>
statements even without permission to access any of the databases on the
server.  For example, you could use the <CODE>mysql</CODE> client as a simple
calculator:

</P>

<PRE>
mysql&#62; SELECT 1+1;
mysql&#62; SELECT PI()*2;
</PRE>

<P>
The <STRONG>index</STRONG> privilege allows you to create or drop (remove) indexes.

</P>
<P>
The <STRONG>alter</STRONG> privilege allows you to use <CODE>ALTER TABLE</CODE>.

</P>
<P>
The <STRONG>create</STRONG> and <STRONG>drop</STRONG> privileges allow you to create new
databases and tables, or to drop (remove) existing databases and tables.

</P>
<P>
Note that if you grant the <STRONG>drop</STRONG> privilege for the <CODE>mysql</CODE>
database to a user, that user can drop the database in which the
<STRONG>MySQL</STRONG> access privileges are stored!

</P>
<P>
The <STRONG>grant</STRONG> privilege allows you to give to other users those
privileges you yourself possess.

</P>
<P>
The <STRONG>file</STRONG> privilege gives you permission to read and write files on
the server using the <CODE>LOAD DATA INFILE</CODE> and <CODE>SELECT ... INTO
OUTFILE</CODE> statements.  Any user to whom this privilege is granted can read or
write any file that the <STRONG>MySQL</STRONG> server can read or write.

</P>
<P>
The remaining privileges are used for administrative operations, which are
performed using the <CODE>mysqladmin</CODE> program.  The table below shows which
<CODE>mysqladmin</CODE> commands each administrative privilege allows you to
execute:

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><STRONG>Privilege</STRONG> </TD><TD> <STRONG>Commands permitted to privilege holders</STRONG>
</TR NOSAVE>
<TR><TD><STRONG>reload</STRONG> </TD><TD> <CODE>reload</CODE>, <CODE>refresh</CODE>,
<CODE>flush-privileges</CODE>,
<CODE>flush-hosts</CODE>, <CODE>flush-logs</CODE>, <CODE>flush-tables</CODE>
</TR NOSAVE>
<TR><TD><STRONG>shutdown</STRONG> </TD><TD> <CODE>shutdown</CODE>
</TR NOSAVE>
<TR><TD><STRONG>process</STRONG> </TD><TD> <CODE>processlist</CODE>, <CODE>kill</CODE>
</TR>
</TABLE>

<P>
The <CODE>reload</CODE> command tells the server to reread the grant tables.  The
<CODE>refresh</CODE> command flushes all tables and opens and closes the log
files.  <CODE>flush-privileges</CODE> is a synonym for <CODE>reload</CODE>.  The other
<CODE>flush-*</CODE> commands perform functions similar to <CODE>refresh</CODE> but are
more limited in scope, and may be preferable in some instances.  For example,
if you want to flush just the log files, <CODE>flush-logs</CODE> is a better choice
than <CODE>refresh</CODE>.

</P>
<P>
The <CODE>shutdown</CODE> command shuts down the server.

</P>
<P>
The <CODE>processlist</CODE> command displays information about the threads
executing within the server.  The <CODE>kill</CODE> command kills server threads.
You can always display or kill your own threads, but you need the
<STRONG>process</STRONG> privilege to display or kill threads initiated by other
users.

</P>
<P>
It is a good idea in general to grant privileges only to those users who need
them, but you should exercise particular caution in granting certain
privileges:

</P>

<UL>
<LI>

The <STRONG>grant</STRONG> privilege allows users to give away their privileges to
other users.  Two users with different privileges and with the <STRONG>grant</STRONG>
privilege are able to combine privileges.

<LI>

The <STRONG>alter</STRONG> privilege may be used to subvert the privilege system
by renaming tables.

<LI>

The <STRONG>file</STRONG> privilege can be abused to read any world-readable file on
the server into a database table, the contents of which can then be
accessed using <CODE>SELECT</CODE>.

<LI>

The <STRONG>shutdown</STRONG> privilege can be abused to deny service to other
users entirely, by terminating the server.

<LI>

The <STRONG>process</STRONG> privilege can be used to view the plain text of
currently executing queries, including queries that set or change passwords.

<LI>

Privileges on the <CODE>mysql</CODE> database can be used to change passwords and
other access privilege information.  (Passwords are stored encrypted, so a
malicious user cannot simply read them.  However, with sufficient privileges,
that same user can replace a password with a different one.)
</UL>

<P>
There are some things that you cannot do with the <STRONG>MySQL</STRONG>
privilege system:

</P>

<UL>
<LI>

You cannot explicitly specify that a given user should be denied access.
That is, you cannot explicitly match a user and then refuse the connection.

<LI>

You cannot specify that a user has privileges to create or drop tables
in a database but not to create or drop the database itself.
</UL>



<H2><A NAME="Privileges" HREF="manual_toc.html#Privileges">6.8  How the privilege system works</A></H2>

<P>
The <STRONG>MySQL</STRONG> privilege system ensures that all users may do exactly the
things that they are supposed to be allowed to do.  When you connect to a
<STRONG>MySQL</STRONG> server, your identity is determined by <STRONG>the host from
which you connect</STRONG> and <STRONG>the user name you specify</STRONG>.  The system grants
privileges according to your identity and <STRONG>what you want to do</STRONG>.

</P>
<P>
<STRONG>MySQL</STRONG> considers both your hostname and user name in identifying you
because there is little reason to assume that a given user name belongs to
the same person everywhere on the Internet.  For example, the user
<CODE>bill</CODE> who connects from <CODE>whitehouse.gov</CODE> need not be the same
person as the user <CODE>bill</CODE> who connects from <CODE>microsoft.com</CODE>.
<STRONG>MySQL</STRONG> handles this by allowing you to distinguish users on different
hosts that happen to have the same name:  you can grant <CODE>bill</CODE> one set
of privileges for connections from <CODE>whitehouse.gov</CODE>, and a different set
of privileges for connections from <CODE>microsoft.com</CODE>.

</P>
<P>
<STRONG>MySQL</STRONG> access control involves two stages:

</P>

<UL>
<LI>

Stage 1: The server checks whether or not you are even allowed to connect.

<LI>

Stage 2: Assuming you can connect, the server checks each request you issue
to see whether or not you have sufficient privileges to perform it.  For
example, if you try to select rows from a table in a database or drop a table
from the database, the server makes sure you have the <STRONG>select</STRONG>
privilege for the table or the <STRONG>drop</STRONG> privilege for the database.
</UL>

<P>
The server uses the <CODE>user</CODE>, <CODE>db</CODE> and <CODE>host</CODE> tables in the
<CODE>mysql</CODE> database at both stages of access control.  The fields in these
grant tables are shown below:

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><STRONG>Table name</STRONG> </TD><TD> <CODE>user</CODE> </TD><TD> <CODE>db</CODE> </TD><TD> <CODE>host</CODE>

</TR NOSAVE>
<TR><TD><STRONG>Scope fields</STRONG> </TD><TD> <CODE>Host</CODE> </TD><TD> <CODE>Host</CODE> </TD><TD> <CODE>Host</CODE>
</TR NOSAVE>
<TR><TD></TD><TD> <CODE>User</CODE> </TD><TD> <CODE>Db</CODE> </TD><TD> <CODE>Db</CODE>
</TR NOSAVE>
<TR><TD></TD><TD> <CODE>Password</CODE> </TD><TD> <CODE>User</CODE> </TD><TD>

</TR NOSAVE>
<TR><TD><STRONG>Privilege fields</STRONG> </TD><TD> <CODE>Select_priv</CODE> </TD><TD> <CODE>Select_priv</CODE> </TD><TD> <CODE>Select_priv</CODE>
</TR NOSAVE>
<TR><TD></TD><TD> <CODE>Insert_priv</CODE> </TD><TD> <CODE>Insert_priv</CODE> </TD><TD> <CODE>Insert_priv</CODE>
</TR NOSAVE>
<TR><TD></TD><TD> <CODE>Update_priv</CODE> </TD><TD> <CODE>Update_priv</CODE> </TD><TD> <CODE>Update_priv</CODE>
</TR NOSAVE>
<TR><TD></TD><TD> <CODE>Delete_priv</CODE> </TD><TD> <CODE>Delete_priv</CODE> </TD><TD> <CODE>Delete_priv</CODE>
</TR NOSAVE>
<TR><TD></TD><TD> <CODE>Index_priv</CODE> </TD><TD> <CODE>Index_priv</CODE> </TD><TD> <CODE>Index_priv</CODE>
</TR NOSAVE>
<TR><TD></TD><TD> <CODE>Alter_priv</CODE> </TD><TD> <CODE>Alter_priv</CODE> </TD><TD> <CODE>Alter_priv</CODE>
</TR NOSAVE>
<TR><TD></TD><TD> <CODE>Create_priv</CODE> </TD><TD> <CODE>Create_priv</CODE> </TD><TD> <CODE>Create_priv</CODE>
</TR NOSAVE>
<TR><TD></TD><TD> <CODE>Drop_priv</CODE> </TD><TD> <CODE>Drop_priv</CODE> </TD><TD> <CODE>Drop_priv</CODE>
</TR NOSAVE>
<TR><TD></TD><TD> <CODE>Grant_priv</CODE> </TD><TD> <CODE>Grant_priv</CODE> </TD><TD> <CODE>Grant_priv</CODE>
</TR NOSAVE>
<TR><TD></TD><TD> <CODE>References_priv</CODE> </TD><TD> </TD><TD> 
</TR NOSAVE>
<TR><TD></TD><TD> <CODE>Reload_priv</CODE> </TD><TD> </TD><TD> 
</TR NOSAVE>
<TR><TD></TD><TD> <CODE>Shutdown_priv</CODE> </TD><TD> </TD><TD> 
</TR NOSAVE>
<TR><TD></TD><TD> <CODE>Process_priv</CODE> </TD><TD> </TD><TD> 
</TR NOSAVE>
<TR><TD></TD><TD> <CODE>File_priv</CODE> </TD><TD> </TD><TD> 
</TR>
</TABLE>

<P>
For the second stage of access control (request verification), the server
may, if the request involves tables, additionally consult the
<CODE>tables_priv</CODE> and <CODE>columns_priv</CODE> tables.  The fields in these
tables are shown below:

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><STRONG>Table name</STRONG> </TD><TD> <CODE>tables_priv</CODE> </TD><TD> <CODE>columns_priv</CODE>

</TR NOSAVE>
<TR><TD><STRONG>Scope fields</STRONG> </TD><TD> <CODE>Host</CODE> </TD><TD> <CODE>Host</CODE>
</TR NOSAVE>
<TR><TD></TD><TD> <CODE>Db</CODE> </TD><TD> <CODE>Db</CODE>
</TR NOSAVE>
<TR><TD></TD><TD> <CODE>User</CODE> </TD><TD> <CODE>User</CODE>
</TR NOSAVE>
<TR><TD></TD><TD> <CODE>Table_name</CODE> </TD><TD> <CODE>Table_name</CODE>
</TR NOSAVE>
<TR><TD></TD><TD> </TD><TD> <CODE>Column_name</CODE>

</TR NOSAVE>
<TR><TD><STRONG>Privilege fields</STRONG> </TD><TD> <CODE>Table_priv</CODE> </TD><TD> <CODE>Column_priv</CODE>
</TR NOSAVE>
<TR><TD></TD><TD> <CODE>Column_priv</CODE> </TD><TD>

</TR NOSAVE>
<TR><TD><STRONG>Other fields</STRONG> </TD><TD> <CODE>Timestamp</CODE> </TD><TD> <CODE>Timestamp</CODE>
</TR NOSAVE>
<TR><TD></TD><TD> <CODE>Grantor</CODE> </TD><TD>
</TR>
</TABLE>

<P>
Each grant table contains scope fields and privilege fields.

</P>
<P>
Scope fields determine the scope of each entry in the tables, i.e., the
context in which the entry applies.  For example, a <CODE>user</CODE> table entry
with <CODE>Host</CODE> and <CODE>User</CODE> values of <CODE>'thomas.loc.gov'</CODE> and
<CODE>'bob'</CODE> would be used for authenticating connections made to the server
by <CODE>bob</CODE> from the host <CODE>thomas.loc.gov</CODE>.  Similarly, a <CODE>db</CODE>
table entry with <CODE>Host</CODE>, <CODE>User</CODE> and <CODE>Db</CODE> fields of
<CODE>'thomas.loc.gov'</CODE>, <CODE>'bob'</CODE> and <CODE>'reports'</CODE> would be used when
<CODE>bob</CODE> connects from the host <CODE>thomas.loc.gov</CODE> to access the
<CODE>reports</CODE> database.  The <CODE>tables_priv</CODE> and <CODE>columns_priv</CODE>
tables contain scope fields indicating tables or table/column combinations
to which each entry applies.

</P>
<P>
<A NAME="IDX130"></A>
For access-checking purposes, comparisons of <CODE>Host</CODE> values are
case insensitive.  <CODE>User</CODE>, <CODE>Password</CODE>, <CODE>Db</CODE> and
<CODE>Table_name</CODE> values are case sensitive.
<CODE>Column_name</CODE> values are case insensitive in <STRONG>MySQL</STRONG> 3.22.12
or later.

</P>
<P>
Privilege fields indicate the privileges granted by a table entry, that is,
what operations can be performed.  The server combines the information in the
various grant tables to form a complete description of a user's privileges.
The rules used to do this are described in section <A HREF="manual.html#Request_access">6.10  Access control, stage 2: Request verification</A>.

</P>
<P>
Scope fields are strings, declared as shown below; the default value for
each is the empty string:

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><STRONG>Field name</STRONG> </TD><TD> <STRONG>Type</STRONG>
</TR NOSAVE>
<TR><TD><CODE>Host</CODE> </TD><TD> <CODE>CHAR(60)</CODE>
</TR NOSAVE>
<TR><TD><CODE>User</CODE> </TD><TD> <CODE>CHAR(16)</CODE>
</TR NOSAVE>
<TR><TD><CODE>Password</CODE> </TD><TD> <CODE>CHAR(16)</CODE>
</TR NOSAVE>
<TR><TD><CODE>Db</CODE> </TD><TD> <CODE>CHAR(64)</CODE> </TD><TD> (<CODE>CHAR(60)</CODE> for the
<CODE>tables_priv</CODE> and <CODE>columns_priv</CODE> tables)
</TR>
</TABLE>

<P>
In the <CODE>user</CODE>, <CODE>db</CODE> and <CODE>host</CODE> tables,
all privilege fields are declared as <CODE>ENUM('N','Y')</CODE> -- each can have a
value of <CODE>'N'</CODE> or <CODE>'Y'</CODE>, and the default value is <CODE>'N'</CODE>.

</P>
<P>
In the <CODE>tables_priv</CODE> and <CODE>columns_priv</CODE> tables, the privilege
fields are declared as <CODE>SET</CODE> fields:

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><STRONG>Table name</STRONG> </TD><TD> <STRONG>Field name</STRONG> </TD><TD> <STRONG>Possible set elements</STRONG>
</TR NOSAVE>
<TR><TD><CODE>tables_priv</CODE> </TD><TD> <CODE>Table_priv</CODE> </TD><TD> <CODE>'Select', 'Insert',
'Update', 'Delete', 'Create', 'Drop', 'Grant', 'References', 'Index', 'Alter'</CODE>
</TR NOSAVE>
<TR><TD><CODE>tables_priv</CODE> </TD><TD> <CODE>Column_priv</CODE> </TD><TD> <CODE>'Select', 'Insert',
'Update', 'References'</CODE>
</TR NOSAVE>
<TR><TD><CODE>columns_priv</CODE> </TD><TD> <CODE>Column_priv</CODE> </TD><TD> <CODE>'Select', 'Insert',
'Update', 'References'</CODE>
</TR>
</TABLE>

<P>
Briefly, the server uses the grant tables like this:

</P>

<UL>
<LI>

The <CODE>user</CODE> table scope fields determine whether to allow or reject
incoming connections.  For allowed connections, the privilege fields indicate
the user's global (superuser) privileges.

<LI>

The <CODE>db</CODE> and <CODE>host</CODE> tables are used together:


<UL>
<LI>

The <CODE>db</CODE> table scope fields determine which users can access which
databases from which hosts.  The privilege fields determine which operations
are allowed.

<LI>

The <CODE>host</CODE> table is used as an extension of the <CODE>db</CODE> table when you
want a given <CODE>db</CODE> table entry to apply to several hosts.  For example,
if you want a user to be able to use a database from several hosts in
your network, leave the <CODE>Host</CODE> value empty in the user's <CODE>db</CODE> table
entry, then populate the <CODE>host</CODE> table with an entry for each of those
hosts.  This mechanism is described more detail in section <A HREF="manual.html#Request_access">6.10  Access control, stage 2: Request verification</A>.
</UL>

<LI>

The <CODE>tables_priv</CODE> and <CODE>columns_priv</CODE> tables are similar to
the <CODE>db</CODE> table, but are more fine-grained: they apply at the
table and column level rather than at the database level.
</UL>

<P>
Note that administrative privileges (<STRONG>reload</STRONG>, <STRONG>shutdown</STRONG>,
etc.) are specified only in the <CODE>user</CODE> table.  This is because
administrative operations are operations on the server itself and are not
database-specific, so there is no reason to list such privileges in the
other grant tables.  In fact, only the <CODE>user</CODE> table need
be consulted to determine whether or not you can perform an administrative
operation.

</P>
<P>
The <STRONG>file</STRONG> privilege is specified only in the <CODE>user</CODE> table, too.
It is not an administrative privilege as such, but your ability to read or
write files on the server host is independent of the database you are
accessing.

</P>
<P>
The <CODE>mysqld</CODE> server reads the contents of the grant tables once, when it
starts up.  Changes to the grant tables take effect as indicated in
section <A HREF="manual.html#Privilege_changes">6.11  When privilege changes take effect</A>.

</P>
<P>
When you modify the contents of the grant tables, it is a good idea to make
sure that your changes set up privileges the way you want.  For help in
diagnosing problems, see section <A HREF="manual.html#Access_denied">6.15  Causes of <CODE>Access denied</CODE> errors</A>.  For advice on security issues,
section <A HREF="manual.html#Security">6.2  How to make MySQL secure against crackers</A>.

</P>
<P>
A useful
diagnostic tool is the <CODE>mysqlaccess</CODE> script, which Yves Carlier has
provided for the <STRONG>MySQL</STRONG> distribution.  Invoke <CODE>mysqlaccess</CODE> with
the <CODE>--help</CODE> option to find out how it works.
Note that <CODE>mysqlaccess</CODE> checks access using only the <CODE>user</CODE>,
<CODE>db</CODE> and <CODE>host</CODE> tables.  It does not check table- or column-level
privileges.

</P>


<H2><A NAME="Connection_access" HREF="manual_toc.html#Connection_access">6.9  Access control, stage 1: Connection verification</A></H2>

<P>
When you attempt to connect to a <STRONG>MySQL</STRONG> server, the server accepts or
rejects the connection based on your identity and whether or not you can
verify your identity by supplying the correct password.  If not, the server
denies access to you completely.  Otherwise, the server accepts the
connection, then enters stage 2 and waits for requests.

</P>
<P>
Your identity is based on two pieces of information:

</P>

<UL>
<LI>

The host from which you connect

<LI>

Your <STRONG>MySQL</STRONG> user name
</UL>

<P>
Identity checking is performed using the three <CODE>user</CODE> table scope fields
(<CODE>Host</CODE>, <CODE>User</CODE> and <CODE>Password</CODE>).  The server accepts the
connection only if a <CODE>user</CODE> table entry matches your hostname and user
name, and you supply the correct password.

</P>
<P>
Values in the <CODE>user</CODE> table scope fields may be specified as follows:

</P>

<UL>
<LI>

A <CODE>Host</CODE> value may be a hostname or an IP number, or <CODE>'localhost'</CODE>
to indicate the local host.

<LI>

<A NAME="IDX131"></A>
You can use the wildcard characters <SAMP>`%'</SAMP> and <SAMP>`_'</SAMP> in the <CODE>Host</CODE>
field.

<LI>

A <CODE>Host</CODE> value of <CODE>'%'</CODE> matches any hostname.  A blank <CODE>Host</CODE>
value is equivalent to <CODE>'%'</CODE>.  Note that these values match <EM>any
host that can create a connection to your server!</EM>

<LI>

<A NAME="IDX132"></A>
Wildcard characters are not allowed in the <CODE>User</CODE> field, but you can
specify a blank value, which matches any name.  If the <CODE>user</CODE> table
entry that matches an incoming connection has a blank user name, the user is
considered to be the anonymous user (the user with no name), rather than the
name that the client actually specified.  This means that a blank user name
is used for all further access checking for the duration of the connection
(that is, during stage 2).

<LI>

The <CODE>Password</CODE> field can be blank.  This does not mean that any password
matches, it means the user must connect without specifying a password.
</UL>

<P>
<A NAME="IDX133"></A>
Non-blank <CODE>Password</CODE> values represent encrypted passwords.
<STRONG>MySQL</STRONG> does not store passwords in plaintext form for anyone to see.
Rather, the password supplied by a user who is attempting to connect is
encrypted (using the <CODE>PASSWORD()</CODE> function) and compared to the
already-encrypted version stored in the <CODE>user</CODE> table.  If they match,
the password is correct.

</P>
<P>
The examples below show how various combinations of <CODE>Host</CODE> and
<CODE>User</CODE> values in <CODE>user</CODE> table entries apply to incoming
connections:

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><CODE>Host</CODE> <STRONG>value</STRONG> </TD><TD> <CODE>User</CODE> <STRONG>value</STRONG> </TD><TD> <STRONG>Connections matched by entry</STRONG>
</TR NOSAVE>
<TR><TD><CODE>'thomas.loc.gov'</CODE> </TD><TD> <CODE>'fred'</CODE> </TD><TD> <CODE>fred</CODE>, connecting from <CODE>thomas.loc.gov</CODE>
</TR NOSAVE>
<TR><TD><CODE>'thomas.loc.gov'</CODE> </TD><TD> <CODE>''</CODE> </TD><TD> Any user, connecting from <CODE>thomas.loc.gov</CODE>
</TR NOSAVE>
<TR><TD><CODE>'%'</CODE> </TD><TD> <CODE>'fred'</CODE> </TD><TD> <CODE>fred</CODE>, connecting from any host
</TR NOSAVE>
<TR><TD><CODE>'%'</CODE> </TD><TD> <CODE>''</CODE> </TD><TD> Any user, connecting from any host
</TR NOSAVE>
<TR><TD><CODE>'%.loc.gov'</CODE> </TD><TD> <CODE>'fred'</CODE> </TD><TD> <CODE>fred</CODE>, connecting from any host in the <CODE>loc.gov</CODE> domain
</TR NOSAVE>
<TR><TD><CODE>'x.y.%'</CODE> </TD><TD> <CODE>'fred'</CODE> </TD><TD> <CODE>fred</CODE>, connecting from <CODE>x.y.net</CODE>, <CODE>x.y.com</CODE>,<CODE>x.y.edu</CODE>, etc. (this is probably not useful)
</TR NOSAVE>
<TR><TD><CODE>'144.155.166.177'</CODE> </TD><TD> <CODE>'fred'</CODE> </TD><TD> <CODE>fred</CODE>, connecting from the host with IP address <CODE>144.155.166.177</CODE>
</TR NOSAVE>
<TR><TD><CODE>'144.155.166.%'</CODE> </TD><TD> <CODE>'fred'</CODE> </TD><TD> <CODE>fred</CODE>, connecting from any host in the <CODE>144.155.166</CODE> class C subnet
</TR>
</TABLE>

<P>
Since you can use IP wildcard values in the <CODE>Host</CODE> field (e.g.,
<CODE>'144.155.166.%'</CODE> to match every host on a subnet), there is the
possibility that someone might try to exploit this capability by naming a
host <CODE>144.155.166.somewhere.com</CODE>.  To foil such attempts, <STRONG>MySQL</STRONG>
disallows matching on hostnames that start with digits and a dot. Thus, if
you have a host named something like <CODE>1.2.foo.com</CODE>, its name will never
match the <CODE>Host</CODE> column of the grant tables.  Only an IP number can
match an IP wildcard value.

</P>
<P>
An incoming connection may be matched by more than one entry in the
<CODE>user</CODE> table.  For example, a connection from <CODE>thomas.loc.gov</CODE> by
<CODE>fred</CODE> would be matched by several of the entries just shown above.  How
does the server choose which entry to use if more than one matches?  The
server resolves this question by sorting the <CODE>user</CODE> table after reading
it at startup time, then looking through the entries in sorted order when a
user attempts to connect.  The first matching entry is the one that is used.

</P>
<P>
<CODE>user</CODE> table sorting works as follows.  Suppose the <CODE>user</CODE> table
looks like this:

</P>

<PRE>
+-----------+----------+-
| Host      | User     | ...
+-----------+----------+-
| %         | root     | ...
| %         | jeffrey  | ...
| localhost | root     | ...
| localhost |          | ...
+-----------+----------+-
</PRE>

<P>
When the server reads in the table, it orders the entries with the
most-specific <CODE>Host</CODE> values first (<CODE>'%'</CODE> in the <CODE>Host</CODE> column
means ``any host'' and is least specific).  Entries with the same <CODE>Host</CODE>
value are ordered with the most-specific <CODE>User</CODE> values first (a blank
<CODE>User</CODE> value means ``any user'' and is least specific).  The resulting
sorted <CODE>user</CODE> table looks like this:

</P>

<PRE>
+-----------+----------+-
| Host      | User     | ...
+-----------+----------+-
| localhost | root     | ...
| localhost |          | ...
| %         | jeffrey  | ...
| %         | root     | ...
+-----------+----------+-
</PRE>

<P>
<A NAME="IDX134"></A>
<A NAME="IDX135"></A>
<A NAME="IDX136"></A>
When a connection is attempted, the server looks through the sorted entries
and uses the first match found.  For a connection from <CODE>localhost</CODE> by
<CODE>jeffrey</CODE>, the entries with <CODE>'localhost'</CODE> in the <CODE>Host</CODE> column
match first.  Of those, the entry with the blank user name matches both the
connecting hostname and user name.  (The <CODE>'%'/'jeffrey'</CODE> entry would
have matched, too, but it is not the first match in the table.)

</P>
<P>
Here is another example.  Suppose the <CODE>user</CODE> table looks like this:

</P>

<PRE>
+----------------+----------+-
| Host           | User     | ...
+----------------+----------+-
| %              | jeffrey  | ...
| thomas.loc.gov |          | ...
+----------------+----------+-
</PRE>

<P>
The sorted table looks like this:

</P>

<PRE>
+----------------+----------+-
| Host           | User     | ...
+----------------+----------+-
| thomas.loc.gov |          | ...
| %              | jeffrey  | ...
+----------------+----------+-
</PRE>

<P>
A connection from <CODE>thomas.loc.gov</CODE> by <CODE>jeffrey</CODE> is matched by the
first entry, whereas a connection from <CODE>whitehouse.gov</CODE> by
<CODE>jeffrey</CODE> is matched by the second.

</P>
<P>
A common misconception is to think that for a given user name, all entries
that explicitly name that user will be used first when the server attempts to
find a match for the connection.  This is simply not true.  The previous
example illustrates this, where a connection from <CODE>thomas.loc.gov</CODE> by
<CODE>jeffrey</CODE> is first matched not by the entry containing <CODE>'jeffrey'</CODE>
as the <CODE>User</CODE> field value, but by the entry with no user name!

</P>
<P>
If you have problems connecting to the server, print out the <CODE>user</CODE>
table and sort it by hand to see where the first match is being made.

</P>


<H2><A NAME="Request_access" HREF="manual_toc.html#Request_access">6.10  Access control, stage 2: Request verification</A></H2>

<P>
Once you establish a connection, the server enters stage 2.  For each request
that comes in on the connection, the server checks whether you have
sufficient privileges to perform it, based on the type of operation you wish
to perform.  This is where the privilege fields in the grant tables come into
play.  These privileges can come from any of the <CODE>user</CODE>, <CODE>db</CODE>,
<CODE>host</CODE>, <CODE>tables_priv</CODE> or <CODE>columns_priv</CODE> tables.  The grant
tables are manipulated with <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> commands.
See section <A HREF="manual.html#GRANT">7.26  <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> syntax</A>.  (You may find it helpful to refer to
section <A HREF="manual.html#Privileges">6.8  How the privilege system works</A>, which lists the fields present in each of the grant
tables.)

</P>
<P>
The <CODE>user</CODE> table grants privileges that are assigned to you on a global
basis and that apply no matter what the current database is.  For example, if
the <CODE>user</CODE> table grants you the <STRONG>delete</STRONG> privilege, you can
delete rows from any database on the server host!  In other words,
<CODE>user</CODE> table privileges are superuser privileges.  It is wise to grant
privileges in the <CODE>user</CODE> table only to superusers such as server or
database administrators.  For other users, you should leave the privileges
in the <CODE>user</CODE> table set to <CODE>'N'</CODE> and grant privileges on a
database-specific basis only, using the <CODE>db</CODE> and <CODE>host</CODE> tables.

</P>
<P>
<A NAME="IDX137"></A>
<A NAME="IDX138"></A>
<A NAME="IDX139"></A>
The <CODE>db</CODE> and <CODE>host</CODE> tables grant database-specific privileges.
Values in the scope fields may be specified as follows:

</P>

<UL>
<LI>

The
wildcard characters <SAMP>`%'</SAMP> and <SAMP>`_'</SAMP> can be used in the <CODE>Host</CODE> and
<CODE>Db</CODE> fields of either table.

<LI>

A <CODE>'%'</CODE> <CODE>Host</CODE> value in the <CODE>db</CODE> table means ``any host.'' A
blank <CODE>Host</CODE> value in the <CODE>db</CODE> table means ``consult the
<CODE>host</CODE> table for further information.''

<LI>

A <CODE>'%'</CODE> or blank <CODE>Host</CODE> value in the <CODE>host</CODE> table means ``any
host.''

<LI>

A <CODE>'%'</CODE> or blank <CODE>Db</CODE> value in either table means ``any database.''

<LI>

A blank <CODE>User</CODE> value in either table matches the anonymous user.
</UL>

<P>
<A NAME="IDX140"></A>
<A NAME="IDX141"></A>
<A NAME="IDX142"></A>
<A NAME="IDX143"></A>
The <CODE>db</CODE> and <CODE>host</CODE> tables are read in and sorted when the server
starts up (at the same time that it reads the <CODE>user</CODE> table).  The
<CODE>db</CODE> table is sorted on the <CODE>Host</CODE>, <CODE>Db</CODE> and <CODE>User</CODE> scope
fields, and the <CODE>host</CODE> table is sorted on the <CODE>Host</CODE> and <CODE>Db</CODE>
scope fields.  As with the <CODE>user</CODE> table, sorting puts the most-specific
values first and least-specific values last, and when the server looks for
matching entries, it uses the first match that it finds.

</P>

<P>
<A NAME="IDX144"></A>
<A NAME="IDX145"></A>
The <CODE>tables_priv</CODE> and <CODE>columns_priv</CODE> tables grant table- and
column-specific privileges.  Values in the scope fields may be specified as
follows:

</P>

<UL>
<LI>

The wildcard characters <SAMP>`%'</SAMP> and <SAMP>`_'</SAMP>
can be used in the <CODE>Host</CODE> field of either table.

<LI>

A <CODE>'%'</CODE> or blank <CODE>Host</CODE> value in either table means ``any host.''

<LI>

The <CODE>Db</CODE>, <CODE>Table_name</CODE> and <CODE>Column_name</CODE> fields cannot contain
wildcards or be blank in either table.
</UL>

<P>
The <CODE>tables_priv</CODE> and <CODE>columns_priv</CODE> tables are sorted on
the <CODE>Host</CODE>, <CODE>Db</CODE> and <CODE>User</CODE> fields.  This is similar to
<CODE>db</CODE> table sorting, although since only the <CODE>Host</CODE> field may
contain wildcards, the sorting is simpler.

</P>
<P>
The request verification process is described below.  (If you are familiar
with the access-checking source code, you will notice that the description
here differs slightly from the algorithm used in the code.  The description
is equivalent to what the code actually does; it differs only to make the
explanation simpler.)

</P>
<P>
For administrative requests (<STRONG>shutdown</STRONG>, <STRONG>reload</STRONG>, etc.), the
server checks only the <CODE>user</CODE> table entry, since that is the only table
that specifies administrative privileges.  Access is granted if the entry
allows the requested operation and denied otherwise.  For example, if you
want to execute <CODE>mysqladmin shutdown</CODE> but your <CODE>user</CODE> table entry
doesn't grant the <STRONG>shutdown</STRONG> privilege to you, access is denied
without even checking the <CODE>db</CODE> or <CODE>host</CODE> tables.  (Since they
contain no <CODE>Shutdown_priv</CODE> column, there is no need to do so.)

</P>
<P>
For database-related requests (<STRONG>insert</STRONG>, <STRONG>update</STRONG>, etc.), the
server first checks the user's global (superuser) privileges by looking in
the <CODE>user</CODE> table entry.  If the entry allows the requested operation,
access is granted.  If the global privileges in the <CODE>user</CODE> table are
insufficient, the server determines the user's database-specific privileges
by checking the <CODE>db</CODE> and <CODE>host</CODE> tables:

</P>

<OL>
<LI>

The server looks in the <CODE>db</CODE> table for a match on the <CODE>Host</CODE>,
<CODE>Db</CODE> and <CODE>User</CODE> fields.  <CODE>Host</CODE> and <CODE>User</CODE> are matched to
the connecting user's hostname and <STRONG>MySQL</STRONG> user name.  The <CODE>Db</CODE>
field is matched to the database the user wants to access.  If there is no
entry for the <CODE>Host</CODE> and <CODE>User</CODE>, access is denied.

<LI>

If there is a matching <CODE>db</CODE> table entry and its <CODE>Host</CODE> field is
not blank, that entry defines the user's database-specific privileges.

<LI>

If the matching <CODE>db</CODE> table entry's <CODE>Host</CODE> field is blank, it
signifies that the <CODE>host</CODE> table enumerates which hosts should be allowed
access to the database.  In this case, a further lookup is done in the
<CODE>host</CODE> table to find a match on the <CODE>Host</CODE> and <CODE>Db</CODE> fields.
If no <CODE>host</CODE> table entry matches, access is denied.  If there is a
match, the user's database-specific privileges are computed as the
intersection (<EM>not</EM> the union!) of the privileges in the <CODE>db</CODE> and
<CODE>host</CODE> table entries, i.e., the privileges that are <CODE>'Y'</CODE> in both
entries.  (This way you can grant general privileges in the <CODE>db</CODE> table
entry and then selectively restrict them on a host-by-host basis using the
<CODE>host</CODE> table entries.)
</OL>

<P>
After determining the database-specific privileges granted by the <CODE>db</CODE>
and <CODE>host</CODE> table entries, the server adds them to the global privileges
granted by the <CODE>user</CODE> table.  If the result allows the requested
operation, access is granted.  Otherwise, the server checks the user's
table and column privileges in the <CODE>tables_priv</CODE> and <CODE>columns_priv</CODE>
tables and adds those to the user's privileges.  Access is allowed or denied
based on the result.

</P>
<P>
Expressed in boolean terms, the preceding description of how a user's
privileges are calculated may be summarized like this:

</P>

<PRE>
global privileges
OR (database privileges AND host privileges)
OR table privileges
OR column privileges
</PRE>

<P>
It may not be apparent why, if the global <CODE>user</CODE> entry privileges are
initially found to be insufficient for the requested operation, the server
adds those privileges to the database-, table- and column-specific privileges
later. The reason is that a request might require more than one type of
privilege.  For example, if you execute an <CODE>INSERT ...  SELECT</CODE>
statement, you need both <STRONG>insert</STRONG> and <STRONG>select</STRONG> privileges.
Your privileges might be such that the <CODE>user</CODE> table entry grants one
privilege and the <CODE>db</CODE> table entry grants the other.  In this case, you
have the necessary privileges to perform the request, but the server cannot
tell that from either table by itself; the privileges granted by both entries
must be combined.

</P>
<P>
The <CODE>host</CODE> table can be used to maintain a list of ``secure'' servers.
At TcX, the <CODE>host</CODE> table contains a list of all machines on the local
network. These are granted all privileges.

</P>
<P>
You can also use the <CODE>host</CODE> table to indicate hosts that are <EM>not</EM>
secure.  Suppose you have a machine <CODE>public.your.domain</CODE> that is located
in a public area that you do not consider secure.  You can allow access to
all hosts on your network except that machine by using <CODE>host</CODE> table
entries
like this:

</P>

<PRE>
+--------------------+----+-
| Host               | Db | ...
+--------------------+----+-
| public.your.domain | %  | ... (all privileges set to 'N')
| %.your.domain      | %  | ... (all privileges set to 'Y')
+--------------------+----+-
</PRE>

<P>
Naturally, you should always test your entries in the grant tables (e.g.,
using <CODE>mysqlaccess</CODE>) to make sure your access privileges are actually
set up the way you think they are.

</P>


<H2><A NAME="Privilege_changes" HREF="manual_toc.html#Privilege_changes">6.11  When privilege changes take effect</A></H2>

<P>
When <CODE>mysqld</CODE> starts, all grant table contents are read into memory and
become effective at that point.

</P>
<P>
Modifications to the grant tables that you perform using <CODE>GRANT</CODE>,
<CODE>REVOKE</CODE>, or <CODE>SET PASSWORD</CODE> are noticed by the server immediately.

</P>
<P>
If you modify the grant tables manually (using <CODE>INSERT</CODE>, <CODE>UPDATE</CODE>,
etc.), you should execute a <CODE>FLUSH PRIVILEGES</CODE> statement or run
<CODE>mysqladmin flush-privileges</CODE> to tell the server to reload the grant
tables.  Otherwise your changes will have <EM>no effect</EM> until
you restart the server.

</P>
<P>
When the server notices that the grant tables have been changed,
existing client connections are affected as follows:

</P>

<UL>
<LI>

Table and column privilege changes take effect with the client's next
request.

<LI>

Database privilege changes take effect at the next <CODE>USE db_name</CODE>
command.
</UL>

<P>
Global privilege changes and password changes take effect the next time the
client connects.

</P>


<H2><A NAME="Default_privileges" HREF="manual_toc.html#Default_privileges">6.12  Setting up the initial MySQL privileges</A></H2>

<P>
After installing <STRONG>MySQL</STRONG>, you set up the initial access privileges by
running <CODE>scripts/mysql_install_db</CODE>.
See section <A HREF="manual.html#Quick_install">4.7.1  Quick installation overview</A>.
The <CODE>scripts/mysql_install_db</CODE> script starts up the <CODE>mysqld</CODE>
server, then initializes the grant tables to contain the following set
of privileges:

</P>

<UL>
<LI>

The <STRONG>MySQL</STRONG> <CODE>root</CODE> user is created as a superuser who can do
anything.  Connections must be made from the local host.

<STRONG>Note:</STRONG>
The initial <CODE>root</CODE> password is empty, so anyone can connect as <CODE>root</CODE>
<EM>without a password</EM> and be granted all privileges.

<LI>

<A NAME="IDX146"></A>
An anonymous user is created that can do anything with databases that have a
name of <CODE>'test'</CODE> or starting with <CODE>'test_'</CODE>.  Connections must be
made from the local host.  This means any local user can connect and be
treated as the anonymous user.

<LI>

Other privileges are denied.  For example, normal users can't use
<CODE>mysqladmin shutdown</CODE> or <CODE>mysqladmin processlist</CODE>.
</UL>

<P>
<STRONG>Note:</STRONG> The default privileges are different for Win32.
See section <A HREF="manual.html#Win32_running">4.12.4  Running MySQL on Win32</A>.

</P>
<P>
Since your installation is initially wide open, one of the first things you
should do is specify a password for the <STRONG>MySQL</STRONG>
<CODE>root</CODE> user.  You can do this as follows (note that you specify the
password using the <CODE>PASSWORD()</CODE> function):

</P>

<PRE>
shell&#62; mysql -u root mysql
mysql&#62; UPDATE user SET Password=PASSWORD('new_password')
           WHERE user='root';
mysql&#62; FLUSH PRIVILEGES;
</PRE>

<P>
You can in <STRONG>MySQL</STRONG> 3.22 and above use the <CODE>SET PASSWORD</CODE> statement:

</P>

<PRE>
shell&#62; mysql -u root mysql
mysql&#62; SET PASSWORD FOR root=PASSWORD('new_password');
</PRE>

<P>
Another way to set the password is by using the <CODE>mysqladmin</CODE> command:

</P>

<PRE>
shell&#62; mysqladmin -u root password new_password
</PRE>

<P>
Note that if you update the password in the <CODE>user</CODE> table directly using
the first method, you must tell the server to reread the grant tables (with
<CODE>FLUSH PRIVILEGES</CODE>), since the change will go unnoticed otherwise.

</P>
<P>
Once the <CODE>root</CODE> password has been set, thereafter you must supply that
password when you connect to the server as <CODE>root</CODE>.

</P>
<P>
You may wish to leave the <CODE>root</CODE> password blank so that you don't need
to specify it while you perform additional setup or testing, but be sure to
set it before using your installation for any real production work.

</P>
<P>
See the <CODE>scripts/mysql_install_db</CODE> script to see how it sets up
the default privileges.  You can use this as a basis to see how to
add other users.

</P>
<P>
If you want the initial privileges to be different than those just described
above, you can modify <CODE>mysql_install_db</CODE> before you run it.

</P>
<P>
To recreate the grant tables completely, remove all the <TT>`*.frm'</TT>,
<TT>`*.MYI'</TT> and <TT>`*.MYD'</TT> files in the directory containing the
<CODE>mysql</CODE> database.  (This is the directory named <TT>`mysql'</TT> under
the database directory, which is listed when you run <CODE>mysqld
--help</CODE>.) Then run the <CODE>mysql_install_db</CODE> script, possibly after
editing it first to have the privileges you want.

</P>
<P>
<STRONG>NOTE:</STRONG> For <STRONG>MySQL</STRONG> versions older than 3.22.10, you should NOT
delete the <TT>`*.frm'</TT> files.  If you accidentally do this, you should
copy them back from your <STRONG>MySQL</STRONG> distribution before running
<CODE>mysql_install_db</CODE>.

</P>


<H2><A NAME="Adding_users" HREF="manual_toc.html#Adding_users">6.13  Adding new user privileges to MySQL</A></H2>

<P>
You can add users two different ways: by using <CODE>GRANT</CODE> statements
or by manipulating the <STRONG>MySQL</STRONG> grant tables directly.  The
preferred method is to use <CODE>GRANT</CODE> statements, because they are
more concise and less error-prone.

</P>
<P>
The examples below show how to use the <CODE>mysql</CODE> client to set up new
users.  These examples assume that privileges are set up according to the
defaults described in the previous section.  This means that to make changes,
you must be on the same machine where <CODE>mysqld</CODE> is running, you must
connect as the <STRONG>MySQL</STRONG> <CODE>root</CODE> user, and the <CODE>root</CODE> user must
have the <STRONG>insert</STRONG> privilege for the <CODE>mysql</CODE> database and the
<STRONG>reload</STRONG> administrative privilege.  Also, if you have changed the
<CODE>root</CODE> user password, you must specify it for the <CODE>mysql</CODE> commands
below.

</P>
<P>
You can add new users by issuing <CODE>GRANT</CODE> statements:

</P>

<PRE>
shell&#62; mysql --user=root mysql
mysql&#62; GRANT ALL PRIVILEGES ON *.* TO monty@localhost
           IDENTIFIED BY 'something' WITH GRANT OPTION;
mysql&#62; GRANT ALL PRIVILEGES ON *.* TO monty@"%"
           IDENTIFIED BY 'something' WITH GRANT OPTION;
mysql&#62; GRANT RELOAD,PROCESS ON *.* TO admin@localhost;
mysql&#62; GRANT USAGE ON *.* TO dummy@localhost;
</PRE>

<P>
These <CODE>GRANT</CODE> statements set up three new users:

</P>
<DL COMPACT>

<DT><CODE>monty</CODE>
<DD>
A full superuser who can connect to the server from anywhere, but who must
use a password (<CODE>'something'</CODE> to do so.  Note that we must issue
<CODE>GRANT</CODE> statements for both <CODE>monty@localhost</CODE> and
<CODE>monty@"%"</CODE>.  If we don't add the entry with <CODE>localhost</CODE>, the
anonymous user entry for <CODE>localhost</CODE> that is created by
<CODE>mysql_install_db</CODE> will take precedence when we connect from the local
host, because it has a more specific <CODE>Host</CODE> field value and thuse comes
earlier in the <CODE>user</CODE> table sort order.

<DT><CODE>admin</CODE>
<DD>
A user who can connect from <CODE>localhost</CODE> without a password and who is
granted the <STRONG>reload</STRONG> and <STRONG>process</STRONG> administrative privileges.
This allows the user to execute the <CODE>mysqladmin reload</CODE>,
<CODE>mysqladmin refresh</CODE> and <CODE>mysqladmin flush-*</CODE> commands, as well as
<CODE>mysqladmin processlist</CODE> .  No database-related privileges are granted.
They can be granted later by issuing additional <CODE>GRANT</CODE> statements.

<DT><CODE>dummy</CODE>
<DD>
A user who can connect without a password, but only from the local host.  The
global privileges are all set to <CODE>'N'</CODE> -- the <CODE>USAGE</CODE> privilege
type allows you to set up a user with no privileges.  It is assumed that you
will grant database-specific privileges later.
</DL>

<P>
You can also add the same user access information directly by issuing
<CODE>INSERT</CODE> statements and then telling the server to reload the grant
tables:

</P>

<PRE>
shell&#62; mysql --user=root mysql
mysql&#62; INSERT INTO user VALUES('localhost','monty',PASSWORD('something'),
                'Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y')
mysql&#62; INSERT INTO user VALUES('%','monty',PASSWORD('something'),
                'Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y')
mysql&#62; INSERT INTO user SET Host='localhost',User='admin',
                 Reload_priv='Y', Process_priv='Y';
mysql&#62; INSERT INTO user (Host,User,Password)
                        VALUES('localhost','dummy','');
mysql&#62; FLUSH PRIVILEGES;
</PRE>

<P>
Depending on your <STRONG>MySQL</STRONG> version, you may have to use a different
number of <CODE>'Y'</CODE> values above (versions prior to 3.22.11 had fewer
privilege columns).  For the <CODE>admin</CODE> user, the more readable extended
<CODE>INSERT</CODE> syntax that is available starting with 3.22.11 is used.

</P>
<P>
Note that to set up a superuser, you need only create a <CODE>user</CODE> table
entry with the privilege fields set to <CODE>'Y'</CODE>.  No <CODE>db</CODE> or
<CODE>host</CODE> table entries are necessary.

</P>
<P>
The privilege columns in the <CODE>user</CODE> table were not set explicitly in the
last <CODE>INSERT</CODE> statement (for the <CODE>dummy</CODE> user), so those columns
are assigned the default value of <CODE>'N'</CODE>.  This is the same thing that
<CODE>GRANT USAGE</CODE> does.

</P>
<P>
The following example adds a user <CODE>custom</CODE> who can connect from hosts
<CODE>localhost</CODE>, <CODE>server.domain</CODE> and <CODE>whitehouse.gov</CODE>.  He wants
to access the <CODE>bankaccount</CODE> database only from <CODE>localhost</CODE>,
the <CODE>expenses</CODE> database only from <CODE>whitehouse.gov</CODE> and
the <CODE>customer</CODE> database from all three hosts.  He wants
to use the password <CODE>stupid</CODE> from all three hosts.

</P>
<P>
To set up this user's privileges using <CODE>GRANT</CODE> statements, run these
commands:

</P>

<PRE>
shell&#62; mysql --user=root mysql
mysql&#62; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP
           ON bankaccount.*
           TO custom@localhost
           IDENTIFIED BY 'stupid';
mysql&#62; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP
           ON expenses.*
           TO custom@whitehouse.gov
           IDENTIFIED BY 'stupid';
mysql&#62; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP
           ON customer.*
           TO custom@'%'
           IDENTIFIED BY 'stupid';
</PRE>

<P>
To set up the user's privileges by modifying the grant tables directly,
run these commands (note the <CODE>FLUSH PRIVILEGES</CODE> at the end):

</P>

<PRE>
shell&#62; mysql --user=root mysql
mysql&#62; INSERT INTO user (Host,User,Password)
       VALUES('localhost','custom',PASSWORD('stupid'));
mysql&#62; INSERT INTO user (Host,User,Password)
       VALUES('server.domain','custom',PASSWORD('stupid'));
mysql&#62; INSERT INTO user (Host,User,Password)
       VALUES('whitehouse.gov','custom',PASSWORD('stupid'));
mysql&#62; INSERT INTO db
       (Host,Db,User,Select_priv,Insert_priv,Update_priv,Delete_priv,
        Create_priv,Drop_priv)
       VALUES
       ('localhost','bankaccount','custom','Y','Y','Y','Y','Y','Y');
mysql&#62; INSERT INTO db
       (Host,Db,User,Select_priv,Insert_priv,Update_priv,Delete_priv,
        Create_priv,Drop_priv)
       VALUES
       ('whitehouse.gov','expenses','custom','Y','Y','Y','Y','Y','Y');
mysql&#62; INSERT INTO db
       (Host,Db,User,Select_priv,Insert_priv,Update_priv,Delete_priv,
        Create_priv,Drop_priv)
       VALUES('%','customer','custom','Y','Y','Y','Y','Y','Y');
mysql&#62; FLUSH PRIVILEGES;
</PRE>

<P>
The first three <CODE>INSERT</CODE> statements add <CODE>user</CODE> table entries that
allow user <CODE>custom</CODE> to connect from the various hosts with the given
password, but grant no permissions to him (all privileges are set to the
default value of <CODE>'N'</CODE>).  The next three <CODE>INSERT</CODE> statements add
<CODE>db</CODE> table entries that grant privileges to <CODE>custom</CODE> for the
<CODE>bankaccount</CODE>, <CODE>expenses</CODE> and <CODE>customer</CODE> databases, but only
when accessed from the proper hosts.  As usual, when the grant tables are
modified directly, the server must be told to reload them (with
<CODE>FLUSH PRIVILEGES</CODE>) so that the privilege changes take effect.

</P>
<P>
If you want to give a specific user access from any machine in a given
domain, you can issue a <CODE>GRANT</CODE> statement like the following:

</P>

<PRE>
mysql&#62; GRANT ...
           ON *.*
           TO myusername@"%.mydomainname.com"
           IDENTIFIED BY 'mypassword';
</PRE>

<P>
To do the same thing by modifying the grant tables directly, do this:

</P>

<PRE>
mysql&#62; INSERT INTO user VALUES ('%.mydomainname.com', 'myusername',
           PASSWORD('mypassword'),...);
mysql&#62; FLUSH PRIVILEGES;
</PRE>

<P>
You can also use <CODE>xmysqladmin</CODE>, <CODE>mysql_webadmin</CODE> and even
<CODE>xmysql</CODE> to insert, change and update values in the grant tables.
You can find these utilities at the <STRONG>MySQL</STRONG>
<a HREF="http://www.mysql.com/Contrib/">Contrib directory</a>.

</P>


<H2><A NAME="Passwords" HREF="manual_toc.html#Passwords">6.14  How to set up passwords</A></H2>
<P>
<A NAME="IDX147"></A>
<A NAME="IDX148"></A>

</P>
<P>
The examples in the preceding sections illustrate an important principle:
when you store a non-empty password using <CODE>INSERT</CODE> or <CODE>UPDATE</CODE>
statements, you must use the <CODE>PASSWORD()</CODE> function to encrypt it.  This
is because the <CODE>user</CODE> table stores passwords in encrypted form, not as
plaintext.  If you forget that fact, you are likely to attempt to set
passwords like this:

</P>

<PRE>
shell&#62; mysql -u root mysql
mysql&#62; INSERT INTO user (Host,User,Password)
       VALUES('%','jeffrey','biscuit');
mysql&#62; FLUSH PRIVILEGES;
</PRE>

<P>
The result is that the plaintext value <CODE>'biscuit'</CODE> is stored as the
password in the <CODE>user</CODE> table.  When the user <CODE>jeffrey</CODE> attempts to
connect to the server using this password, the <CODE>mysql</CODE> client encrypts
it with <CODE>PASSWORD()</CODE> and sends the result to the server.  The server
compares the value in the <CODE>user</CODE> table (which is the plaintext value
<CODE>'biscuit'</CODE>) to the encrypted password (which is <EM>not</EM>
<CODE>'biscuit'</CODE>).  The comparison fails and the server rejects the
connection:

</P>

<PRE>
shell&#62; mysql -u jeffrey -pbiscuit test
Access denied
</PRE>

<P>
Since passwords must be encrypted when they are inserted in the <CODE>user</CODE>
table, the <CODE>INSERT</CODE> statement should have been specified like this
instead:

</P>

<PRE>
mysql&#62; INSERT INTO user (Host,User,Password)
       VALUES('%','jeffrey',PASSWORD('biscuit'));
</PRE>

<P>
You must also use the <CODE>PASSWORD()</CODE> function when you use <CODE>SET
PASSWORD</CODE> statements:

</P>

<PRE>
mysql&#62; SET PASSWORD FOR jeffrey@"%" = PASSWORD('biscuit');
</PRE>

<P>
If you set passwords using the <CODE>GRANT ... IDENTIFIED BY</CODE> statement
or the <CODE>mysqladmin password</CODE> command, the <CODE>PASSWORD()</CODE> function
is unnecessary.  They both take care of encrypting the password for you,
so you would specify a password of <CODE>'biscuit'</CODE> like this:

</P>

<PRE>
mysql&#62; GRANT USAGE ON *.* TO jeffrey@"%" IDENTIFIED BY 'biscuit';
</PRE>

<P>
or

</P>

<PRE>
shell&#62; mysqladmin -u jeffrey password biscuit
</PRE>

<P>
Note: <CODE>PASSWORD()</CODE> does not perform password encryption in the same way
that Unix passwords are encrypted.  You should not assume that if your Unix
password and your <STRONG>MySQL</STRONG> password are the same, <CODE>PASSWORD()</CODE>
will result in the same encrypted value as is stored in the Unix password
file.
See section <A HREF="manual.html#User_names">6.4  MySQL user names and passwords</A>.

</P>


<H2><A NAME="Access_denied" HREF="manual_toc.html#Access_denied">6.15  Causes of <CODE>Access denied</CODE> errors</A></H2>

<P>
If you encounter <CODE>Access denied</CODE> errors when you try to connect to the
<STRONG>MySQL</STRONG> server, the list below indicates some courses of
action you can take to correct the problem:

</P>

<UL>
<LI>

Did you run the <CODE>mysql_install_db</CODE> script after installing
<STRONG>MySQL</STRONG>, to set up the initial grant table contents?  If not, do
so.  See section <A HREF="manual.html#Default_privileges">6.12  Setting up the initial MySQL privileges</A>.  Test the initial privileges by
executing this command:


<PRE>
shell&#62; mysql -u root test
</PRE>

The server should let you connect without error.  You should also make sure
you have a file <TT>`user.MYD'</TT> in the <STRONG>MySQL</STRONG> database directory.
Ordinarily, this is <TT>`PATH/var/mysql/user.MYD'</TT>, where <CODE>PATH</CODE> is the
pathname to the <STRONG>MySQL</STRONG> installation root.

<LI>

After a fresh installation, you should connect to the server and set up
your users and their access permissions:


<PRE>
shell&#62; mysql -u root mysql
</PRE>

The server should let you connect because the <STRONG>MySQL</STRONG> <CODE>root</CODE> user
has no password initially.  Since that is also a security risk, setting the
<CODE>root</CODE> password is something you should do while you're setting up
your other <STRONG>MySQL</STRONG> users.

If you try to connect as <CODE>root</CODE> and get this error:


<PRE>
Access denied for user: '@unknown' to database mysql
</PRE>

this means that you don't have an entry in the <CODE>user</CODE> table with a
<CODE>User</CODE> column value of <CODE>'root'</CODE> and that <CODE>mysqld</CODE> cannot
resolve the hostname for your client.  In this case, you must restart the
server with the <CODE>--skip-grant-tables</CODE> option and edit your
<TT>`/etc/hosts'</TT> or <TT>`\windows\hosts'</TT> file to add a entry for your
host.

<LI>

<A NAME="IDX149"></A>
If you updated an existing <STRONG>MySQL</STRONG> installation from a pre-3.22.11
version to 3.22.11 or later, did you run the
<CODE>mysql_fix_privilege_tables</CODE> script?  If not, do so.  The structure of
the grant tables changed with <STRONG>MySQL</STRONG> 3.22.11 when the <CODE>GRANT</CODE>
statement became functional.

<LI>

If you make changes to the grant tables directly (using <CODE>INSERT</CODE> or
<CODE>UPDATE</CODE> statement) and your changes seem to be ignored, remember that
you must issue a <CODE>FLUSH PRIVILEGES</CODE> statement or execute a
<CODE>mysqladmin flush-privileges</CODE> command to cause the server to reread the
tables.  Otherwise your changes have no effect until the next time the server
is restarted.  Remember that after you set the <CODE>root</CODE> password, you
won't need to specify it until after you flush the privileges, because the
server still won't know you've changed the password yet!

<LI>

If your privileges seem to have changed in the middle of a session, it may be
that a superuser has changed them.  Reloading the grant tables affects new
client connections, but it also affects existing connections as indicated in
section <A HREF="manual.html#Privilege_changes">6.11  When privilege changes take effect</A>.

<LI>

For testing, start the <CODE>mysqld</CODE> daemon with the
<CODE>--skip-grant-tables</CODE> option.  Then you can change the <STRONG>MySQL</STRONG>
grant tables and use the <CODE>mysqlaccess</CODE> script to check whether or not
your modifications have the desired effect.  When you are satisfied with your
changes, execute <CODE>mysqladmin flush-privileges</CODE> to tell the <CODE>mysqld</CODE>
server to start using the new grant tables.  <STRONG>Note:</STRONG> Reloading the
grant tables overrides the <CODE>--skip-grant-tables</CODE> option.  This allows
you to tell the server to begin using the grant tables again without bringing
it down and restarting it.

<LI>

If you have access problems with a Perl, Python or ODBC program, try to
connect to the server with <CODE>mysql -u user_name db_name</CODE> or <CODE>mysql
-u user_name -pyour_pass db_name</CODE>.  If you are able to connect using the
<CODE>mysql</CODE> client, there is a problem with your program and not with the
access privileges.  (Notice that there is no space between <CODE>-p</CODE> and the
password; you can also use the <CODE>--password=your_pass</CODE> syntax to specify
the password.)

<LI>

If you can't get your password to work, remember that you must use
the <CODE>PASSWORD()</CODE> function if you set the password with the
<CODE>INSERT</CODE>, <CODE>UPDATE</CODE> or <CODE>SET PASSWORD</CODE> statements.  The
<CODE>PASSWORD()</CODE> function is unnecessary if you specify the password using
the <CODE>GRANT ... INDENTIFIED BY</CODE> statement or the <CODE>mysqladmin
password</CODE> command.
See section <A HREF="manual.html#Passwords">6.14  How to set up passwords</A>.

<LI>

<CODE>localhost</CODE> is a synonym for your local hostname, and is also the
default host to which clients try to connect if you specify no host
explicitly.  However, connections to <CODE>localhost</CODE> do not work if you are
running on a system that uses MIT-pthreads (<CODE>localhost</CODE> connections are
made using Unix sockets, which are not supported by MIT-pthreads).  To avoid
this problem on such systems, you should use the <CODE>--host</CODE> option to name
the server host explicitly.  This will make a TCP/IP connection to the
<CODE>mysqld</CODE> server.  In this case, you must have your real hostname in
<CODE>user</CODE> table entries on the server host.  (This is true even if you are
running a client program on the same host as the server.)

<LI>

If you get an <CODE>Access denied</CODE> error when trying to connect to the
database with <CODE>mysql -u user_name db_name</CODE>, you may have a problem
with the <CODE>user</CODE> table. Check this by executing <CODE>mysql -u root
mysql</CODE> and issuing this SQL statement:


<PRE>
mysql&#62; SELECT * FROM user;
</PRE>

The result should include an entry with the <CODE>Host</CODE> and <CODE>User</CODE>
columns matching your computer's hostname and your <STRONG>MySQL</STRONG> user name.

<LI>

The <CODE>Access denied</CODE> error message will tell you who you are trying
to log in as, the host from which you are trying to connect, and whether
or not you were using a password. Normally, you should have one entry in
the <CODE>user</CODE> table that exactly matches the hostname and user name
that were given in the error message.

<LI>

If you get the following error when you try to connect from a different host
than the one on which the <STRONG>MySQL</STRONG> server is running, then there is no
row in the <CODE>user</CODE> table that matches that host:


<PRE>
Host ... is not allowed to connect to this MySQL server
</PRE>

You can fix this by using the command line tool <CODE>mysql</CODE> (on the server
host!) to add a row to the <CODE>user</CODE> table for the user/hostname combination
from which you are trying to connect.  If you are not running <STRONG>MySQL</STRONG>
3.22 and you don't know the IP number or hostname of the machine from which
you are connecting, you should put an entry with <CODE>'%'</CODE> as the
<CODE>Host</CODE> column value in the <CODE>user</CODE> table and restart <CODE>mysqld</CODE>
with the <CODE>--log</CODE> option on the server machine.  After trying to connect
from the client machine, the information in the <STRONG>MySQL</STRONG> log will
indicate how you really did connect.  (Then replace the <CODE>'%'</CODE> in the
<CODE>user</CODE> table entry with the actual hostname that shows up in the log.
Otherwise, you'll have a system that is insecure.)

<LI>

If <CODE>mysql -u root test</CODE> works but <CODE>mysql -h your_hostname -u root
test</CODE> results in <CODE>Access denied</CODE>, then you may not have the correct name
for your host in the <CODE>user</CODE> table.  A common problem here is that the
<CODE>Host</CODE> value in the user table entry specifies an unqualified hostname,
but your system's name resolution routines return a fully-qualified domain
name (or vice-versa).  For example, if you have an entry with host
<CODE>'tcx'</CODE> in the <CODE>user</CODE> table, but your DNS tells <STRONG>MySQL</STRONG> that
your hostname is <CODE>'tcx.subnet.se'</CODE>, the entry will not work. Try adding
an entry to the <CODE>user</CODE> table that contains the IP number of your host as
the <CODE>Host</CODE> column value.  (Alternatively, you could add an entry to the
<CODE>user</CODE> table with a <CODE>Host</CODE> value that contains a wildcard--for
example, <CODE>'tcx.%'</CODE>.  However, use of hostnames ending with <SAMP>`%'</SAMP> is
<EM>insecure</EM> and is <EM>not</EM> recommended!)

<LI>

If <CODE>mysql -u user_name test</CODE> works but <CODE>mysql -u user_name
other_db_name</CODE> doesn't work, you don't have an entry for <CODE>other_db_name</CODE>
listed in the <CODE>db</CODE> table.

<LI>

If <CODE>mysql -u user_name db_name</CODE> works when executed on the server
machine, but <CODE>mysql -u host_name -u user_name db_name</CODE> doesn't work when
executed on another client machine, you don't have the client machine listed
in the <CODE>user</CODE> table or the <CODE>db</CODE> table.

<LI>

If you can't figure out why you get <CODE>Access denied</CODE>, remove from the
<CODE>user</CODE> table all entries that have <CODE>Host</CODE> values containing
wildcards (entries that contain <SAMP>`%'</SAMP> or <SAMP>`_'</SAMP>).  A very common error
is to insert a new entry with <CODE>Host</CODE>=<CODE>'%'</CODE> and
<CODE>User</CODE>=<CODE>'some user'</CODE>, thinking that this will allow you to specify
<CODE>localhost</CODE> to connect from the same machine.  The reason that this
doesn't work is that the default privileges include an entry with
<CODE>Host</CODE>=<CODE>'localhost'</CODE> and <CODE>User</CODE>=<CODE>''</CODE>.  Since that entry
has a <CODE>Host</CODE> value <CODE>'localhost'</CODE> that is more specific than
<CODE>'%'</CODE>, it is used in preference to the new entry when connecting from
<CODE>localhost</CODE>!  The correct procedure is to insert a second entry with
<CODE>Host</CODE>=<CODE>'localhost'</CODE> and <CODE>User</CODE>=<CODE>'some_user'</CODE>, or to
remove the entry with with <CODE>Host</CODE>=<CODE>'localhost'</CODE> and
<CODE>User</CODE>=<CODE>''</CODE>.

<LI>

If you get the following error, you may have a problem with the <CODE>db</CODE> or
<CODE>host</CODE> table:


<PRE>
Access to database denied
</PRE>

If the entry selected from the <CODE>db</CODE> table has an empty value in the
<CODE>Host</CODE> column, make sure there are one or more corresponding entries in
the <CODE>host</CODE> table specifying which hosts the <CODE>db</CODE> table entry
applies to.

If you get the error when using the SQL commands <CODE>SELECT ...
INTO OUTFILE</CODE> or <CODE>LOAD DATA INFILE</CODE>, your entry in the <CODE>user</CODE> table
probably doesn't have the <STRONG>file</STRONG> privilege enabled.

<LI>

<A NAME="IDX150"></A>
<A NAME="IDX151"></A>
<A NAME="IDX152"></A>
Remember that client programs will use connection parameters specified in
configuration files or environment variables.  If a client seems to be
sending the wrong default connection parameters when you don't specify them
on the command line, check your environment and the <TT>`.my.cnf'</TT> file in
your home directory.  You might also check the system-wide <STRONG>MySQL</STRONG>
configuration files, though it is far less likely that client connection
parameters will be specified there. See section <A HREF="manual.html#Option_files">4.15.4  Option files</A>.  If you get
<CODE>Access denied</CODE> when you run a client without any options, make sure you
haven't specified an old password in any of your option files!
See section <A HREF="manual.html#Option_files">4.15.4  Option files</A>.

<LI>

If everything else fails, start the <CODE>mysqld</CODE> daemon with a debugging
option (for example, <CODE>--debug=d,general,query</CODE>). This will print host and
user information about attempted connections, as well as information about
each command issued. See section <A HREF="manual.html#Debugging_server">G.1  Debugging a MySQL server</A>.

<LI>

If you have any other problems with the <STRONG>MySQL</STRONG> grant tables and
feel you must post the problem to the mailing list, always provide a
dump of the <STRONG>MySQL</STRONG> grant tables. You can dump the tables with
the <CODE>mysqldump mysql</CODE> command. As always, post your problem using
the <CODE>mysqlbug</CODE> script.  In some cases you may restart <CODE>mysqld</CODE> with
<CODE>--skip-grant-tables</CODE> to be able to run <CODE>mysqldump</CODE>.
</UL>



<H1><A NAME="Reference" HREF="manual_toc.html#Reference">7  MySQL language reference</A></H1>

<P>
<A NAME="IDX153"></A>
<A NAME="IDX154"></A>


<H2><A NAME="Literals" HREF="manual_toc.html#Literals">7.1  Literals: how to write strings and numbers</A></H2>



<H3><A NAME="String_syntax" HREF="manual_toc.html#String_syntax">7.1.1  Strings</A></H3>

<P>
A string is a sequence of characters, surrounded by either single quote
(<SAMP>`''</SAMP>) or double quote (<SAMP>`"'</SAMP>) characters (the later only if you
don't run in ANSI mode).  Examples:

</P>

<PRE>
'a string'
"another string"
</PRE>

<P>
Within a string, certain sequences have special meaning.  Each of these
sequences begins with a backslash (<SAMP>`\'</SAMP>), known as the <EM>escape
character</EM>.  <STRONG>MySQL</STRONG> recognizes the following escape sequences:

</P>
<DL COMPACT>

<DT><CODE>\0</CODE>
<DD>
<A NAME="IDX155"></A>
 <A NAME="IDX156"></A>
 
An ASCII 0 (<CODE>NUL</CODE>) character.

<A NAME="IDX157"></A>
<A NAME="IDX158"></A>
<DT><CODE>\n</CODE>
<DD>
A newline character.

<A NAME="IDX159"></A>
<A NAME="IDX160"></A>
<DT><CODE>\t</CODE>
<DD>
A tab character.

<A NAME="IDX161"></A>
<A NAME="IDX162"></A>
<A NAME="IDX163"></A>
<DT><CODE>\r</CODE>
<DD>
A carriage return character.

<A NAME="IDX164"></A>
<A NAME="IDX165"></A>
<DT><CODE>\b</CODE>
<DD>
A backspace character.

<A NAME="IDX166"></A>
<A NAME="IDX167"></A>
<DT><CODE>\'</CODE>
<DD>
A single quote (<SAMP>`''</SAMP>) character.

<A NAME="IDX168"></A>
<A NAME="IDX169"></A>
<DT><CODE>\"</CODE>
<DD>
A double quote (<SAMP>`"'</SAMP>) character.

<A NAME="IDX170"></A>
<A NAME="IDX171"></A>
<DT><CODE>\\</CODE>
<DD>
A backslash (<SAMP>`\'</SAMP>) character.

<A NAME="IDX172"></A>
<A NAME="IDX173"></A>
<DT><CODE>\%</CODE>
<DD>
A <SAMP>`%'</SAMP> character. This is used to search for literal instances of
<SAMP>`%'</SAMP> in contexts where <SAMP>`%'</SAMP> would otherwise be interpreted
as a wildcard character.

<A NAME="IDX174"></A>
<A NAME="IDX175"></A>
<DT><CODE>\_</CODE>
<DD>
A <SAMP>`_'</SAMP> character. This is used to search for literal instances of
<SAMP>`_'</SAMP> in contexts where <SAMP>`_'</SAMP> would otherwise be interpreted
as a wildcard character.
</DL>

<P>
Note that if you use <SAMP>`\%'</SAMP> or <SAMP>`\%_'</SAMP> in some string contexts, these
will return the strings <SAMP>`\%'</SAMP> and <SAMP>`\_'</SAMP> and not <SAMP>`%'</SAMP> and
<SAMP>`_'</SAMP>.

</P>
<P>
There are several ways to include quotes within a string:

</P>

<UL>
<LI>

A <SAMP>`''</SAMP> inside a string quoted with <SAMP>`''</SAMP> may be written as <SAMP>`'''</SAMP>.

<LI>

A <SAMP>`"'</SAMP> inside a string quoted with <SAMP>`"'</SAMP> may be written as <SAMP>`""'</SAMP>.

<LI>

You can precede the quote character with an escape character (<SAMP>`\'</SAMP>).

<LI>

A <SAMP>`''</SAMP> inside a string quoted with <SAMP>`"'</SAMP> needs no special treatment
and need not be doubled or escaped.  In the same way, <SAMP>`"'</SAMP> inside a
string quoted with <SAMP>`''</SAMP> needs no special treatment.
</UL>

<P>
The <CODE>SELECT</CODE> statements shown below demonstrate how quoting and
escaping work:

</P>

<PRE>
mysql&#62; SELECT 'hello', '"hello"', '""hello""', 'hel''lo', '\'hello';
+-------+---------+-----------+--------+--------+
| hello | "hello" | ""hello"" | hel'lo | 'hello |
+-------+---------+-----------+--------+--------+

mysql&#62; SELECT "hello", "'hello'", "''hello''", "hel""lo", "\"hello";
+-------+---------+-----------+--------+--------+
| hello | 'hello' | ''hello'' | hel"lo | "hello |
+-------+---------+-----------+--------+--------+

mysql&#62; SELECT "This\nIs\nFour\nlines";
+--------------------+
| This
Is
Four
lines |
+--------------------+
</PRE>

<P>
<A NAME="IDX176"></A>

</P>
<P>
If you want to insert binary data into a <CODE>BLOB</CODE> column, the following
characters must be represented by escape sequences:
<DL COMPACT>

<DT><CODE>NUL</CODE>
<DD>
ASCII 0. You should represent this by <SAMP>`\0'</SAMP> (a backslash and an ASCII <SAMP>`0'</SAMP> character).
<DT><CODE>\</CODE>
<DD>
ASCII 92, backslash.  Represent this by <SAMP>`\\'</SAMP>.
<DT><CODE>'</CODE>
<DD>
ASCII 39, single quote.  Represent this by <SAMP>`\''</SAMP>.
<DT><CODE>"</CODE>
<DD>
ASCII 34, double quote.  Represent this by <SAMP>`\"'</SAMP>.
</DL>

<P>
<A NAME="IDX177"></A>
<A NAME="IDX178"></A>
<A NAME="IDX179"></A>
<A NAME="IDX180"></A>
If you write C code, you can use the C API function
<CODE>mysql_escape_string()</CODE> to escape characters for the <CODE>INSERT</CODE>
statement.  See section <A HREF="manual.html#C_API_function_overview">20.3  C API function overview</A>.  In Perl, you can use the
<CODE>quote</CODE> method of the <CODE>DBI</CODE> package to convert special
characters to the proper escape sequences.  See section <A HREF="manual.html#Perl_DBI_Class">20.5.2  The <CODE>DBI</CODE> interface</A>.

</P>
<P>
You should use an escape function on any string that might contain any of the
special characters listed above!

</P>


<H3><A NAME="Number_syntax" HREF="manual_toc.html#Number_syntax">7.1.2  Numbers</A></H3>

<P>
Integers are represented as a sequence of digits. Floats use <SAMP>`.'</SAMP> as a
decimal separator.  Either type of number may be preceded by <SAMP>`-'</SAMP> to
indicate a negative value.

</P>
<P>
Examples of valid integers:

</P>

<PRE>
1221
0
-32
</PRE>

<P>
Examples of valid floating-point numbers:

</P>

<PRE>
294.42
-32032.6809e+10
148.00
</PRE>

<P>
An integer may be used in a floating-point context; it is interpreted
as the equivalent floating-point number.

</P>
<P>
<A NAME="IDX181"></A>


<H3><A NAME="Hexadecimal_values" HREF="manual_toc.html#Hexadecimal_values">7.1.3  Hexadecimal values</A></H3>

<P>
<STRONG>MySQL</STRONG> supports hexadecimal values.  In number context these acts
like an integer (64 bit precision). In string context these acts like a binary
string where each pair of hex digits is converted to a character.

</P>

<PRE>
mysql&#62; SELECT 0xa+0
       -&#62; 10
mysql&#62; select 0x5061756c;
       -&#62; Paul
</PRE>

<P>
Hexadecimal strings is often used by ODBC to give values for BLOB columns.

</P>
<P>
<A NAME="IDX182"></A>


<H3><A NAME="NULL_values" HREF="manual_toc.html#NULL_values">7.1.4  <CODE>NULL</CODE> values</A></H3>

<P>
The <CODE>NULL</CODE> value means ``no data'' and is different from values such
as <CODE>0</CODE> for numeric types or the empty string for string types.
See section <A HREF="manual.html#Problems_with_NULL">18.15  Problems with <CODE>NULL</CODE> values</A>.

</P>
<P>
<CODE>NULL</CODE> may be represented by <CODE>\N</CODE> when using the text file import
or export formats (<CODE>LOAD DATA INFILE</CODE>, <CODE>SELECT ... INTO OUTFILE</CODE>).
See section <A HREF="manual.html#LOAD_DATA">7.16  <CODE>LOAD DATA INFILE</CODE> syntax</A>.

</P>


<H3><A NAME="Legal_names" HREF="manual_toc.html#Legal_names">7.1.5  Database, table, index, column and alias names</A></H3>

<P>
Database, table, index, column and alias names all follow the same rules in
<STRONG>MySQL</STRONG>:

</P>
<P>
<A NAME="IDX183"></A>
<A NAME="IDX184"></A>
<A NAME="IDX185"></A>
Note that the rules changed starting with <STRONG>MySQL</STRONG> 3.23.6 when we introduced
quoting of identifiers (database, table and column names) with <CODE>`</CODE> (<CODE>"</CODE>
will also work to quote identifiers if you run in ANSI mode).

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><STRONG>Identifier</STRONG> </TD><TD> <STRONG>max length</STRONG> </TD><TD> <STRONG>Allowed characters</STRONG>
</TR NOSAVE>
<TR><TD>Database </TD><TD> 64 </TD><TD> Any character that is allowed in a directory name execpt <CODE>/</CODE>.
</TR NOSAVE>
<TR><TD>Table </TD><TD> 64 </TD><TD> Any character that is allowed in file name, execpt <CODE>/</CODE> or <CODE>.</CODE>
</TR NOSAVE>
<TR><TD>Column </TD><TD> 64 </TD><TD> All characters
</TR NOSAVE>
<TR><TD>Alias </TD><TD> 255 </TD><TD> All characters
</TR>
</TABLE>

<P>
Note that in addition to the above, you can't have ASCII(0) or ASCII(255) in
an identifier.

</P>
<P>
Note that if the identifer is a restricted word or contains special character
you must always quote it with <CODE>`</CODE> when you use it:

</P>

<PRE>
SELECT * from `select` where `select`.id &#62; 100;
</PRE>

<P>
In previous versions of MySQL, the name rules are as follows:

</P>

<UL>
<LI>

A name may consist of alphanumeric characters from the current character set
and also <SAMP>`_'</SAMP> and <SAMP>`$'</SAMP>. The default character set is ISO-8859-1
Latin1; this may be changed by recompiling <STRONG>MySQL</STRONG>.
See section <A HREF="manual.html#Character_sets">9.1.1  The character set used for data and sorting</A>.

<LI>

A name may start with any character that is legal in a name.  In particular,
a name may start with a number (this differs from many other database
systems!).  However, a name cannot consist <EM>only</EM> of numbers.

<LI>

You cannot use the <SAMP>`.'</SAMP> character in names because it is used to extend the
format by which you can refer to columns (see immediately below).
</UL>

<P>
It is recommended that you do not use names like <CODE>1e</CODE>, because
an expression like <CODE>1e+1</CODE> is ambiguous. It may be interpreted as the
expression <CODE>1e + 1</CODE> or as the number <CODE>1e+1</CODE>.

</P>
<P>
In <STRONG>MySQL</STRONG> you can refer to a column using any of the following forms:

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><STRONG>Column reference</STRONG> </TD><TD> <STRONG>Meaning</STRONG>
</TR NOSAVE>
<TR><TD><CODE>col_name</CODE> </TD><TD> Column <CODE>col_name</CODE>
from whichever table used in the query contains a column of that name
</TR NOSAVE>
<TR><TD><CODE>tbl_name.col_name</CODE> </TD><TD> Column <CODE>col_name</CODE> from table
<CODE>tbl_name</CODE> of the current database
</TR NOSAVE>
<TR><TD><CODE>db_name.tbl_name.col_name</CODE> </TD><TD> Column <CODE>col_name</CODE> from table
<CODE>tbl_name</CODE> of the database <CODE>db_name</CODE>.  This form is available in
<STRONG>MySQL</STRONG> 3.22 or later.
</TR NOSAVE>
<TR><TD>
<CODE>`column_name`</CODE> </TD><TD> A column that is a keyword or contains special characters.
</TR>
</TABLE>

<P>
You need not specify a <CODE>tbl_name</CODE> or <CODE>db_name.tbl_name</CODE> prefix for
a column reference in a statement unless the reference would be ambiguous.
For example, suppose tables <CODE>t1</CODE> and <CODE>t2</CODE> each contain a column
<CODE>c</CODE>, and you retrieve <CODE>c</CODE> in a <CODE>SELECT</CODE> statement that uses
both <CODE>t1</CODE> and <CODE>t2</CODE>.  In this case, <CODE>c</CODE> is ambiguous because it
is not unique among the tables used in the statement, so you must indicate
which table you mean by writing <CODE>t1.c</CODE> or <CODE>t2.c</CODE>.  Similarly, if
you are retrieving from a table <CODE>t</CODE> in database <CODE>db1</CODE> and from a
table <CODE>t</CODE> in database <CODE>db2</CODE>, you must refer to columns in those
tables as <CODE>db1.t.col_name</CODE> and <CODE>db2.t.col_name</CODE>.

</P>
<P>
<A NAME="IDX186"></A>
<A NAME="IDX187"></A>
The syntax <CODE>.tbl_name</CODE> means the table <CODE>tbl_name</CODE> in the current
database.  This syntax is accepted for ODBC compatibility, because some ODBC
programs prefix table names with a <SAMP>`.'</SAMP> character.

</P>


<H4><A NAME="Name_case_sensitivity" HREF="manual_toc.html#Name_case_sensitivity">7.1.5.1  Case sensitivity in names</A></H4>
<P>
<A NAME="IDX188"></A>
<A NAME="IDX189"></A>
<A NAME="IDX190"></A>
<A NAME="IDX191"></A>
<A NAME="IDX192"></A>
<A NAME="IDX193"></A>
<A NAME="IDX194"></A>
<A NAME="IDX195"></A>

</P>
<P>
In <STRONG>MySQL</STRONG>, databases and tables correspond to directories and files
within those directories.  Consequently, the case sensitivity of the
underlying operating system determines the case sensitivity of database and
table names.  This means database and table names are case sensitive in Unix
and case insensitive in Win32.

</P>
<P>
<STRONG>Note:</STRONG> Although database and table names are case insensitive for
Win32, you should not refer to a given database or table using different
cases within the same query.  The following query would not work because it
refers to a table both as <CODE>my_table</CODE> and as <CODE>MY_TABLE</CODE>:

</P>

<PRE>
mysql&#62; SELECT * FROM my_table WHERE MY_TABLE.col=1;
</PRE>

<P>
Column names are case insensitive in all cases.

</P>
<P>
Aliases on tables are case sensitive.  The following query would not work
because it refers to the alias both as <CODE>a</CODE> and as <CODE>A</CODE>:

</P>

<PRE>
mysql&#62; SELECT col_name FROM tbl_name AS a
           WHERE a.col_name = 1 OR A.col_name = 2;
</PRE>

<P>
Aliases on columns are case insensitive.

</P>


<H2><A NAME="Variables" HREF="manual_toc.html#Variables">7.2  User variables</A></H2>

<P>
<STRONG>MySQL</STRONG> supports thread specific variables with the
<CODE>@variablename</CODE> syntax.  A variable name may consist of
alphanumeric characters from the current character set and also
<SAMP>`_'</SAMP>, <SAMP>`$'</SAMP>, and <SAMP>`.'</SAMP> . The default character set is
ISO-8859-1 Latin1; this may be changed by recompiling
<STRONG>MySQL</STRONG>. See section <A HREF="manual.html#Character_sets">9.1.1  The character set used for data and sorting</A>.

</P>
<P>
Variables don't have to be initialized.  They contain NULL by default
and can store and integer, real or a string value.  All variables for
a thread are automaticly freed when the thread exits.

</P>
<P>
You can set a variable with the <CODE>SET</CODE> syntax:

</P>

<PRE>
SET @variable= { integer expression | real expression | string expression }
[,@variable= ...].
</PRE>

<P>
You can also set a variable in an expression with the <CODE>@variable:=expr</CODE>
syntax:

</P>

<PRE>
select @t1:=(@t2:=1)+@t3:=4,@t1,@t2,@t3;
+----------------------+------+------+------+
| @t1:=(@t2:=1)+@t3:=4 | @t1  | @t2  | @t3  |
+----------------------+------+------+------+
|                    5 |    5 |    1 |    4 |
+----------------------+------+------+------+
</PRE>

<P>
(We had to use the <CODE>:=</CODE> syntax here as <CODE>=</CODE> was reserverd for
comparisons)

</P>


<H2><A NAME="Column_types" HREF="manual_toc.html#Column_types">7.3  Column types</A></H2>

<P>
<STRONG>MySQL</STRONG> supports a number of column types, which may be grouped into
three categories: numeric types, date and time types, and string (character)
types.  This section first gives an overview of the types available and
summarizes the storage requirements for each column type, then provides a
more detailed description of the properties of the types in each category.
The overview is intentionally brief.  The more detailed descriptions should
be consulted for additional information about particular column types, such
as the allowable formats in which you can specify values.

</P>
<P>
The column types supported by <STRONG>MySQL</STRONG> are listed below.
The following code letters are used in the descriptions:

</P>
<DL COMPACT>

<DT><CODE>M</CODE>
<DD>
Indicates the maximum display size.  The maximum legal display size is 255.

<DT><CODE>D</CODE>
<DD>
Applies to floating-point types and indicates the number of digits
following the decimal point.  The maximum possible value is 30, but
should be no greater than <CODE>M</CODE>-2.
</DL>

<P>
Square brackets (<SAMP>`['</SAMP> and <SAMP>`]'</SAMP>) indicate parts of type specifiers
that are optional.

</P>
<P>
<A NAME="IDX196"></A>

</P>

<P>
Note that if you specify <CODE>ZEROFILL</CODE> for a column, <STRONG>MySQL</STRONG> will
automatically add the <CODE>UNSIGNED</CODE> attribute to the column.

</P>
<DL COMPACT>

<DT><CODE>TINYINT[(M)] [UNSIGNED] [ZEROFILL]</CODE>
<DD>
<A NAME="IDX197"></A>
 

A very small integer. The signed range is <CODE>-128</CODE> to <CODE>127</CODE>. The
unsigned range is <CODE>0</CODE> to <CODE>255</CODE>.

<A NAME="IDX198"></A>
<DT><CODE>SMALLINT[(M)] [UNSIGNED] [ZEROFILL]</CODE>
<DD>
A small integer. The signed range is <CODE>-32768</CODE> to <CODE>32767</CODE>. The
unsigned range is <CODE>0</CODE> to <CODE>65535</CODE>.

<A NAME="IDX199"></A>
<DT><CODE>MEDIUMINT[(M)] [UNSIGNED] [ZEROFILL]</CODE>
<DD>
A medium-size integer. The signed range is <CODE>-8388608</CODE> to
<CODE>8388607</CODE>. The unsigned range is <CODE>0</CODE> to <CODE>16777215</CODE>.

<A NAME="IDX200"></A>
<DT><CODE>INT[(M)] [UNSIGNED] [ZEROFILL]</CODE>
<DD>
A normal-size integer. The signed range is <CODE>-2147483648</CODE> to
<CODE>2147483647</CODE>.  The unsigned range is <CODE>0</CODE> to <CODE>4294967295</CODE>.

<A NAME="IDX201"></A>
<DT><CODE>INTEGER[(M)] [UNSIGNED] [ZEROFILL]</CODE>
<DD>
This is a synonym for <CODE>INT</CODE>.

<A NAME="IDX202"></A>
<DT><CODE>BIGINT[(M)] [UNSIGNED] [ZEROFILL]</CODE>
<DD>
A large integer. The signed range is <CODE>-9223372036854775808</CODE> to
<CODE>9223372036854775807</CODE>. The unsigned range is <CODE>0</CODE> to
<CODE>18446744073709551615</CODE>.  Note that all arithmetic is done using
signed <CODE>BIGINT</CODE> or <CODE>DOUBLE</CODE> values, so you shouldn't use
unsigned big integers larger than <CODE>9223372036854775807</CODE> (63 bits)
except with bit functions!  Note that <CODE>-</CODE>, <CODE>+</CODE> and <CODE>*</CODE>
will use <CODE>BIGINT</CODE> arithmetic when both arguments are <CODE>INTEGER</CODE>
values!  This means that if you multiply two big integers (or results
from functions that return integers) you may get unexpected results if
the result is larger than <CODE>9223372036854775807</CODE>.

<A NAME="IDX203"></A>
<A NAME="IDX204"></A>

A floating-point number. Cannot be unsigned.  <CODE>precision</CODE> can be
<CODE>&#60;=24</CODE> for a single precision floating point number and between 25
and 53 for a double precision floating point number. 
these types are like the <CODE>FLOAT</CODE> and <CODE>DOUBLE</CODE> types described
immediately below. <CODE>FLOAT(X)</CODE> have the same ranges as the
corresponding <CODE>FLOAT</CODE> and <CODE>DOUBLE</CODE> types, but the display
size and number of decimals is undefined.

In <STRONG>MySQL</STRONG> 3.23, this is a true floating point value.  In
earlier <STRONG>MySQL</STRONG> versions, <CODE>FLOAT(precision)</CODE> always has 2 decimals.

<A NAME="IDX205"></A>
<A NAME="IDX206"></A>
This syntax is provided for ODBC compatibility.

<A NAME="IDX207"></A>
<A NAME="IDX208"></A>
<A NAME="IDX209"></A>
<DT><CODE>FLOAT[(M,D)] [ZEROFILL]</CODE>
<DD>
A small (single-precision) floating-point number. Cannot be unsigned.
Allowable values are <CODE>-3.402823466E+38</CODE> to
<CODE>-1.175494351E-38</CODE>, <CODE>0</CODE> and <CODE>1.175494351E-38</CODE> to
<CODE>3.402823466E+38</CODE>.  The M is the display width and D is the
number of decimals.  <CODE>FLOAT</CODE> without an argument or with an argument of
&#60;= 24 stands for a single-precision floating point number.

<A NAME="IDX210"></A>
<A NAME="IDX211"></A>
<DT><CODE>DOUBLE[(M,D)] [ZEROFILL]</CODE>
<DD>
A normal-size (double-precision) floating-point number. Cannot be
unsigned. Allowable values are <CODE>-1.7976931348623157E+308</CODE> to
<CODE>-2.2250738585072014E-308</CODE>, <CODE>0</CODE> and
<CODE>2.2250738585072014E-308</CODE> to <CODE>1.7976931348623157E+308</CODE>.  The M
is the display width and D is the number of decimals.  <CODE>DOUBLE</CODE>
without an argument or <CODE>FLOAT(X)</CODE> where 25 &#60;= X &#60;= 53 stands for a
double-precision floating point number.

<A NAME="IDX212"></A>
<A NAME="IDX213"></A>
<DT><CODE>DOUBLE PRECISION[(M,D)] [ZEROFILL]</CODE>
<DD>
<DT><CODE>REAL[(M,D)] [ZEROFILL]</CODE>
<DD>
These are synonyms for <CODE>DOUBLE</CODE>.

<A NAME="IDX214"></A>
<DT><CODE>DECIMAL[(M[,D])] [ZEROFILL]</CODE>
<DD>
An unpacked floating-point number.  Cannot be unsigned.  Behaves like a
<CODE>CHAR</CODE> column: ``unpacked'' means the number is stored as a string,
using one character for each digit of the value.  The decimal point,
and, for negative numbers, the <SAMP>`-'</SAMP> sign is not counted in M.  If
<CODE>D</CODE> is 0, values will have no decimal point or fractional part.
The maximum range of <CODE>DECIMAL</CODE> values is the same as for
<CODE>DOUBLE</CODE>, but the actual range for a given <CODE>DECIMAL</CODE> column
may be constrained by the choice of <CODE>M</CODE> and <CODE>D</CODE>.

If <CODE>D</CODE> is left out it's set to 0. If <CODE>M</CODE> is left out it's set to 10.

Note that in <STRONG>MySQL</STRONG> 3.22 the <CODE>M</CODE> argument includes the sign
and the decimal point.

<A NAME="IDX215"></A>
<DT><CODE>NUMERIC(M,D) [ZEROFILL]</CODE>
<DD>
This is a synonym for <CODE>DECIMAL</CODE>.

<A NAME="IDX216"></A>
<DT><CODE>DATE</CODE>
<DD>
A date.  The supported range is <CODE>'1000-01-01'</CODE> to <CODE>'9999-12-31'</CODE>.
<STRONG>MySQL</STRONG> displays <CODE>DATE</CODE> values in <CODE>'YYYY-MM-DD'</CODE> format, but
allows you to assign values to <CODE>DATE</CODE> columns using either strings or
numbers.

<A NAME="IDX217"></A>
<DT><CODE>DATETIME</CODE>
<DD>
A date and time combination.  The supported range is <CODE>'1000-01-01
00:00:00'</CODE> to <CODE>'9999-12-31 23:59:59'</CODE>.  <STRONG>MySQL</STRONG> displays
<CODE>DATETIME</CODE> values in <CODE>'YYYY-MM-DD HH:MM:SS'</CODE> format, but allows you
to assign values to <CODE>DATETIME</CODE> columns using either strings or numbers.

<A NAME="IDX218"></A>
<DT><CODE>TIMESTAMP[(M)]</CODE>
<DD>
A timestamp.  The range is <CODE>'1970-01-01 00:00:00'</CODE> to sometime in the
year <CODE>2037</CODE>.  <STRONG>MySQL</STRONG> displays <CODE>TIMESTAMP</CODE> values in
<CODE>YYYYMMDDHHMMSS</CODE>, <CODE>YYMMDDHHMMSS</CODE>, <CODE>YYYYMMDD</CODE> or <CODE>YYMMDD</CODE>
format, depending on whether <CODE>M</CODE> is <CODE>14</CODE> (or missing), <CODE>12</CODE>,
<CODE>8</CODE> or <CODE>6</CODE>, but allows you to assign values to <CODE>TIMESTAMP</CODE>
columns using either strings or numbers.  A <CODE>TIMESTAMP</CODE> column is useful
for recording the date and time of an <CODE>INSERT</CODE> or <CODE>UPDATE</CODE>
operation because it is automatically set to the date and time of the most
recent operation if you don't give it a value yourself.  You can also set it
to the current date and time by assigning it a <CODE>NULL</CODE> value.  See section <A HREF="manual.html#Date_and_time_types">7.3.6  Date and time types</A>.

<A NAME="IDX219"></A>
<DT><CODE>TIME</CODE>
<DD>
A time.  The range is <CODE>'-838:59:59'</CODE> to <CODE>'838:59:59'</CODE>.
<STRONG>MySQL</STRONG> displays <CODE>TIME</CODE> values in <CODE>'HH:MM:SS'</CODE> format, but
allows you to assign values to <CODE>TIME</CODE> columns using either strings or
numbers.

<A NAME="IDX220"></A>
<DT><CODE>YEAR[(2|4)]</CODE>
<DD>
A year in 2- or 4- digit formats (default is 4-digit).  The allowable values are
<CODE>1901</CODE> to <CODE>2155</CODE>, and <CODE>0000</CODE> in the 4 year format and
1970-2069 if you use the 2 digit format (70-69).  <STRONG>MySQL</STRONG> displays
<CODE>YEAR</CODE> values in <CODE>YYYY</CODE> format, but allows you to assign
values to <CODE>YEAR</CODE> columns using either strings or numbers.
(The <CODE>YEAR</CODE> type is new in <STRONG>MySQL</STRONG> 3.22.)

<A NAME="IDX221"></A>
<A NAME="IDX222"></A>
<A NAME="IDX223"></A>
<A NAME="IDX224"></A>
<DT><CODE>CHAR(M) [BINARY]</CODE>
<DD>
A fixed-length string that is always right-padded with spaces to the
specified length when stored. The range of <CODE>M</CODE> is 1 to 255 characters.
Trailing spaces are removed when the value is retrieved. <CODE>CHAR</CODE> values
are sorted and compared in case-insensitive fashion according to the
default character set unless the <CODE>BINARY</CODE> keyword is given.

<CODE>NATIONAL CHAR</CODE> (short form <CODE>NCHAR</CODE>) is the ANSI SQL way to
define that a CHAR column should use the default CHARACTER set.  This is
default in <CODE>MySQL</CODE>.

<CODE>CHAR</CODE> is a shorthand for <CODE>CHARACTER</CODE>.

<A NAME="IDX225"></A>
<A NAME="IDX226"></A>
<A NAME="IDX227"></A>
<DT><CODE>[NATIONAL] VARCHAR(M) [BINARY]</CODE>
<DD>
A variable-length string.  Note:
Trailing spaces are removed when the value is stored (this differs from the
ANSI SQL specification). The range of <CODE>M</CODE> is 1 to 255 characters.
<CODE>VARCHAR</CODE> values are sorted and compared in case-insensitive fashion
unless the <CODE>BINARY</CODE> keyword is given. See section <A HREF="manual.html#Silent_column_changes">7.7.1  Silent column specification changes</A>.

<CODE>VARCHAR</CODE> is a shorthand for <CODE>CHARACTER VARYING</CODE>.

<A NAME="IDX228"></A>
<A NAME="IDX229"></A>
<DT><CODE>TINYBLOB</CODE>
<DD>
<DT><CODE>TINYTEXT</CODE>
<DD>
A <CODE>BLOB</CODE> or <CODE>TEXT</CODE> column with a maximum length of 255 (2^8 - 1)
characters. See section <A HREF="manual.html#Silent_column_changes">7.7.1  Silent column specification changes</A>.

<A NAME="IDX230"></A>
<A NAME="IDX231"></A>
<DT><CODE>BLOB</CODE>
<DD>
<DT><CODE>TEXT</CODE>
<DD>
A <CODE>BLOB</CODE> or <CODE>TEXT</CODE> column with a maximum length of 65535 (2^16 - 1)
characters. See section <A HREF="manual.html#Silent_column_changes">7.7.1  Silent column specification changes</A>.

<A NAME="IDX232"></A>
<A NAME="IDX233"></A>
<DT><CODE>MEDIUMBLOB</CODE>
<DD>
<DT><CODE>MEDIUMTEXT</CODE>
<DD>
A <CODE>BLOB</CODE> or <CODE>TEXT</CODE> column with a maximum length of 16777215
(2^24 - 1) characters. See section <A HREF="manual.html#Silent_column_changes">7.7.1  Silent column specification changes</A>.

<A NAME="IDX234"></A>
<A NAME="IDX235"></A>
<DT><CODE>LONGBLOB</CODE>
<DD>
<DT><CODE>LONGTEXT</CODE>
<DD>
A <CODE>BLOB</CODE> or <CODE>TEXT</CODE> column with a maximum length of 4294967295
(2^32 - 1) characters. See section <A HREF="manual.html#Silent_column_changes">7.7.1  Silent column specification changes</A>.

<A NAME="IDX236"></A>
<DT><CODE>ENUM('value1','value2',...)</CODE>
<DD>
An enumeration.
A string object that can have only one value, chosen from the list of values
<CODE>'value1'</CODE>, <CODE>'value2'</CODE>, <CODE>...</CODE>, or <CODE>NULL</CODE>.  An <CODE>ENUM</CODE>
can have a maximum of 65535 distinct values.

<A NAME="IDX237"></A>
<DT><CODE>SET('value1','value2',...)</CODE>
<DD>
A set.  A string object that can have zero or more values, each of which must
be chosen from the list of values <CODE>'value1'</CODE>, <CODE>'value2'</CODE>,
<CODE>...</CODE> A <CODE>SET</CODE> can have a maximum of 64 members.
</DL>

<P>
<A NAME="IDX238"></A>


<H3><A NAME="Storage_requirements" HREF="manual_toc.html#Storage_requirements">7.3.1  Column type storage requirements</A></H3>

<P>
The storage requirements for each of the column types supported by
<STRONG>MySQL</STRONG> are listed below by category.

</P>

<H3>7.3.2  Numeric types</H3>

<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><STRONG>Column type</STRONG> </TD><TD> <STRONG>Storage required</STRONG>
</TR NOSAVE>
<TR><TD><CODE>TINYINT</CODE> </TD><TD> 1 byte
</TR NOSAVE>
<TR><TD><CODE>SMALLINT</CODE> </TD><TD> 2 bytes
</TR NOSAVE>
<TR><TD><CODE>MEDIUMINT</CODE> </TD><TD> 3 bytes
</TR NOSAVE>
<TR><TD><CODE>INT</CODE> </TD><TD> 4 bytes
</TR NOSAVE>
<TR><TD><CODE>INTEGER</CODE> </TD><TD> 4 bytes
</TR NOSAVE>
<TR><TD><CODE>BIGINT</CODE> </TD><TD> 8 bytes
</TR NOSAVE>
<TR><TD><CODE>FLOAT(X)</CODE> </TD><TD> 4 if X &#60;= 24 or 8 if 25 &#60;= X &#60;= 53
</TR NOSAVE>
<TR><TD><CODE>FLOAT</CODE> </TD><TD> 4 bytes
</TR NOSAVE>
<TR><TD><CODE>DOUBLE</CODE> </TD><TD> 8 bytes
</TR NOSAVE>
<TR><TD><CODE>DOUBLE PRECISION</CODE> </TD><TD> 8 bytes
</TR NOSAVE>
<TR><TD><CODE>REAL</CODE> </TD><TD> 8 bytes
</TR NOSAVE>
<TR><TD><CODE>DECIMAL(M,D)</CODE> </TD><TD> <CODE>M</CODE> bytes (<CODE>D</CODE>+2, if <CODE>M &#60; D</CODE>)
</TR NOSAVE>
<TR><TD><CODE>NUMERIC(M,D)</CODE> </TD><TD> <CODE>M</CODE> bytes (<CODE>D</CODE>+2, if <CODE>M &#60; D</CODE>)
</TR>
</TABLE>


<H3>7.3.3  Date and time types</H3>

<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><STRONG>Column type</STRONG> </TD><TD> <STRONG>Storage required</STRONG>
</TR NOSAVE>
<TR><TD><CODE>DATE</CODE> </TD><TD> 3 bytes
</TR NOSAVE>
<TR><TD><CODE>DATETIME</CODE> </TD><TD> 8 bytes
</TR NOSAVE>
<TR><TD><CODE>TIMESTAMP</CODE> </TD><TD> 4 bytes
</TR NOSAVE>
<TR><TD><CODE>TIME</CODE> </TD><TD> 3 bytes
</TR NOSAVE>
<TR><TD><CODE>YEAR</CODE> </TD><TD> 1 byte
</TR>
</TABLE>


<H3>7.3.4  String types</H3>

<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><STRONG>Column type</STRONG> </TD><TD> <STRONG>Storage required</STRONG>
</TR NOSAVE>
<TR><TD><CODE>CHAR(M)</CODE> </TD><TD> <CODE>M</CODE> bytes, <CODE>1 &#60;= M &#60;= 255</CODE>
</TR NOSAVE>
<TR><TD><CODE>VARCHAR(M)</CODE> </TD><TD> <CODE>L</CODE>+1 bytes, where <CODE>L &#60;= M</CODE> and
<CODE>1 &#60;= M &#60;= 255</CODE>
</TR NOSAVE>
<TR><TD><CODE>TINYBLOB</CODE>, <CODE>TINYTEXT</CODE> </TD><TD> <CODE>L</CODE>+1 bytes,
where <CODE>L</CODE> &#60; 2^8
</TR NOSAVE>
<TR><TD><CODE>BLOB</CODE>, <CODE>TEXT</CODE> </TD><TD> <CODE>L</CODE>+2 bytes,
where <CODE>L</CODE> &#60; 2^16
</TR NOSAVE>
<TR><TD><CODE>MEDIUMBLOB</CODE>, <CODE>MEDIUMTEXT</CODE> </TD><TD> <CODE>L</CODE>+3 bytes,
where <CODE>L</CODE> &#60; 2^24
</TR NOSAVE>
<TR><TD><CODE>LONGBLOB</CODE>, <CODE>LONGTEXT</CODE> </TD><TD> <CODE>L</CODE>+4 bytes,
where <CODE>L</CODE> &#60; 2^32
</TR NOSAVE>
<TR><TD><CODE>ENUM('value1','value2',...)</CODE> </TD><TD> 1 or 2 bytes, depending on
the number of enumeration values (65535 values maximum)
</TR NOSAVE>
<TR><TD><CODE>SET('value1','value2',...)</CODE> </TD><TD> 1, 2, 3, 4 or 8 bytes, depending
on the number of set members (64 members maximum)
</TR>
</TABLE>

<P>
<CODE>VARCHAR</CODE> and the <CODE>BLOB</CODE> and <CODE>TEXT</CODE> types are variable-length
types, for which the storage requirements depend on the actual length of
column values (represented by <CODE>L</CODE> in the preceding table), rather than
on the type's maximum possible size.  For example, a <CODE>VARCHAR(10)</CODE>
column can hold a string with a maximum length of 10 characters.  The actual
storage required is the length of the string (<CODE>L</CODE>), plus 1 byte to
record the length of the string.  For the string <CODE>'abcd'</CODE>, <CODE>L</CODE> is 4
and the storage requirement is 5 bytes.

</P>
<P>
The <CODE>BLOB</CODE> and <CODE>TEXT</CODE> types require 1, 2, 3 or 4 bytes to record
the length of the column value, depending on the maximum possible length of
the type.

</P>
<P>
If a table includes any variable-length column types, the record format will
also be variable-length.  Note that when a table is created, <STRONG>MySQL</STRONG>
may under certain conditions change a column from a variable-length type to a
fixed-length type, or vice-versa.  See section <A HREF="manual.html#Silent_column_changes">7.7.1  Silent column specification changes</A>.

</P>
<P>
The size of an <CODE>ENUM</CODE> object is determined by the number of different
enumeration values.  1 byte is used for enumerations with up to 255 possible
values.  2 bytes are used for enumerations with up to 65535 values.

</P>
<P>
The size of a <CODE>SET</CODE> object is determined by the number of different
set members.  If the set size is <CODE>N</CODE>, the object occupies <CODE>(N+7)/8</CODE>
bytes, rounded up to 1, 2, 3, 4 or 8 bytes.  A <CODE>SET</CODE> can have a maximum
of 64 members.

</P>


<H3><A NAME="Numeric_types" HREF="manual_toc.html#Numeric_types">7.3.5  Numeric types</A></H3>

<P>
<STRONG>MySQL</STRONG> supports all of the ANSI/ISO SQL92 numeric types.  These
types include the exact numeric data types (<CODE>NUMERIC</CODE>,
<CODE>DECIMAL</CODE>, <CODE>INTEGER</CODE>, and <CODE>SMALLINT</CODE>), as well as the
approximate numeric data types (<CODE>FLOAT</CODE>, <CODE>REAL</CODE>, and
<CODE>DOUBLE PRECISION</CODE>). The keyword <CODE>INT</CODE> is a synonym for
<CODE>INTEGER</CODE>, and the keyword <CODE>DEC</CODE> is a synonym for
<CODE>DECIMAL</CODE>.

</P>
<P>
The <CODE>NUMERIC</CODE> and <CODE>DECIMAL</CODE> types are implemented as the same
type by <STRONG>MySQL</STRONG>, as permitted by the SQL92 standard.  They are
used for values for which it is important to preserve exact precision,
for example with monetary data.  When declaring a column of one of these
types the precision and scale can be (and usually is) specified; for
example:

</P>

<PRE>
    salary DECIMAL(9,2)
</PRE>

<P>
In this example, <CODE>9</CODE> (<CODE>precision</CODE>) represents the number of
significant decimal digits which will be stored for values, and 
<CODE>2</CODE> (<CODE>scale</CODE>) represents the number of digits which will be 
stored following the decimal point.  In this case, therefore, the range 
of values which can be stored in the <CODE>salary</CODE> column is from 
<CODE>-9999999.99</CODE> to <CODE>9999999.99</CODE>.  In ANSI/ISO SQL92, the syntax
<CODE>DECIMAL(p)</CODE> is equivalent to <CODE>DECIMAL(p,0)</CODE>.  Similarly, the
syntax <CODE>DECIMAL</CODE> is equivalent to <CODE>DECIMAL(p,0)</CODE>, where the
implementation is allowed to decide the value of <CODE>p</CODE>. 
<STRONG>MySQL</STRONG> does not currently support either of these variant forms
of the <CODE>DECIMAL</CODE>/<CODE>NUMERIC</CODE> data types.  This is not generally
a serious problem, as the principal benefits of these types derive from 
the ability to control both precision and scale explicitly.

</P>
<P>
<CODE>DECIMAL</CODE> and <CODE>NUMERIC</CODE> values are stored as strings, rather
than as binary floating point numbers, in order to preserve the decimal
precision of those values.  One character is used for each digit of the 
value, the decimal point (if <CODE>scale</CODE> &#62; 0) and the <SAMP>`-'</SAMP> sign 
(for negative numbers).  If <CODE>scale</CODE> is 0, <CODE>DECIMAL</CODE> and
<CODE>NUMERIC</CODE> values contain no decimal point or fractional part.

</P>
<P>
The maximum range of <CODE>DECIMAL</CODE> and <CODE>NUMERIC</CODE> values is the 
same as for <CODE>DOUBLE</CODE>, but the actual range for a given 
<CODE>DECIMAL</CODE> or <CODE>NUMERIC</CODE> column can be constrained by the 
<CODE>precision</CODE> or <CODE>scale</CODE> for a given column.  When such a column
is assigned a value with more digits following the decimal point than
are allowed by the specified <CODE>scale</CODE>, the value is rounded to that
<CODE>scale</CODE>.  When a <CODE>DECIMAL</CODE> or <CODE>NUMERIC</CODE> column is
assigned a value whose magnitude exceeds the range implied by the
specified (or defaulted) <CODE>precision</CODE> and <CODE>scale</CODE>, 
<STRONG>MySQL</STRONG> stores the value representing the corresponding end
point of that range.

</P>
<P>
As an extension to the ANSI/ISO SQL92 standard, <STRONG>MySQL</STRONG> also
supports the integral types <CODE>TINYINT</CODE>, <CODE>MEDIUMINT</CODE>, and
<CODE>BIGINT</CODE> as listed in the tables above.  Another extension is
supported by <STRONG>MySQL</STRONG> for optionally specifying the display width
of an integral value in parentheses following the base keyword for the
type (for example, <CODE>INT(4)</CODE>).  This optional width specification is
used to left-pad the display of values whose width is less than the
width specified for the column, but does not constrain the range of
values which can be stored in the column, nor the number of digits which
will be displayed for values whose width exceeds that specified for the
column.  When used in conjunction with the optional extension attribute
<CODE>ZEROFILL</CODE> the default padding of spaces is replaced with zeroes.
For example, for a column declared as <CODE>INT(5) ZEROFILL</CODE>, a value 
of <CODE>4</CODE> is retrieved as <CODE>00004</CODE>.  Note that if you store larger
values than the display width in an integral column, you may experience
problems when <STRONG>MySQL</STRONG> generates temporary tables for some
complicated joins as in these case <STRONG>MySQL</STRONG> trust that the data
did fit into the original column width.

</P>
<P>
All integral types can have an optional (non-standard) attribute 
<CODE>UNSIGNED</CODE>.  Unsigned values can be used when you want to allow 
only positive numbers in a column and you need a little bigger numeric 
range for the column.

</P>
<P>
The <CODE>FLOAT</CODE> type is used to represent approximate numeric data
types. The ANSI/ISO SQL92 standard allows an optional specification of
the precision (but not the range of the exponent) in bits following the
keyword <CODE>FLOAT</CODE> in parentheses.  The <STRONG>MySQL</STRONG> implementation
also supports this optional precision specification.  When the keyword
<CODE>FLOAT</CODE> is used for a column type without a precision
specification, <STRONG>MySQL</STRONG> uses four bytes to store the values.  A
variant syntax is also supported, with two numbers given in parentheses
following the <CODE>FLOAT</CODE> keyword.  With this option, the first number
continues to represent the storage requirements for the value in bytes,
and the second number specifies the number of digits to be stored and
displayed following the decimal point (as with <CODE>DECIMAL</CODE> and
<CODE>NUMERIC</CODE>).  When <STRONG>MySQL</STRONG> is asked to store a number for
such a column with more decimal digits following the decimal point than
specified for the column, the value is rounded to eliminate the extra
digits when the value is stored.

</P>
<P>
The <CODE>REAL</CODE> and <CODE>DOUBLE PRECISION</CODE> types do not accept
precision specifications.  As an extension to the ANSI/ISO SQL92
standard, <STRONG>MySQL</STRONG> recognizes <CODE>DOUBLE</CODE> as a synonym for the
<CODE>DOUBLE PRECISION</CODE> type.  In contrast with the standard's
requirement that the precision for <CODE>REAL</CODE> be smaller than that used
for <CODE>DOUBLE PRECISION</CODE>, <STRONG>MySQL</STRONG> implements both as 8-byte
double-precision floating point values (when running in not "Ansi mode").
For maximum portability, code requiring storage of approximate numeric
data values should use <CODE>FLOAT</CODE> or <CODE>DOUBLE PRECISION</CODE> with no
specification of precision or number of decimal points.

</P>
<P>
When asked to store a value in a numeric column that is outside the column
type's allowable range, <STRONG>MySQL</STRONG> clips the value to the appropriate
endpoint of the range and stores the resulting value instead.

</P>
<P>
For example, the range of an <CODE>INT</CODE> column is <CODE>-2147483648</CODE> to
<CODE>2147483647</CODE>.  If you try to insert <CODE>-9999999999</CODE> into an
<CODE>INT</CODE> column, the value is clipped to the lower endpoint of the range,
and <CODE>-2147483648</CODE> is stored instead. Similarly, if you try to insert
<CODE>9999999999</CODE>, <CODE>2147483647</CODE> is stored instead.

</P>
<P>
If the <CODE>INT</CODE> column is <CODE>UNSIGNED</CODE>, the size of the column's
range is the same but its endpoints shift up to <CODE>0</CODE> and <CODE>4294967295</CODE>.
If you try to store <CODE>-9999999999</CODE> and <CODE>9999999999</CODE>,
the values stored in the column become <CODE>0</CODE> and <CODE>4294967296</CODE>.

</P>
<P>
Conversions that occur due to clipping are reported as ``warnings'' for
<CODE>ALTER TABLE</CODE>, <CODE>LOAD DATA INFILE</CODE>, <CODE>UPDATE</CODE> and
multi-row <CODE>INSERT</CODE> statements.

</P>
<P>
<A NAME="IDX239"></A>
<A NAME="IDX240"></A>


<H3><A NAME="Date_and_time_types" HREF="manual_toc.html#Date_and_time_types">7.3.6  Date and time types</A></H3>

<P>
The date and time types are <CODE>DATETIME</CODE>, <CODE>DATE</CODE>,
<CODE>TIMESTAMP</CODE>, <CODE>TIME</CODE> and <CODE>YEAR</CODE>.  Each of these has a
range of legal values, as well as a ``zero'' value that is used when you
specify a really illegal value.  Note that MySQL allows you to store
certain 'not strictly' legal date values, for example <CODE>1999-11-31</CODE>.
The reason for this is that we think it's the responsibility of the
application to handle date checking, not the SQL servers.  To make the
date checking 'fast', <STRONG>MySQL</STRONG> only checks that the month is in
the range of 0-12 and the day is in the range of 0-31. The above ranges
are defined this way because <STRONG>MySQL</STRONG> allows you to store, in a
<CODE>DATE</CODE> or <CODE>DATETIME</CODE> column, dates where the day or month-day
are zero.  This is extremely useful for applications that need to store
a birth-date for which you don't know the exact date. In this case you
simply store the date like <CODE>1999-00-00</CODE> or <CODE>1999-01-00</CODE>.  (You
can of course not expect to get a correct value from functions like
<CODE>DATE_SUB()</CODE> or <CODE>DATE_ADD</CODE> for dates like these).

</P>
<P>
Here are some general considerations to keep in mind when working
with date and time types:

</P>

<UL>
<LI>

<STRONG>MySQL</STRONG> retrieves values for a given date or time type in a standard
format, but it attempts to interpret a variety of formats for values that
you supply (e.g., when you specify a value to be assigned to or compared to a
date or time type).  Nevertheless, only the formats described in the
following sections are supported.  It is expected that you will supply legal
values, and unpredictable results may occur if you use values in other
formats.

<LI>

Although <STRONG>MySQL</STRONG> tries to interpret values in several formats, it
always expects the year part of date values to be leftmost.  Dates must be
given in year-month-day order (e.g., <CODE>'98-09-04'</CODE>), rather than in the
month-day-year or day-month-year orders commonly used elsewhere (e.g.,
<CODE>'09-04-98'</CODE>, <CODE>'04-09-98'</CODE>).

<LI>

<STRONG>MySQL</STRONG> automatically converts a date or time type value to a number
if the value is used in a numeric context, and vice versa.

<LI>

When <STRONG>MySQL</STRONG> encounters a value for a date or time type that is
out of range or otherwise illegal for the type (see start of this
section), it converts the value to the ``zero'' value for that type.
(The exception is that out-of-range <CODE>TIME</CODE> values are clipped to
the appropriate endpoint of the <CODE>TIME</CODE> range.)  The table below
shows the format of the ``zero'' value for each type:

<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><STRONG>Column type</STRONG> </TD><TD> <STRONG>``Zero'' value</STRONG>
</TR NOSAVE>
<TR><TD><CODE>DATETIME</CODE> </TD><TD> <CODE>'0000-00-00 00:00:00'</CODE>
</TR NOSAVE>
<TR><TD><CODE>DATE</CODE> </TD><TD> <CODE>'0000-00-00'</CODE>
</TR NOSAVE>
<TR><TD><CODE>TIMESTAMP</CODE> </TD><TD> <CODE>00000000000000</CODE> (length depends on display size)
</TR NOSAVE>
<TR><TD><CODE>TIME</CODE> </TD><TD> <CODE>'00:00:00'</CODE>
</TR NOSAVE>
<TR><TD><CODE>YEAR</CODE> </TD><TD> <CODE>0000</CODE>
</TR>
</TABLE>

<LI>

The ``zero'' values are special, but you can store or refer to them
explicitly using the values shown in the table.  You can also do this
using the values <CODE>'0'</CODE> or <CODE>0</CODE>, which are easier to write.

<LI>

``Zero'' date or time values used through <STRONG>MyODBC</STRONG> are converted
automatically to <CODE>NULL</CODE> in <STRONG>MyODBC</STRONG> 2.50.12 and above, because
ODBC can't handle such values.
</UL>

<P>
<A NAME="IDX241"></A>


<H4><A NAME="Y2K_issues" HREF="manual_toc.html#Y2K_issues">7.3.6.1  Y2K issues and date types</A></H4>

<P>
<STRONG>MySQL</STRONG> itself is Y2K-safe (see section <A HREF="manual.html#Year_2000_compliance">1.7  Year 2000 compliance</A>),
but input values presented to <STRONG>MySQL</STRONG> may not be.  Any input
containing 2-digit year values is ambiguous, since the century is unknown.
Such values must be interpreted into 4-digit form since <STRONG>MySQL</STRONG> stores
years internally using four digits.

</P>
<P>
For <CODE>DATETIME</CODE>, <CODE>DATE</CODE>, <CODE>TIMESTAMP</CODE> and <CODE>YEAR</CODE> types,
<STRONG>MySQL</STRONG> interprets dates with ambiguous year values using the
following rules:

</P>

<UL>
<LI>

Year values in the range <CODE>00-69</CODE> are converted to <CODE>2000-2069</CODE>.

<LI>

Year values in the range <CODE>70-99</CODE> are converted to <CODE>1970-1999</CODE>.
</UL>

<P>
Remember that these rules provide only reasonable guesses as to what your
data mean.  If the heuristics used by <STRONG>MySQL</STRONG> don't produce the
correct values, you should provide unambiguous input containing 4-digit
year values.

</P>
<P>
<A NAME="IDX242"></A>
<A NAME="IDX243"></A>
<A NAME="IDX244"></A>


<H4><A NAME="DATETIME" HREF="manual_toc.html#DATETIME">7.3.6.2  The <CODE>DATETIME</CODE>, <CODE>DATE</CODE> and <CODE>TIMESTAMP</CODE> types</A></H4>

<P>
The <CODE>DATETIME</CODE>, <CODE>DATE</CODE> and <CODE>TIMESTAMP</CODE> types are related.
This section describes their characteristics, how they are similar and how
they differ.

</P>
<P>
The <CODE>DATETIME</CODE> type is used when you need values that contain both date
and time information.  <STRONG>MySQL</STRONG> retrieves and displays <CODE>DATETIME</CODE>
values in <CODE>'YYYY-MM-DD HH:MM:SS'</CODE> format.  The supported range is
<CODE>'1000-01-01 00:00:00'</CODE> to <CODE>'9999-12-31 23:59:59'</CODE>.  (``Supported''
means that although earlier values might work, there is no guarantee that
they will.)

</P>
<P>
The <CODE>DATE</CODE> type is used when you need only a date value, without a time
part.  <STRONG>MySQL</STRONG> retrieves and displays <CODE>DATE</CODE> values in
<CODE>'YYYY-MM-DD'</CODE> format.  The supported range is <CODE>'1000-01-01'</CODE> to
<CODE>'9999-12-31'</CODE>.

</P>
<P>
The <CODE>TIMESTAMP</CODE> column type provides a type that you can use to
automatically mark <CODE>INSERT</CODE> or <CODE>UPDATE</CODE> operations with the current
date and time.  If you have multiple <CODE>TIMESTAMP</CODE> columns, only the first
one is updated automatically.

</P>
<P>
Automatic updating of the first <CODE>TIMESTAMP</CODE> column occurs under any of
the following conditions:

</P>

<UL>
<LI>

The column is not specified explicitly in an <CODE>INSERT</CODE> or
<CODE>LOAD DATA INFILE</CODE> statement.
<LI>

The column is not specified explicitly in an <CODE>UPDATE</CODE> statement and some
other column changes value.  (Note that an <CODE>UPDATE</CODE> that sets a column
to the value it already has will not cause the <CODE>TIMESTAMP</CODE> column to be
updated, because if you set a column to its current value, <STRONG>MySQL</STRONG>
ignores the update for efficiency.)
<LI>

You explicitly set the <CODE>TIMESTAMP</CODE> column to <CODE>NULL</CODE>.
</UL>

<P>
<CODE>TIMESTAMP</CODE> columns other than the first may also be set to the current
date and time.  Just set the column to <CODE>NULL</CODE>, or to <CODE>NOW()</CODE>.

</P>
<P>
You can set any <CODE>TIMESTAMP</CODE> column to a value different than the current
date and time by setting it explicitly to the desired value.  This is true
even for the first <CODE>TIMESTAMP</CODE> column.  You can use this property if,
for example, you want a <CODE>TIMESTAMP</CODE> to be set to the current date and
time when you create a row, but not to be changed whenever the row is updated
later:

</P>

<UL>
<LI>

Let <STRONG>MySQL</STRONG> set the column when the row is created.
This will initialize it to the current date and time.

<LI>

When you perform subsequent updates to other columns in the row, set
the <CODE>TIMESTAMP</CODE> column explicitly to its current value.
</UL>

<P>
On the other hand, you may find it just as easy to use a <CODE>DATETIME</CODE>
column that you initialize to <CODE>NOW()</CODE> when the row is created and
leave alone for subsequent updates.

</P>
<P>
<CODE>TIMESTAMP</CODE> values may range from the beginning of 1970 to sometime in
the year 2037, with a resolution of one second.  Values are displayed as
numbers.

</P>
<P>
The format in which <STRONG>MySQL</STRONG> retrieves and displays <CODE>TIMESTAMP</CODE>
values depends on the display size, as illustrated by the table below.  The
`full' <CODE>TIMESTAMP</CODE> format is 14 digits, but <CODE>TIMESTAMP</CODE> columns may
be created with shorter display sizes:

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><STRONG>Column type</STRONG> </TD><TD> <STRONG>Display format</STRONG>
</TR NOSAVE>
<TR><TD><CODE>TIMESTAMP(14)</CODE> </TD><TD> <CODE>YYYYMMDDHHMMSS</CODE>
</TR NOSAVE>
<TR><TD><CODE>TIMESTAMP(12)</CODE> </TD><TD> <CODE>YYMMDDHHMMSS</CODE>
</TR NOSAVE>
<TR><TD><CODE>TIMESTAMP(10)</CODE> </TD><TD> <CODE>YYMMDDHHMM</CODE>
</TR NOSAVE>
<TR><TD><CODE>TIMESTAMP(8)</CODE> </TD><TD> <CODE>YYYYMMDD</CODE>
</TR NOSAVE>
<TR><TD><CODE>TIMESTAMP(6)</CODE> </TD><TD> <CODE>YYMMDD</CODE>
</TR NOSAVE>
<TR><TD><CODE>TIMESTAMP(4)</CODE> </TD><TD> <CODE>YYMM</CODE>
</TR NOSAVE>
<TR><TD><CODE>TIMESTAMP(2)</CODE> </TD><TD> <CODE>YY</CODE>
</TR>
</TABLE>

<P>
All <CODE>TIMESTAMP</CODE> columns have the same storage size, regardless of
display size.  The most common display sizes are 6, 8, 12, and 14.  You can
specify an arbitrary display size at table creation time, but values of 0 or
greater than 14 are coerced to 14.  Odd-valued sizes in the range from 1 to
13 are coerced to the next higher even number.

</P>
<P>
You can specify <CODE>DATETIME</CODE>, <CODE>DATE</CODE> and <CODE>TIMESTAMP</CODE> values using
any of a common set of formats:

</P>

<UL>
<LI>

As a string in either <CODE>'YYYY-MM-DD HH:MM:SS'</CODE> or <CODE>'YY-MM-DD
HH:MM:SS'</CODE> format.  A ``relaxed'' syntax is allowed--any punctuation
character may be used as the delimiter between date parts or time parts.
For example, <CODE>'98-12-31 11:30:45'</CODE>, <CODE>'98.12.31 11+30+45'</CODE>,
<CODE>'98/12/31 11*30*45'</CODE> and <CODE>'98@12@31 11^30^45'</CODE> are
equivalent.

<LI>

As a string in either <CODE>'YYYY-MM-DD'</CODE> or <CODE>'YY-MM-DD'</CODE> format.
A ``relaxed'' syntax is allowed here, too.  For example, <CODE>'98-12-31'</CODE>,
<CODE>'98.12.31'</CODE>, <CODE>'98/12/31'</CODE> and <CODE>'98@12@31'</CODE> are
equivalent.

<LI>

As a string with no delimiters in either <CODE>'YYYYMMDDHHMMSS'</CODE> or
<CODE>'YYMMDDHHMMSS'</CODE> format, provided that the string makes sense as a
date.  For example, <CODE>'19970523091528'</CODE> and <CODE>'970523091528'</CODE> are
interpreted as <CODE>'1997-05-23 09:15:28'</CODE>, but <CODE>'971122459015'</CODE> is
illegal (it has a nonsensical minute part) and becomes <CODE>'0000-00-00
00:00:00'</CODE>.

<LI>

As a string with no delimiters in either <CODE>'YYYYMMDD'</CODE> or <CODE>'YYMMDD'</CODE>
format, provided that the string makes sense as a date.  For example,
<CODE>'19970523'</CODE> and <CODE>'970523'</CODE> are interpreted as
<CODE>'1997-05-23'</CODE>, but <CODE>'971332'</CODE> is illegal (it has nonsensical month
and day parts) and becomes <CODE>'0000-00-00'</CODE>.

<LI>

As a number in either <CODE>YYYYMMDDHHMMSS</CODE> or <CODE>YYMMDDHHMMSS</CODE>
format, provided that the number makes sense as a date.  For example,
<CODE>19830905132800</CODE> and <CODE>830905132800</CODE> are interpreted as
<CODE>'1983-09-05 13:28:00'</CODE>.

<LI>

As a number in either <CODE>YYYYMMDD</CODE> or <CODE>YYMMDD</CODE>
format, provided that the number makes sense as a date.  For example,
<CODE>19830905</CODE> and <CODE>830905</CODE> are interpreted as <CODE>'1983-09-05'</CODE>.

<LI>

As the result of a function that returns a value that is acceptable
in a <CODE>DATETIME</CODE>, <CODE>DATE</CODE> or <CODE>TIMESTAMP</CODE> context, such as
<CODE>NOW()</CODE> or <CODE>CURRENT_DATE</CODE>.
</UL>

<P>
Illegal <CODE>DATETIME</CODE>, <CODE>DATE</CODE> or <CODE>TIMESTAMP</CODE> values are converted
to the ``zero'' value of the appropriate type (<CODE>'0000-00-00 00:00:00'</CODE>,
<CODE>'0000-00-00'</CODE> or <CODE>00000000000000</CODE>).

</P>
<P>
For values specified as strings that include date part delimiters, it is not
necessary to specify two digits for month or day values that are less than
<CODE>10</CODE>.  <CODE>'1979-6-9'</CODE> is the same as <CODE>'1979-06-09'</CODE>.  Similarly,
for values specified as strings that include time part delimiters, it is not
necessary to specify two digits for hour, month or second values that are
less than <CODE>10</CODE>.  <CODE>'1979-10-30 1:2:3'</CODE> is the same as
<CODE>'1979-10-30 01:02:03'</CODE>.

</P>
<P>
Values specified as numbers should be 6, 8, 12 or 14 digits long.  If the
number is 8 or 14 digits long, it is assumed to be in <CODE>YYYYMMDD</CODE> or
<CODE>YYYYMMDDHHMMSS</CODE> format and that the year is given by the first 4
digits.  If the number is 6 or 12 digits long, it is assumed to be in
<CODE>YYMMDD</CODE> or <CODE>YYMMDDHHMMSS</CODE> format and that the year is given by the
first 2 digits.  Numbers that are not one of these lengths are interpreted
as though padded with leading zeros to the closest length.

</P>
<P>
Values specified as non-delimited strings are interpreted using their length
as given.  If the string is 8 or 14 characters long, the year is assumed to
be given by the first 4 characters.  Otherwise the year is assumed to be
given by the first 2 characters.  The string is interpreted from left to
right to find year, month, day, hour, minute and second values, for as many
parts as are present in the string.  This means you should not use strings
that have fewer than 6 characters.  For example, if you specify <CODE>'9903'</CODE>,
thinking that will represent March, 1999, you will find that <STRONG>MySQL</STRONG>
inserts a ``zero'' date into your table.  This is because the year and month
values are <CODE>99</CODE> and <CODE>03</CODE>, but the day part is missing (zero), so
the value is not a legal date.

</P>
<P>
<CODE>TIMESTAMP</CODE> columns store legal values using the full precision with
which the value was specified, regardless of the display size.  This has
several implications:

</P>

<UL>
<LI>

Always specify year, month, and day, even if your column types are
<CODE>TIMESTAMP(4)</CODE> or <CODE>TIMESTAMP(2)</CODE>.  Otherwise, the value will not
be a legal date and <CODE>0</CODE> will be stored.

<LI>

If you use <CODE>ALTER TABLE</CODE> to widen a narrow <CODE>TIMESTAMP</CODE> column,
information will be displayed that previously was ``hidden''.

<LI>

Similarly, narrowing a <CODE>TIMESTAMP</CODE> column does not cause information to
be lost, except in the sense that less information is shown when the values
are displayed.

<LI>

Although <CODE>TIMESTAMP</CODE> values are stored to full precision, the only
function that operates directly on the underlying stored value is
<CODE>UNIX_TIMESTAMP()</CODE>.  Other functions operate on the formatted retrieved
value.  This means you cannot use functions such as <CODE>HOUR()</CODE> or
<CODE>SECOND()</CODE> unless the relevant part of the <CODE>TIMESTAMP</CODE> value is
included in the formatted value.  For example, the <CODE>HH</CODE> part of a
<CODE>TIMESTAMP</CODE> column is not displayed unless the display size is at least
10, so trying to use <CODE>HOUR()</CODE> on shorter <CODE>TIMESTAMP</CODE> values
produces a meaningless result.
</UL>

<P>
You can to some extent assign values of one date type to an object
of a different date type.  However, there may be some alteration
of the value or loss of information:

</P>

<UL>
<LI>

If you assign a <CODE>DATE</CODE> value to a <CODE>DATETIME</CODE> or <CODE>TIMESTAMP</CODE>
object, the time part of the resulting value is set to <CODE>'00:00:00'</CODE>,
because the <CODE>DATE</CODE> value contains no time information.

<LI>

If you assign a <CODE>DATETIME</CODE> or <CODE>TIMESTAMP</CODE> value to a <CODE>DATE</CODE>
object, the time part of the resulting value is deleted, because the
<CODE>DATE</CODE> type stores no time information.

<LI>

Remember that although <CODE>DATETIME</CODE>, <CODE>DATE</CODE> and <CODE>TIMESTAMP</CODE>
values all can be specified using the same set of formats, the types do not
all have the same range of values.  For example, <CODE>TIMESTAMP</CODE> values
cannot be earlier than <CODE>1970</CODE> or later than <CODE>2037</CODE>.  This means
that a date such as <CODE>'1968-01-01'</CODE>, while legal as a <CODE>DATETIME</CODE> or
<CODE>DATE</CODE> value, is not a valid <CODE>TIMESTAMP</CODE> value and will be
converted to <CODE>0</CODE> if assigned to such an object.
</UL>

<P>
Be aware of certain pitfalls when specifying date values:

</P>

<UL>
<LI>

The relaxed format allowed for values specified as strings can be deceiving.
For example, a value such as <CODE>'10:11:12'</CODE> might look like a time value
because of the <SAMP>`:'</SAMP> delimiter, but if used in a date context will be
interpreted as the year <CODE>'2010-11-12'</CODE>.  The value <CODE>'10:45:15'</CODE>
will be converted to <CODE>'0000-00-00'</CODE> because <CODE>'45'</CODE> is not a legal
month.

<LI>

Year values specified as two digits are ambiguous, since the century is
unknown.  <STRONG>MySQL</STRONG> interprets 2-digit year values using the following
rules:


<UL>
<LI>

Year values in the range <CODE>00-69</CODE> are converted to <CODE>2000-2069</CODE>.

<LI>

Year values in the range <CODE>70-99</CODE> are converted to <CODE>1970-1999</CODE>.
</UL>

</UL>

<P>
<A NAME="IDX245"></A>


<H4><A NAME="TIME" HREF="manual_toc.html#TIME">7.3.6.3  The <CODE>TIME</CODE> type</A></H4>

<P>
<STRONG>MySQL</STRONG> retrieves and displays <CODE>TIME</CODE> values in <CODE>'HH:MM:SS'</CODE>
format (or <CODE>'HHH:MM:SS'</CODE> format for large hours values).  <CODE>TIME</CODE>
values may range from <CODE>'-838:59:59'</CODE> to <CODE>'838:59:59'</CODE>.  The reason
the hours part may be so large is that the <CODE>TIME</CODE> type may be used not
only to represent a time of day (which must be less than 24 hours), but also
elapsed time or a time interval between two events (which may be much greater
than 24 hours, or even negative).

</P>
<P>
You can specify <CODE>TIME</CODE> values in a variety of formats:

</P>

<UL>
<LI>

As a string in <CODE>'HH:MM:SS'</CODE> format.
A ``relaxed'' syntax is allowed--any punctuation character may be
used as the delimiter between time parts.  For example, <CODE>'10:11:12'</CODE>
and <CODE>'10.11.12'</CODE> are equivalent.

<LI>

As a string with no delimiters in <CODE>'HHMMSS'</CODE> format, provided that
it makes sense as a time.  For example, <CODE>'101112'</CODE> is understood as
<CODE>'10:11:12'</CODE>, but <CODE>'109712'</CODE> is illegal (it has a nonsensical
minute part) and becomes <CODE>'00:00:00'</CODE>.

<LI>

As a number in <CODE>HHMMSS</CODE> format, provided that it makes sense as a time.
For example, <CODE>101112</CODE> is understood as <CODE>'10:11:12'</CODE>.

<LI>

As the result of a function that returns a value that is acceptable
in a <CODE>TIME</CODE> context, such as <CODE>CURRENT_TIME</CODE>.
</UL>

<P>
For <CODE>TIME</CODE> values specified as strings that include a time part
delimiter, it is not necessary to specify two digits for hours, minutes or
seconds values that are less than <CODE>10</CODE>.  <CODE>'8:3:2'</CODE> is the same as
<CODE>'08:03:02'</CODE>.

</P>
<P>
Be careful about assigning ``short'' <CODE>TIME</CODE> values to a <CODE>TIME</CODE>
column.  <STRONG>MySQL</STRONG> interprets values using the assumption that the
rightmost digits represent seconds.  (<STRONG>MySQL</STRONG> interprets <CODE>TIME</CODE>
values as elapsed time, rather than as time of day.)  For example, you might
think of <CODE>'11:12'</CODE>, <CODE>'1112'</CODE> and <CODE>1112</CODE> as meaning
<CODE>'11:12:00'</CODE> (12 minutes after 11 o'clock), but <STRONG>MySQL</STRONG>
interprets them as <CODE>'00:11:12'</CODE> (11 minutes, 12 seconds).  Similarly,
<CODE>'12'</CODE> and <CODE>12</CODE> are interpreted as <CODE>'00:00:12'</CODE>.

</P>
<P>
Values that lie outside the <CODE>TIME</CODE> range
but are otherwise legal are clipped to the appropriate
endpoint of the range.  For example, <CODE>'-850:00:00'</CODE> and
<CODE>'850:00:00'</CODE> are converted to <CODE>'-838:59:59'</CODE> and
<CODE>'838:59:59'</CODE>.

</P>
<P>
Illegal <CODE>TIME</CODE> values are converted to <CODE>'00:00:00'</CODE>.  Note that
since <CODE>'00:00:00'</CODE> is itself a legal <CODE>TIME</CODE> value, there is no way
to tell, from a value of <CODE>'00:00:00'</CODE> stored in a table, whether the
original value was specified as <CODE>'00:00:00'</CODE> or whether it was illegal.

</P>
<P>
<A NAME="IDX246"></A>


<H4><A NAME="YEAR" HREF="manual_toc.html#YEAR">7.3.6.4  The <CODE>YEAR</CODE> type</A></H4>

<P>
The <CODE>YEAR</CODE> type is a 1-byte type used for representing years.

</P>
<P>
<STRONG>MySQL</STRONG> retrieves and displays <CODE>YEAR</CODE> values in <CODE>YYYY</CODE>
format.  The range is <CODE>1901</CODE> to <CODE>2155</CODE>.

</P>
<P>
You can specify <CODE>YEAR</CODE> values in a variety of formats:

</P>

<UL>
<LI>

As a four-digit string in the range <CODE>'1901'</CODE> to <CODE>'2155'</CODE>.

<LI>

As a four-digit number in the range <CODE>1901</CODE> to <CODE>2155</CODE>.

<LI>

As a two-digit string in the range <CODE>'00'</CODE> to <CODE>'99'</CODE>.  Values in the
ranges <CODE>'00'</CODE> to <CODE>'69'</CODE> and <CODE>'70'</CODE> to <CODE>'99'</CODE> are
converted to <CODE>YEAR</CODE> values in the ranges <CODE>2000</CODE> to <CODE>2069</CODE> and
<CODE>1970</CODE> to <CODE>1999</CODE>.

<LI>

As a two-digit number in the range <CODE>1</CODE> to <CODE>99</CODE>.  Values in the
ranges <CODE>1</CODE> to <CODE>69</CODE> and <CODE>70</CODE> to <CODE>99</CODE> are converted to
<CODE>YEAR</CODE> values in the ranges <CODE>2001</CODE> to <CODE>2069</CODE> and <CODE>1970</CODE>
to <CODE>1999</CODE>.  Note that the range for two-digit numbers is slightly
different than the range for two-digit strings, since you cannot specify zero
directly as a number and have it be interpreted as <CODE>2000</CODE>.  You
<EM>must</EM> specify it as a string <CODE>'0'</CODE> or <CODE>'00'</CODE> or it will be
interpreted as <CODE>0000</CODE>.

<LI>

As the result of a function that returns a value that is acceptable
in a <CODE>YEAR</CODE> context, such as <CODE>NOW()</CODE>.
</UL>

<P>
Illegal <CODE>YEAR</CODE> values are converted to <CODE>0000</CODE>.

</P>


<H3><A NAME="String_types" HREF="manual_toc.html#String_types">7.3.7  String types</A></H3>

<P>
The string types are <CODE>CHAR</CODE>, <CODE>VARCHAR</CODE>, <CODE>BLOB</CODE>, <CODE>TEXT</CODE>,
<CODE>ENUM</CODE> and <CODE>SET</CODE>.

</P>
<P>
<A NAME="IDX247"></A>
<A NAME="IDX248"></A>

</P>


<H4><A NAME="CHAR" HREF="manual_toc.html#CHAR">7.3.7.1  The <CODE>CHAR</CODE> and <CODE>VARCHAR</CODE> types</A></H4>

<P>
The <CODE>CHAR</CODE> and <CODE>VARCHAR</CODE> types are similar, but differ in the
way they are stored and retrieved.

</P>
<P>
The length of a <CODE>CHAR</CODE> column is fixed to the length that you declare
when you create the table.  The length can be any value between 1 and 255.
(As of MySQL 3.23, the length of <CODE>CHAR</CODE> may be 0 to 255.)
When <CODE>CHAR</CODE> values are stored, they are right-padded with spaces to the
specified length.  When <CODE>CHAR</CODE> values are retrieved, trailing spaces are
removed.

</P>
<P>
Values in <CODE>VARCHAR</CODE> columns are variable-length strings.  You can
declare a <CODE>VARCHAR</CODE> column to be any length between 1 and 255, just as
for <CODE>CHAR</CODE> columns.  However, in contrast to <CODE>CHAR</CODE>, <CODE>VARCHAR</CODE>
values are stored using only as many characters as are needed, plus one byte
to record the length.  Values are not padded; instead, trailing spaces are
removed when values are stored.  (This space removal differs from the ANSI
SQL specification.)

</P>
<P>
If you assign a value to a <CODE>CHAR</CODE> or <CODE>VARCHAR</CODE> column that
exceeds the column's maximum length, the value is truncated to fit.

</P>
<P>
The table below illustrates the differences between the two types of columns
by showing the result of storing various string values into <CODE>CHAR(4)</CODE>
and <CODE>VARCHAR(4)</CODE> columns:

</P>

<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><STRONG>Value</STRONG> </TD><TD> <CODE>CHAR(4)</CODE> </TD><TD> <STRONG>Storage required</STRONG> </TD><TD> <CODE>VARCHAR(4)</CODE> </TD><TD> <STRONG>Storage required</STRONG>
</TR NOSAVE>
<TR><TD><CODE>''</CODE> </TD><TD> <CODE>'    '</CODE> </TD><TD> 4 bytes </TD><TD> <CODE>''</CODE> </TD><TD> 1 byte
</TR NOSAVE>
<TR><TD><CODE>'ab'</CODE> </TD><TD> <CODE>'ab  '</CODE> </TD><TD> 4 bytes </TD><TD> <CODE>'ab'</CODE> </TD><TD> 3 bytes
</TR NOSAVE>
<TR><TD><CODE>'abcd'</CODE> </TD><TD> <CODE>'abcd'</CODE> </TD><TD> 4 bytes </TD><TD> <CODE>'abcd'</CODE> </TD><TD> 5 bytes
</TR NOSAVE>
<TR><TD><CODE>'abcdefgh'</CODE> </TD><TD> <CODE>'abcd'</CODE> </TD><TD> 4 bytes </TD><TD> <CODE>'abcd'</CODE> </TD><TD> 5 bytes
</TR>
</TABLE>

<P>
The values retrieved from the <CODE>CHAR(4)</CODE> and <CODE>VARCHAR(4)</CODE> columns
will be the same in each case, because trailing spaces are removed from
<CODE>CHAR</CODE> columns upon retrieval.

</P>
<P>
Values in <CODE>CHAR</CODE> and <CODE>VARCHAR</CODE> columns are sorted and compared in
case-insensitive fashion, unless the <CODE>BINARY</CODE> attribute was specified
when the table was created.  The <CODE>BINARY</CODE> attribute means that column
values are sorted and compared in case-sensitive fashion according to the
ASCII order of the machine where the <STRONG>MySQL</STRONG> server is running.

</P>
<P>
The <CODE>BINARY</CODE> attribute is ``sticky''.  This means that if a column marked
<CODE>BINARY</CODE> is used in an expression, the whole expression is compared as a
<CODE>BINARY</CODE> value.

</P>
<P>
<STRONG>MySQL</STRONG> may silently change the type of a <CODE>CHAR</CODE> or <CODE>VARCHAR</CODE>
column at table creation time.
See section <A HREF="manual.html#Silent_column_changes">7.7.1  Silent column specification changes</A>.

</P>
<P>
<A NAME="IDX249"></A>
<A NAME="IDX250"></A>


<H4><A NAME="BLOB" HREF="manual_toc.html#BLOB">7.3.7.2  The <CODE>BLOB</CODE> and <CODE>TEXT</CODE> types</A></H4>

<P>
A <CODE>BLOB</CODE> is a binary large object that can hold a variable amount of
data.  The four <CODE>BLOB</CODE> types <CODE>TINYBLOB</CODE>, <CODE>BLOB</CODE>,
<CODE>MEDIUMBLOB</CODE> and <CODE>LONGBLOB</CODE> differ only in the maximum length of
the values they can hold.
See section <A HREF="manual.html#Storage_requirements">7.3.1  Column type storage requirements</A>.

</P>
<P>
The four <CODE>TEXT</CODE> types <CODE>TINYTEXT</CODE>, <CODE>TEXT</CODE>, <CODE>MEDIUMTEXT</CODE>
and <CODE>LONGTEXT</CODE> correspond to the four <CODE>BLOB</CODE> types and have the
same maximum lengths and storage requirements.  The only difference between
<CODE>BLOB</CODE> and <CODE>TEXT</CODE> types is that sorting and comparison is performed
in case-sensitive fashion for <CODE>BLOB</CODE> values and case-insensitive fashion
for <CODE>TEXT</CODE> values.  In other words, a <CODE>TEXT</CODE> is a case-insensitive
<CODE>BLOB</CODE>.

</P>
<P>
If you assign a value to a <CODE>BLOB</CODE> or <CODE>TEXT</CODE> column that exceeds
the column type's maximum length, the value is truncated to fit.

</P>
<P>
In most respects, you can regard a <CODE>TEXT</CODE> column as a <CODE>VARCHAR</CODE>
column that can be as big as you like.  Similarly, you can regard a
<CODE>BLOB</CODE> column as a <CODE>VARCHAR BINARY</CODE> column.  The differences are:

</P>

<UL>
<LI>

You can have indexes on <CODE>BLOB</CODE> and <CODE>TEXT</CODE> columns with
<STRONG>MySQL</STRONG> versions 3.23.2 and newer. Older versions of
<STRONG>MySQL</STRONG> did not support this.

<LI>

There is no trailing-space removal for <CODE>BLOB</CODE> and <CODE>TEXT</CODE> columns
when values are stored, as there is for <CODE>VARCHAR</CODE> columns.

<LI>

<A NAME="IDX251"></A>
<A NAME="IDX252"></A>
<A NAME="IDX253"></A>
<CODE>BLOB</CODE> and <CODE>TEXT</CODE> columns cannot have <CODE>DEFAULT</CODE> values.
</UL>

<P>
<STRONG>MyODBC</STRONG> defines <CODE>BLOB</CODE> values as <CODE>LONGVARBINARY</CODE> and
<CODE>TEXT</CODE> values as <CODE>LONGVARCHAR</CODE>.

</P>
<P>
Because <CODE>BLOB</CODE> and <CODE>TEXT</CODE> values may be extremely long, you
may run up against some constraints when using them:

</P>

<UL>
<LI>

If you want to use <CODE>GROUP BY</CODE> or <CODE>ORDER BY</CODE> on a <CODE>BLOB</CODE> or
<CODE>TEXT</CODE> column, you must convert the column value into a fixed-length
object. The standard way to do this is with the <CODE>SUBSTRING</CODE>
function.  For example:


<PRE>
mysql&#62; select comment from tbl_name,substring(comment,20) as substr ORDER BY substr;
</PRE>

If you don't do this, only the first <CODE>max_sort_length</CODE> bytes of the
column are used when sorting.  The default value of <CODE>max_sort_length</CODE> is
1024; this value can be changed using the <CODE>-O</CODE> option when starting the
<CODE>mysqld</CODE> server. You can group on an expression involving <CODE>BLOB</CODE> or
<CODE>TEXT</CODE> values by specifying the column position or by using an alias:


<PRE>
mysql&#62; select id,substring(blob_col,1,100) from tbl_name
           GROUP BY 2;
mysql&#62; select id,substring(blob_col,1,100) as b from tbl_name
           GROUP BY b;
</PRE>

<LI>

The maximum size of a <CODE>BLOB</CODE> or <CODE>TEXT</CODE> object is determined by its
type, but the largest value you can actually transmit between the client and
server is determined by the amount of available memory and the size of the
communications buffers.  You can change the message buffer size, but you must
do so on both the server and client ends. See section <A HREF="manual.html#Server_parameters">10.2.3  Tuning server parameters</A>.
</UL>

<P>
Note that each <CODE>BLOB</CODE> or <CODE>TEXT</CODE> value is represented internally by
a separately-allocated object. This is in contrast to all other column types,
for which storage is allocated once per column when the table is opened.

</P>
<P>
<A NAME="IDX254"></A>


<H4><A NAME="ENUM" HREF="manual_toc.html#ENUM">7.3.7.3  The <CODE>ENUM</CODE> type</A></H4>

<P>
An <CODE>ENUM</CODE> is a string object whose value normally is chosen from a list
of allowed values that are enumerated explicitly in the column specification
at table creation time.

</P>
<P>
The value may also be the empty string (<CODE>""</CODE>) or <CODE>NULL</CODE> under
certain circumstances:

</P>

<UL>
<LI>

If you insert an invalid value into an <CODE>ENUM</CODE> (that is, a string not
present in the list of allowed values), the empty string is inserted
instead as a special error value.

<LI>

If an <CODE>ENUM</CODE> is declared <CODE>NULL</CODE>, <CODE>NULL</CODE> is also a legal value
for the column, and the default value is <CODE>NULL</CODE>.  If an <CODE>ENUM</CODE> is
declared <CODE>NOT NULL</CODE>, the default value is the first element of the
list of allowed values.
</UL>

<P>
Each enumeration value has an index:

</P>

<UL>
<LI>

Values from the list of allowable elements in the column specification are
numbered beginning with 1.

<LI>

The index value of the empty string error value is 0.  This means that you
can use the following <CODE>SELECT</CODE> statement to find rows into which invalid
<CODE>ENUM</CODE> values were assigned:


<PRE>
mysql&#62; SELECT * FROM tbl_name WHERE enum_col=0;
</PRE>

<LI>

The index of the <CODE>NULL</CODE> value is <CODE>NULL</CODE>.
</UL>

<P>
For example, a column specified as <CODE>ENUM("one", "two", "three")</CODE> can
have any of the values shown below.  The index of each value is also shown:

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><STRONG>Value</STRONG> </TD><TD> <STRONG>Index</STRONG>
</TR NOSAVE>
<TR><TD><CODE>NULL</CODE> </TD><TD> <CODE>NULL</CODE>
</TR NOSAVE>
<TR><TD><CODE>""</CODE> </TD><TD> 0
</TR NOSAVE>
<TR><TD><CODE>"one"</CODE> </TD><TD> 1
</TR NOSAVE>
<TR><TD><CODE>"two"</CODE> </TD><TD> 2
</TR NOSAVE>
<TR><TD><CODE>"three"</CODE> </TD><TD> 3
</TR>
</TABLE>

<P>
An enumeration can have a maximum of 65535 elements.

</P>
<P>
Lettercase is irrelevant when you assign values to an <CODE>ENUM</CODE> column.
However, values retrieved from the column later have lettercase matching the
values that were used to specify the allowable values at table creation time.

</P>
<P>
If you retrieve an <CODE>ENUM</CODE> in a numeric context, the column value's index
is returned.  If you store a number into an <CODE>ENUM</CODE>, the number is
treated as an index, and the the value stored is the enumeration member with
that index.

</P>
<P>
<CODE>ENUM</CODE> values are sorted according to the order in which the enumeration
members were listed in the column specification.  (In other words,
<CODE>ENUM</CODE> values are sorted according to their index numbers.)  For
example, <CODE>"a"</CODE> sorts before <CODE>"b"</CODE> for <CODE>ENUM("a", "b")</CODE>, but
<CODE>"b"</CODE> sorts before <CODE>"a"</CODE> for <CODE>ENUM("b", "a")</CODE>.  The empty
string sorts before non-empty strings, and <CODE>NULL</CODE> values sort before
all other enumeration values.

</P>
<P>
If you want to get all possible values for an <CODE>ENUM</CODE> column, you should
use: <CODE>SHOW COLUMNS FROM table_name LIKE enum_column_name</CODE> and parse
the <CODE>ENUM</CODE> definition in the second column.

</P>
<P>
<A NAME="IDX255"></A>


<H4><A NAME="SET" HREF="manual_toc.html#SET">7.3.7.4  The <CODE>SET</CODE> type</A></H4>

<P>
A <CODE>SET</CODE> is a string object that can have zero or more values, each of
which must be chosen from a list of allowed values specified when the table
is created.  <CODE>SET</CODE> column values that consist of multiple set members
are specified with members separated by commas (<SAMP>`,'</SAMP>).  A consequence of
this is that <CODE>SET</CODE> member values cannot themselves contain commas.

</P>
<P>
For example, a column specified as <CODE>SET("one", "two") NOT NULL</CODE> can have
any of these values:

</P>

<PRE>
""
"one"
"two"
"one,two"
</PRE>

<P>
A <CODE>SET</CODE> can have a maximum of 64 different members.

</P>
<P>
<STRONG>MySQL</STRONG> stores <CODE>SET</CODE> values numerically, with the low-order bit
of the stored value corresponding to the first set member.  If you retrieve a
<CODE>SET</CODE> value in a numeric context, the value retrieved has bits set
corresponding to the set members that make up the column value.  If a number
is stored into a <CODE>SET</CODE> column, the bits that are set in the binary
representation of the number determine the set members in the column value.
Suppose a column is specified as <CODE>SET("a","b","c","d")</CODE>.  Then the
members have the following bit values:

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><CODE>SET</CODE> <STRONG>member</STRONG> </TD><TD> <STRONG>Decimal value</STRONG> </TD><TD> <STRONG>Binary value</STRONG>
</TR NOSAVE>
<TR><TD><CODE>a</CODE> </TD><TD> <CODE>1</CODE> </TD><TD> <CODE>0001</CODE>
</TR NOSAVE>
<TR><TD><CODE>b</CODE> </TD><TD> <CODE>2</CODE> </TD><TD> <CODE>0010</CODE>
</TR NOSAVE>
<TR><TD><CODE>c</CODE> </TD><TD> <CODE>4</CODE> </TD><TD> <CODE>0100</CODE>
</TR NOSAVE>
<TR><TD><CODE>d</CODE> </TD><TD> <CODE>8</CODE> </TD><TD> <CODE>1000</CODE>
</TR>
</TABLE>

<P>
If you assign a value of <CODE>9</CODE> to this column, that is <CODE>1001</CODE> in
binary, so the first and fourth <CODE>SET</CODE> value members <CODE>"a"</CODE> and
<CODE>"d"</CODE> are selected and the resulting value is <CODE>"a,d"</CODE>.

</P>
<P>
For a value containing more than one <CODE>SET</CODE> element, it does not matter
what order the elements are listed in when you insert the value.  It also
doesn't not matter how many times a given element is listed in the value.
When the value is retrieved later, each element in the value will appear
once, with elements listed according to the order in which they were
specified at table creation time.  For example, if a column is specified as
<CODE>SET("a","b","c","d")</CODE>, then <CODE>"a,d"</CODE>, <CODE>"d,a"</CODE> and
<CODE>"d,a,a,d,d"</CODE> will all appear as <CODE>"a,d"</CODE> when retrieved.

</P>
<P>
<CODE>SET</CODE> values are sorted numerically.  <CODE>NULL</CODE> values sort before
non-<CODE>NULL</CODE> <CODE>SET</CODE> values.

</P>
<P>
Normally, you perform a <CODE>SELECT</CODE> on a <CODE>SET</CODE> column using
the <CODE>LIKE</CODE> operator or the <CODE>FIND_IN_SET()</CODE> function:

</P>

<PRE>
mysql&#62; SELECT * FROM tbl_name WHERE set_col LIKE '%value%';
mysql&#62; SELECT * FROM tbl_name WHERE FIND_IN_SET('value',set_col)&#62;0;
</PRE>

<P>
But the following will also work:

</P>

<PRE>
mysql&#62; SELECT * FROM tbl_name WHERE set_col = 'val1,val2';
mysql&#62; SELECT * FROM tbl_name WHERE set_col &#38; 1;
</PRE>

<P>
The first of these statements looks for an exact match.  The second looks
for values containing the first set member.

</P>
<P>
If you want to get all possible values for an <CODE>SET</CODE> column, you should
use: <CODE>SHOW COLUMNS FROM table_name LIKE set_column_name</CODE> and parse
the <CODE>SET</CODE> definition in the second column.

</P>
<P>
<A NAME="IDX256"></A>
<A NAME="IDX257"></A>


<H3><A NAME="Choosing_types" HREF="manual_toc.html#Choosing_types">7.3.8  Choosing the right type for a column</A></H3>

<P>
For the most efficient use of storage, try to use the most precise type in
all cases. For example, if an integer column will be used for values in the
range between <CODE>1</CODE> and <CODE>99999</CODE>, <CODE>MEDIUMINT UNSIGNED</CODE> is the
best type.

</P>
<P>
Accurate representation of monetary values is a common problem. In
<STRONG>MySQL</STRONG>, you should use the <CODE>DECIMAL</CODE> type. This is stored as
a string, so no loss of accuracy should occur. If accuracy is not
too important, the <CODE>DOUBLE</CODE> type may also be good enough.

</P>
<P>
For high precision, you can always convert to a fixed-point type stored
in a <CODE>BIGINT</CODE>. This allows you to do all calculations with integers
and convert results back to floating-point values only when necessary.
See section <A HREF="manual.html#Choosing_table_type">10.6  Choosing a table type</A>.

</P>
<P>
<A NAME="IDX258"></A>
<A NAME="IDX259"></A>


<H3><A NAME="Indexes" HREF="manual_toc.html#Indexes">7.3.9  Column indexes</A></H3>

<P>
All <STRONG>MySQL</STRONG> column types can be indexed.  Use of indexes on the
relevant columns is the best way to improve the performance of <CODE>SELECT</CODE>
operations.

</P>
<P>
A table may have up to 16 indexes.  The maximum index length is
256 bytes, although this may be changed when compiling <STRONG>MySQL</STRONG>.

</P>
<P>
For <CODE>CHAR</CODE> and <CODE>VARCHAR</CODE> columns, you can index a prefix of a
column.  This is much faster and requires less disk space than indexing the
whole column.  The syntax to use in the <CODE>CREATE TABLE</CODE> statement to
index a column prefix looks like this:

</P>

<PRE>
KEY index_name (col_name(length))
</PRE>

<P>
The example below creates an index for the first 10 characters of the
<CODE>name</CODE> column:

</P>

<PRE>
mysql&#62; CREATE TABLE test (
           name CHAR(200) NOT NULL,
           KEY index_name (name(10)));
</PRE>

<P>
For <CODE>BLOB</CODE> and <CODE>TEXT</CODE> columns, you must index a prefix of the
column, you cannot index the entire thing.

</P>


<H3><A NAME="Multiple-column_indexes" HREF="manual_toc.html#Multiple-column_indexes">7.3.10  Multiple-column indexes</A></H3>

<P>
<STRONG>MySQL</STRONG> can create indexes on multiple columns.  An index may
consist of up to 15 columns. (On <CODE>CHAR</CODE> and <CODE>VARCHAR</CODE> columns you
can also use a prefix of the column as a part of an index).

</P>
<P>
A multiple-column index can be considered a sorted array containing values
that are created by concatenating the values of the indexed columns.

</P>
<P>
<STRONG>MySQL</STRONG> uses multiple-column indexes in such a way that queries are
fast when you specify a known quantity for the first column of the index in a
<CODE>WHERE</CODE> clause, even if you don't specify values for the other columns.

</P>
<P>
Suppose a table is created using the following specification:

</P>

<PRE>
mysql&#62; CREATE TABLE test (
           id INT NOT NULL,
           last_name CHAR(30) NOT NULL,
           first_name CHAR(30) NOT NULL,
           PRIMARY KEY (id),
           INDEX name (last_name,first_name));
</PRE>

<P>
Then the index <CODE>name</CODE> is an index over <CODE>last_name</CODE> and
<CODE>first_name</CODE>.  The index will be used for queries that specify
values in a known range for <CODE>last_name</CODE>, or for both <CODE>last_name</CODE>
and <CODE>first_name</CODE>.
Therefore, the <CODE>name</CODE> index will be used in the following queries:

</P>

<PRE>
mysql&#62; SELECT * FROM test WHERE last_name="Widenius";

mysql&#62; SELECT * FROM test WHERE last_name="Widenius"
                          AND first_name="Michael";

mysql&#62; SELECT * FROM test WHERE last_name="Widenius"
                          AND (first_name="Michael" OR first_name="Monty");

mysql&#62; SELECT * FROM test WHERE last_name="Widenius"
                          AND first_name &#62;="M" AND first_name &#60; "N";
</PRE>

<P>
However, the <CODE>name</CODE> index will NOT be used in the following queries:

</P>

<PRE>
mysql&#62; SELECT * FROM test WHERE first_name="Michael";

mysql&#62; SELECT * FROM test WHERE last_name="Widenius"
                          OR first_name="Michael";
</PRE>

<P>
For more information on the manner in which <STRONG>MySQL</STRONG> uses indexes to
improve query performance, see section <A HREF="manual.html#MySQL_indexes">10.4  MySQL index use</A>.

</P>
<P>
<A NAME="IDX260"></A>


<H3><A NAME="Other-vendor_column_types" HREF="manual_toc.html#Other-vendor_column_types">7.3.11  Using column types from other database engines</A></H3>

<P>
To make it easier to use code written for SQL implementations from other
vendors, <STRONG>MySQL</STRONG> maps column types as shown in the table below.  These
mappings make it easier to move table definitions from other database engines
to <STRONG>MySQL</STRONG>:

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><STRONG>Other vendor type</STRONG> </TD><TD> <STRONG>MySQL type</STRONG>
</TR NOSAVE>
<TR><TD><CODE>BINARY(NUM)</CODE> </TD><TD> <CODE>CHAR(NUM) BINARY</CODE>
</TR NOSAVE>
<TR><TD><CODE>CHAR VARYING(NUM)</CODE> </TD><TD> <CODE>VARCHAR(NUM)</CODE>
</TR NOSAVE>
<TR><TD><CODE>FLOAT4</CODE> </TD><TD> <CODE>FLOAT</CODE>
</TR NOSAVE>
<TR><TD><CODE>FLOAT8</CODE> </TD><TD> <CODE>DOUBLE</CODE>
</TR NOSAVE>
<TR><TD><CODE>INT1</CODE> </TD><TD> <CODE>TINYINT</CODE>
</TR NOSAVE>
<TR><TD><CODE>INT2</CODE> </TD><TD> <CODE>SMALLINT</CODE>
</TR NOSAVE>
<TR><TD><CODE>INT3</CODE> </TD><TD> <CODE>MEDIUMINT</CODE>
</TR NOSAVE>
<TR><TD><CODE>INT4</CODE> </TD><TD> <CODE>INT</CODE>
</TR NOSAVE>
<TR><TD><CODE>INT8</CODE> </TD><TD> <CODE>BIGINT</CODE>
</TR NOSAVE>
<TR><TD><CODE>LONG VARBINARY</CODE> </TD><TD> <CODE>MEDIUMBLOB</CODE>
</TR NOSAVE>
<TR><TD><CODE>LONG VARCHAR</CODE> </TD><TD> <CODE>MEDIUMTEXT</CODE>
</TR NOSAVE>
<TR><TD><CODE>MIDDLEINT</CODE> </TD><TD> <CODE>MEDIUMINT</CODE>
</TR NOSAVE>
<TR><TD><CODE>VARBINARY(NUM)</CODE> </TD><TD> <CODE>VARCHAR(NUM) BINARY</CODE>
</TR>
</TABLE>

<P>
Column type mapping occurs at table creation time.  If you create a table
with types used by other vendors and then issue a <CODE>DESCRIBE tbl_name</CODE>
statement, <STRONG>MySQL</STRONG> reports the table structure using the equivalent
<STRONG>MySQL</STRONG> types.

</P>
<P>
<A NAME="IDX261"></A>


<H2><A NAME="Functions" HREF="manual_toc.html#Functions">7.4  Functions for use in <CODE>SELECT</CODE> and <CODE>WHERE</CODE> clauses</A></H2>

<P>
A <CODE>select_expression</CODE> or <CODE>where_definition</CODE> in a SQL statement
can consist of any expression using the functions described below.

</P>
<P>
An expression that contains <CODE>NULL</CODE> always produces a <CODE>NULL</CODE> value
unless otherwise indicated in the documentation for the operators and
functions involved in the expression.

</P>
<P>
<STRONG>Note:</STRONG> There must be no whitespace between a function name and the
parenthesis following it. This helps the <STRONG>MySQL</STRONG> parser distinguish
between function calls and references to tables or columns that happen to
have the same name as a function.  Spaces around arguments are permitted,
though.

</P>
<P>
For the sake of brevity, examples display the output from the <CODE>mysql</CODE>
program in abbreviated form.  So this:

</P>

<PRE>
mysql&#62; select MOD(29,9);
1 rows in set (0.00 sec)

+-----------+
| mod(29,9) |
+-----------+
|         2 |
+-----------+
</PRE>

<P>
Is displayed like this:

</P>

<PRE>
mysql&#62; select MOD(29,9);
        -&#62; 2
</PRE>



<H3><A NAME="Grouping_functions" HREF="manual_toc.html#Grouping_functions">7.4.1  Grouping functions</A></H3>
<P>
<A NAME="IDX262"></A>
<DL COMPACT>

<DT><CODE>( ... )</CODE>
<DD>
<A NAME="IDX263"></A>
 <A NAME="IDX264"></A>
 
Parentheses. Use these to force the order of evaluation in an expression.

<PRE>
mysql&#62; select 1+2*3;
        -&#62; 7
mysql&#62; select (1+2)*3;
        -&#62; 9
</PRE>

</DL>



<H3><A NAME="Arithmetic_functions" HREF="manual_toc.html#Arithmetic_functions">7.4.2  Normal arithmetic operations</A></H3>

<P>
The usual arithmetic operators are available.  Note that in the case of
<CODE>-</CODE>, <CODE>+</CODE> and <CODE>*</CODE>, the result is calculated with <CODE>BIGINT</CODE>
(64-bit) precision if both arguments are integers!

</P>
<P>
<A NAME="IDX265"></A>
<DL COMPACT>

<DT><CODE>+</CODE>
<DD>
<A NAME="IDX266"></A>
 <A NAME="IDX267"></A>
 
Addition

<PRE>
mysql&#62; select 3+5;
        -&#62; 8
</PRE>

<A NAME="IDX268"></A>
<A NAME="IDX269"></A>
<DT><CODE>-</CODE>
<DD>
Subtraction

<PRE>
mysql&#62; select 3-5;
        -&#62; -2
</PRE>

<A NAME="IDX270"></A>
<A NAME="IDX271"></A>
<DT><CODE>*</CODE>
<DD>
Multiplication

<PRE>
mysql&#62; select 3*5;
        -&#62; 15
mysql&#62; select 18014398509481984*18014398509481984.0;
        -&#62; 324518553658426726783156020576256.0
mysql&#62; select 18014398509481984*18014398509481984;
        -&#62; 0
</PRE>

The result of the last expression is incorrect because the result of the integer
multiplication exceeds the 64-bit range of <CODE>BIGINT</CODE> calculations.

<A NAME="IDX272"></A>
<A NAME="IDX273"></A>
<DT><CODE>/</CODE>
<DD>
Division

<PRE>
mysql&#62; select 3/5;
        -&#62; 0.60
</PRE>

Division by zero produces a <CODE>NULL</CODE> result:


<PRE>
mysql&#62; select 102/(1-1);
        -&#62; NULL
</PRE>

A division will be calculated with <CODE>BIGINT</CODE> arithmetic only if performed
in a context where its result is converted to an integer!
</DL>

<P>
<A NAME="IDX274"></A>
<A NAME="IDX275"></A>
<A NAME="IDX276"></A>
<A NAME="IDX277"></A>


<H3><A NAME="Bit_functions" HREF="manual_toc.html#Bit_functions">7.4.3  Bit functions</A></H3>

<P>
<STRONG>MySQL</STRONG> uses <CODE>BIGINT</CODE> (64-bit) arithmetic for bit operations, so
these operators have a maximum range of 64 bits.

</P>
<DL COMPACT>

<DT><CODE>|</CODE>
<DD>
<A NAME="IDX278"></A>
 <A NAME="IDX279"></A>
 
Bitwise OR

<PRE>
mysql&#62; select 29 | 15;
        -&#62; 31
</PRE>

<A NAME="IDX280"></A>
<A NAME="IDX281"></A>
<DT><CODE>&#38;</CODE>
<DD>
Bitwise AND

<PRE>
mysql&#62; select 29 &#38; 15;
        -&#62; 13
</PRE>

<A NAME="IDX282"></A>
<DT><CODE>&#60;&#60;</CODE>
<DD>
Shifts a longlong (<CODE>BIGINT</CODE>) number to the left.

<PRE>
mysql&#62; select 1 &#60;&#60; 2
        -&#62; 4
</PRE>

<A NAME="IDX283"></A>
<DT><CODE>&#62;&#62;</CODE>
<DD>
Shifts a longlong (<CODE>BIGINT</CODE>) number to the right.

<PRE>
mysql&#62; select 4 &#62;&#62; 2
        -&#62; 1
</PRE>

<A NAME="IDX284"></A>
<DT><CODE>~</CODE>
<DD>
Invert all bits.

<PRE>
mysql&#62; select 5 &#38; ~1
        -&#62; 4
</PRE>

<A NAME="IDX285"></A>
<DT><CODE>BIT_COUNT(N)</CODE>
<DD>
Returns the number of bits that are set in the argument <CODE>N</CODE>.

<PRE>
mysql&#62; select BIT_COUNT(29);
        -&#62; 4
</PRE>

</DL>

<P>
<A NAME="IDX286"></A>
<A NAME="IDX287"></A>


<H3><A NAME="Logical_functions" HREF="manual_toc.html#Logical_functions">7.4.4  Logical operations</A></H3>

<P>
All logical functions return <CODE>1</CODE> (TRUE) or <CODE>0</CODE> (FALSE).

</P>
<DL COMPACT>

<DT><CODE>NOT</CODE>
<DD>
<A NAME="IDX288"></A>
 <A NAME="IDX289"></A>
 
<DT><CODE>!</CODE>
<DD>
Logical NOT. Returns <CODE>1</CODE> if the argument is <CODE>0</CODE>, otherwise returns
<CODE>0</CODE>.
Exception: <CODE>NOT NULL</CODE> returns <CODE>NULL</CODE>.

<PRE>
mysql&#62; select NOT 1;
        -&#62; 0
mysql&#62; select NOT NULL;
        -&#62; NULL
mysql&#62; select ! (1+1);
        -&#62; 0
mysql&#62; select ! 1+1;
        -&#62; 1
</PRE>

The last example returns <CODE>1</CODE> because the expression evaluates
the same way as <CODE>(!1)+1</CODE>.

<A NAME="IDX290"></A>
<A NAME="IDX291"></A>
<DT><CODE>OR</CODE>
<DD>
<DT><CODE>||</CODE>
<DD>
Logical OR. Returns <CODE>1</CODE> if either argument is not <CODE>0</CODE> and not
<CODE>NULL</CODE>.

<PRE>
mysql&#62; select 1 || 0;
        -&#62; 1
mysql&#62; select 0 || 0;
        -&#62; 0
mysql&#62; select 1 || NULL;
        -&#62; 1

</PRE>

<A NAME="IDX292"></A>
<A NAME="IDX293"></A>
<DT><CODE>AND</CODE>
<DD>
<DT><CODE>&#38;&</CODE>
<DD>
Logical AND. Returns <CODE>0</CODE> if either argument is <CODE>0</CODE> or <CODE>NULL</CODE>,
otherwise returns <CODE>1</CODE>.

<PRE>
mysql&#62; select 1 &#38;& NULL;
        -&#62; 0
mysql&#62; select 1 &#38;& 0;
        -&#62; 0
</PRE>

</DL>

<P>
<A NAME="IDX294"></A>
<A NAME="IDX295"></A>
<A NAME="IDX296"></A>


<H3><A NAME="Comparison_functions" HREF="manual_toc.html#Comparison_functions">7.4.5  Comparison operators</A></H3>

<P>
Comparison operations result in a value of <CODE>1</CODE> (TRUE), <CODE>0</CODE> (FALSE)
or <CODE>NULL</CODE>. These functions work for both numbers and strings.  Strings
are automatically converted to numbers and numbers to strings as needed (as
in Perl).

</P>
<P>
<STRONG>MySQL</STRONG> performs comparisons using the following
rules:

</P>

<UL>
<LI>

If one or both arguments are <CODE>NULL</CODE>, the result of the comparison
is <CODE>NULL</CODE>, except for the <CODE>&#60;=&#62;</CODE> operator.

<LI>

If both arguments in a comparison operation are strings, they are compared as
strings.

<LI>

If both arguments are integers, they are compared as integers.

<LI>

Hexadecimal values are treated as binary strings if not compared to a number.

<LI>

<A NAME="IDX297"></A>
<A NAME="IDX298"></A>
If one of the arguments is a <CODE>TIMESTAMP</CODE> or <CODE>DATETIME</CODE> column and
the other argument is a constant, the constant is converted
to a timestamp before the comparison is performed. This is done to be more
ODBC-friendly.

<LI>

In all other cases, the arguments are compared as floating-point (real)
numbers.
</UL>

<P>
By default, string comparisons are done in case-independent fashion using the
current character set (ISO-8859-1 Latin1 by default, which also works
excellently for English).

</P>
<P>
The examples below illustrate conversion of strings to numbers for comparison
operations:

</P>

<PRE>
mysql&#62; SELECT 1 &#62; '6x';
         -&#62; 0
mysql&#62; SELECT 7 &#62; '6x';
         -&#62; 1
mysql&#62; SELECT 0 &#62; 'x6';
         -&#62; 0
mysql&#62; SELECT 0 = 'x6';
         -&#62; 1
</PRE>

<DL COMPACT>

<DT><CODE>=</CODE>
<DD>
<A NAME="IDX299"></A>
 <A NAME="IDX300"></A>
 
Equal

<PRE>
mysql&#62; select 1 = 0;
        -&#62; 0
mysql&#62; select '0' = 0;
        -&#62; 1
mysql&#62; select '0.0' = 0;
        -&#62; 1
mysql&#62; select '0.01' = 0;
        -&#62; 0
mysql&#62; select '.01' = 0.01;
        -&#62; 1
</PRE>

<A NAME="IDX301"></A>
<A NAME="IDX302"></A>
<A NAME="IDX303"></A>
<A NAME="IDX304"></A>
<DT><CODE>&#60;&#62;</CODE>
<DD>
<DT><CODE>!=</CODE>
<DD>
Not equal

<PRE>
mysql&#62; select '.01' &#60;&#62; '0.01';
        -&#62; 1
mysql&#62; select .01 &#60;&#62; '0.01';
        -&#62; 0
mysql&#62; select 'zapp' &#60;&#62; 'zappp';
        -&#62; 1
</PRE>

<A NAME="IDX305"></A>
<A NAME="IDX306"></A>
<DT><CODE>&#60;=</CODE>
<DD>
Less than or equal

<PRE>
mysql&#62; select 0.1 &#60;= 2;
        -&#62; 1
</PRE>

<A NAME="IDX307"></A>
<A NAME="IDX308"></A>
<DT><CODE>&#60;</CODE>
<DD>
Less than

<PRE>
mysql&#62; select 2 &#60;= 2;
        -&#62; 1
</PRE>

<A NAME="IDX309"></A>
<A NAME="IDX310"></A>
<DT><CODE>&#62;=</CODE>
<DD>
Greater than or equal

<PRE>
mysql&#62; select 2 &#62;= 2;
        -&#62; 1
</PRE>

<A NAME="IDX311"></A>
<A NAME="IDX312"></A>
<DT><CODE>&#62;</CODE>
<DD>
Greater than

<PRE>
mysql&#62; select 2 &#62; 2;
        -&#62; 0
</PRE>

<A NAME="IDX313"></A>
<DT><CODE>&#60;=&#62;</CODE>
<DD>
Null safe equal

<PRE>
mysql&#62; select 1 &#60;=&#62; 1, NULL &#60;=&#62; NULL, 1 &#60;=&#62; NULL;
        -&#62; 1 1 0
</PRE>

<A NAME="IDX314"></A>
<A NAME="IDX315"></A>
<DT><CODE>IS NULL</CODE>
<DD>
<DT><CODE>IS NOT NULL</CODE>
<DD>
Test whether or not a value is or is not <CODE>NULL</CODE>

<PRE>
mysql&#62; select 1 IS NULL, 0 IS NULL, NULL IS NULL:
        -&#62; 0 0 1
mysql&#62; select 1 IS NOT NULL, 0 IS NOT NULL, NULL IS NOT NULL;
        -&#62; 1 1 0
</PRE>

<A NAME="IDX316"></A>
<DT><CODE>expr BETWEEN min AND max</CODE>
<DD>
If <CODE>expr</CODE> is greater than or equal to <CODE>min</CODE> and <CODE>expr</CODE> is
less than or equal to <CODE>max</CODE>, <CODE>BETWEEN</CODE> returns <CODE>1</CODE>,
otherwise it returns <CODE>0</CODE>.  This is equivalent to the expression
<CODE>(min &#60;= expr AND expr &#60;= max)</CODE> if all the arguments are of the
same type.  (You can't compare <CODE>DATE</CODE> with <CODE>DATETIME</CODE>
arguments with <CODE>BETWEEN</CODE> as you can do with simple compare
operations like <CODE>=</CODE>) The first argument (<CODE>expr</CODE>) determines
how the comparison is performed.  If <CODE>expr</CODE> is a case-insensitive
string expression, a case-insensitive string comparison is done.  If
<CODE>expr</CODE> is a case-sensitive string expression, a case-sensitive
string comparison is done.  If <CODE>expr</CODE> is an integer expression, an
integer comparison is done.  Otherwise, a floating-point (real)
comparison is done.


<PRE>
mysql&#62; select 1 BETWEEN 2 AND 3;
        -&#62; 0
mysql&#62; select 'b' BETWEEN 'a' AND 'c';
        -&#62; 1
mysql&#62; select 2 BETWEEN 2 AND '3';
        -&#62; 1
mysql&#62; select 2 BETWEEN 2 AND 'x-3';
        -&#62; 0
</PRE>

<A NAME="IDX317"></A>
<DT><CODE>expr IN (value,...)</CODE>
<DD>
Returns <CODE>1</CODE> if <CODE>expr</CODE> is any of the values in the <CODE>IN</CODE> list,
else returns <CODE>0</CODE>.  If all values are constants, then all values are
evaluated according to the type of <CODE>expr</CODE> and sorted. The search for the
item is then done using a binary search. This means <CODE>IN</CODE> is very quick
if the <CODE>IN</CODE> value list consists entirely of constants.  If <CODE>expr</CODE>
is a case-sensitive string expression, the string comparison is performed in
case-sensitive fashion.


<PRE>
mysql&#62; select 2 IN (0,3,5,'wefwf');
        -&#62; 0
mysql&#62; select 'wefwf' IN (0,3,5,'wefwf');
        -&#62; 1
</PRE>

<A NAME="IDX318"></A>
<DT><CODE>expr NOT IN (value,...)</CODE>
<DD>
Same as <CODE>NOT (expr IN (value,...))</CODE>.

<A NAME="IDX319"></A>
<DT><CODE>ISNULL(expr)</CODE>
<DD>
If <CODE>expr</CODE> is <CODE>NULL</CODE>, <CODE>ISNULL()</CODE> returns <CODE>1</CODE>, otherwise
it returns <CODE>0</CODE>.

<PRE>
mysql&#62; select ISNULL(1+1);
        -&#62; 0
mysql&#62; select ISNULL(1/0);
        -&#62; 1
</PRE>

Note that a comparison of <CODE>NULL</CODE> values using <CODE>=</CODE> will always be
false!

<A NAME="IDX320"></A>
<DT><CODE>COALESCE(list)</CODE>
<DD>
Returns first non-<CODE>NULL</CODE> element in list.


<PRE>
mysql&#62; select COALESCE(NULL,1);
        -&#62; 1
mysql&#62; select COALESCE(NULL,NULL,NULL);
        -&#62; NULL
</PRE>

<A NAME="IDX321"></A>
<DT><CODE>INTERVAL(N,N1,N2,N3,...)</CODE>
<DD>
Returns <CODE>0</CODE> if <CODE>N</CODE> &#60; <CODE>N1</CODE>, <CODE>1</CODE> if <CODE>N</CODE> &#60; <CODE>N2</CODE>
and so on. All arguments are treated as integers.  It is required that
<CODE>N1</CODE> &#60; <CODE>N2</CODE> &#60; <CODE>N3</CODE> &#60; <CODE>...</CODE> &#60; <CODE>Nn</CODE> for this function
to work correctly. This is because a binary search is used (very fast).


<PRE>
mysql&#62; select INTERVAL(23, 1, 15, 17, 30, 44, 200);
        -&#62; 3
mysql&#62; select INTERVAL(10, 1, 10, 100, 1000);
        -&#62; 2
mysql&#62; select INTERVAL(22, 23, 30, 44, 200);
        -&#62; 0
</PRE>

</DL>

<P>
<A NAME="IDX322"></A>
<A NAME="IDX323"></A>


<H3><A NAME="String_comparison_functions" HREF="manual_toc.html#String_comparison_functions">7.4.6  String comparison functions</A></H3>

<P>
<A NAME="IDX324"></A>
<A NAME="IDX325"></A>
Normally, if any expression in a string comparison is case sensitive, the
comparison is performed in case-sensitive fashion.

</P>
<DL COMPACT>

<DT><CODE>expr LIKE pat [ESCAPE 'escape-char']</CODE>
<DD>
<A NAME="IDX326"></A>
 
Pattern matching using
SQL simple regular expression comparison. Returns <CODE>1</CODE> (TRUE) or <CODE>0</CODE>
(FALSE).  With <CODE>LIKE</CODE> you can use the following two wildcard characters
in the pattern:

<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><CODE>%</CODE> </TD><TD> Matches any number of characters, even zero characters
</TR NOSAVE>
<TR><TD><CODE>_</CODE> </TD><TD> Matches exactly one character
</TR>
</TABLE>


<PRE>
mysql&#62; select 'David!' LIKE 'David_';
        -&#62; 1
mysql&#62; select 'David!' LIKE '%D%v%';
        -&#62; 1
</PRE>

To test for literal instances of a wildcard character, precede the character
with the escape character.  If you don't specify the <CODE>ESCAPE</CODE> character,
<SAMP>`\'</SAMP> is assumed:

<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><CODE>\%</CODE> </TD><TD> Matches one <CODE>%</CODE> character
</TR NOSAVE>
<TR><TD><CODE>\_</CODE> </TD><TD> Matches one <CODE>_</CODE> character
</TR>
</TABLE>


<PRE>
mysql&#62; select 'David!' LIKE 'David\_';
        -&#62; 0
mysql&#62; select 'David_' LIKE 'David\_';
        -&#62; 1
</PRE>

To specify a different escape character, use the <CODE>ESCAPE</CODE> clause:


<PRE>
mysql&#62; select 'David_' LIKE 'David|_' ESCAPE '|';
        -&#62; 1
</PRE>

<CODE>LIKE</CODE> is allowed on numeric expressions! (This is a <STRONG>MySQL</STRONG>
extension to the ANSI SQL <CODE>LIKE</CODE>.)


<PRE>
mysql&#62; select 10 LIKE '1%';
        -&#62; 1
</PRE>

Note: Because <STRONG>MySQL</STRONG> uses the C escape syntax in strings (e.g.,
<SAMP>`\n'</SAMP>), you must double any <SAMP>`\'</SAMP> that you use in your <CODE>LIKE</CODE>
strings.  For example, to search for <SAMP>`\n'</SAMP>, specify it as <SAMP>`\\n'</SAMP>.  To
search for <SAMP>`\'</SAMP>, specify it as <SAMP>`\\\\'</SAMP> (the backslashes are stripped
once by the parser, and another time when the pattern match is done, leaving
a single backslash to be matched).

<A NAME="IDX327"></A>
<DT><CODE>expr NOT LIKE pat [ESCAPE 'escape-char']</CODE>
<DD>
Same as <CODE>NOT (expr LIKE pat [ESCAPE 'escape-char'])</CODE>.

<A NAME="IDX328"></A>
<A NAME="IDX329"></A>
<A NAME="IDX330"></A>
<A NAME="IDX331"></A>
<DT><CODE>expr REGEXP pat</CODE>
<DD>
<DT><CODE>expr RLIKE pat</CODE>
<DD>
Performs a pattern match of a string expression <CODE>expr</CODE> against a pattern
<CODE>pat</CODE>.  The pattern can be an extended regular expression.
See section <A HREF="manual.html#Regexp">H  Description of MySQL regular expression syntax</A>.  Returns <CODE>1</CODE> if <CODE>expr</CODE> matches <CODE>pat</CODE>, otherwise
returns <CODE>0</CODE>.  <CODE>RLIKE</CODE> is a synonym for <CODE>REGEXP</CODE>, provided for
<CODE>mSQL</CODE> compatibility. Note: Because <STRONG>MySQL</STRONG> uses the C escape
syntax in strings (e.g., <SAMP>`\n'</SAMP>), you must double any <SAMP>`\'</SAMP> that you
use in your <CODE>REGEXP</CODE> strings.  In <CODE>MySQL</CODE> 3.23.4
<CODE>REGEXP</CODE> is case insensitive for normal (not binary) strings.


<PRE>
mysql&#62; select 'Monty!' REGEXP 'm%y%%';
        -&#62; 0
mysql&#62; select 'Monty!' REGEXP '.*';
        -&#62; 1
mysql&#62; select 'new*\n*line' REGEXP 'new\\*.\\*line';
        -&#62; 1
mysql&#62; select "a" REGEXP "A", "a" REGEXP BINARY "A";
        -&#62; 1  0
</PRE>

<DT><CODE></CODE>
<DD>
<CODE>REGEXP</CODE> and <CODE>RLIKE</CODE> use the current character set (ISO-8859-1
Latin1 by default) when deciding the type of a character.

<A NAME="IDX332"></A>
<DT><CODE>expr NOT REGEXP pat</CODE>
<DD>
<DT><CODE>expr NOT RLIKE pat</CODE>
<DD>
Same as <CODE>NOT (expr REGEXP pat)</CODE>.

<A NAME="IDX333"></A>
<DT><CODE>STRCMP(expr1,expr2)</CODE>
<DD>
<CODE>STRCMP()</CODE>
returns <CODE>0</CODE> if the strings are the same, <CODE>-1</CODE> if the first
argument is smaller than the second according to the current sort order,
and <CODE>1</CODE> otherwise.


<PRE>
mysql&#62; select STRCMP('text', 'text2');
        -&#62; -1
mysql&#62; select STRCMP('text2', 'text');
        -&#62; 1
mysql&#62; select STRCMP('text', 'text');
        -&#62; 0
</PRE>

</DL>

<P>
<A NAME="IDX334"></A>


<H3><A NAME="Casts" HREF="manual_toc.html#Casts">7.4.7  Cast operators</A></H3>

<DL COMPACT>

<DT><CODE><CODE>BINARY</CODE></CODE>
<DD>
<A NAME="IDX335"></A>
 
The <CODE>BINARY</CODE> operator casts the string following it to a binary string.
This is an easy way to force a column comparison to be case sensitive even
if the column isn't defined as <CODE>BINARY</CODE> or <CODE>BLOB</CODE>.

<PRE>
mysql&#62; select "a" = "A";
        -&#62; 1
mysql&#62; select BINARY "a" = "A";
        -&#62; 0
</PRE>

<CODE>BINARY</CODE> was introduced in <STRONG>MySQL</STRONG> 3.23.0
</DL>

<P>
<A NAME="IDX336"></A>
<A NAME="IDX337"></A>


<H3><A NAME="Control_flow_functions" HREF="manual_toc.html#Control_flow_functions">7.4.8  Control flow functions</A></H3>

<DL COMPACT>

<DT><CODE>IFNULL(expr1,expr2)</CODE>
<DD>
<A NAME="IDX338"></A>
 
If <CODE>expr1</CODE> is not <CODE>NULL</CODE>, <CODE>IFNULL()</CODE> returns <CODE>expr1</CODE>,
else it returns <CODE>expr2</CODE>.  <CODE>IFNULL()</CODE> returns a numeric or string
value, depending on the context in which it is used.

<PRE>
mysql&#62; select IFNULL(1,0);
        -&#62; 1
mysql&#62; select IFNULL(0,10);
        -&#62; 0
mysql&#62; select IFNULL(1/0,10);
        -&#62; 10
mysql&#62; select IFNULL(1/0,'yes');
        -&#62; 'yes'
</PRE>

<A NAME="IDX339"></A>
<DT><CODE>IF(expr1,expr2,expr3)</CODE>
<DD>
If <CODE>expr1</CODE> is TRUE (<CODE>expr1 &#60;&#62; 0</CODE> and <CODE>expr1 &#60;&#62; NULL</CODE>) then
<CODE>IF()</CODE> returns <CODE>expr2</CODE>, else it returns <CODE>expr3</CODE>.
<CODE>IF()</CODE> returns a numeric or string value, depending on the context
in which it is used.


<PRE>
mysql&#62; select IF(1&#62;2,2,3);
        -&#62; 3
mysql&#62; select IF(1&#60;2,'yes','no');
        -&#62; 'yes'
mysql&#62; select IF(strcmp('test','test1'),'yes','no');
        -&#62; 'no'
</PRE>

<CODE>expr1</CODE> is evaluated as an integer value, which means that if you are
testing floating-point or string values, you should do so using a comparison
operation.


<PRE>
mysql&#62; select IF(0.1,1,0);
        -&#62; 0
mysql&#62; select IF(0.1&#60;&#62;0,1,0);
        -&#62; 1
</PRE>

In the first case above, <CODE>IF(0.1)</CODE> returns <CODE>0</CODE> because <CODE>0.1</CODE>
is converted to an integer value, resulting in a test of <CODE>IF(0)</CODE>.  This
may not be what you expect.  In the second case, the comparison tests the
original floating-point value to see whether it is non-zero.  The result
of the comparison is used as an integer.

<A NAME="IDX340"></A>
<DT><CODE>CASE value WHEN [compare-value] THEN result [WHEN [compare-value] THEN result ...] [ELSE result] END</CODE>
<DD>
<DT><CODE>CASE WHEN [condition] THEN result [WHEN [condition] THEN result ...] [ELSE result] END</CODE>
<DD>
The first version returns the <CODE>result</CODE> where
<CODE>value=compare-value</CODE>. The second version returns the result for
the first condition which is true. If there was no matching result
value, then the result after <CODE>ELSE</CODE> is returned. If there is no
<CODE>ELSE</CODE> part then <CODE>NULL</CODE> is returned.


<PRE>
mysql&#62; SELECT CASE 1 WHEN 1 THEN "one" WHEN 2 THEN "two" ELSE "more" END;
       -&#62; "one"
mysql&#62; SELECT CASE WHEN 1&#62;0 THEN "true" ELSE "false" END;
       -&#62; "true"
mysql&#62; SELECT CASE BINARY "B" when "a" then 1 when "b" then 2 END;
       -&#62; NULL
</PRE>

</DL>

<P>
<A NAME="IDX341"></A>
<A NAME="IDX342"></A>


<H3><A NAME="Mathematical_functions" HREF="manual_toc.html#Mathematical_functions">7.4.9  Mathematical functions</A></H3>
<P>
All mathematical functions return <CODE>NULL</CODE> in case of an error.

</P>
<DL COMPACT>

<DT><CODE>-</CODE>
<DD>
<A NAME="IDX343"></A>
 <A NAME="IDX344"></A>
 <A NAME="IDX345"></A>
 
Unary minus. Changes the sign of the argument.

<PRE>
mysql&#62; select - 2;
        -&#62; -2
</PRE>

Note that if this operator is used with a <CODE>BIGINT</CODE>, the return value is a
<CODE>BIGINT</CODE>!  This means that you should avoid using <CODE>-</CODE> on integers that
may have the value of <CODE>-2^63</CODE>!

<A NAME="IDX346"></A>
<DT><CODE>ABS(X)</CODE>
<DD>
Returns the absolute value of <CODE>X</CODE>.

<PRE>
mysql&#62; select ABS(2);
        -&#62; 2
mysql&#62; select ABS(-32);
        -&#62; 32
</PRE>

This function is safe to use with <CODE>BIGINT</CODE> values.

<A NAME="IDX347"></A>
<DT><CODE>SIGN(X)</CODE>
<DD>
Returns the sign of the argument as <CODE>-1</CODE>, <CODE>0</CODE> or <CODE>1</CODE>, depending
on whether <CODE>X</CODE> is negative, zero, or positive.

<PRE>
mysql&#62; select SIGN(-32);
        -&#62; -1
mysql&#62; select SIGN(0);
        -&#62; 0
mysql&#62; select SIGN(234);
        -&#62; 1
</PRE>

<A NAME="IDX348"></A>
<A NAME="IDX349"></A>
<A NAME="IDX350"></A>
<DT><CODE>MOD(N,M)</CODE>
<DD>
<DT><CODE>%</CODE>
<DD>
Modulo (like the <CODE>%</CODE> operator in C).
Returns the remainder of <CODE>N</CODE> divided by <CODE>M</CODE>.

<PRE>
mysql&#62; select MOD(234, 10);
        -&#62; 4
mysql&#62; select 253 % 7;
        -&#62; 1
mysql&#62; select MOD(29,9);
        -&#62; 2
</PRE>

This function is safe to use with <CODE>BIGINT</CODE> values.

<A NAME="IDX351"></A>
<DT><CODE>FLOOR(X)</CODE>
<DD>
Returns the largest integer value not greater than <CODE>X</CODE>.

<PRE>
mysql&#62; select FLOOR(1.23);
        -&#62; 1
mysql&#62; select FLOOR(-1.23);
        -&#62; -2
</PRE>

Note that the return value is converted to a <CODE>BIGINT</CODE>!

<A NAME="IDX352"></A>
<DT><CODE>CEILING(X)</CODE>
<DD>
Returns the smallest integer value not less than <CODE>X</CODE>.

<PRE>
mysql&#62; select CEILING(1.23);
        -&#62; 2
mysql&#62; select CEILING(-1.23);
        -&#62; -1
</PRE>

Note that the return value is converted to a <CODE>BIGINT</CODE>!

<A NAME="IDX353"></A>
<DT><CODE>ROUND(X)</CODE>
<DD>
Returns the argument <CODE>X</CODE>, rounded to an integer.

<PRE>
mysql&#62; select ROUND(-1.23);
        -&#62; -1
mysql&#62; select ROUND(-1.58);
        -&#62; -2
mysql&#62; select ROUND(1.58);
        -&#62; 2
</PRE>

Note that the return value is converted to a <CODE>BIGINT</CODE>!

<A NAME="IDX354"></A>
<DT><CODE>ROUND(X,D)</CODE>
<DD>
Returns the argument <CODE>X</CODE>, rounded to a number with <CODE>D</CODE> decimals.
If <CODE>D</CODE> is <CODE>0</CODE>, the result will have no decimal point or fractional
part.


<PRE>
mysql&#62; select ROUND(1.298, 1);
        -&#62; 1.3
mysql&#62; select ROUND(1.298, 0);
        -&#62; 1
</PRE>

Note that the return value is converted to a <CODE>BIGINT</CODE>!

<A NAME="IDX355"></A>
<DT><CODE>EXP(X)</CODE>
<DD>
Returns the value of <CODE>e</CODE> (the base of natural logarithms) raised to
the power of <CODE>X</CODE>.

<PRE>
mysql&#62; select EXP(2);
        -&#62; 7.389056
mysql&#62; select EXP(-2);
        -&#62; 0.135335
</PRE>

<A NAME="IDX356"></A>
<DT><CODE>LOG(X)</CODE>
<DD>
Returns the natural logarithm of <CODE>X</CODE>.

<PRE>
mysql&#62; select LOG(2);
        -&#62; 0.693147
mysql&#62; select LOG(-2);
        -&#62; NULL
</PRE>

If you want the log of a number <CODE>X</CODE> to some arbitary base <CODE>B</CODE>, use
the formula <CODE>LOG(X)/LOG(B)</CODE>.

<A NAME="IDX357"></A>
<DT><CODE>LOG10(X)</CODE>
<DD>
Returns the base-10 logarithm of <CODE>X</CODE>.

<PRE>
mysql&#62; select LOG10(2);
        -&#62; 0.301030
mysql&#62; select LOG10(100);
        -&#62; 2.000000
mysql&#62; select LOG10(-100);
        -&#62; NULL
</PRE>

<A NAME="IDX358"></A>
<A NAME="IDX359"></A>
<DT><CODE>POW(X,Y)</CODE>
<DD>
<DT><CODE>POWER(X,Y)</CODE>
<DD>
Returns the value of <CODE>X</CODE> raised to the power of <CODE>Y</CODE>.

<PRE>
mysql&#62; select POW(2,2);
        -&#62; 4.000000
mysql&#62; select POW(2,-2);
        -&#62; 0.250000
</PRE>

<A NAME="IDX360"></A>
<DT><CODE>SQRT(X)</CODE>
<DD>
Returns the non-negative square root of <CODE>X</CODE>.

<PRE>
mysql&#62; select SQRT(4);
        -&#62; 2.000000
mysql&#62; select SQRT(20);
        -&#62; 4.472136
</PRE>

<A NAME="IDX361"></A>
<DT><CODE>PI()</CODE>
<DD>
Returns the value of PI.

<PRE>
mysql&#62; select PI();
        -&#62; 3.141593
</PRE>

<A NAME="IDX362"></A>
<DT><CODE>COS(X)</CODE>
<DD>
Returns the cosine of <CODE>X</CODE>, where <CODE>X</CODE> is given in radians.

<PRE>
mysql&#62; select COS(PI());
        -&#62; -1.000000
</PRE>

<A NAME="IDX363"></A>
<DT><CODE>SIN(X)</CODE>
<DD>
Returns the sine of <CODE>X</CODE>, where <CODE>X</CODE> is given in radians.

<PRE>
mysql&#62; select SIN(PI());
        -&#62; 0.000000
</PRE>

<A NAME="IDX364"></A>
<DT><CODE>TAN(X)</CODE>
<DD>
Returns the tangent of <CODE>X</CODE>, where <CODE>X</CODE> is given in radians.

<PRE>
mysql&#62; select TAN(PI()+1);
        -&#62; 1.557408
</PRE>

<A NAME="IDX365"></A>
<DT><CODE>ACOS(X)</CODE>
<DD>
Returns the arc cosine of <CODE>X</CODE>, that is, the value whose cosine is
<CODE>X</CODE>. Returns <CODE>NULL</CODE> if <CODE>X</CODE> is not in the range <CODE>-1</CODE> to
<CODE>1</CODE>.

<PRE>
mysql&#62; select ACOS(1);
        -&#62; 0.000000
mysql&#62; select ACOS(1.0001);
        -&#62; NULL
mysql&#62; select ACOS(0);
        -&#62; 1.570796
</PRE>

<A NAME="IDX366"></A>
<DT><CODE>ASIN(X)</CODE>
<DD>
Returns the arc sine of <CODE>X</CODE>, that is, the value whose sine is
<CODE>X</CODE>. Returns <CODE>NULL</CODE> if <CODE>X</CODE> is not in the range <CODE>-1</CODE> to
<CODE>1</CODE>.

<PRE>
mysql&#62; select ASIN(0.2);
        -&#62; 0.201358
mysql&#62; select ASIN('foo');
        -&#62; 0.000000
</PRE>

<A NAME="IDX367"></A>
<DT><CODE>ATAN(X)</CODE>
<DD>
Returns the arc tangent of <CODE>X</CODE>, that is, the value whose tangent is
<CODE>X</CODE>.

<PRE>
mysql&#62; select ATAN(2);
        -&#62; 1.107149
mysql&#62; select ATAN(-2);
        -&#62; -1.107149
</PRE>

<A NAME="IDX368"></A>
<DT><CODE>ATAN2(X,Y)</CODE>
<DD>
Returns the arc tangent of the two variables <CODE>X</CODE> and <CODE>Y</CODE>. It is
similar to calculating the arc tangent of <CODE>Y / X</CODE>, except that the
signs of both arguments are used to determine the quadrant of the
result.

<PRE>
mysql&#62; select ATAN(-2,2);
        -&#62; -0.785398
mysql&#62; select ATAN(PI(),0);
        -&#62; 1.570796
</PRE>

<A NAME="IDX369"></A>
<DT><CODE>COT(X)</CODE>
<DD>
Returns the cotangent of <CODE>X</CODE>.

<PRE>
mysql&#62; select COT(12);
        -&#62; -1.57267341
mysql&#62; select COT(0);
        -&#62; NULL
</PRE>

<A NAME="IDX370"></A>
<DT><CODE>RAND()</CODE>
<DD>
<DT><CODE>RAND(N)</CODE>
<DD>
Returns a random floating-point value in the range <CODE>0</CODE> to <CODE>1.0</CODE>.
If an integer argument <CODE>N</CODE> is specified, it is used as the seed value.

<PRE>
mysql&#62; select RAND();
        -&#62; 0.5925
mysql&#62; select RAND(20);
        -&#62; 0.1811
mysql&#62; select RAND(20);
        -&#62; 0.1811
mysql&#62; select RAND();
        -&#62; 0.2079
mysql&#62; select RAND();
        -&#62; 0.7888
</PRE>

You can't use a column with <CODE>RAND()</CODE> values in an <CODE>ORDER BY</CODE>
clause, because <CODE>ORDER BY</CODE> would evaluate the column multiple times.
In <STRONG>MySQL</STRONG> 3.23, you can however do:
<CODE>SELECT * FROM table_name ORDER BY RAND()</CODE>

This is useful to get a random sample of a set <CODE>SELECT * FROM
table1,table2 WHERE a=b AND c&#60;d ORDER BY RAND() LIMIT 1000</CODE>.

Note that a <CODE>RAND()</CODE> in a <CODE>WHERE</CODE> clause will be re-evaluated
every time the <CODE>WHERE</CODE> is executed.

<A NAME="IDX371"></A>
<DT><CODE>LEAST(X,Y,...)</CODE>
<DD>
With two or more arguments, returns the smallest (minimum-valued) argument.
The arguments are compared using the following rules:


<UL>
<LI>

If the return value is used in an <CODE>INTEGER</CODE> context, or all arguments
are integer-valued, they are compared as integers.

<LI>

If the return value is used in a <CODE>REAL</CODE> context, or all arguments are
real-valued, they are compared as reals.

<LI>

If any argument is a case-sensitive string, the arguments are compared
as case-sensitive strings.

<LI>

In other cases, the arguments are compared as case-insensitive strings.
</UL>


<PRE>
mysql&#62; select LEAST(2,0);
        -&#62; 0
mysql&#62; select LEAST(34.0,3.0,5.0,767.0);
        -&#62; 3.0
mysql&#62; select LEAST("B","A","C");
        -&#62; "A"
</PRE>

In <STRONG>MySQL</STRONG> versions prior to 3.22.5, you can use <CODE>MIN()</CODE> instead
of <CODE>LEAST</CODE>.

<A NAME="IDX372"></A>
<DT><CODE>GREATEST(X,Y,...)</CODE>
<DD>
Returns the largest (maximum-valued) argument.
The arguments are compared using the same rules as for <CODE>LEAST</CODE>.

<PRE>
mysql&#62; select GREATEST(2,0);
        -&#62; 2
mysql&#62; select GREATEST(34.0,3.0,5.0,767.0);
        -&#62; 767.0
mysql&#62; select GREATEST("B","A","C");
        -&#62; "C"
</PRE>

In <STRONG>MySQL</STRONG> versions prior to 3.22.5, you can use <CODE>MAX()</CODE> instead
of <CODE>GREATEST</CODE>.

<A NAME="IDX373"></A>
<DT><CODE>DEGREES(X)</CODE>
<DD>
Returns the argument <CODE>X</CODE>, converted from radians to degrees.

<PRE>
mysql&#62; select DEGREES(PI());
        -&#62; 180.000000
</PRE>

<A NAME="IDX374"></A>
<DT><CODE>RADIANS(X)</CODE>
<DD>
Returns the argument <CODE>X</CODE>, converted from degrees to radians.

<PRE>
mysql&#62; select RADIANS(90);
        -&#62; 1.570796
</PRE>

<A NAME="IDX375"></A>
<DT><CODE>TRUNCATE(X,D)</CODE>
<DD>
Returns the number <CODE>X</CODE>, truncated to <CODE>D</CODE> decimals.  If <CODE>D</CODE>
is <CODE>0</CODE>, the result will have no decimal point or fractional part.

<PRE>
mysql&#62; select TRUNCATE(1.223,1);
        -&#62; 1.2
mysql&#62; select TRUNCATE(1.999,1);
        -&#62; 1.9
mysql&#62; select TRUNCATE(1.999,0);
        -&#62; 1
</PRE>

</DL>

<P>
<A NAME="IDX376"></A>
<A NAME="IDX377"></A>


<H3><A NAME="String_functions" HREF="manual_toc.html#String_functions">7.4.10  String functions</A></H3>

<P>
String-valued functions return <CODE>NULL</CODE> if the length of the result would
be greater than the <CODE>max_allowed_packet</CODE> server parameter.  See section <A HREF="manual.html#Server_parameters">10.2.3  Tuning server parameters</A>.

</P>
<P>
For functions that operate on string positions,
the first position is numbered 1.

</P>
<DL COMPACT>

<DT><CODE>ASCII(str)</CODE>
<DD>
<A NAME="IDX378"></A>
 
Returns the ASCII code value of the leftmost character of the string
<CODE>str</CODE>. Returns <CODE>0</CODE> if <CODE>str</CODE> is the empty string.  Returns
<CODE>NULL</CODE> if <CODE>str</CODE> is <CODE>NULL</CODE>.


<PRE>
mysql&#62; select ASCII('2');
        -&#62; 50
mysql&#62; select ASCII(2);
        -&#62; 50
mysql&#62; select ASCII('dx');
        -&#62; 100
</PRE>

See also the <CODE>ORD()</CODE> function.

<A NAME="IDX379"></A>
<DT><CODE>ORD(str)</CODE>
<DD>
If the leftmost character of the string str is a multi-byte character,
returns the code of multi-byte character by returning the ASCII code value
of the character in the format of:
<CODE>((first byte ASCII code)*256+(second byte ASCII code))[*256+third byte ASCII code...]</CODE>.
If the leftmost character is not a multi-byte character, returns the same
value as the like <CODE>ASCII()</CODE> function does.


<PRE>
mysql&#62; select ORD('2');
        -&#62; 50
</PRE>

<A NAME="IDX380"></A>
<DT><CODE>CONV(N,from_base,to_base)</CODE>
<DD>
Converts numbers between different number bases.  Returns a string
representation of the number <CODE>N</CODE>, converted from base <CODE>from_base</CODE>
to base <CODE>to_base</CODE>.  Returns <CODE>NULL</CODE> if any argument is <CODE>NULL</CODE>.
The argument <CODE>N</CODE> is interpreted as an integer, but may be specified as
an integer or a string.  The minimum base is <CODE>2</CODE> and the maximum base is
<CODE>36</CODE>.  If <CODE>to_base</CODE> is a negative number, <CODE>N</CODE> is regarded as a
signed number.  Otherwise, <CODE>N</CODE> is treated as unsigned.  <CODE>CONV</CODE> works
with 64-bit precision.


<PRE>
mysql&#62; select CONV("a",16,2);
        -&#62; '1010'
mysql&#62; select CONV("6E",18,8);
        -&#62; '172'
mysql&#62; select CONV(-17,10,-18);
        -&#62; '-H'
mysql&#62; select CONV(10+"10"+'10'+0xa,10,10);
        -&#62; '40'
</PRE>

<A NAME="IDX381"></A>
<DT><CODE>BIN(N)</CODE>
<DD>
Returns a string representation of the binary value of <CODE>N</CODE>, where
<CODE>N</CODE> is a longlong (<CODE>BIGINT</CODE>) number.  This is equivalent to
<CODE>CONV(N,10,2)</CODE>.  Returns <CODE>NULL</CODE> if <CODE>N</CODE> is <CODE>NULL</CODE>.


<PRE>
mysql&#62; select BIN(12);
        -&#62; '1100'
</PRE>

<A NAME="IDX382"></A>
<DT><CODE>OCT(N)</CODE>
<DD>
Returns a string representation of the octal value of <CODE>N</CODE>, where
<CODE>N</CODE> is a longlong number.  This is equivalent to <CODE>CONV(N,10,8)</CODE>.
Returns <CODE>NULL</CODE> if <CODE>N</CODE> is <CODE>NULL</CODE>.


<PRE>
mysql&#62; select OCT(12);
        -&#62; '14'
</PRE>

<A NAME="IDX383"></A>
<DT><CODE>HEX(N)</CODE>
<DD>
Returns a string representation of the hexadecimal value of <CODE>N</CODE>, where
<CODE>N</CODE> is a longlong (<CODE>BIGINT</CODE>) number.  This is equivalent to
<CODE>CONV(N,10,16)</CODE>.  Returns <CODE>NULL</CODE> if <CODE>N</CODE> is <CODE>NULL</CODE>.


<PRE>
mysql&#62; select HEX(255);
        -&#62; 'FF'
</PRE>

<A NAME="IDX384"></A>
<DT><CODE>CHAR(N,...)</CODE>
<DD>
<CODE>CHAR()</CODE> interprets the arguments as integers and returns a string
consisting of the characters given by the ASCII code values of those
integers. <CODE>NULL</CODE> values are skipped.


<PRE>
mysql&#62; select CHAR(77,121,83,81,'76');
        -&#62; 'MySQL'
mysql&#62; select CHAR(77,77.3,'77.3');
        -&#62; 'MMM'
</PRE>

<A NAME="IDX385"></A>
<DT><CODE>CONCAT(str1,str2,...)</CODE>
<DD>
Returns the string that results from concatenating the arguments.  Returns
<CODE>NULL</CODE> if any argument is <CODE>NULL</CODE>.  May have more than 2 arguments.
A numeric argument is converted to the equivalent string form.

<PRE>
mysql&#62; select CONCAT('My', 'S', 'QL');
        -&#62; 'MySQL'
mysql&#62; select CONCAT('My', NULL, 'QL');
        -&#62; NULL
mysql&#62; select CONCAT(14.3);
        -&#62; '14.3'
</PRE>

<A NAME="IDX386"></A>
<A NAME="IDX387"></A>
<A NAME="IDX388"></A>
<A NAME="IDX389"></A>
<DT><CODE>LENGTH(str)</CODE>
<DD>
<DT><CODE>OCTET_LENGTH(str)</CODE>
<DD>
<DT><CODE>CHAR_LENGTH(str)</CODE>
<DD>
<DT><CODE>CHARACTER_LENGTH(str)</CODE>
<DD>
Returns the length of the string <CODE>str</CODE>.

<PRE>
mysql&#62; select LENGTH('text');
        -&#62; 4
mysql&#62; select OCTET_LENGTH('text');
        -&#62; 4
</PRE>

Note that for <CODE>CHAR_LENGTH()</CODE>, multi-byte characters are only counted once.

<A NAME="IDX390"></A>
<A NAME="IDX391"></A>
<DT><CODE>LOCATE(substr,str)</CODE>
<DD>
<DT><CODE>POSITION(substr IN str)</CODE>
<DD>
Returns the position of the first occurrence of substring <CODE>substr</CODE>
in string <CODE>str</CODE>. Returns <CODE>0</CODE> if <CODE>substr</CODE> is not in <CODE>str</CODE>.

<PRE>
mysql&#62; select LOCATE('bar', 'foobarbar');
        -&#62; 4
mysql&#62; select LOCATE('xbar', 'foobar');
        -&#62; 0
</PRE>

This function is multi-byte safe.

<A NAME="IDX392"></A>
<DT><CODE>LOCATE(substr,str,pos)</CODE>
<DD>
Returns the position of the first occurrence of substring <CODE>substr</CODE> in
string <CODE>str</CODE>, starting at position <CODE>pos</CODE>.
Returns <CODE>0</CODE> if <CODE>substr</CODE> is not in <CODE>str</CODE>.

<PRE>
mysql&#62; select LOCATE('bar', 'foobarbar',5);
        -&#62; 7
</PRE>

This function is multi-byte safe.

<A NAME="IDX393"></A>
<DT><CODE>INSTR(str,substr)</CODE>
<DD>
Returns the position of the first occurrence of substring <CODE>substr</CODE> in
string <CODE>str</CODE>. This is the same as the two-argument form of
<CODE>LOCATE()</CODE>, except that the arguments are swapped.


<PRE>
mysql&#62; select INSTR('foobarbar', 'bar');
        -&#62; 4
mysql&#62; select INSTR('xbar', 'foobar');
        -&#62; 0
</PRE>

This function is multi-byte safe.

<A NAME="IDX394"></A>
<DT><CODE>LPAD(str,len,padstr)</CODE>
<DD>
Returns the string <CODE>str</CODE>, left-padded with the string
<CODE>padstr</CODE> until <CODE>str</CODE> is <CODE>len</CODE> characters long.

<PRE>
mysql&#62; select LPAD('hi',4,'??');
        -&#62; '??hi'
</PRE>

<A NAME="IDX395"></A>
<DT><CODE>RPAD(str,len,padstr)</CODE>
<DD>
Returns the string <CODE>str</CODE>, right-padded with the string
<CODE>padstr</CODE> until <CODE>str</CODE> is <CODE>len</CODE> characters long.

<PRE>
mysql&#62; select RPAD('hi',5,'?');
        -&#62; 'hi???'
</PRE>

<A NAME="IDX396"></A>
<DT><CODE>LEFT(str,len)</CODE>
<DD>
Returns the leftmost <CODE>len</CODE> characters from the string <CODE>str</CODE>.

<PRE>
mysql&#62; select LEFT('foobarbar', 5);
        -&#62; 'fooba'
</PRE>

This function is multi-byte safe.

<A NAME="IDX397"></A>
<DT><CODE>RIGHT(str,len)</CODE>
<DD>
Returns the rightmost <CODE>len</CODE> characters from the string <CODE>str</CODE>.

<PRE>
mysql&#62; select RIGHT('foobarbar', 4);
        -&#62; 'rbar'
</PRE>

This function is multi-byte safe.

<A NAME="IDX398"></A>
<A NAME="IDX399"></A>
<DT><CODE>SUBSTRING(str,pos,len)</CODE>
<DD>
<DT><CODE>SUBSTRING(str FROM pos FOR len)</CODE>
<DD>
<DT><CODE>MID(str,pos,len)</CODE>
<DD>
Returns a substring <CODE>len</CODE> characters long from string <CODE>str</CODE>,
starting at position <CODE>pos</CODE>.
The variant form that uses <CODE>FROM</CODE> is ANSI SQL92 syntax.

<PRE>
mysql&#62; select SUBSTRING('Quadratically',5,6);
        -&#62; 'ratica'
</PRE>

This function is multi-byte safe.

<A NAME="IDX400"></A>
<DT><CODE>SUBSTRING(str,pos)</CODE>
<DD>
<DT><CODE>SUBSTRING(str FROM pos)</CODE>
<DD>
Returns a substring from string <CODE>str</CODE> starting at position <CODE>pos</CODE>.

<PRE>
mysql&#62; select SUBSTRING('Quadratically',5);
        -&#62; 'ratically'
mysql&#62; select SUBSTRING('foobarbar' FROM 4);
        -&#62; 'barbar'
</PRE>

This function is multi-byte safe.

<A NAME="IDX401"></A>
<DT><CODE>SUBSTRING_INDEX(str,delim,count)</CODE>
<DD>
Returns the substring from string <CODE>str</CODE> after <CODE>count</CODE>
occurrences of the delimiter <CODE>delim</CODE>.
If <CODE>count</CODE> is positive, everything to the left of the final delimiter
(counting from the left) is returned.
If <CODE>count</CODE> is negative, everything to the right of the final delimiter
(counting from the right) is returned.

<PRE>
mysql&#62; select SUBSTRING_INDEX('www.mysql.com', '.', 2);
        -&#62; 'www.mysql'
mysql&#62; select SUBSTRING_INDEX('www.mysql.com', '.', -2);
        -&#62; 'mysql.com'
</PRE>

This function is multi-byte safe.

<A NAME="IDX402"></A>
<DT><CODE>LTRIM(str)</CODE>
<DD>
Returns the string <CODE>str</CODE> with leading space characters removed.

<PRE>
mysql&#62; select LTRIM('  barbar');
        -&#62; 'barbar'
</PRE>

<A NAME="IDX403"></A>
<DT><CODE>RTRIM(str)</CODE>
<DD>
Returns the string <CODE>str</CODE> with trailing space characters removed.

<PRE>
mysql&#62; select RTRIM('barbar   ');
        -&#62; 'barbar'
</PRE>

This function is multi-byte safe.

<A NAME="IDX404"></A>
<DT><CODE>TRIM([[BOTH | LEADING | TRAILING] [remstr] FROM] str)</CODE>
<DD>
Returns the string <CODE>str</CODE> with all <CODE>remstr</CODE> prefixes and/or suffixes
removed. If none of the specifiers <CODE>BOTH</CODE>, <CODE>LEADING</CODE> or
<CODE>TRAILING</CODE> are given, <CODE>BOTH</CODE> is assumed. If <CODE>remstr</CODE> is not
specified, spaces are removed.

<PRE>
mysql&#62; select TRIM('  bar   ');
        -&#62; 'bar'
mysql&#62; select TRIM(LEADING 'x' FROM 'xxxbarxxx');
        -&#62; 'barxxx'
mysql&#62; select TRIM(BOTH 'x' FROM 'xxxbarxxx');
        -&#62; 'bar'
mysql&#62; select TRIM(TRAILING 'xyz' FROM 'barxxyz');
        -&#62; 'barx'
</PRE>

This function is multi-byte safe.

<A NAME="IDX405"></A>
<DT><CODE>SOUNDEX(str)</CODE>
<DD>
Returns a soundex string from <CODE>str</CODE>. Two strings that sound ``about the
same'' should have identical soundex strings. A ``standard'' soundex string
is 4 characters long, but the <CODE>SOUNDEX()</CODE> function returns an
arbitrarily long string. You can use <CODE>SUBSTRING()</CODE> on the result to get
a ``standard'' soundex string.  All non-alphanumeric characters are ignored
in the given string. All international alpha characters outside the A-Z range
are treated as vowels.


<PRE>
mysql&#62; select SOUNDEX('Hello');
        -&#62; 'H400'
mysql&#62; select SOUNDEX('Quadratically');
        -&#62; 'Q36324'
</PRE>

<A NAME="IDX406"></A>
<DT><CODE>SPACE(N)</CODE>
<DD>
Returns a string consisting of <CODE>N</CODE> space characters.

<PRE>
mysql&#62; select SPACE(6);
        -&#62; '      '
</PRE>

<A NAME="IDX407"></A>
<DT><CODE>REPLACE(str,from_str,to_str)</CODE>
<DD>
Returns the string <CODE>str</CODE> with all all occurrences of the string
<CODE>from_str</CODE> replaced by the string <CODE>to_str</CODE>.


<PRE>
mysql&#62; select REPLACE('www.mysql.com', 'w', 'Ww');
        -&#62; 'WwWwWw.mysql.com'
</PRE>

This function is multi-byte safe.

<A NAME="IDX408"></A>
<DT><CODE>REPEAT(str,count)</CODE>
<DD>
Returns a string consisting of the string <CODE>str</CODE> repeated <CODE>count</CODE>
times. If <CODE>count &#60;= 0</CODE>, returns an empty string. Returns <CODE>NULL</CODE> if
<CODE>str</CODE> or <CODE>count</CODE> are <CODE>NULL</CODE>.


<PRE>
mysql&#62; select REPEAT('MySQL', 3);
        -&#62; 'MySQLMySQLMySQL'
</PRE>

<A NAME="IDX409"></A>
<DT><CODE>REVERSE(str)</CODE>
<DD>
Returns the string <CODE>str</CODE> with the order of the characters reversed.

<PRE>
mysql&#62; select REVERSE('abc');
        -&#62; 'cba'
</PRE>

This function is multi-byte safe.

<A NAME="IDX410"></A>
<DT><CODE>INSERT(str,pos,len,newstr)</CODE>
<DD>
Returns the string <CODE>str</CODE>, with the substring beginning at position
<CODE>pos</CODE> and <CODE>len</CODE> characters long replaced by the string
<CODE>newstr</CODE>.


<PRE>
mysql&#62; select INSERT('Quadratic', 3, 4, 'What');
        -&#62; 'QuWhattic'
</PRE>

This function is multi-byte safe.

<A NAME="IDX411"></A>
<DT><CODE>ELT(N,str1,str2,str3,...)</CODE>
<DD>
Returns <CODE>str1</CODE> if <CODE>N</CODE> = <CODE>1</CODE>, <CODE>str2</CODE> if <CODE>N</CODE> =
<CODE>2</CODE>, and so on.  Returns <CODE>NULL</CODE> if <CODE>N</CODE> is less than <CODE>1</CODE>
or greater than the number of arguments.  <CODE>ELT()</CODE> is the complement of
<CODE>FIELD()</CODE>.


<PRE>
mysql&#62; select ELT(1, 'ej', 'Heja', 'hej', 'foo');
        -&#62; 'ej'
mysql&#62; select ELT(4, 'ej', 'Heja', 'hej', 'foo');
        -&#62; 'foo'
</PRE>

<A NAME="IDX412"></A>
<DT><CODE>FIELD(str,str1,str2,str3,...)</CODE>
<DD>
Returns the index of <CODE>str</CODE> in the <CODE>str1</CODE>, <CODE>str2</CODE>,
<CODE>str3</CODE>, <CODE>...</CODE> list.
Returns <CODE>0</CODE> if <CODE>str</CODE> is not found.
<CODE>FIELD()</CODE> is the complement of <CODE>ELT()</CODE>.


<PRE>
mysql&#62; select FIELD('ej', 'Hej', 'ej', 'Heja', 'hej', 'foo');
        -&#62; 2
mysql&#62; select FIELD('fo', 'Hej', 'ej', 'Heja', 'hej', 'foo');
        -&#62; 0
</PRE>

<A NAME="IDX413"></A>
<DT><CODE>FIND_IN_SET(str,strlist)</CODE>
<DD>
Returns a value <CODE>1</CODE> to <CODE>N</CODE> if the string <CODE>str</CODE> is in the list
<CODE>strlist</CODE> consisting of <CODE>N</CODE> substrings. A string list is a string
composed of substrings separated by <SAMP>`,'</SAMP> characters. If the first
argument is a constant string and the second is a column of type <CODE>SET</CODE>,
the <CODE>FIND_IN_SET()</CODE> function is optimized to use bit arithmetic!
Returns <CODE>0</CODE> if <CODE>str</CODE> is not in <CODE>strlist</CODE> or if <CODE>strlist</CODE>
is the empty string.  Returns <CODE>NULL</CODE> if either argument is <CODE>NULL</CODE>.
This function will not work properly if the first argument contains a
<SAMP>`,'</SAMP>.


<PRE>
mysql&#62; SELECT FIND_IN_SET('b','a,b,c,d');
        -&#62; 2
</PRE>

<A NAME="IDX414"></A>
<DT><CODE>MAKE_SET(bits,str1,str2,...)</CODE>
<DD>
Returns a set (a string containing substrings separated by <SAMP>`,'</SAMP>
characters) consisting of the strings that have the corresponding bit in
<CODE>bits</CODE> set.  <CODE>str1</CODE> corresponds to bit 0, <CODE>str2</CODE> to bit 1,
etc.  <CODE>NULL</CODE> strings in <CODE>str1</CODE>, <CODE>str2</CODE>, <CODE>...</CODE>
are not appended to the result.


<PRE>
mysql&#62; SELECT MAKE_SET(1,'a','b','c');
        -&#62; 'a'
mysql&#62; SELECT MAKE_SET(1 | 4,'hello','nice','world');
        -&#62; 'hello,world'
mysql&#62; SELECT MAKE_SET(0,'a','b','c');
        -&#62; ''
</PRE>

<A NAME="IDX415"></A>
<DT><CODE>EXPORT_SET(bits,on,off,[separator,[number_of_bits]])</CODE>
<DD>
Returns a string where for every bit set in 'bit', you get a 'on' string and for
every reset bit you get an 'off' string. Each string is separated with 'separator'
(default ',') and only 'number_of_bits' (default 64) of 'bits' is used.


<PRE>
mysql&#62; select EXPORT_SET(5,'Y','N',',',4)
        -&#62; Y,N,Y,N 
</PRE>

<A NAME="IDX416"></A>
<A NAME="IDX417"></A>
<DT><CODE>LCASE(str)</CODE>
<DD>
<DT><CODE>LOWER(str)</CODE>
<DD>
Returns the string <CODE>str</CODE> with all characters changed to lowercase
according to the current character set mapping (the default is ISO-8859-1
Latin1).

This function is multi-byte safe.


<PRE>
mysql&#62; select LCASE('QUADRATICALLY');
        -&#62; 'quadratically'
</PRE>

<A NAME="IDX418"></A>
<A NAME="IDX419"></A>
<DT><CODE>UCASE(str)</CODE>
<DD>
<DT><CODE>UPPER(str)</CODE>
<DD>
Returns the string <CODE>str</CODE> with all characters changed to uppercase
according to the current character set mapping (the default is ISO-8859-1
Latin1).


<PRE>
mysql&#62; select UCASE('Hej');
        -&#62; 'HEJ'
</PRE>

This function is multi-byte safe.

<A NAME="IDX420"></A>
<DT><CODE>LOAD_FILE(file_name)</CODE>
<DD>
Reads the file and returns the file contents as a string.  The file
must be on the server, you must specify the full pathname to the
file, and you must have the <STRONG>file</STRONG> privilege.  The file must
be readable by all and be smaller than <CODE>max_allowed_packet</CODE>.

If the file doesn't exist or can't be read due to one of the above reasons,
the function returns <CODE>NULL</CODE>.


<PRE>
mysql&#62; UPDATE table_name
           SET blob_column=LOAD_FILE("/tmp/picture")
           WHERE id=1;
</PRE>

</DL>

<P>
<STRONG>MySQL</STRONG> automatically converts numbers to strings as necessary, and
vice versa:

</P>

<PRE>
mysql&#62; SELECT 1+"1";
        -&#62; 2
mysql&#62; SELECT CONCAT(2,' test');
        -&#62; '2 test'
</PRE>

<P>
If you want to convert a number to a string explicitly, pass it as the
argument to <CODE>CONCAT()</CODE>.

</P>
<P>
If a string function is given a binary string as an argument, the resulting
string is also a binary string.  A number converted to a string is treated as
a binary string.  This only affects comparisons.

</P>
<P>
<A NAME="IDX421"></A>
<A NAME="IDX422"></A>


<H3><A NAME="Date_and_time_functions" HREF="manual_toc.html#Date_and_time_functions">7.4.11  Date and time functions</A></H3>

<P>
See section <A HREF="manual.html#Date_and_time_types">7.3.6  Date and time types</A> for a description of the range of values
each type has, and the valid formats in which date and time values may be
specified.

</P>
<P>
Here is an example that uses date functions.  The query below selects
all records with a <CODE>date_col</CODE> value from within the last 30 days:

</P>

<PRE>
mysql&#62; SELECT something FROM table
           WHERE TO_DAYS(NOW()) - TO_DAYS(date_col) &#60;= 30;
</PRE>

<DL COMPACT>

<DT><CODE>DAYOFWEEK(date)</CODE>
<DD>
<A NAME="IDX423"></A>
 
Returns the weekday index
for <CODE>date</CODE> (<CODE>1</CODE> = Sunday, <CODE>2</CODE> = Monday, ... <CODE>7</CODE> = Saturday).
These index values correspond to the ODBC standard.

<PRE>
mysql&#62; select DAYOFWEEK('1998-02-03');
        -&#62; 3
</PRE>

<A NAME="IDX424"></A>
<DT><CODE>WEEKDAY(date)</CODE>
<DD>
Returns the weekday index for
<CODE>date</CODE> (<CODE>0</CODE> = Monday, <CODE>1</CODE> = Tuesday, ... <CODE>6</CODE> = Sunday).

<PRE>
mysql&#62; select WEEKDAY('1997-10-04 22:23:00');
        -&#62; 5
mysql&#62; select WEEKDAY('1997-11-05');
        -&#62; 2
</PRE>

<A NAME="IDX425"></A>
<DT><CODE>DAYOFMONTH(date)</CODE>
<DD>
Returns the day of the month for <CODE>date</CODE>, in the range <CODE>1</CODE> to
<CODE>31</CODE>.

<PRE>
mysql&#62; select DAYOFMONTH('1998-02-03');
        -&#62; 3
</PRE>

<A NAME="IDX426"></A>
<DT><CODE>DAYOFYEAR(date)</CODE>
<DD>
Returns the day of the year for <CODE>date</CODE>, in the range <CODE>1</CODE> to
<CODE>366</CODE>.

<PRE>
mysql&#62; select DAYOFYEAR('1998-02-03');
        -&#62; 34
</PRE>

<A NAME="IDX427"></A>
<DT><CODE>MONTH(date)</CODE>
<DD>
Returns the month for <CODE>date</CODE>, in the range <CODE>1</CODE> to <CODE>12</CODE>.

<PRE>
mysql&#62; select MONTH('1998-02-03');
        -&#62; 2
</PRE>

<A NAME="IDX428"></A>
<DT><CODE>DAYNAME(date)</CODE>
<DD>
Returns the name of the weekday for <CODE>date</CODE>.

<PRE>
mysql&#62; select DAYNAME("1998-02-05");
        -&#62; 'Thursday'
</PRE>

<A NAME="IDX429"></A>
<DT><CODE>MONTHNAME(date)</CODE>
<DD>
Returns the name of the month for <CODE>date</CODE>.

<PRE>
mysql&#62; select MONTHNAME("1998-02-05");
        -&#62; 'February'
</PRE>

<A NAME="IDX430"></A>
<DT><CODE>QUARTER(date)</CODE>
<DD>
Returns the quarter of the year for <CODE>date</CODE>, in the range <CODE>1</CODE>
to <CODE>4</CODE>.

<PRE>
mysql&#62; select QUARTER('98-04-01');
        -&#62; 2
</PRE>

<A NAME="IDX431"></A>
<DT><CODE>WEEK(date)</CODE>
<DD>
<DT><CODE>WEEK(date,first)</CODE>
<DD>
With a single argument, returns the week for <CODE>date</CODE>, in the range
<CODE>0</CODE> to <CODE>53</CODE> (yes there may be the beginnings of a 53 week),
for locations where Sunday is the first day of the week.  The
two-argument form of <CODE>WEEK()</CODE> allows you to specify whether the
week starts on Sunday or Monday.  The week starts on Sunday if the
second argument is <CODE>0</CODE>, on Monday if the second argument is
<CODE>1</CODE>.

<PRE>
mysql&#62; select WEEK('1998-02-20');
        -&#62; 7
mysql&#62; select WEEK('1998-02-20',0);
        -&#62; 7
mysql&#62; select WEEK('1998-02-20',1);
        -&#62; 8
mysql&#62; select WEEK('1998-12-31',1);
        -&#62; 53
</PRE>

<A NAME="IDX432"></A>
<DT><CODE>YEAR(date)</CODE>
<DD>
Returns the year for <CODE>date</CODE>, in the range <CODE>1000</CODE> to <CODE>9999</CODE>.

<PRE>
mysql&#62; select YEAR('98-02-03');
        -&#62; 1998
</PRE>

<DT><CODE>YEARWEEK(date)</CODE>
<DD>
<DT><CODE>YEARWEEK(date,first)</CODE>
<DD>
Returns year and week for a data.  The second arguments works
exactly like the second argument to <CODE>WEEK()</CODE>.  Note that the year may be
different from the year in the date argument for the first and the last week
of the year!

<PRE>

mysql&#62; select YEARWEEK('1987-01-01');
        -&#62; 198653
</PRE>

<A NAME="IDX433"></A>
<DT><CODE>HOUR(time)</CODE>
<DD>
Returns the hour for <CODE>time</CODE>, in the range <CODE>0</CODE> to <CODE>23</CODE>.

<PRE>
mysql&#62; select HOUR('10:05:03');
        -&#62; 10
</PRE>

<A NAME="IDX434"></A>
<DT><CODE>MINUTE(time)</CODE>
<DD>
Returns the minute for <CODE>time</CODE>, in the range <CODE>0</CODE> to <CODE>59</CODE>.

<PRE>
mysql&#62; select MINUTE('98-02-03 10:05:03');
        -&#62; 5
</PRE>

<A NAME="IDX435"></A>
<DT><CODE>SECOND(time)</CODE>
<DD>
Returns the second for <CODE>time</CODE>, in the range <CODE>0</CODE> to <CODE>59</CODE>.

<PRE>
mysql&#62; select SECOND('10:05:03');
        -&#62; 3
</PRE>

<A NAME="IDX436"></A>
<DT><CODE>PERIOD_ADD(P,N)</CODE>
<DD>
Adds <CODE>N</CODE> months to period <CODE>P</CODE> (in the format <CODE>YYMM</CODE> or
<CODE>YYYYMM</CODE>). Returns a value in the format <CODE>YYYYMM</CODE>.

Note that the period argument <CODE>P</CODE> is <EM>not</EM> a date value.


<PRE>
mysql&#62; select PERIOD_ADD(9801,2);
        -&#62; 199803
</PRE>

<A NAME="IDX437"></A>
<DT><CODE>PERIOD_DIFF(P1,P2)</CODE>
<DD>
Returns the number of months between periods <CODE>P1</CODE> and <CODE>P2</CODE>.
<CODE>P1</CODE> and <CODE>P2</CODE> should be in the format <CODE>YYMM</CODE> or <CODE>YYYYMM</CODE>.

Note that the period arguments <CODE>P1</CODE> and <CODE>P2</CODE> are <EM>not</EM>
date values.


<PRE>
mysql&#62; select PERIOD_DIFF(9802,199703);
        -&#62; 11
</PRE>

<A NAME="IDX438"></A>
<A NAME="IDX439"></A>
<A NAME="IDX440"></A>
<A NAME="IDX441"></A>
<A NAME="IDX442"></A>
<DT><CODE>DATE_ADD(date,INTERVAL expr type)</CODE>
<DD>
<DT><CODE>DATE_SUB(date,INTERVAL expr type)</CODE>
<DD>
<DT><CODE>ADDDATE(date,INTERVAL expr type)</CODE>
<DD>
<DT><CODE>SUBDATE(date,INTERVAL expr type)</CODE>
<DD>
These functions perform date arithmetic.  They are new for <STRONG>MySQL</STRONG>
3.22.  <CODE>ADDDATE()</CODE> and <CODE>SUBDATE()</CODE> are synonyms for
<CODE>DATE_ADD()</CODE> and <CODE>DATE_SUB()</CODE>.

In <STRONG>MySQL</STRONG> 3.23, you can use <CODE>+</CODE> and <CODE>-</CODE> instead of
<CODE>DATE_ADD()</CODE> and <CODE>DATE_SUB()</CODE>. (See example)

<CODE>date</CODE> is a <CODE>DATETIME</CODE> or <CODE>DATE</CODE> value specifying the starting
date.  <CODE>expr</CODE> is an expression specifying the interval value to be added
or substracted from the starting date.  <CODE>expr</CODE> is a string; it may start
with a <SAMP>`-'</SAMP> for negative intervals.  <CODE>type</CODE> is a keyword indicating
how the expression should be interpreted.

The <CODE>EXTRACT(type FROM date)</CODE> function returns the 'type'
interval from the date.

The following table shows how the <CODE>type</CODE> and <CODE>expr</CODE> arguments
are related:

<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><CODE>type</CODE> <STRONG>value</STRONG> </TD><TD> <STRONG>Meaning</STRONG> </TD><TD> <STRONG>Expected</STRONG> <CODE>expr</CODE> <STRONG>format</STRONG>
</TR NOSAVE>
<TR><TD><CODE>SECOND</CODE> </TD><TD> Seconds </TD><TD> <CODE>SECONDS</CODE>
</TR NOSAVE>
<TR><TD><CODE>MINUTE</CODE> </TD><TD> Minutes </TD><TD> <CODE>MINUTES</CODE>
</TR NOSAVE>
<TR><TD><CODE>HOUR</CODE> </TD><TD> Hours </TD><TD> <CODE>HOURS</CODE>
</TR NOSAVE>
<TR><TD><CODE>DAY</CODE> </TD><TD> Days </TD><TD> <CODE>DAYS</CODE>
</TR NOSAVE>
<TR><TD><CODE>MONTH</CODE> </TD><TD> Months </TD><TD> <CODE>MONTHS</CODE>
</TR NOSAVE>
<TR><TD><CODE>YEAR</CODE> </TD><TD> Years </TD><TD> <CODE>YEARS</CODE>
</TR NOSAVE>
<TR><TD><CODE>MINUTE_SECOND</CODE> </TD><TD> Minutes and seconds </TD><TD> <CODE>"MINUTES:SECONDS"</CODE>
</TR NOSAVE>
<TR><TD><CODE>HOUR_MINUTE</CODE> </TD><TD> Hours and minutes </TD><TD> <CODE>"HOURS:MINUTES"</CODE>
</TR NOSAVE>
<TR><TD><CODE>DAY_HOUR</CODE> </TD><TD> Days and hours </TD><TD> <CODE>"DAYS HOURS"</CODE>
</TR NOSAVE>
<TR><TD><CODE>YEAR_MONTH</CODE> </TD><TD> Years and months </TD><TD> <CODE>"YEARS-MONTHS"</CODE>
</TR NOSAVE>
<TR><TD><CODE>HOUR_SECOND</CODE> </TD><TD> Hours, minutes, </TD><TD> <CODE>"HOURS:MINUTES:SECONDS"</CODE>
</TR NOSAVE>
<TR><TD><CODE>DAY_MINUTE</CODE> </TD><TD> Days, hours, minutes </TD><TD> <CODE>"DAYS HOURS:MINUTES"</CODE>
</TR NOSAVE>
<TR><TD><CODE>DAY_SECOND</CODE> </TD><TD> Days, hours, minutes, seconds </TD><TD> <CODE>"DAYS HOURS:MINUTES:SECONDS"</CODE>
</TR>
</TABLE>

<STRONG>MySQL</STRONG> allows any punctuation delimiter in the <CODE>expr</CODE> format.
The ones shown in the table are the suggested delimiters.  If the <CODE>date</CODE>
argument is a <CODE>DATE</CODE> value and your calculations involve only
<CODE>YEAR</CODE>, <CODE>MONTH</CODE> and <CODE>DAY</CODE> parts (that is, no time parts), the
result is a <CODE>DATE</CODE> value.  Otherwise the result is a <CODE>DATETIME</CODE>
value.


<PRE>
mysql&#62; SELECT "1997-12-31 23:59:59" + INTERVAL 1 SECOND;
        -&#62; 1998-01-01 00:00:00
mysql&#62; SELECT INTERVAL 1 DAY + "1997-12-31";
        -&#62; 1998-01-01
mysql&#62; SELECT "1998-01-01" - INTERVAL 1 SECOND;
       -&#62; 1997-12-31 23:59:59 
mysql&#62; SELECT DATE_ADD("1997-12-31 23:59:59",
                       INTERVAL 1 SECOND);
        -&#62; 1998-01-01 00:00:00
mysql&#62; SELECT DATE_ADD("1997-12-31 23:59:59",
                       INTERVAL 1 DAY);
        -&#62; 1998-01-01 23:59:59
mysql&#62; SELECT DATE_ADD("1997-12-31 23:59:59",
                       INTERVAL "1:1" MINUTE_SECOND);
        -&#62; 1998-01-01 00:01:00
mysql&#62; SELECT DATE_SUB("1998-01-01 00:00:00",
                       INTERVAL "1 1:1:1" DAY_SECOND);
        -&#62; 1997-12-30 22:58:59
mysql&#62; SELECT DATE_ADD("1998-01-01 00:00:00",
                       INTERVAL "-1 10" DAY_HOUR);
        -&#62; 1997-12-30 14:00:00
mysql&#62; SELECT DATE_SUB("1998-01-02", INTERVAL 31 DAY);
        -&#62; 1997-12-02
mysql&#62; SELECT EXTRACT(YEAR FROM "1999-07-02");
       -&#62; 1999
mysql&#62; SELECT EXTRACT(YEAR_MONTH FROM "1999-07-02 01:02:03");
       -&#62; 199907
mysql&#62; SELECT EXTRACT(DAY_MINUTE FROM "1999-07-02 01:02:03");
       -&#62; 20102
</PRE>

If you specify an interval value that is too short (does not include all the
interval parts that would be expected from the <CODE>type</CODE> keyword),
<STRONG>MySQL</STRONG> assumes you have left out the leftmost parts of the interval
value.  For example, if you specify a <CODE>type</CODE> of <CODE>DAY_SECOND</CODE>, the
value of <CODE>expr</CODE> is expected to have days, hours, minutes and seconds
parts.  If you specify a value like <CODE>"1:10"</CODE>, <STRONG>MySQL</STRONG> assumes
that the days and hours parts are missing and the value represents minutes
and seconds.  In other words, <CODE>"1:10" DAY_SECOND</CODE> is interpreted in such
a way that it is equivalent to <CODE>"1:10" MINUTE_SECOND</CODE>.  This is
analogous to the way that <STRONG>MySQL</STRONG> interprets <CODE>TIME</CODE> values
as representing elapsed time rather than as time of day.

If you use really incorrect dates, the result is <CODE>NULL</CODE>. If you add
<CODE>MONTH</CODE>, <CODE>YEAR_MONTH</CODE> or <CODE>YEAR</CODE> and the resulting date
has a day that is larger than the maximum day for the new month, the day is
adjusted to the maximum days in the new month.


<PRE>
mysql&#62; select DATE_ADD('1998-01-30', Interval 1 month);
        -&#62; 1998-02-28
</PRE>

Note from the preceding example that the word <CODE>INTERVAL</CODE> and the
<CODE>type</CODE> keyword are not case sensitive.

<A NAME="IDX443"></A>
<DT><CODE>TO_DAYS(date)</CODE>
<DD>
Given a date <CODE>date</CODE>, returns a daynumber (the number of days since year
0).


<PRE>
mysql&#62; select TO_DAYS(950501);
        -&#62; 728779
mysql&#62; select TO_DAYS('1997-10-07');
        -&#62; 729669
</PRE>

<CODE>TO_DAYS()</CODE> is not intended for use with values that precede the advent
of the Gregorian calendar (1582).

<A NAME="IDX444"></A>
<DT><CODE>FROM_DAYS(N)</CODE>
<DD>
Given a daynumber <CODE>N</CODE>, returns a <CODE>DATE</CODE> value.


<PRE>
mysql&#62; select FROM_DAYS(729669);
        -&#62; '1997-10-07'
</PRE>

<CODE>FROM_DAYS()</CODE> is not intended for use with values that precede the
advent of the Gregorian calendar (1582).

<A NAME="IDX445"></A>
<DT><CODE>DATE_FORMAT(date,format)</CODE>
<DD>
Formats the <CODE>date</CODE> value according to the <CODE>format</CODE> string. The
following specifiers may be used in the <CODE>format</CODE> string:
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><CODE>%M</CODE> </TD><TD> Month name (<CODE>January</CODE>..<CODE>December</CODE>)
</TR NOSAVE>
<TR><TD><CODE>%W</CODE> </TD><TD> Weekday name (<CODE>Sunday</CODE>..<CODE>Saturday</CODE>)
</TR NOSAVE>
<TR><TD><CODE>%D</CODE> </TD><TD> Day of the month with english suffix (<CODE>1st</CODE>, <CODE>2nd</CODE>, <CODE>3rd</CODE>, etc.)
</TR NOSAVE>
<TR><TD><CODE>%Y</CODE> </TD><TD> Year, numeric, 4 digits
</TR NOSAVE>
<TR><TD><CODE>%y</CODE> </TD><TD> Year, numeric, 2 digits
</TR NOSAVE>
<TR><TD><CODE>%X</CODE> </TD><TD> Year for the week where Sunday is the first day of the week, numeric, 4 digits, used with '%V'
</TR NOSAVE>
<TR><TD><CODE>%x</CODE> </TD><TD> Year for the week, where Monday is the first day of the week, numeric, 4 digits, used with '%v'
</TR NOSAVE>
<TR><TD><CODE>%a</CODE> </TD><TD> Abbreviated weekday name (<CODE>Sun</CODE>..<CODE>Sat</CODE>)
</TR NOSAVE>
<TR><TD><CODE>%d</CODE> </TD><TD> Day of the month, numeric (<CODE>00</CODE>..<CODE>31</CODE>)
</TR NOSAVE>
<TR><TD><CODE>%e</CODE> </TD><TD> Day of the month, numeric (<CODE>0</CODE>..<CODE>31</CODE>)
</TR NOSAVE>
<TR><TD><CODE>%m</CODE> </TD><TD> Month, numeric (<CODE>01</CODE>..<CODE>12</CODE>)
</TR NOSAVE>
<TR><TD><CODE>%c</CODE> </TD><TD> Month, numeric (<CODE>1</CODE>..<CODE>12</CODE>)
</TR NOSAVE>
<TR><TD><CODE>%b</CODE> </TD><TD> Abbreviated month name (<CODE>Jan</CODE>..<CODE>Dec</CODE>)
</TR NOSAVE>
<TR><TD><CODE>%j</CODE> </TD><TD> Day of year (<CODE>001</CODE>..<CODE>366</CODE>)
</TR NOSAVE>
<TR><TD><CODE>%H</CODE> </TD><TD> Hour (<CODE>00</CODE>..<CODE>23</CODE>)
</TR NOSAVE>
<TR><TD><CODE>%k</CODE> </TD><TD> Hour (<CODE>0</CODE>..<CODE>23</CODE>)
</TR NOSAVE>
<TR><TD><CODE>%h</CODE> </TD><TD> Hour (<CODE>01</CODE>..<CODE>12</CODE>)
</TR NOSAVE>
<TR><TD><CODE>%I</CODE> </TD><TD> Hour (<CODE>01</CODE>..<CODE>12</CODE>)
</TR NOSAVE>
<TR><TD><CODE>%l</CODE> </TD><TD> Hour (<CODE>1</CODE>..<CODE>12</CODE>)
</TR NOSAVE>
<TR><TD><CODE>%i</CODE> </TD><TD> Minutes, numeric (<CODE>00</CODE>..<CODE>59</CODE>)
</TR NOSAVE>
<TR><TD><CODE>%r</CODE> </TD><TD> Time, 12-hour (<CODE>hh:mm:ss [AP]M</CODE>)
</TR NOSAVE>
<TR><TD><CODE>%T</CODE> </TD><TD> Time, 24-hour (<CODE>hh:mm:ss</CODE>)
</TR NOSAVE>
<TR><TD><CODE>%S</CODE> </TD><TD> Seconds (<CODE>00</CODE>..<CODE>59</CODE>)
</TR NOSAVE>
<TR><TD><CODE>%s</CODE> </TD><TD> Seconds (<CODE>00</CODE>..<CODE>59</CODE>)
</TR NOSAVE>
<TR><TD><CODE>%p</CODE> </TD><TD> <CODE>AM</CODE> or <CODE>PM</CODE>
</TR NOSAVE>
<TR><TD><CODE>%w</CODE> </TD><TD> Day of the week (<CODE>0</CODE>=Sunday..<CODE>6</CODE>=Saturday)
</TR NOSAVE>
<TR><TD><CODE>%U</CODE> </TD><TD> Week (<CODE>0</CODE>..<CODE>53</CODE>), where Sunday is the first day of the week
</TR NOSAVE>
<TR><TD><CODE>%u</CODE> </TD><TD> Week (<CODE>0</CODE>..<CODE>53</CODE>), where Monday is the first day of the week
</TR NOSAVE>
<TR><TD><CODE>%V</CODE> </TD><TD> Week (<CODE>1</CODE>..<CODE>53</CODE>), where Sunday is the first day of the week. Used with '%X'
</TR NOSAVE>
<TR><TD><CODE>%v</CODE> </TD><TD> Week (<CODE>1</CODE>..<CODE>53</CODE>), where Monday is the first day of the week. Used with '%x'
</TR NOSAVE>
<TR><TD><CODE>%%</CODE> </TD><TD> A literal <SAMP>`%'</SAMP>.
</TR>
</TABLE>

All other characters are just copied to the result without interpretation.


<PRE>
mysql&#62; select DATE_FORMAT('1997-10-04 22:23:00', '%W %M %Y');
        -&#62; 'Saturday October 1997'
mysql&#62; select DATE_FORMAT('1997-10-04 22:23:00', '%H:%i:%s');
        -&#62; '22:23:00'
mysql&#62; select DATE_FORMAT('1997-10-04 22:23:00',
                          '%D %y %a %d %m %b %j');
        -&#62; '4th 97 Sat 04 10 Oct 277'
mysql&#62; select DATE_FORMAT('1997-10-04 22:23:00',
                          '%H %k %I %r %T %S %w');
        -&#62; '22 22 10 10:23:00 PM 22:23:00 00 6'
mysql&#62; select DATE_FORMAT('1999-01-01', '%X %V');
        -&#62; '1998 52'
</PRE>

As of <STRONG>MySQL</STRONG> 3.23, the <CODE>%</CODE> character is required before
format specifier characters.  In earlier versions of <STRONG>MySQL</STRONG>,
<CODE>%</CODE> was optional.

<A NAME="IDX446"></A>
<DT><CODE>TIME_FORMAT(time,format)</CODE>
<DD>
This is used like the <CODE>DATE_FORMAT()</CODE> function above, but the
<CODE>format</CODE> string may contain only those format specifiers that handle
hours, minutes and seconds.  Other specifiers produce a <CODE>NULL</CODE> value or
<CODE>0</CODE>.

<A NAME="IDX447"></A>
<A NAME="IDX448"></A>
<DT><CODE>CURDATE()</CODE>
<DD>
<DT><CODE>CURRENT_DATE</CODE>
<DD>
Returns today's date as a value in <CODE>'YYYY-MM-DD'</CODE> or <CODE>YYYYMMDD</CODE>
format, depending on whether the function is used in a string or numeric
context.


<PRE>
mysql&#62; select CURDATE();
        -&#62; '1997-12-15'
mysql&#62; select CURDATE() + 0;
        -&#62; 19971215
</PRE>

<A NAME="IDX449"></A>
<A NAME="IDX450"></A>
<DT><CODE>CURTIME()</CODE>
<DD>
<DT><CODE>CURRENT_TIME</CODE>
<DD>
Returns the current time as a value in <CODE>'HH:MM:SS'</CODE> or <CODE>HHMMSS</CODE>
format, depending on whether the function is used in a string or numeric
context.


<PRE>
mysql&#62; select CURTIME();
        -&#62; '23:50:26'
mysql&#62; select CURTIME() + 0;
        -&#62; 235026
</PRE>

<A NAME="IDX451"></A>
<A NAME="IDX452"></A>
<A NAME="IDX453"></A>
<DT><CODE>NOW()</CODE>
<DD>
<DT><CODE>SYSDATE()</CODE>
<DD>
<DT><CODE>CURRENT_TIMESTAMP</CODE>
<DD>
Returns the current date and time as a value in <CODE>'YYYY-MM-DD HH:MM:SS'</CODE>
or <CODE>YYYYMMDDHHMMSS</CODE> format, depending on whether the function is used in
a string or numeric context.


<PRE>
mysql&#62; select NOW();
        -&#62; '1997-12-15 23:50:26'
mysql&#62; select NOW() + 0;
        -&#62; 19971215235026
</PRE>

<A NAME="IDX454"></A>
<DT><CODE>UNIX_TIMESTAMP()</CODE>
<DD>
<DT><CODE>UNIX_TIMESTAMP(date)</CODE>
<DD>
If called with no argument, returns a Unix timestamp (seconds since
<CODE>'1970-01-01 00:00:00'</CODE> GMT). If <CODE>UNIX_TIMESTAMP()</CODE> is called with
a <CODE>date</CODE> argument, it returns the value of the argument as seconds since
<CODE>'1970-01-01 00:00:00'</CODE> GMT.  <CODE>date</CODE> may be a <CODE>DATE</CODE> string,
a <CODE>DATETIME</CODE> string, a <CODE>TIMESTAMP</CODE>, or a number in the format
<CODE>YYMMDD</CODE> or <CODE>YYYYMMDD</CODE> in local time.


<PRE>
mysql&#62; select UNIX_TIMESTAMP();
        -&#62; 882226357
mysql&#62; select UNIX_TIMESTAMP('1997-10-04 22:23:00');
        -&#62; 875996580
</PRE>

When <CODE>UNIX_TIMESTAMP</CODE> is used on a <CODE>TIMESTAMP</CODE> column, the function
will receive the value directly, with no implicit
``string-to-unix-timestamp'' conversion.

<A NAME="IDX455"></A>
<DT><CODE>FROM_UNIXTIME(unix_timestamp)</CODE>
<DD>
Returns a representation of the <CODE>unix_timestamp</CODE> argument as a value in
<CODE>'YYYY-MM-DD HH:MM:SS'</CODE> or <CODE>YYYYMMDDHHMMSS</CODE> format, depending on
whether the function is used in a string or numeric context.


<PRE>
mysql&#62; select FROM_UNIXTIME(875996580);
        -&#62; '1997-10-04 22:23:00'
mysql&#62; select FROM_UNIXTIME(875996580) + 0;
        -&#62; 19971004222300
</PRE>

<A NAME="IDX456"></A>
<DT><CODE>FROM_UNIXTIME(unix_timestamp,format)</CODE>
<DD>
Returns a string representation of the Unix timestamp, formatted according to
the <CODE>format</CODE> string. <CODE>format</CODE> may contain the same specifiers as
those listed in the entry for the <CODE>DATE_FORMAT()</CODE> function.


<PRE>
mysql&#62; select FROM_UNIXTIME(UNIX_TIMESTAMP(),
                            '%Y %D %M %h:%i:%s %x');
        -&#62; '1997 23rd December 03:43:30 x'
</PRE>

<A NAME="IDX457"></A>
<DT><CODE>SEC_TO_TIME(seconds)</CODE>
<DD>
Returns the <CODE>seconds</CODE> argument, converted to hours, minutes and seconds,
as a value in <CODE>'HH:MM:SS'</CODE> or <CODE>HHMMSS</CODE> format, depending on whether
the function is used in a string or numeric context.


<PRE>
mysql&#62; select SEC_TO_TIME(2378);
        -&#62; '00:39:38'
mysql&#62; select SEC_TO_TIME(2378) + 0;
        -&#62; 3938
</PRE>

<A NAME="IDX458"></A>
<DT><CODE>TIME_TO_SEC(time)</CODE>
<DD>
Returns the <CODE>time</CODE> argument, converted to seconds.

<PRE>
mysql&#62; select TIME_TO_SEC('22:23:00');
        -&#62; 80580
mysql&#62; select TIME_TO_SEC('00:39:38');
        -&#62; 2378
</PRE>

</DL>

<P>
<A NAME="IDX459"></A>
<A NAME="IDX460"></A>


<H3><A NAME="Miscellaneous_functions" HREF="manual_toc.html#Miscellaneous_functions">7.4.12  Miscellaneous functions</A></H3>

<DL COMPACT>

<DT><CODE>DATABASE()</CODE>
<DD>
<A NAME="IDX461"></A>
 
Returns the current database name.

<PRE>
mysql&#62; select DATABASE();
        -&#62; 'test'
</PRE>

If there is no current database, <CODE>DATABASE()</CODE> returns the empty string.

<A NAME="IDX462"></A>
<A NAME="IDX463"></A>
<A NAME="IDX464"></A>
<DT><CODE>USER()</CODE>
<DD>
<DT><CODE>SYSTEM_USER()</CODE>
<DD>
<DT><CODE>SESSION_USER()</CODE>
<DD>
Returns the current <STRONG>MySQL</STRONG> user name.

<PRE>
mysql&#62; select USER();
        -&#62; 'davida@localhost'
</PRE>

In MySQL 3.22.11 or later, this includes the client hostname as well as the
username.  You can extract just the username part like this (which works
whether or not the value includes a hostname part):


<PRE>
mysql&#62; select substring_index(USER(),"@",1);
        -&#62; 'davida'
</PRE>

<A NAME="IDX465"></A>
<DT><CODE>PASSWORD(str)</CODE>
<DD>
Calculates a password string from the plaintext password <CODE>str</CODE>. This is
the function that is used for encrypting <STRONG>MySQL</STRONG> passwords for storage
in the <CODE>Password</CODE> column of the <CODE>user</CODE> grant table.


<PRE>
mysql&#62; select PASSWORD('badpwd');
        -&#62; '7f84554057dd964b'
</PRE>

<A NAME="IDX466"></A>
<CODE>PASSWORD()</CODE> encryption is non-reversible.

<CODE>PASSWORD()</CODE> does not perform password encryption in the same way that
Unix passwords are encrypted.  You should not assume that if your Unix
password and your <STRONG>MySQL</STRONG> password are the same, <CODE>PASSWORD()</CODE>
will result in the same encrypted value as is stored in the Unix password
file.  See <CODE>ENCRYPT()</CODE>.

<A NAME="IDX467"></A>
<DT><CODE>ENCRYPT(str[,salt])</CODE>
<DD>
Encrypt <CODE>str</CODE> using the Unix <CODE>crypt()</CODE> system call. The
<CODE>salt</CODE> argument should be a string with two characters.
(As of MySQL 3.22.16, <CODE>salt</CODE> may be longer than two characters.)


<PRE>
mysql&#62; select ENCRYPT("hello");
        -&#62; 'VxuFAJXVARROc'
</PRE>

If <CODE>crypt()</CODE> is not available on your system, <CODE>ENCRYPT()</CODE> always
returns <CODE>NULL</CODE>.

<CODE>ENCRYPT()</CODE> ignores all but the first 8 characters of <CODE>str</CODE>, at
least on some systems.  This will be determined by the behavior of the
underlying <CODE>crypt()</CODE> system call.

<A NAME="IDX468"></A>
<DT><CODE>ENCODE(str,pass_str)</CODE>
<DD>
Encrypt <CODE>str</CODE> using <CODE>pass_str</CODE> as the password.
To decrypt the result, use <CODE>DECODE()</CODE>.

The results is a binary string.  If you want to save it in a column,
use a <CODE>BLOB</CODE> column type.

<A NAME="IDX469"></A>
<DT><CODE>DECODE(crypt_str,pass_str)</CODE>
<DD>
Descrypts the encrypted string <CODE>crypt_str</CODE> using <CODE>pass_str</CODE> as the
password.  <CODE>crypt_str</CODE> should be a string returned from
<CODE>ENCODE()</CODE>.

<A NAME="IDX470"></A>
<DT><CODE>MD5(string)</CODE>
<DD>
Calculates a MD5 checksum for the string. Value is returned as a 32 long hex number
that may, for example, be used as a hash key.


<PRE>
mysql&#62; select MD5("testing")
        -&#62; 'ae2b1fca515949e5d54fb22b8ed95575'
</PRE>

This is a "RSA Data Security, Inc. MD5 Message-Digest Algorithm".

<A NAME="IDX471"></A>
<DT><CODE>LAST_INSERT_ID([expr])</CODE>
<DD>
Returns the last automatically generated value that was inserted into an
<CODE>AUTO_INCREMENT</CODE> column.
See section <A HREF="manual.html#mysql_insert_id">20.4.29  <CODE>mysql_insert_id()</CODE></A>.


<PRE>
mysql&#62; select LAST_INSERT_ID();
        -&#62; 195
</PRE>

The last ID that was generated is maintained in the server on a
per-connection basis.  It will not be changed by another client. It will not
even be changed if you update another <CODE>AUTO_INCREMENT</CODE> column with a
non-magic value (that is, a value that is not <CODE>NULL</CODE> and not <CODE>0</CODE>).

<A NAME="IDX472"></A>
If <CODE>expr</CODE> is given as an argument to <CODE>LAST_INSERT_ID()</CODE> in an
<CODE>UPDATE</CODE> clause, then the value of the argument is returned as a
<CODE>LAST_INSERT_ID()</CODE> value.  This can be used to simulate sequences:

First create the table:


<PRE>
mysql&#62; create table sequence (id int not null);
mysql&#62; insert into sequence values (0);
</PRE>

Then the table can be used to generate sequence numbers like this:


<PRE>
mysql&#62; update sequence set id=LAST_INSERT_ID(id+1);
</PRE>

You can generate sequences without calling <CODE>LAST_INSERT_ID()</CODE>, but the
utility of using the function this way is that the ID value is maintained in
the server as the last automatically generated value.  You can retrieve the
new ID as you would read any normal <CODE>AUTO_INCREMENT</CODE> value in
<STRONG>MySQL</STRONG>.  For example, <CODE>LAST_INSERT_ID()</CODE> (without an argument)
will return the new ID.  The C API function <CODE>mysql_insert_id()</CODE>
can also be used to get the value.

<A NAME="IDX473"></A>
<DT><CODE>FORMAT(X,D)</CODE>
<DD>
Formats the number <CODE>X</CODE> to a format like <CODE>'#,###,###.##'</CODE>, rounded
to <CODE>D</CODE> decimals.  If <CODE>D</CODE> is <CODE>0</CODE>, the result will have no
decimal point or fractional part.


<PRE>
mysql&#62; select FORMAT(12332.123456, 4);
        -&#62; '12,332.1235'
mysql&#62; select FORMAT(12332.1,4);
        -&#62; '12,332.1000'
mysql&#62; select FORMAT(12332.2,0);
        -&#62; '12,332'
</PRE>

<A NAME="IDX474"></A>
<DT><CODE>VERSION()</CODE>
<DD>
Returns a string indicating the <STRONG>MySQL</STRONG> server version.

<PRE>
mysql&#62; select VERSION();
        -&#62; '3.22.19b-log'
</PRE>

<A NAME="IDX475"></A>
<DT><CODE>GET_LOCK(str,timeout)</CODE>
<DD>
Tries to obtain a lock with a name given by the string <CODE>str</CODE>, with a
timeout of <CODE>timeout</CODE> seconds.  Returns <CODE>1</CODE> if the lock was obtained
successfully, <CODE>0</CODE> if the attempt timed out, or <CODE>NULL</CODE> if an error
occurred (such as running out of memory or the thread was killed with
<CODE>mysqladmin kill</CODE>).  A lock is released when you execute
<CODE>RELEASE_LOCK()</CODE>, execute a new <CODE>GET_LOCK()</CODE> or the thread
terminates.  This function can be used to implement application locks or to
simulate record locks.  It blocks requests by other clients for locks with
the same name; clients that agree on a given lock string name can use the
string to perform cooperative advisory locking.


<PRE>
mysql&#62; select GET_LOCK("lock1",10);
        -&#62; 1
mysql&#62; select GET_LOCK("lock2",10);
        -&#62; 1
mysql&#62; select RELEASE_LOCK("lock2");
        -&#62; 1
mysql&#62; select RELEASE_LOCK("lock1");
        -&#62; NULL
</PRE>

Note that the second <CODE>RELEASE_LOCK()</CODE> call returns <CODE>NULL</CODE> because
the lock <CODE>"lock1"</CODE> was automatically released by the second
<CODE>GET_LOCK()</CODE> call.

<A NAME="IDX476"></A>
<DT><CODE>RELEASE_LOCK(str)</CODE>
<DD>
Releases the lock named by the string <CODE>str</CODE> that was obtained with
<CODE>GET_LOCK()</CODE>. Returns <CODE>1</CODE> if the lock was released, <CODE>0</CODE> if the
lock wasn't locked by this thread (in which case the lock is not released)
and <CODE>NULL</CODE> if the named lock didn't exist.  The lock will not exist if
it was never obtained by a call to <CODE>GET_LOCK()</CODE> or if it already has
been released.

<A NAME="IDX477"></A>
<DT><CODE>BENCHMARK(count,expr)</CODE>
<DD>
The <CODE>BENCHMARK()</CODE> function executes the expression <CODE>expr</CODE>
repeatedly <CODE>count</CODE> times.  It may be used to time how fast <STRONG>MySQL</STRONG>
processes the expression.  The result value is always <CODE>0</CODE>.  The intended
use is in the <CODE>mysql</CODE> client, which reports query execution times.


<PRE>
mysql&#62; select BENCHMARK(1000000,encode("hello","goodbye"));
+----------------------------------------------+
| BENCHMARK(1000000,encode("hello","goodbye")) |
+----------------------------------------------+
|                                            0 |
+----------------------------------------------+
1 row in set (4.74 sec)
</PRE>

The time reported is elapsed time on the client end, not CPU time on the
server end.  It may be advisable to execute <CODE>BENCHMARK()</CODE> several
times, and interpret the result with regard to how heavily loaded the
server machine is.
</DL>

<P>
<A NAME="IDX478"></A>
<A NAME="IDX479"></A>


<H3><A NAME="Group_by_functions" HREF="manual_toc.html#Group_by_functions">7.4.13  Functions for use with <CODE>GROUP BY</CODE> clauses</A></H3>

<P>
If you use a group function in a statement containing no <CODE>GROUP BY</CODE>
clause, it is equivalent to grouping on all rows.

</P>
<DL COMPACT>

<DT><CODE>COUNT(expr)</CODE>
<DD>
<A NAME="IDX480"></A>
 
Returns a count of the number of non-<CODE>NULL</CODE> values in the rows
retrieved by a <CODE>SELECT</CODE> statement.


<PRE>
mysql&#62; select student.student_name,COUNT(*)
           from student,course
           where student.student_id=course.student_id
           GROUP BY student_name;

</PRE>

<CODE>COUNT(*)</CODE> is somewhat different in that it returns a count of
the number of rows retrieved, whether or not they contain <CODE>NULL</CODE>
values.

<CODE>COUNT(*)</CODE> is optimized to
return very quickly if the <CODE>SELECT</CODE> retrieves from one table, no
other columns are retrieved and there is no <CODE>WHERE</CODE> clause.
For example:


<PRE>
mysql&#62; select COUNT(*) from student;
</PRE>

<A NAME="IDX481"></A>
<A NAME="IDX482"></A>
<DT><CODE>COUNT(DISTINCT expr,[expr...])</CODE>
<DD>
Returns a count of the number of different values.


<PRE>
mysql&#62; select COUNT(DISTINCT results) from student;
</PRE>

In <STRONG>MySQL</STRONG> you can get the number of distinct expressions combinations
by giving a list of expressions.  In ANSI SQL you would have to do a
concatenation of all expressions inside <CODE>CODE(DISTINCT ..)</CODE>.

<A NAME="IDX483"></A>
<DT><CODE>AVG(expr)</CODE>
<DD>
Returns the average value of <CODE>expr</CODE>.


<PRE>
mysql&#62; select student_name, AVG(test_score)
           from student
           GROUP BY student_name;
</PRE>

<A NAME="IDX484"></A>
<A NAME="IDX485"></A>
<DT><CODE>MIN(expr)</CODE>
<DD>
<DT><CODE>MAX(expr)</CODE>
<DD>
Returns the minimum or maximum value of <CODE>expr</CODE>.  <CODE>MIN()</CODE> and
<CODE>MAX()</CODE> may take a string argument; in such cases they return the
minimum or maximum string value.


<PRE>
mysql&#62; select student_name, MIN(test_score), MAX(test_score)
           from student
           GROUP BY student_name;
</PRE>

<A NAME="IDX486"></A>
<DT><CODE>SUM(expr)</CODE>
<DD>
Returns the sum of <CODE>expr</CODE>.  Note that if the return set has no rows,
it returns NULL!

<A NAME="IDX487"></A>
<A NAME="IDX488"></A>
<A NAME="IDX489"></A>
<A NAME="IDX490"></A>
<DT><CODE>STD(expr)</CODE>
<DD>
<DT><CODE>STDDEV(expr)</CODE>
<DD>
Returns the standard deviation of <CODE>expr</CODE>. This is an extension to
ANSI SQL.
The <CODE>STDDEV()</CODE> form of this function is provided for Oracle compatability.

<A NAME="IDX491"></A>
<DT><CODE>BIT_OR(expr)</CODE>
<DD>
Returns the bitwise <CODE>OR</CODE> of all bits in <CODE>expr</CODE>. The calculation is
performed with 64-bit (<CODE>BIGINT</CODE> precision.

<A NAME="IDX492"></A>
<DT><CODE>BIT_AND(expr)</CODE>
<DD>
Returns the bitwise <CODE>AND</CODE> of all bits in <CODE>expr</CODE>. The calculation is
performed with 64-bit (<CODE>BIGINT</CODE> precision.
</DL>

<P>
<STRONG>MySQL</STRONG> has extended the use of <CODE>GROUP BY</CODE>. You can use columns or
calculations in the <CODE>SELECT</CODE> expressions which don't appear in
the <CODE>GROUP BY</CODE> part. This stands for <EM>any possible value for this
group</EM>.  You can use this to get better performance by avoiding sorting and
grouping on unnecessary items.  For example, you don't need to group on
<CODE>customer.name</CODE> in the following query:

</P>

<PRE>
mysql&#62; select order.custid,customer.name,max(payments)
       from order,customer
       where order.custid = customer.custid
       GROUP BY order.custid;
</PRE>

<P>
In ANSI SQL, you would have to add <CODE>customer.name</CODE> to the <CODE>GROUP
BY</CODE> clause.  In <STRONG>MySQL</STRONG>, the name is redundant.

</P>
<P>
Don't use this feature if the columns you omit from the <CODE>GROUP BY</CODE> part
aren't unique in the group!

</P>
<P>
In some cases, you can use <CODE>MIN()</CODE> and <CODE>MAX()</CODE> to obtain a specific
column value even if it isn't unique. The following gives the value of
<CODE>column</CODE> from the row containing the smallest value in the <CODE>sort</CODE>
column:

</P>

<PRE>
substr(MIN(concat(sort,space(6-length(sort)),column),7,length(column)))
</PRE>

<P>
<A NAME="IDX493"></A>
<A NAME="IDX494"></A>
<A NAME="IDX495"></A>
<A NAME="IDX496"></A>
<A NAME="IDX497"></A>
<A NAME="IDX498"></A>
Note that if you are using <STRONG>MySQL</STRONG> 3.22 (or earlier) or if you
are trying to follow ANSI SQL, you can't use expressions in <CODE>GROUP
BY</CODE> or <CODE>ORDER BY</CODE> clauses.  You can work around this limitation by
using an alias for the expression:

</P>

<PRE>
mysql&#62; SELECT id,FLOOR(value/100) AS val FROM tbl_name
           GROUP BY id,val ORDER BY val;
</PRE>

<P>
In <CODE>MySQL</CODE> 3.23 you can do:

</P>

<PRE>
mysql&#62; SELECT id,FLOOR(value/100) FROM tbl_name ORDER BY RAND();
</PRE>

<P>
<A NAME="IDX499"></A>


<H2><A NAME="CREATE_DATABASE" HREF="manual_toc.html#CREATE_DATABASE">7.5  <CODE>CREATE DATABASE</CODE> syntax</A></H2>


<PRE>
CREATE DATABASE db_name
</PRE>

<P>
<CODE>CREATE DATABASE</CODE> creates a database with the given name.  Rules for
allowable database names are given in section <A HREF="manual.html#Legal_names">7.1.5  Database, table, index, column and alias names</A>.  An error occurs if
the database already exists.

</P>
<P>
Databases in <STRONG>MySQL</STRONG> are implemented as directories containing files
that correspond to tables in the database.  Since there are no tables in a
database when it is initially created, the <CODE>CREATE DATABASE</CODE> statement
only creates a directory under the <STRONG>MySQL</STRONG> data directory.

</P>
<P>
<A NAME="IDX500"></A>
You can also create databases with <CODE>mysqladmin</CODE>.
See section <A HREF="manual.html#Programs">12.1  Overview of the different MySQL programs</A>.

</P>
<P>
<A NAME="IDX501"></A>


<H2><A NAME="DROP_DATABASE" HREF="manual_toc.html#DROP_DATABASE">7.6  <CODE>DROP DATABASE</CODE> syntax</A></H2>


<PRE>
DROP DATABASE [IF EXISTS] db_name
</PRE>

<P>
<CODE>DROP DATABASE</CODE> drops all tables in the database and deletes the
database.  <STRONG>Be VERY careful with this command!</STRONG>

</P>
<P>
<CODE>DROP DATABASE</CODE> returns the number of files that were removed from the
database directory.  Normally, this is three times the number of tables,
since each table corresponds to a <TT>`.MYD'</TT> file, a <TT>`.MYI'</TT> file and a
<TT>`.frm'</TT> file.

</P>
<P>
In <STRONG>MySQL</STRONG> 3.22 or later, you can use the keywords <CODE>IF EXISTS</CODE> to
prevent an error from occurring if the database doesn't exist.

</P>
<P>
<A NAME="IDX502"></A>
You can also drop databases with <CODE>mysqladmin</CODE>.
See section <A HREF="manual.html#Programs">12.1  Overview of the different MySQL programs</A>.

</P>
<P>
<A NAME="IDX503"></A>


<H2><A NAME="CREATE_TABLE" HREF="manual_toc.html#CREATE_TABLE">7.7  <CODE>CREATE TABLE</CODE> syntax</A></H2>


<PRE>
CREATE [TEMPORARY] TABLE [IF NOT EXISTS] tbl_name [(create_definition,...)]
[table_options] [select_statement]

create_definition:
  col_name type [NOT NULL | NULL] [DEFAULT default_value] [AUTO_INCREMENT]
            [PRIMARY KEY] [reference_definition]
  or    PRIMARY KEY (index_col_name,...)
  or    KEY [index_name] (index_col_name,...)
  or    INDEX [index_name] (index_col_name,...)
  or    UNIQUE [INDEX] [index_name] (index_col_name,...)
  or    [CONSTRAINT symbol] FOREIGN KEY index_name (index_col_name,...)
            [reference_definition]
  or    CHECK (expr)

type:
        TINYINT[(length)] [UNSIGNED] [ZEROFILL]
  or    SMALLINT[(length)] [UNSIGNED] [ZEROFILL]
  or    MEDIUMINT[(length)] [UNSIGNED] [ZEROFILL]
  or    INT[(length)] [UNSIGNED] [ZEROFILL]
  or    INTEGER[(length)] [UNSIGNED] [ZEROFILL]
  or    BIGINT[(length)] [UNSIGNED] [ZEROFILL]
  or    REAL[(length,decimals)] [UNSIGNED] [ZEROFILL]
  or    DOUBLE[(length,decimals)] [UNSIGNED] [ZEROFILL]
  or    FLOAT[(length,decimals)] [UNSIGNED] [ZEROFILL]
  or    DECIMAL(length,decimals) [UNSIGNED] [ZEROFILL]
  or    NUMERIC(length,decimals) [UNSIGNED] [ZEROFILL]
  or    CHAR(length) [BINARY]
  or    VARCHAR(length) [BINARY]
  or    DATE
  or    TIME
  or    TIMESTAMP
  or    DATETIME
  or    TINYBLOB
  or    BLOB
  or    MEDIUMBLOB
  or    LONGBLOB
  or    TINYTEXT
  or    TEXT
  or    MEDIUMTEXT
  or    LONGTEXT
  or    ENUM(value1,value2,value3,...)
  or    SET(value1,value2,value3,...)

index_col_name:
        col_name [(length)]

reference_definition:
        REFERENCES tbl_name [(index_col_name,...)]
                   [MATCH FULL | MATCH PARTIAL]
                   [ON DELETE reference_option]
                   [ON UPDATE reference_option]

reference_option:
        RESTRICT | CASCADE | SET NULL | NO ACTION | SET DEFAULT

table_options:
	TYPE = {ISAM | MYISAM | HEAP}
or	AUTO_INCREMENT = #
or	AVG_ROW_LENGTH = #
or	CHECKSUM = {0 | 1}
or	COMMENT = "string"
or	MAX_ROWS = #
or	MIN_ROWS = #
or	PACK_KEYS = {0 | 1}
or	PASSWORD = "string"
or	DELAY_KEY_WRITE = {0 | 1}
or      ROW_FORMAT= { default | dynamic | static | compressed }

select_statement:
	[IGNORE | REPLACE] SELECT ...  (Some legal select statement)
</PRE>

<P>
<CODE>CREATE TABLE</CODE>
creates a table with the given name in the current database.  Rules for
allowable table names are given in section <A HREF="manual.html#Legal_names">7.1.5  Database, table, index, column and alias names</A>.  An error occurs if
there is no current database or if the table already exists.

</P>
<P>
In <STRONG>MySQL</STRONG> 3.22 or later, the table name can be specified as
<CODE>db_name.tbl_name</CODE>.  This works whether or not there is a current
database.

</P>
<P>
In <STRONG>MySQL</STRONG> 3.23, you can use the <CODE>TEMPORARY</CODE> keyword when you
create a table.  A temporary table will automatically be deleted if a
connection dies and the name is per connection.  This means that two different
connections can both use the same temporary table name without conflicting
with each other or with an existing table of the same name. (The existing table
is hidden until the temporary table is deleted).

</P>
<P>
In <STRONG>MySQL</STRONG> 3.23 or later, you can use the keywords <CODE>IF NOT EXISTS</CODE>
so that an error does not occur if the table already exists.  Note that there
is no verification that the table structures are identical.

</P>
<P>
Each table <CODE>tbl_name</CODE> is represented by some files in the database
directory. In the case of MyISAM-type tables you will get:

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><STRONG>File</STRONG> </TD><TD> <STRONG>Purpose</STRONG>
</TR NOSAVE>
<TR><TD><CODE>tbl_name.frm</CODE> </TD><TD> Table definition (form) file
</TR NOSAVE>
<TR><TD><CODE>tbl_name.MYD</CODE> </TD><TD> Data file
</TR NOSAVE>
<TR><TD><CODE>tbl_name.MYI</CODE> </TD><TD> Index file
</TR>
</TABLE>

<P>
For more information on the properties of the various column types, see
section <A HREF="manual.html#Column_types">7.3  Column types</A>.

</P>

<UL>
<LI>

If neither <CODE>NULL</CODE> nor <CODE>NOT NULL</CODE> is specified, the column
is treated as though <CODE>NULL</CODE> had been specified.

<LI>

An integer column may have the additional attribute <CODE>AUTO_INCREMENT</CODE>.
When you insert a value of <CODE>NULL</CODE> (recommended) or <CODE>0</CODE> into an
<CODE>AUTO_INCREMENT</CODE> column, the column is set to <CODE>value+1</CODE>, where
<CODE>value</CODE> is the largest value for the column currently in the table.
<CODE>AUTO_INCREMENT</CODE> sequences begin with <CODE>1</CODE>.
See section <A HREF="manual.html#mysql_insert_id">20.4.29  <CODE>mysql_insert_id()</CODE></A>.

If you delete the row containing the maximum value for an <CODE>AUTO_INCREMENT</CODE>
column, the value will be reused.  If you delete all rows in the table, the
sequence starts over.

<STRONG>Note:</STRONG> There can be only one <CODE>AUTO_INCREMENT</CODE> column per table,
and it must be indexed.

<A NAME="IDX504"></A>
<A NAME="IDX505"></A>
To make <STRONG>MySQL</STRONG> compatible with some ODBC applications, you can find
the last inserted row with the following query:


<PRE>
SELECT * FROM tbl_name WHERE auto_col IS NULL
</PRE>

<LI>

<CODE>NULL</CODE> values are handled differently for <CODE>TIMESTAMP</CODE> columns than
for other column types.  You cannot store a literal <CODE>NULL</CODE> in a
<CODE>TIMESTAMP</CODE> column; setting the column to <CODE>NULL</CODE> sets it to the
current date and time.  Because <CODE>TIMESTAMP</CODE> columns behave this way, the
<CODE>NULL</CODE> and <CODE>NOT NULL</CODE> attributes do not apply in the normal way and
are ignored if you specify them.

On the other hand, to make it easier for <STRONG>MySQL</STRONG> clients to use
<CODE>TIMESTAMP</CODE> columns, the server reports that such columns may be
assigned <CODE>NULL</CODE> values (which is true), even though <CODE>TIMESTAMP</CODE>
never actually will contain a <CODE>NULL</CODE> value.  You can see this when you
use <CODE>DESCRIBE tbl_name</CODE> to get a description of your table.

Note that setting a <CODE>TIMESTAMP</CODE> column to <CODE>0</CODE> is not the same
as setting it to <CODE>NULL</CODE>, because <CODE>0</CODE> is a valid <CODE>TIMESTAMP</CODE>
value.

<LI>

If no <CODE>DEFAULT</CODE> value is specified for a column, <STRONG>MySQL</STRONG>
automatically assigns one.

If the column may take <CODE>NULL</CODE> as a value, the default value is
<CODE>NULL</CODE>.

If the column is declared as <CODE>NOT NULL</CODE>, the default value depends on
the column type:


<UL>
<LI>

For numeric types other than those declared with the <CODE>AUTO_INCREMENT</CODE>
attribute, the default is <CODE>0</CODE>.  For an <CODE>AUTO_INCREMENT</CODE> column, the
default value is the next value in the sequence.

<LI>

For date and time types other than <CODE>TIMESTAMP</CODE>, the default is the
appropriate ``zero'' value for the type.  For the first <CODE>TIMESTAMP</CODE>
column in a table, the default value is the current date and time.
See section <A HREF="manual.html#Date_and_time_types">7.3.6  Date and time types</A>.

<LI>

For string types other than <CODE>ENUM</CODE>, the default is the empty string.
For <CODE>ENUM</CODE>, the default is the first enumeration value.
</UL>

<LI>

<CODE>KEY</CODE> is a synonym for <CODE>INDEX</CODE>.

<LI>

In <STRONG>MySQL</STRONG>, a <CODE>UNIQUE</CODE> key can have only distinct values. An
error occurs if you try to add a new row with a key that matches an existing
row.

<LI>

A <CODE>PRIMARY KEY</CODE> is an unique <CODE>KEY</CODE> with the extra constraint
that all key columns must be defined as <CODE>NOT NULL</CODE>.  In <STRONG>MySQL</STRONG>
the key is named <CODE>PRIMARY</CODE>. A table can have only one <CODE>PRIMARY KEY</CODE>.
If you don't have a <CODE>PRIMARY KEY</CODE> and some applications ask for the
<CODE>PRIMARY KEY</CODE> in your tables, <STRONG>MySQL</STRONG> will return the first
<CODE>UNIQUE</CODE> key, which doesn't have any <CODE>NULL</CODE> columns, as the
<CODE>PRIMARY KEY</CODE>.

<LI>

A <CODE>PRIMARY KEY</CODE> can be a multiple-column index.  However, you cannot
create a multiple-column index using the <CODE>PRIMARY KEY</CODE> key attibute in a
column specification.  Doing so will mark only that single column as primary.
You must use the <CODE>PRIMARY KEY(index_col_name, ...)</CODE> syntax.

<LI>

If you don't assign a name to an index, the index will be assigned the same
name as the first <CODE>index_col_name</CODE>, with an optional suffix (<CODE>_2</CODE>,
<CODE>_3</CODE>, <CODE>...</CODE>) to make it unique.  You can see index names for a
table using <CODE>SHOW INDEX FROM tbl_name</CODE>.
See section <A HREF="manual.html#SHOW">7.21  <CODE>SHOW</CODE> syntax (Get information about tables, columns,...)</A>.

<LI>

<A NAME="IDX506"></A>
<A NAME="IDX507"></A>
Only the <CODE>MyISAM</CODE> table type supports indexes on columns that can have
<CODE>NULL</CODE> values. In other cases you must declare such columns
<CODE>NOT NULL</CODE> or an error results.

<LI>

With <CODE>col_name(length)</CODE> syntax, you can specify an index which
uses only a part of a <CODE>CHAR</CODE> or <CODE>VARCHAR</CODE> column. This can
make the index file much smaller.
See section <A HREF="manual.html#Indexes">7.3.9  Column indexes</A>.

<LI>

<A NAME="IDX508"></A>
<A NAME="IDX509"></A>
<A NAME="IDX510"></A>
<A NAME="IDX511"></A>
Only the <CODE>MyISAM</CODE> table type supports indexing on <CODE>BLOB</CODE> and 
<CODE>TEXT</CODE> columns.  When putting an index on a <CODE>BLOB</CODE> or <CODE>TEXT</CODE>
column you MUST always specify the length of the index:

<PRE>
CREATE TABLE test (blob_col BLOB, index(blob_col(10)));
</PRE>

<LI>

When you use <CODE>ORDER BY</CODE> or <CODE>GROUP BY</CODE> with a <CODE>TEXT</CODE> or
<CODE>BLOB</CODE> column, only the first <CODE>max_sort_length</CODE> bytes are used.
See section <A HREF="manual.html#BLOB">7.3.7.2  The <CODE>BLOB</CODE> and <CODE>TEXT</CODE> types</A>.

<LI>

The <CODE>FOREIGN KEY</CODE>, <CODE>CHECK</CODE> and <CODE>REFERENCES</CODE> clauses don't
actually do anything.  The syntax for them is provided only for compatibility,
to make it easier to port code from other SQL servers and to run applications
that create tables with references.
See section <A HREF="manual.html#Missing_functions">5.4  Functionality missing from MySQL</A>.

<LI>

Each <CODE>NULL</CODE> column takes one bit extra, rounded up to the nearest byte.

<LI>

The maximum record length in bytes can be calculated as follows:


<PRE>
row length = 1
             + (sum of column lengths)
             + (number of NULL columns + 7)/8
             + (number of variable-length columns)
</PRE>

<LI>The <CODE>table_options</CODE> and <CODE>SELECT</CODE> options is only

implemented in <STRONG>MySQL</STRONG> 3.23 and above.

The different table types are:

<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD>ISAM </TD><TD> The original table handler
</TR NOSAVE>
<TR><TD>MyISAM </TD><TD> The new binary portable table handler
</TR NOSAVE>
<TR><TD>HEAP </TD><TD> The data for this table is only stored in memory
</TR>
</TABLE>
See section <A HREF="manual.html#Table_types">9.4  MySQL table types</A>.

The other table options are used to optimize the behavior of the
table. In most cases, you don't have to specify any of them.
The options work for all table types, if not otherwise indicated.

<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><CODE>AUTO_INCREMENT</CODE> </TD><TD> The next auto_increment value you want to set for your table (MyISAM)
</TR NOSAVE>
<TR><TD><CODE>AVG_ROW_LENGTH</CODE> </TD><TD> An approximation of the average row length for your table. You only need to set this for tables with variable size records.
</TR NOSAVE>
<TR><TD><CODE>CHECKSUM</CODE> </TD><TD> Set this to 1 if you want <STRONG>MySQL</STRONG> to maintain a checksum for all rows (makes the table a little slower to update but makes it easier to find corrupted tables) (MyISAM)
</TR NOSAVE>
<TR><TD><CODE>COMMENT</CODE> </TD><TD> A 60 character comment for your table
</TR NOSAVE>
<TR><TD><CODE>MAX_ROWS</CODE> </TD><TD> Max number of rows you plan to store in the table
</TR NOSAVE>
<TR><TD><CODE>MIN_ROWS</CODE> </TD><TD> Minimum number of rows you plan to store in the table
</TR NOSAVE>
<TR><TD><CODE>PACK_KEYS</CODE> </TD><TD> Set this to 1 if you want to have smaller index. This usually makes updates slower and reads faster (MyISAM, ISAM).
</TR NOSAVE>
<TR><TD><CODE>PASSWORD</CODE> </TD><TD> Encrypt the <CODE>.frm</CODE> file with a password.  This option doesn't do anything in the standard <STRONG>MySQL</STRONG> version.
</TR NOSAVE>
<TR><TD><CODE>DELAY_KEY_WRITE</CODE> </TD><TD> Set this to 1 if want to delay key table updates until the table is closed (MyISAM).
</TR NOSAVE>
<TR><TD><CODE>ROW_FORMAT</CODE> </TD><TD> Defines how the rows should be stored (for the future).
</TR>
</TABLE>

When you use a <CODE>MyISAM</CODE> table, <STRONG>MySQL</STRONG> uses the product of
<CODE>max_rows * avg_row_length</CODE> to decide how big the resulting table
will be.  If you don't specify any of the above options, the maximum size
for a table will be 4G (or 2G if your operating systems only supports 2G
tables).

If you don't use <CODE>PACK_KEYS</CODE>, the default is to only pack strings,
not numbers.  If you use <CODE>PACK_KEYS=1</CODE>, numbers will be packed as well.

When packing binary number keys, <STRONG>MySQL</STRONG> will use prefix compression.
This means that you will only get a big benefit of this if you have
many numbers that are the same.  Prefix compression means that every
key needs one extra byte to indicate how many bytes of the previous key are
the same for the next key (note that the pointer to the row is stored
in high-byte-first-order directly after the key, to improve
compression.  This means that if you have many equal keys on two rows
in a row, all following 'same' keys will usually only take 2 bytes
(including the pointer to the row).  Compare this to the ordinary case
where the following keys will take 'storage_size_for_key' +
pointer_size (usually 4).  On the other hand, if all keys are
totally different, you will lose 1 byte per key, if the key isn't a
key that can have <CODE>NULL</CODE> values (In this case the packed key length will
be stored in the same byte that is used to mark if a key is <CODE>NULL</CODE>).

<LI>

If you specify a <CODE>SELECT</CODE> after the <CODE>CREATE STATEMENT</CODE>,
<STRONG>MySQL</STRONG> will create new fields for all elements in the
<CODE>SELECT</CODE>.  For example:


<PRE>
mysql&#62; CREATE TABLE test (a int not null auto_increment,
           primary key (a), key(b))
           TYPE=HEAP SELECT b,c from test2;
</PRE>

This will create a <CODE>HEAP</CODE> table with 3 columns.  Note that the table will
automatically be deleted if any errors occur while copying data
into the table.
</UL>



<H3><A NAME="Silent_column_changes" HREF="manual_toc.html#Silent_column_changes">7.7.1  Silent column specification changes</A></H3>

<P>
In some cases, <STRONG>MySQL</STRONG> silently changes a column specification from
that given in a <CODE>CREATE TABLE</CODE> statement.  (This may also occur with
<CODE>ALTER TABLE</CODE>.)

</P>

<UL>
<LI>

<CODE>VARCHAR</CODE> columns with a length less than four are changed to
<CODE>CHAR</CODE>.

<LI>

If any column in a table has a variable length, the entire row is
variable-length as a result.  Therefore, if a table contains any
variable-length columns (<CODE>VARCHAR</CODE>, <CODE>TEXT</CODE> or <CODE>BLOB</CODE>),
all <CODE>CHAR</CODE> columns longer than three characters are changed to
<CODE>VARCHAR</CODE> columnss.  This doesn't affect how you use the columns in
any way; in <STRONG>MySQL</STRONG>, <CODE>VARCHAR</CODE> is just a different way to
store characters.  <STRONG>MySQL</STRONG> performs this conversion because it
saves space and makes table operations faster.  See section <A HREF="manual.html#Choosing_table_type">10.6  Choosing a table type</A>.

<LI>

<CODE>TIMESTAMP</CODE> display sizes must be even and in the range from 2 to 14.
If you specify a display size of 0 or greater than 14, the size is coerced
to 14.  Odd-valued sizes in the range from 1 to 13 are coerced
to the next higher even number.

<LI>

You cannot store a literal <CODE>NULL</CODE> in a <CODE>TIMESTAMP</CODE> column; setting
it to <CODE>NULL</CODE> sets it to the current date and time.  Because
<CODE>TIMESTAMP</CODE> columns behave this way, the <CODE>NULL</CODE> and <CODE>NOT NULL</CODE>
attributes do not apply in the normal way and are ignored if you specify
them.  <CODE>DESCRIBE tbl_name</CODE> always reports that a <CODE>TIMESTAMP</CODE>
column may be assigned <CODE>NULL</CODE> values.

<LI>

<STRONG>MySQL</STRONG> maps certain column types used by other SQL database vendors
to <STRONG>MySQL</STRONG> types.  See section <A HREF="manual.html#Other-vendor_column_types">7.3.11  Using column types from other database engines</A>.
</UL>

<P>
If you want to see whether or not <STRONG>MySQL</STRONG> used a column type other
than the one you specified, issue a <CODE>DESCRIBE tbl_name</CODE> statement after
creating or altering your table.

</P>
<P>
<A NAME="IDX512"></A>
Certain other column type changes may occur if you compress a table
using <CODE>myisampack</CODE>. See section <A HREF="manual.html#Compressed_format">10.6.3  Compressed table characteristics</A>.

</P>
<P>
<A NAME="IDX513"></A>


<H2><A NAME="ALTER_TABLE" HREF="manual_toc.html#ALTER_TABLE">7.8  <CODE>ALTER TABLE</CODE> syntax</A></H2>


<PRE>
ALTER [IGNORE] TABLE tbl_name alter_spec [, alter_spec ...]

alter_specification:
        ADD [COLUMN] create_definition [FIRST | AFTER column_name ]
  or    ADD INDEX [index_name] (index_col_name,...)
  or    ADD PRIMARY KEY (index_col_name,...)
  or    ADD UNIQUE [index_name] (index_col_name,...)
  or    ALTER [COLUMN] col_name {SET DEFAULT literal | DROP DEFAULT}
  or    CHANGE [COLUMN] old_col_name create_definition
  or    MODIFY [COLUMN] create_definition
  or    DROP [COLUMN] col_name
  or    DROP PRIMARY KEY
  or    DROP INDEX index_name
  or    RENAME [AS] new_tbl_name
  or    table_options
</PRE>

<P>
<CODE>ALTER TABLE</CODE> allows you to change the structure of an existing table.
For example, you can add or delete columns, create or destroy indexes, change
the type of existing columns, or rename columns or the table itself.  You can
also change the comment for the table and type of the table.
See section <A HREF="manual.html#CREATE_TABLE">7.7  <CODE>CREATE TABLE</CODE> syntax</A>.

</P>

<P>
If you use <CODE>ALTER TABLE</CODE> to change a column specification but
<CODE>DESCRIBE tbl_name</CODE> indicates that your column was not changed, it is
possible that <STRONG>MySQL</STRONG> ignored your modification for one of the reasons
described in section <A HREF="manual.html#Silent_column_changes">7.7.1  Silent column specification changes</A>.  For example, if you try to change
a <CODE>VARCHAR</CODE> column to <CODE>CHAR</CODE>, <STRONG>MySQL</STRONG> will still use
<CODE>VARCHAR</CODE> if the table contains other variable-length columns.

</P>
<P>
<CODE>ALTER TABLE</CODE> works by making a temporary copy of the original table.
The alteration is performed on the copy, then the original table is
deleted and the new one is renamed. This is done in such a way that
all updates are automatically redirected to the new table without
any failed updates. While <CODE>ALTER TABLE</CODE> is executing, the original
table is readable by other clients. Updates and writes to the table
are stalled until the new table is ready.

</P>

<UL>
<LI>

To use <CODE>ALTER TABLE</CODE>, you need <STRONG>select</STRONG>, <STRONG>insert</STRONG>,
<STRONG>delete</STRONG>, <STRONG>update</STRONG>, <STRONG>create</STRONG> and <STRONG>drop</STRONG>
privileges on the table.

<LI>

<CODE>IGNORE</CODE> is a <STRONG>MySQL</STRONG> extension to ANSI SQL92.
It controls how <CODE>ALTER TABLE</CODE> works if there are duplicates on
unique keys in the new table.
If <CODE>IGNORE</CODE> isn't specified, the copy is aborted and rolled back.
If <CODE>IGNORE</CODE> is specified, then for rows with duplicates on a unique
key, only the first row is used; the others are deleted.

<LI>

You can issue multiple <CODE>ADD</CODE>, <CODE>ALTER</CODE>, <CODE>DROP</CODE> and
<CODE>CHANGE</CODE> clauses in a single <CODE>ALTER TABLE</CODE> statement. This is a
<STRONG>MySQL</STRONG> extension to ANSI SQL92, which allows only one of each clause
per <CODE>ALTER TABLE</CODE> statement.

<LI>

<CODE>CHANGE col_name</CODE>, <CODE>DROP col_name</CODE> and <CODE>DROP
INDEX</CODE> are <STRONG>MySQL</STRONG> extensions to ANSI SQL92.

<LI>

<CODE>MODIFY</CODE> is an Oracle extension to <CODE>ALTER TABLE</CODE>.

<LI>

The optional word <CODE>COLUMN</CODE> is a pure noise word and can be omitted.

<LI>

If you use <CODE>ALTER TABLE tbl_name RENAME AS new_name</CODE> without any other
options, <STRONG>MySQL</STRONG> simply renames the files that correspond to the table
<CODE>tbl_name</CODE>.  There is no need to create the temporary table.

<LI>

<CODE>create_definition</CODE> clauses use the same syntax for <CODE>ADD</CODE> and
<CODE>CHANGE</CODE> as for <CODE>CREATE TABLE</CODE>.  Note that this syntax includes
the column name, not just the column type.
See section <A HREF="manual.html#CREATE_TABLE">7.7  <CODE>CREATE TABLE</CODE> syntax</A>.

<LI>

You can rename a column using a <CODE>CHANGE old_col_name create_definition</CODE>
clause.  To do so, specify the old and new column names and the type that
the column currently has.  For example, to rename an <CODE>INTEGER</CODE> column
from <CODE>a</CODE> to <CODE>b</CODE>, you can do this:


<PRE>
mysql&#62; ALTER TABLE t1 CHANGE a b INTEGER;
</PRE>

If you want to change a column's type but not the name, <CODE>CHANGE</CODE>
syntax still requires two column names even if they are the same.  For
example:


<PRE>
mysql&#62; ALTER TABLE t1 CHANGE b b BIGINT NOT NULL;
</PRE>

However, as of <STRONG>MySQL</STRONG> 3.22.16a, you can also use <CODE>MODIFY</CODE> to
change a column's type without renaming it:


<PRE>
mysql&#62; ALTER TABLE t1 MODIFY b BIGINT NOT NULL;
</PRE>

<LI>

If you use <CODE>CHANGE</CODE> or <CODE>MODIFY</CODE> to shorten a column for which
an index exists on part of the column (for instance, if you have an index
on the first 10 characters of a <CODE>VARCHAR</CODE> column), you cannot make
the column shorter than the number of characters that are indexed.

<LI>

When you change a column type using <CODE>CHANGE</CODE> or <CODE>MODIFY</CODE>,
<STRONG>MySQL</STRONG> tries to convert data to the new type as well as possible.

<LI>

In <STRONG>MySQL</STRONG> 3.22 or later, you can use <CODE>FIRST</CODE> or <CODE>ADD ...
AFTER col_name</CODE> to add a column at a specific position within a table row.
The default is to add the column last.

<LI>

<CODE>ALTER COLUMN</CODE> specifies a new default value for a column
or removes the old default value.
If the old default is removed and the column can be <CODE>NULL</CODE>, the new
default is <CODE>NULL</CODE>. If the column cannot be <CODE>NULL</CODE>, <STRONG>MySQL</STRONG>
assigns a default value.
Default value assignment is described in
section <A HREF="manual.html#CREATE_TABLE">7.7  <CODE>CREATE TABLE</CODE> syntax</A>.

<LI>

<CODE>DROP INDEX</CODE> removes an index. This is a <STRONG>MySQL</STRONG> extension to
ANSI SQL92.

<LI>

If columns are dropped from a table, the columns are also removed from any
index of which they are a part.  If all columns that make up an index are
dropped, the index is dropped as well.

<LI>

<CODE>DROP PRIMARY KEY</CODE> drops the primary index. If no such
index exists, it drops the first <CODE>UNIQUE</CODE> index in the table.
(<STRONG>MySQL</STRONG> marks the first <CODE>UNIQUE</CODE> key as the <CODE>PRIMARY KEY</CODE>
if no <CODE>PRIMARY KEY</CODE> was specified explicitly.)

<LI>

<A NAME="IDX514"></A>
With the C API function <CODE>mysql_info()</CODE>, you can find out how many
records were copied, and (when <CODE>IGNORE</CODE> is used) how many records were
deleted due to duplication of unique key values.

<LI>

<A NAME="IDX515"></A>
<A NAME="IDX516"></A>
The <CODE>FOREIGN KEY</CODE>, <CODE>CHECK</CODE> and <CODE>REFERENCES</CODE> clauses don't
actually do anything.  The syntax for them is provided only for compatibility,
to make it easier to port code from other SQL servers and to run applications
that create tables with references.
See section <A HREF="manual.html#Missing_functions">5.4  Functionality missing from MySQL</A>.
</UL>

<P>
Here is an example that shows some of the uses of <CODE>ALTER TABLE</CODE>.  We
begin with a table <CODE>t1</CODE> that is created as shown below:

</P>

<PRE>
mysql&#62; CREATE TABLE t1 (a INTEGER,b CHAR(10));
</PRE>

<P>
To rename the table from <CODE>t1</CODE> to <CODE>t2</CODE>:

</P>

<PRE>
mysql&#62; ALTER TABLE t1 RENAME t2;
</PRE>

<P>
To change column <CODE>a</CODE> from <CODE>INTEGER</CODE> to <CODE>TINYINT NOT NULL</CODE>
(leaving the name the same), and to change column <CODE>b</CODE> from
<CODE>CHAR(10)</CODE> to <CODE>CHAR(20)</CODE> as well as renaming it from <CODE>b</CODE> to
<CODE>c</CODE>:

</P>

<PRE>
mysql&#62; ALTER TABLE t2 MODIFY a TINYINT NOT NULL, CHANGE b c CHAR(20);
</PRE>

<P>
To add a new <CODE>TIMESTAMP</CODE> column named <CODE>d</CODE>:

</P>

<PRE>
mysql&#62; ALTER TABLE t2 ADD d TIMESTAMP;
</PRE>

<P>
To add an index on column <CODE>d</CODE>, and make column <CODE>a</CODE> the primary key:

</P>

<PRE>
mysql&#62; ALTER TABLE t2 ADD INDEX (d), ADD PRIMARY KEY (a);
</PRE>

<P>
To remove column <CODE>c</CODE>:

</P>

<PRE>
mysql&#62; ALTER TABLE t2 DROP COLUMN c;
</PRE>

<P>
To add a new <CODE>AUTO_INCREMENT</CODE> integer column named <CODE>c</CODE>:

</P>

<PRE>
mysql&#62; ALTER TABLE t2 ADD c INT UNSIGNED NOT NULL AUTO_INCREMENT,
           ADD INDEX (c);
</PRE>

<P>
Note that we indexed <CODE>c</CODE>, because <CODE>AUTO_INCREMENT</CODE> columns must be
indexed, and also that we declare <CODE>c</CODE> as <CODE>NOT NULL</CODE>, because
indexed columns cannot be <CODE>NULL</CODE>.

</P>
<P>
When you add an <CODE>AUTO_INCREMENT</CODE> column, column values are filled in
with sequence numbers for you automatically.

</P>
<P>
<A NAME="IDX517"></A>


<H2><A NAME="OPTIMIZE_TABLE" HREF="manual_toc.html#OPTIMIZE_TABLE">7.9  <CODE>OPTIMIZE TABLE</CODE> syntax</A></H2>


<PRE>
OPTIMIZE TABLE tbl_name
</PRE>

<P>
<CODE>OPTIMZE TABLE</CODE> should be used if you have deleted a large part of a
table or if you have made many changes to a table with variable-length rows
(tables that have <CODE>VARCHAR</CODE>, <CODE>BLOB</CODE> or <CODE>TEXT</CODE> columns).
Deleted records are maintained in a linked list and subsequent <CODE>INSERT</CODE>
operations reuse old record positions. You can use <CODE>OPTIMIZE TABLE</CODE> to
reclaim the unused space.

</P>
<P>
<CODE>OPTIMIZE TABLE</CODE> works by making a temporary copy of the original
table.  The old table is copied to the new table (without the unused rows),
then the original table is deleted and the new one is renamed. This is done
in such a way that all updates are automatically redirected to the new table
without any failed updates. While <CODE>OPTIMIZE TABLE</CODE> is executing, the
original table is readable by other clients. Updates and writes to the table
are stalled until the new table is ready.

</P>
<P>
<A NAME="IDX518"></A>


<H2><A NAME="DROP_TABLE" HREF="manual_toc.html#DROP_TABLE">7.10  <CODE>DROP TABLE</CODE> syntax</A></H2>


<PRE>
DROP TABLE [IF EXISTS] tbl_name [, tbl_name,...]
</PRE>

<P>
<CODE>DROP TABLE</CODE> removes one or more tables. All table data and the table
definition are <EM>removed</EM>, so <STRONG>be careful</STRONG> with this command!

</P>
<P>
In <STRONG>MySQL</STRONG> 3.22 or later, you can use the keywords <CODE>IF EXISTS</CODE> to
prevent an error from occurring for tables that don't exist.

</P>
<P>
<A NAME="IDX519"></A>


<H2><A NAME="DELETE" HREF="manual_toc.html#DELETE">7.11  <CODE>DELETE</CODE> syntax</A></H2>


<PRE>
DELETE [LOW_PRIORITY] FROM tbl_name
    [WHERE where_definition] [LIMIT rows]
</PRE>

<P>
<CODE>DELETE</CODE> deletes rows from <CODE>tbl_name</CODE> that satisfy the condition
given by <CODE>where_definition</CODE>, and returns the number of records deleted.

</P>
<P>
If you issue a <CODE>DELETE</CODE> with no <CODE>WHERE</CODE> clause, all rows are
deleted.  <STRONG>MySQL</STRONG> does this by recreating the table as an empty table,
which is much faster than deleting each row.  In this case, <CODE>DELETE</CODE>
returns zero as the number of affected records. (<STRONG>MySQL</STRONG> can't return
the number of rows that were actually deleted, since the recreate is done
without opening the data files. As long as the table definition file
<TT>`tbl_name.frm'</TT> is valid, the table can be recreated this way, even if
the data or index files have become corrupted.).

</P>
<P>
If you really want to know how many records are deleted when you are deleting
all rows, and are willing to suffer a speed penalty, you can use a
<CODE>DELETE</CODE> statement of this form:

</P>

<PRE>
mysql&#62; DELETE FROM tbl_name WHERE 1&#62;0;
</PRE>

<P>
Note that this is MUCH slower than <CODE>DELETE FROM tbl_name</CODE> with no
<CODE>WHERE</CODE> clause, because it deletes rows one at a time.

</P>
<P>
If you specify the keyword <CODE>LOW_PRIORITY</CODE>, execution of the
<CODE>DELETE</CODE> is delayed until no other clients are reading from the table.

</P>
<P>
Deleted records are maintained in a linked list and subsequent <CODE>INSERT</CODE>
operations reuse old record positions. To reclaim unused space and reduce
file sizes, use the <CODE>OPTIMIZE TABLE</CODE> statement or the <CODE>myisamchk</CODE>
utility to reorganize tables.  <CODE>OPTIMIZE TABLE</CODE> is easier, but
<CODE>myisamchk</CODE> is faster.
See section <A HREF="manual.html#OPTIMIZE_TABLE">7.9  <CODE>OPTIMIZE TABLE</CODE> syntax</A>, and
section <A HREF="manual.html#Optimization">13.4.3  Table optimization</A>.

</P>
<P>
The <STRONG>MySQL</STRONG>-specific <CODE>LIMIT rows</CODE> option to <CODE>DELETE</CODE> tells
the server the maximum number of rows to be deleted before control is
returned to the client.  This can be used to ensure that a specific
<CODE>DELETE</CODE> command doesn't take too much time.  You can simply repeat
the <CODE>DELETE</CODE> command until the number of affected rows is less than
the <CODE>LIMIT</CODE> value.

</P>
<P>
<A NAME="IDX520"></A>


<H2><A NAME="SELECT" HREF="manual_toc.html#SELECT">7.12  <CODE>SELECT</CODE> syntax</A></H2>


<PRE>
SELECT [STRAIGHT_JOIN] [SQL_SMALL_RESULT] [SQL_BIG_RESULT] [HIGH_PRIORITY]
       [DISTINCT | DISTINCTROW | ALL]
    select_expression,...
    [INTO {OUTFILE | DUMPFILE} 'file_name' export_options]
    [FROM table_references
        [WHERE where_definition]
        [GROUP BY col_name,...]
        [HAVING where_definition]
        [ORDER BY {unsigned_integer | col_name | formula} [ASC | DESC] ,...]
        [LIMIT [offset,] rows]
        [PROCEDURE procedure_name] ]
</PRE>

<P>
<CODE>SELECT</CODE> is used to retrieve rows selected from one or more tables.
<CODE>select_expression</CODE> indicates the columns you want to retrieve.
<CODE>SELECT</CODE> may also be used to retrieve rows computed without reference to
any table.  For example:

</P>

<PRE>
mysql&#62; SELECT 1 + 1;
         -&#62; 2
</PRE>

<P>
All keywords used must be given in exactly the order shown above. For example,
a <CODE>HAVING</CODE> clause must come after any <CODE>GROUP BY</CODE> clause and before
any <CODE>ORDER BY</CODE> clause.

</P>

<UL>

<LI>

<A NAME="IDX521"></A>
<A NAME="IDX522"></A>
A <CODE>SELECT</CODE> expression may be given an alias using <CODE>AS</CODE>. The alias
is used as the expression's column name and can be used with
<CODE>ORDER BY</CODE> or <CODE>HAVING</CODE> clauses.  For example:


<PRE>
mysql&#62; select concat(last_name,', ',first_name) AS full_name
    from mytable ORDER BY full_name;
</PRE>

<LI>

The <CODE>FROM table_references</CODE> clause indicates the tables from which to
retrieve rows.  If you name more than one table, you are performing a
join.  For information on join syntax, see section <A HREF="manual.html#JOIN">7.13  <CODE>JOIN</CODE> syntax</A>.

<LI>

You can refer to a column as <CODE>col_name</CODE>, <CODE>tbl_name.col_name</CODE> or
<CODE>db_name.tbl_name.col_name</CODE>.  You need not specify a <CODE>tbl_name</CODE> or
<CODE>db_name.tbl_name</CODE> prefix for a column reference in a <CODE>SELECT</CODE>
statement unless the reference would be ambiguous.  See section <A HREF="manual.html#Legal_names">7.1.5  Database, table, index, column and alias names</A>,
for examples of ambiguity that require the more explicit column reference
forms.

<LI>

<A NAME="IDX523"></A>
<A NAME="IDX524"></A>
A table reference may be aliased using <CODE>tbl_name [AS] alias_name</CODE>.


<PRE>
mysql&#62; select t1.name, t2.salary from employee AS t1, info AS t2
           where t1.name = t2.name;
mysql&#62; select t1.name, t2.salary from employee t1, info t2
           where t1.name = t2.name;
</PRE>

<LI>

Columns selected for output may be referred to in <CODE>ORDER BY</CODE> and
<CODE>GROUP BY</CODE> clauses using column names, column aliases or column
positions.  Column positions begin with 1.


<PRE>
mysql&#62; select college, region, seed from tournament
           ORDER BY region, seed;
mysql&#62; select college, region AS r, seed AS s from tournament
           ORDER BY r, s;
mysql&#62; select college, region, seed from tournament
           ORDER BY 2, 3;
</PRE>

To sort in reverse order, add the <CODE>DESC</CODE> (descending) keyword to the
name of the column in the <CODE>ORDER BY</CODE> clause that you are sorting by.
The default is ascending order; this may be specified explicitly using
the <CODE>ASC</CODE> keyword.

<LI>

The <CODE>HAVING</CODE> clause can refer to any column or alias named in the
<CODE>select_expression</CODE>. It is applied last, just before items are sent to
the client, with no optimization. Don't use <CODE>HAVING</CODE> for items that
should be in the <CODE>WHERE</CODE> clause.  For example, do not write this:


<PRE>
mysql&#62; select col_name from tbl_name HAVING col_name &#62; 0;
</PRE>

Write this instead:


<PRE>
mysql&#62; select col_name from tbl_name WHERE col_name &#62; 0;
</PRE>

In <STRONG>MySQL</STRONG> 3.22.5 or later, you can also write queries like this:


<PRE>
mysql&#62; select user,max(salary) from users
           group by user HAVING max(salary)&#62;10;
</PRE>

In older <STRONG>MySQL</STRONG> versions, you can write this instead:


<PRE>
mysql&#62; select user,max(salary) AS sum from users
           group by user HAVING sum&#62;10;
</PRE>

<LI>

<CODE>SQL_SMALL_RESULT</CODE>, <CODE>SQL_BIG_RESULT</CODE>, <CODE>STRAIGHT_JOIN</CODE> and
<CODE>HIGH_PRIORITY</CODE> are <STRONG>MySQL</STRONG> extensions to ANSI SQL92.

<LI>

<CODE>STRAIGHT_JOIN</CODE> forces the optimizer to join the tables in the order in
which they are listed in the <CODE>FROM</CODE> clause. You can use this to speed up
a query if the optimizer joins the tables in non-optimal order.
See section <A HREF="manual.html#EXPLAIN">7.22  <CODE>EXPLAIN</CODE> syntax (Get information about a <CODE>SELECT</CODE>)</A>.

<LI>

<CODE>SQL_SMALL_RESULT</CODE> can be used with <CODE>GROUP BY</CODE> or <CODE>DISTINCT</CODE>
to tell the optimizer that the result set will be small.  In this case,
<STRONG>MySQL</STRONG> will use fast temporary tables to store the resulting table
instead of using sorting.  <CODE>SQL_SMALL_RESULT</CODE> is a <STRONG>MySQL</STRONG>

<LI>

<CODE>SQL_BIG_RESULT</CODE> can be used with <CODE>GROUP BY</CODE> or <CODE>DISTINCT</CODE>
to tell the optimizer that the result set will have many rows.  In this case,
<STRONG>MySQL</STRONG> will directly use disk based temporary tables if needed.
<CODE>MySQL</CODE> in this case will prefer to do a sort instead doing a
temporary table with a key on the <CODE>GROUP BY</CODE> elements.

<LI>

<CODE>HIGH_PRIORITY</CODE> will give the <CODE>SELECT</CODE> higher priority than
a statement that updates a table.  You should only use this for queries
that are very fast and must be done at once.  A <CODE>SELECT HIGH_PRIORITY</CODE>
query will run if the table is locked for read even if there is an update
statement that is waiting for the table to be free.

<LI>

The <CODE>LIMIT</CODE> clause can be used to constrain the number of rows returned
by the <CODE>SELECT</CODE> statement.  <CODE>LIMIT</CODE> takes one or two numeric
arguments.

If two arguments are given, the first specifies the offset of the first row to
return, the second specifies the maximum number of rows to return.
The offset of the initial row is 0 (not 1).


<PRE>
mysql&#62; select * from table LIMIT 5,10;  # Retrieve rows 6-15
</PRE>

If one argument is given, it indicates the maximum number of rows to return.


<PRE>
mysql&#62; select * from table LIMIT 5;     # Retrieve first 5 rows
</PRE>

In other words, <CODE>LIMIT n</CODE> is equivalent to <CODE>LIMIT 0,n</CODE>.

<LI>

<A NAME="IDX525"></A>
The <CODE>SELECT ... INTO OUTFILE 'file_name'</CODE> form of <CODE>SELECT</CODE> writes
the selected rows to a file. The file is created on the server host, and
cannot already exist (among other things, this prevents database tables and
files such as <TT>`/etc/passwd'</TT> from being destroyed).  You must have the
<STRONG>file</STRONG> privilege on the server host to use this form of <CODE>SELECT</CODE>.

<CODE>SELECT ...  INTO OUTFILE</CODE> is the complement of <CODE>LOAD DATA
INFILE</CODE>; the syntax for the <CODE>export_options</CODE> part of the statement
consists of the same <CODE>FIELDS</CODE> and <CODE>LINES</CODE> clauses that are used
with the <CODE>LOAD DATA INFILE</CODE> statement.
See section <A HREF="manual.html#LOAD_DATA">7.16  <CODE>LOAD DATA INFILE</CODE> syntax</A>.

In the resulting text file, only the following characters are escaped by
the <CODE>ESCAPED BY</CODE> character:


<UL>
<LI>The <CODE>ESCAPED BY</CODE> character

<LI>The first character in <CODE>FIELDS TERMINATED BY</CODE>

<LI>The first character in <CODE>LINES TERMINATED BY</CODE>

</UL>

Additionally, <CODE>ASCII 0</CODE> is converted to <CODE>ESCAPED BY</CODE> followed by 0
(<CODE>ASCII 48</CODE>).

The reason for the above is that you MUST escape any <CODE>FIELDS
TERMINATED BY</CODE>, <CODE>ESCAPED BY</CODE> or <CODE>LINES TERMINATED BY</CODE>
characters to reliably be able to read the file
back. <CODE>ASCII 0</CODE> is escaped to make it easier to view with some
pagers.

As the resulting file doesn't have to conform to the SQL syntax, nothing
else need be escaped.
</UL>

<P>
<A NAME="IDX526"></A>
If you use <CODE>INTO DUMPFILE</CODE> instead of <CODE>INTO OUTFILE</CODE> <STRONG>MySQL</STRONG>
will only write one row into the file, without any column or line
terminations and without any escaping.  This is useful if you want to
store a blob in a file.

</P>
<P>
<A NAME="IDX527"></A>
<A NAME="IDX528"></A>
<A NAME="IDX529"></A>
<A NAME="IDX530"></A>
<A NAME="IDX531"></A>
<A NAME="IDX532"></A>
<A NAME="IDX533"></A>
<A NAME="IDX534"></A>


<H2><A NAME="JOIN" HREF="manual_toc.html#JOIN">7.13  <CODE>JOIN</CODE> syntax</A></H2>

<P>
<STRONG>MySQL</STRONG> supports the following <CODE>JOIN</CODE> syntaxes for use in
<CODE>SELECT</CODE> statements:

</P>

<PRE>
table_reference, table_reference
table_reference [CROSS] JOIN table_reference
table_reference INNER JOIN table_reference
table_reference STRAIGHT_JOIN table_reference
table_reference LEFT [OUTER] JOIN table_reference ON conditional_expr
table_reference LEFT [OUTER] JOIN table_reference USING (column_list)
table_reference NATURAL LEFT [OUTER] JOIN table_reference
{ oj table_reference LEFT OUTER JOIN table_reference ON conditional_expr }
</PRE>

<P>
<A NAME="IDX535"></A>
<A NAME="IDX536"></A>
The last <CODE>LEFT OUTER JOIN</CODE> syntax shown above exists only for
compatibility with ODBC.

</P>

<UL>
<LI>

A table reference may be aliased using <CODE>tbl_name AS alias_name</CODE> or
<CODE>tbl_name alias_name</CODE>.


<PRE>
mysql&#62; select t1.name, t2.salary from employee AS t1, info AS t2
           where t1.name = t2.name;
</PRE>

<LI>

<CODE>INNER JOIN</CODE> and <CODE>,</CODE> (comma) are semantically equivalent.
Both do a full join between the tables used.  Normally, you specify how
the tables should be linked in the <CODE>WHERE</CODE> condition.

<LI>

The <CODE>ON</CODE> conditional is any conditional of the form that may be used in
a <CODE>WHERE</CODE> clause.

<LI>

If there is no matching record for the right table in a <CODE>LEFT JOIN</CODE>, a
row with all columns set to <CODE>NULL</CODE> is used for the right table.  You can
use this fact to find records in a table that have no counterpart in another
table:


<PRE>
mysql&#62; select table1.* from table1
           LEFT JOIN table2 ON table1.id=table2.id
           where table2.id is NULL;
</PRE>

This example finds all rows in <CODE>table1</CODE> with an <CODE>id</CODE> value that is
not present in <CODE>table2</CODE> (i.e., all rows in <CODE>table1</CODE> with no
corresponding row in <CODE>table2</CODE>).  This assumes that <CODE>table2.id</CODE> is
declared <CODE>NOT NULL</CODE>, of course.

<LI>

The <CODE>USING</CODE> <CODE>(column_list)</CODE> clause names a list of columns that must
exist in both tables.  A <CODE>USING</CODE> clause such as:


<PRE>
A LEFT JOIN B USING (C1,C2,C3,...)
</PRE>

is defined to be semantically identical to an <CODE>ON</CODE> expression like
this:


<PRE>
A.C1=B.C1 AND A.C2=B.C2 AND A.C3=B.C3,...
</PRE>

<LI>

The <CODE>NATURAL LEFT JOIN</CODE> of two tables is defined to be semantically
equivalent to a <CODE>LEFT JOIN</CODE> with a <CODE>USING</CODE> clause that names all
columns that exist in both tables.

<LI>

<CODE>STRAIGHT_JOIN</CODE> is identical to <CODE>JOIN</CODE>, except that the left table
is always read before the right table. This can be used for those (few)
cases where the join optimizer puts the tables in the wrong order.
</UL>

<P>
Some examples:

</P>

<PRE>
mysql&#62; select * from table1,table2 where table1.id=table2.id;
mysql&#62; select * from table1 LEFT JOIN table2 ON table1.id=table2.id;
mysql&#62; select * from table1 LEFT JOIN table2 USING (id);
mysql&#62; select * from table1 LEFT JOIN table2 ON table1.id=table2.id
           LEFT JOIN table3 ON table2.id=table3.id;
</PRE>

<P>
See section <A HREF="manual.html#LEFT_JOIN_optimization">10.5.4  How MySQL optimizes <CODE>LEFT JOIN</CODE></A>.

</P>
<P>
<A NAME="IDX537"></A>


<H2><A NAME="INSERT" HREF="manual_toc.html#INSERT">7.14  <CODE>INSERT</CODE> syntax</A></H2>


<PRE>
    INSERT [LOW_PRIORITY | DELAYED] [IGNORE]
        [INTO] tbl_name [(col_name,...)]
        VALUES (expression,...),(...),...
or  INSERT [LOW_PRIORITY | DELAYED] [IGNORE]
        [INTO] tbl_name [(col_name,...)]
        SELECT ...
or  INSERT [LOW_PRIORITY | DELAYED] [IGNORE]
        [INTO] tbl_name
        SET col_name=expression, col_name=expression, ...
</PRE>

<P>
<CODE>INSERT</CODE> inserts new rows into an existing table.  The <CODE>INSERT ...
VALUES</CODE> form of the statement inserts rows based on explicitly-specified
values.  The <CODE>INSERT ... SELECT</CODE> form inserts rows selected from another
table or tables.  The <CODE>INSERT ... VALUES</CODE> form with multiple value lists
is supported in <STRONG>MySQL</STRONG> 3.22.5 or later.  The
<CODE>col_name=expression</CODE> syntax is supported in <STRONG>MySQL</STRONG> 3.22.10 or
later.

</P>
<P>
<CODE>tbl_name</CODE> is the table into which rows should be inserted.  The column
name list or the <CODE>SET</CODE> clause indicates which columns the statement
specifies values for.

</P>

<UL>
<LI>

If you specify no column list for <CODE>INSERT ... VALUES</CODE> or <CODE>INSERT
... SELECT</CODE>, values for all columns must be provided in the
<CODE>VALUES()</CODE> list or by the <CODE>SELECT</CODE>.  If you don't know the order of
the columns in the table, use <CODE>DESCRIBE tbl_name</CODE> to find out.

<LI>

Any column not explicitly given a value is set to its default value.  For
example, if you specify a column list that doesn't name all the columns in
the table, unnamed columns are set to their default values.  Default value
assignment is described in section <A HREF="manual.html#CREATE_TABLE">7.7  <CODE>CREATE TABLE</CODE> syntax</A>.

<LI>

An <CODE>expression</CODE> may refer to any column that was set earlier in a value
list.  For example, you can say this:


<PRE>
mysql&#62; INSERT INTO tbl_name (col1,col2) VALUES(15,col1*2);
</PRE>

But not this:


<PRE>
mysql&#62; INSERT INTO tbl_name (col1,col2) VALUES(col2*2,15);
</PRE>

<LI>

If you specify the keyword <CODE>LOW_PRIORITY</CODE>, execution of the
<CODE>INSERT</CODE> is delayed until no other clients are reading from the table.
In this case the client has to wait until the insert statement is completed,
which may take a long time if the table is in heavy use. This is in
contrast to <CODE>INSERT DELAYED</CODE> which lets the client continue at once.

<LI>

If you specify the keyword <CODE>IGNORE</CODE> in an <CODE>INSERT</CODE> with many value
rows, any rows which duplicate an existing <CODE>PRIMARY</CODE> or <CODE>UNIQUE</CODE>
key in the table are ignored and are not inserted.  If you do not specify
<CODE>IGNORE</CODE>, the insert is aborted if there is any row that duplicates an
existing key value.  You can check with the C API function
<CODE>mysql_info()</CODE> how many rows were inserted into the table.

<LI>

If <STRONG>MySQL</STRONG> was configured using the <CODE>DONT_USE_DEFAULT_FIELDS</CODE>
option, <CODE>INSERT</CODE> statements generate an error unless you explicitly
specify values for all columns that require a non-<CODE>NULL</CODE> value.
See section <A HREF="manual.html#configure_options">4.7.3  Typical <CODE>configure</CODE> options</A>.

<LI>

The following conditions hold for a <CODE>INSERT INTO ... SELECT</CODE> statement:


<UL>
<LI>

The query cannot contain an <CODE>ORDER BY</CODE> clause.

<LI>

The target table of the <CODE>INSERT</CODE> statement cannot appear in the
<CODE>FROM</CODE> clause of the <CODE>SELECT</CODE> part of the query, because it's
forbidden in ANSI SQL to <CODE>SELECT</CODE> from the same table into which you are
<CODE>INSERT</CODE>ing.  (The problem is that the <CODE>SELECT</CODE> possibly would
find records that were inserted earlier during the same run.  When using
sub-select clauses, the situation could easily be very confusing!)

<LI>

<CODE>AUTO_INCREMENT</CODE> columns work as usual.
</UL>

</UL>

<P>
<A NAME="IDX538"></A>
If you use <CODE>INSERT ... SELECT</CODE> or a <CODE>INSERT ... VALUES</CODE>
statement with multiple value lists, you can use the C API function
<CODE>mysql_info()</CODE> to get information about the query.  The format of the
information string is shown below:

</P>

<PRE>
Records: 100 Duplicates: 0 Warnings: 0
</PRE>

<P>
<CODE>Duplicates</CODE> indicates the number of rows that couldn't be inserted
because they would duplicate some existing unique index value.
<CODE>Warnings</CODE> indicates the number of attempts to insert column values that
were problematic in some way. Warnings can occur under any of the following
conditions:

</P>

<UL>
<LI>

Inserting <CODE>NULL</CODE> into a column that has been declared <CODE>NOT NULL</CODE>.
The column is set to its default value.

<LI>

Setting a numeric column to a value that lies outside the column's range.
The value is clipped to the appropriate endpoint of the range.

<LI>

Setting a numeric column to a value such as <CODE>'10.34 a'</CODE>.  The trailing
garbage is stripped and the remaining numeric part is inserted.  If the value
doesn't make sense as a number at all, the column is set to <CODE>0</CODE>.

<LI>

Inserting a string into a <CODE>CHAR</CODE>, <CODE>VARCHAR</CODE>, <CODE>TEXT</CODE> or
<CODE>BLOB</CODE> column that exceeds the column's maximum length.  The value is
truncated to the column's maximum length.

<LI>

Inserting a value into a date or time column that is illegal for the column
type.  The column is set to the appropriate ``zero'' value for the type.
</UL>

<P>
<A NAME="IDX539"></A>
<A NAME="IDX540"></A>

</P>
<P>
The <CODE>DELAYED</CODE> option
for the
<CODE>INSERT</CODE> statement is a <STRONG>MySQL</STRONG>-specific option that is very
useful if you have clients that can't wait for the <CODE>INSERT</CODE> to complete.
This is a common problem when you use <STRONG>MySQL</STRONG> for logging and you also
periodically run <CODE>SELECT</CODE> statements that take a long time to complete.
<CODE>DELAYED</CODE> was introduced in <STRONG>MySQL</STRONG> 3.22.15.  It is a
<STRONG>MySQL</STRONG> extension to ANSI SQL92.

</P>
<P>
When you use <CODE>INSERT DELAYED</CODE>, the client will get an ok at once
and the row will be inserted when the table is not in use by any other thread.

</P>
<P>
Another major benefit of using <CODE>INSERT DELAYED</CODE> is that inserts
from many clients are bundled together and written in one block. This is much
faster than doing many separate inserts.

</P>
<P>
Note that currently the queued rows are only stored in memory until they are
inserted into the table.  This means that if you kill <CODE>mysqld</CODE>
the hard way (<CODE>kill -9</CODE>) or if <CODE>mysqld</CODE> dies unexpectedly, any
queued rows that weren't written to disk are lost!

</P>
<P>
The following describes in detail what happens when you use the
<CODE>DELAYED</CODE> option to <CODE>INSERT</CODE> or <CODE>REPLACE</CODE>.  In this
description, the ``thread'' is the thread that received an <CODE>INSERT
DELAYED</CODE> command and ``handler'' is the thread that handles all
<CODE>INSERT DELAYED</CODE> statements for a particular table.

</P>

<UL>
<LI>

When a thread executes a <CODE>DELAYED</CODE> statement for a table, a handler
thread is created to process all <CODE>DELAYED</CODE> statements for the table, if
no such handler already exists.

<LI>

The thread checks whether or not the handler has acquired a <CODE>DELAYED</CODE>
lock already; if not, it tells the handler thread to do so.  The
<CODE>DELAYED</CODE> lock can be obtained even if other threads have a <CODE>READ</CODE>
or <CODE>WRITE</CODE> lock on the table.  However, the handler will wait for all
<CODE>ALTER TABLE</CODE> locks or <CODE>FLUSH TABLES</CODE> to ensure that the table
structure is up to date.

<LI>

The thread executes the <CODE>INSERT</CODE> statement but instead of writing
the row to the table it puts a copy of the final row into a queue that
is managed by the handler thread. Any syntax errors are noticed by the
thread and reported to the client program.

<LI>

The client can't report the number of duplicates or the <CODE>AUTO_INCREMENT</CODE>
value for the resulting row; it can't obtain them from the server, because
the <CODE>INSERT</CODE> returns before the insert operation has been completed.  If
you use the C API, the <CODE>mysql_info()</CODE> function doesn't return anything
meaningful, for the same reason.

<LI>

The update log is updated by the handler thread when the row is inserted into
the table.  In case of multiple-row inserts, the update log is updated when
the first row is inserted.

<LI>

After every <CODE>delayed_insert_limit</CODE> rows are written, the handler checks
whether or not any <CODE>SELECT</CODE> statements are still pending.  If so, it
allows these to execute before continuing.

<LI>

When the handler has no more rows in its queue, the table is unlocked.  If no
new <CODE>INSERT DELAYED</CODE> commands are received within
<CODE>delayed_insert_timeout</CODE> seconds, the handler terminates.

<LI>

If more than <CODE>delayed_queue_size</CODE> rows are pending already in a specific
handler queue, the thread waits until there is room in the queue.  This is
useful to ensure that the <CODE>mysqld</CODE> server doesn't use all memory for the
delayed memory queue.

<LI>

The handler thread will show up in the <STRONG>MySQL</STRONG> process list
with <CODE>delayed_insert</CODE> in the <CODE>Command</CODE> column.  It will
be killed if you execute a <CODE>FLUSH TABLES</CODE> command or kill it with
<CODE>KILL thread_id</CODE>. However, it will first store all queued rows into the
table before exiting. During this time it will not accept any new
<CODE>INSERT</CODE> commands from another thread. If you execute an <CODE>INSERT
DELAYED</CODE> command after this, a new handler thread will be created.

<LI>

Note that the above means that <CODE>INSERT DELAYED</CODE> commands have higher
priority than normal <CODE>INSERT</CODE> commands if there is an <CODE>INSERT
DELAYED</CODE> handler already running!  Other update commands will have to wait
until the <CODE>INSERT DELAY</CODE> queue is empty, someone kills the handler
thread (with <CODE>KILL thread_id</CODE>) or someone executes <CODE>FLUSH TABLES</CODE>.

<LI>

The following status variables provide information about <CODE>INSERT
DELAYED</CODE> commands:

<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><CODE>Delayed_insert_threads</CODE> </TD><TD> Number of handler threads
</TR NOSAVE>
<TR><TD><CODE>Delayed_writes</CODE> </TD><TD> Number of rows written with <CODE>INSERT DELAYED</CODE>
</TR NOSAVE>
<TR><TD><CODE>Not_flushed_delayed_rows</CODE> </TD><TD> Number of rows waiting to be written
</TR>
</TABLE>

You can view these variables by issuing a <CODE>SHOW STATUS</CODE> statement or
by executing a <CODE>mysqladmin extended-status</CODE> command.
</UL>

<P>
Note that <CODE>INSERT DELAYED</CODE> is slower than a normal INSERT if the
table is not in use.  There is also the additional overhead for the
server to handle a separate thread for each table on which you use
<CODE>INSERT DELAYED</CODE>.  This means that you should only use <CODE>INSERT
DELAYED</CODE> when you are really sure you need it!

</P>
<P>
<A NAME="IDX541"></A>


<H2><A NAME="REPLACE" HREF="manual_toc.html#REPLACE">7.15  <CODE>REPLACE</CODE> syntax</A></H2>


<PRE>
    REPLACE [LOW_PRIORITY | DELAYED]
        [INTO] tbl_name [(col_name,...)]
        VALUES (expression,...)
or  REPLACE [LOW_PRIORITY | DELAYED]
        [INTO] tbl_name [(col_name,...)]
        SELECT ...
or  REPLACE [LOW_PRIORITY | DELAYED]
        [INTO] tbl_name
        SET col_name=expression, col_name=expression,...
</PRE>

<P>
<CODE>REPLACE</CODE> works exactly like <CODE>INSERT</CODE>, except that if an old
record in the table has the same value as a new record on a unique index,
the old record is deleted before the new record is inserted.
See section <A HREF="manual.html#INSERT">7.14  <CODE>INSERT</CODE> syntax</A>.

</P>
<P>
<A NAME="IDX542"></A>


<H2><A NAME="LOAD_DATA" HREF="manual_toc.html#LOAD_DATA">7.16  <CODE>LOAD DATA INFILE</CODE> syntax</A></H2>


<PRE>
LOAD DATA [LOW_PRIORITY] [LOCAL] INFILE 'file_name.txt' [REPLACE | IGNORE]
    INTO TABLE tbl_name
    [FIELDS
        [TERMINATED BY '\t']
        [OPTIONALLY] ENCLOSED BY '']
        [ESCAPED BY '\\' ]]
    [LINES TERMINATED BY '\n']
    [IGNORE number LINES]
    [(col_name,...)]
</PRE>

<P>
The <CODE>LOAD DATA INFILE</CODE> statement reads rows from a text file into a
table at a very high speed.  If the <CODE>LOCAL</CODE> keyword is specified, the
file is read from the client host.  If <CODE>LOCAL</CODE> is not specified, the
file must be located on the server.  (<CODE>LOCAL</CODE> is available in
<STRONG>MySQL</STRONG> 3.22.6 or later.)

</P>
<P>
For security reasons, when reading text files located on the server, the
files must either reside in the database directory or be readable by all.
Also, to use <CODE>LOAD DATA INFILE</CODE> on server files, you must have the
<STRONG>file</STRONG> privilege on the server host.
See section <A HREF="manual.html#Privileges_provided">6.7  Privileges provided by MySQL</A>.

</P>
<P>
If you specify the keyword <CODE>LOW_PRIORITY</CODE>, execution of the
<CODE>LOAD DATA</CODE> statement is delayed until no other clients are reading
from the table.

</P>
<P>
Using <CODE>LOCAL</CODE> will be a bit slower than letting the server access the
files directly, since the contents of the file must travel from the client
host to the server host.  On the other hand, you do not need the
<STRONG>file</STRONG> privilege to load local files.

</P>
<P>
<A NAME="IDX543"></A>
You can also load data files by using the <CODE>mysqlimport</CODE> utility; it
operates by sending a <CODE>LOAD DATA INFILE</CODE> command to the server.  The
<CODE>--local</CODE> option causes <CODE>mysqlimport</CODE> to read data files from the
client host.  You can specify the <CODE>--compress</CODE> option to get better
performance over slow networks if the client and server support the
compressed protocol.

</P>
<P>
When locating files on the server host, the server uses the following rules:

</P>

<UL>
<LI>

If an absolute pathname is given, the server uses the pathname as is.

<LI>

If a relative pathname with one or more leading components is given,
the server searches for the file relative to the server's data directory.

<LI>

If a filename with no leading components is given, the server looks for
the file in the database directory of the current database.
</UL>

<P>
Note that these rules mean a file given as <TT>`./myfile.txt'</TT> is read from
the server's data directory, whereas a file given as <TT>`myfile.txt'</TT> is
read from the database directory of the current database.  For example,
the following <CODE>LOAD DATA</CODE> statement reads the file <TT>`data.txt'</TT>
from the database directory for <CODE>db1</CODE> because <CODE>db1</CODE> is the current
database, even though the statement explicitly loads the file into a
table in the <CODE>db2</CODE> database:

</P>

<PRE>
mysql&#62; USE db1;
mysql&#62; LOAD DATA INFILE "data.txt" INTO TABLE db2.my_table; 
</PRE>

<P>
The <CODE>REPLACE</CODE> and <CODE>IGNORE</CODE> keywords control handling of input
records that duplicate existing records on unique key values.  If you specify
<CODE>REPLACE</CODE>, new rows replace existing rows that have the same unique key
value. If you specify <CODE>IGNORE</CODE>, input rows that duplicate an existing
row on a unique key value are skipped.  If you don't specify either option, an
error occurs when a duplicate key value is found, and the rest of the text
file is ignored.

</P>
<P>
If you load data from a local file using the <CODE>LOCAL</CODE> keyword, the server
has no way to stop transmission of the file in the middle of the operation,
so the default bahavior is the same as if <CODE>IGNORE</CODE> is specified.

</P>
<P>
<CODE>LOAD DATA INFILE</CODE> is the complement of <CODE>SELECT ... INTO OUTFILE</CODE>.
See section <A HREF="manual.html#SELECT">7.12  <CODE>SELECT</CODE> syntax</A>.
To write data from a database to a file, use <CODE>SELECT ... INTO OUTFILE</CODE>.
To read the file back into the database, use <CODE>LOAD DATA INFILE</CODE>.
The syntax of the <CODE>FIELDS</CODE> and <CODE>LINES</CODE> clauses is the same for
both commands.  Both clauses are optional, but <CODE>FIELDS</CODE>
must precede <CODE>LINES</CODE> if both are specified.

</P>
<P>
If you specify a <CODE>FIELDS</CODE> clause,
each of its subclauses (<CODE>TERMINATED BY</CODE>, <CODE>[OPTIONALLY] ENCLOSED
BY</CODE> and <CODE>ESCAPED BY</CODE>) is also optional, except that you must
specify at least one of them.

</P>
<P>
If you don't specify a <CODE>FIELDS</CODE> clause, the defaults are the
same as if you had written this:

</P>

<PRE>
FIELDS TERMINATED BY '\t' ENCLOSED BY '' ESCAPED BY '\\'
</PRE>

<P>
If you don't specify a <CODE>LINES</CODE> clause, the default
is the same as if you had written this:

</P>

<PRE>
LINES TERMINATED BY '\n'
</PRE>

<P>
In other words, the defaults cause <CODE>LOAD DATA INFILE</CODE> to act as follows
when reading input:

</P>

<UL>
<LI>

Look for line boundaries at newlines

<LI>

Break lines into fields at tabs

<LI>

Do not expect fields to be enclosed within any quoting characters

<LI>

Interpret occurrences of tab, newline or <SAMP>`\'</SAMP> preceded by
<SAMP>`\'</SAMP> as literal characters that are part of field values
</UL>

<P>
Conversely, the defaults cause <CODE>SELECT ... INTO OUTFILE</CODE> to act as
follows when writing output:

</P>

<UL>
<LI>

Write tabs between fields

<LI>

Do not enclose fields within any quoting characters

<LI>

Use <SAMP>`\'</SAMP> to escape instances of tab, newline or <SAMP>`\'</SAMP> that occur
within field values

<LI>

Write newlines at the ends of lines
</UL>

<P>
Note that to write <CODE>FIELDS ESCAPED BY '\\'</CODE>, you must specify two
backslashes for the value to be read as a single backslash.

</P>
<P>
The <CODE>IGNORE number LINES</CODE> option can be used to ignore a header of
column names at the start of the file:

</P>

<PRE>
mysql&#62; LOAD DATA INFILE "/tmp/file_name" into table test IGNORE 1 LINES;
</PRE>

<P>
When you use <CODE>SELECT ... INTO OUTFILE</CODE> in tandem with <CODE>LOAD
DATA INFILE</CODE> to write data from a database into a file and then read
the file back into the database later, the field and line handling
options for both commands must match.  Otherwise, <CODE>LOAD DATA
INFILE</CODE> will not interpret the contents of the file properly.  Suppose
you use <CODE>SELECT ... INTO OUTFILE</CODE> to write a file with
fields delimited by commas:

</P>

<PRE>
mysql&#62; SELECT * FROM table1 INTO OUTFILE 'data.txt'
           FIELDS TERMINATED BY ','
           FROM ...
</PRE>

<P>
To read the comma-delimited file back in, the correct statement would be:

</P>

<PRE>
mysql&#62; LOAD DATA INFILE 'data.txt' INTO TABLE table2
           FIELDS TERMINATED BY ',';
</PRE>

<P>
If instead you tried to read in the file with the statement shown below, it
wouldn't work because it instructs <CODE>LOAD DATA INFILE</CODE> to look for
tabs between fields:

</P>

<PRE>
mysql&#62; LOAD DATA INFILE 'data.txt' INTO TABLE table2
           FIELDS TERMINATED BY '\t';
</PRE>

<P>
The likely result is that each input line would be interpreted as
a single field.

</P>
<P>
<CODE>LOAD DATA INFILE</CODE> can be used to read files obtained from
external sources, too. For example, a file in dBASE format will have
fields separated by commas and enclosed in double quotes.  If lines in
the file are terminated by newlines, the command shown below
illustrates the field and line handling options you would use to load
the file:

</P>

<PRE>
mysql&#62; LOAD DATA INFILE 'data.txt' INTO TABLE tbl_name
           FIELDS TERMINATED BY ',' ENCLOSED BY '"'
           LINES TERMINATED BY '\n';
</PRE>

<P>
Any of the field or line handling options may specify an empty string
(<CODE>''</CODE>).  If not empty, the <CODE>FIELDS [OPTIONALLY] ENCLOSED BY</CODE>
and <CODE>FIELDS ESCAPED BY</CODE> values must be a single character.  The
<CODE>FIELDS TERMINATED BY</CODE> and <CODE>LINES TERMINATED BY</CODE> values may
be more than one character.  For example, to write lines that are
terminated by carriage return-linefeed pairs, or to read a file
containing such lines, specify a <CODE>LINES TERMINATED BY '\r\n'</CODE>
clause.

</P>
<P>
<CODE>FIELDS [OPTIONALLY] ENCLOSED BY</CODE> controls quoting of fields.  For
output (<CODE>SELECT ... INTO OUTFILE</CODE>), if you omit the word
<CODE>OPTIONALLY</CODE>, all fields are enclosed by the <CODE>ENCLOSED BY</CODE>
character.  An example of such output (using a comma as the field
delimiter) is shown below:

</P>

<PRE>
"1","a string","100.20"
"2","a string containing a , comma","102.20"
"3","a string containing a \" quote","102.20"
"4","a string containing a \", quote and comma","102.20"
</PRE>

<P>
If you specify <CODE>OPTIONALLY</CODE>, the <CODE>ENCLOSED BY</CODE> character is
used only to enclose <CODE>CHAR</CODE> and <CODE>VARCHAR</CODE> fields:

</P>

<PRE>
1,"a string",100.20
2,"a string containing a , comma",102.20
3,"a string containing a \" quote",102.20
4,"a string containing a \", quote and comma",102.20
</PRE>

<P>
Note that occurrences of the <CODE>ENCLOSED BY</CODE> character within a
field value are escaped by prefixing them with the <CODE>ESCAPED BY</CODE>
character.  Also note that if you specify an empty <CODE>ESCAPED BY</CODE>
value, it is possible to generate output that cannot be read properly by
<CODE>LOAD DATA INFILE</CODE>. For example, the output just shown above would
appear as shown below if the escape character is empty.  Observe that the
second field in the fourth line contains a comma following the quote, which
(erroneously) appears to terminate the field:

</P>

<PRE>
1,"a string",100.20
2,"a string containing a , comma",102.20
3,"a string containing a " quote",102.20
4,"a string containing a ", quote and comma",102.20
</PRE>

<P>
For input, the <CODE>ENCLOSED BY</CODE> character, if present, is stripped from the
ends of field values.  (This is true whether or not <CODE>OPTIONALLY</CODE> is
specified; <CODE>OPTIONALLY</CODE> has no effect on input interpretation.)
Occurrences of the <CODE>ENCLOSED BY</CODE> character preceded by the
<CODE>ESCAPED BY</CODE> character are interpreted as part of the current field
value.  In addition, duplicated <CODE>ENCLOSED BY</CODE> characters occurring
within fields are interpreted as single <CODE>ENCLOSED BY</CODE> characters if the
field itself starts with that character.  For example, if <CODE>ENCLOSED BY
'"'</CODE> is specified, quotes are handled as shown below:

</P>

<PRE>
"The ""BIG"" boss"  -&#62; The "BIG" boss
The "BIG" boss      -&#62; The "BIG" boss
The ""BIG"" boss    -&#62; The ""BIG"" boss
</PRE>

<P>
<CODE>FIELDS ESCAPED BY</CODE> controls how to write or read special characters.
If the <CODE>FIELDS ESCAPED BY</CODE> character is not empty, it is used to prefix
the following characters on output:

<UL>
<LI>

The <CODE>FIELDS ESCAPED BY</CODE> character
<LI>

The <CODE>FIELDS [OPTIONALLY] ENCLOSED BY</CODE> character
<LI>

The first character of the <CODE>FIELDS TERMINATED BY</CODE> and
<CODE>LINES TERMINATED BY</CODE> values
<LI>

ASCII <CODE>0</CODE> (what is actually written following the escape character is
ASCII <CODE>'0'</CODE>, not a zero-valued byte)
</UL>

<P>
If the <CODE>FIELDS ESCAPED BY</CODE> character is empty, no characters are escaped.
It is probably not a good idea to specify an empty escape character,
particularly if field values in your data contain any of the characters in
the list just given.

</P>
<P>
For input, if the <CODE>FIELDS ESCAPED BY</CODE> character is not empty, occurrences
of that character are stripped and the following character is taken literally
as part of a field value.  The exceptions are an escaped <SAMP>`0'</SAMP> or
<SAMP>`N'</SAMP> (e.g., <CODE>\0</CODE> or <CODE>\N</CODE> if the escape character is
<SAMP>`\'</SAMP>).  These sequences are interpreted as ASCII <CODE>0</CODE> (a zero-valued
byte) and <CODE>NULL</CODE>.  See below for the rules on <CODE>NULL</CODE> handling.

</P>
<P>
For more information about <SAMP>`\'</SAMP>-escape syntax,
see section <A HREF="manual.html#Literals">7.1  Literals: how to write strings and numbers</A>.

</P>
<P>
In certain cases, field and line handling options interact:

</P>

<UL>
<LI>

If <CODE>LINES TERMINATED BY</CODE> is an empty string and <CODE>FIELDS
TERMINATED BY</CODE> is non-empty, lines are also terminated with
<CODE>FIELDS TERMINATED BY</CODE>.
<LI>

If the <CODE>FIELDS TERMINATED BY</CODE> and <CODE>FIELDS ENCLOSED BY</CODE> values are
both empty (<CODE>''</CODE>), a fixed-row (non-delimited) format is used.  With
fixed-row format, no delimiters are used between fields. Instead, column
values are written and read using the ``display'' widths of the columns.  For
example, if a column is declared as <CODE>INT(7)</CODE>, values for the column are
written using 7-character fields.  On input, values for the column are
obtained by reading 7 characters.  Fixed-row format also affects handling of
<CODE>NULL</CODE> values; see below.  Note that fixed size format will not work
if you are using a multi-byte character set.
</UL>

<P>
Handling of <CODE>NULL</CODE> values varies, depending on the <CODE>FIELDS</CODE> and
<CODE>LINES</CODE> options you use:

</P>

<UL>
<LI>

For the default <CODE>FIELDS</CODE> and <CODE>LINES</CODE> values,
<CODE>NULL</CODE> is written as <CODE>\N</CODE> for output and <CODE>\N</CODE> is read
as <CODE>NULL</CODE> for input (assuming the <CODE>ESCAPED BY</CODE> character
is <SAMP>`\'</SAMP>).

<LI>

If <CODE>FIELDS ENCLOSED BY</CODE> is not empty, a field containing the literal
word <CODE>NULL</CODE> as its value is read as a <CODE>NULL</CODE> value (this differs
from the word <CODE>NULL</CODE> enclosed within <CODE>FIELDS ENCLOSED BY</CODE>
characters, which is read as the string <CODE>'NULL'</CODE>).

<LI>

If <CODE>FIELDS ESCAPED BY</CODE> is empty, <CODE>NULL</CODE> is written as the word
<CODE>NULL</CODE>.

<LI>

With fixed-row format (which happens when <CODE>FIELDS TERMINATED BY</CODE> and
<CODE>FIELDS ENCLOSED BY</CODE> are both empty), <CODE>NULL</CODE> is written as an empty
string.  Note that this causes both <CODE>NULL</CODE> values and empty strings in
the table to be indistinguishable when written to the file since they are
both written as empty strings.  If you need to be able to tell the two apart
when reading the file back in, you should not use fixed-row format.
</UL>

<P>
Some cases are not supported by <CODE>LOAD DATA INFILE</CODE>:

<UL>

<LI>

Fixed-size rows (<CODE>FIELDS TERMINATED BY</CODE> and <CODE>FIELDS ENCLOSED
BY</CODE> both empty) and <CODE>BLOB</CODE> or <CODE>TEXT</CODE> columns.

<LI>

If you specify one separator that is the same as or a prefix of another,
<CODE>LOAD DATA INFILE</CODE> won't be able to interpret the input properly.
For example, the following <CODE>FIELDS</CODE> clause would cause problems:


<PRE>
FIELDS TERMINATED BY '"' ENCLOSED BY '"'
</PRE>

<LI>

If <CODE>FIELDS ESCAPED BY</CODE> is empty, a field value that contains an occurrence
of <CODE>FIELDS ENCLOSED BY</CODE> or <CODE>LINES TERMINATED BY</CODE>
followed by the <CODE>FIELDS TERMINATED BY</CODE> value will cause <CODE>LOAD
DATA INFILE</CODE> to stop reading a field or line too early.
This happens because <CODE>LOAD DATA INFILE</CODE> cannot properly determine
where the field or line value ends.
</UL>

<P>
The following example loads all columns of the <CODE>persondata</CODE> table:

</P>

<PRE>
mysql&#62; LOAD DATA INFILE 'persondata.txt' INTO TABLE persondata;
</PRE>

<P>
No field list is specified, so <CODE>LOAD DATA INFILE</CODE> expects input rows
to contain a field for each table column.  The default <CODE>FIELDS</CODE> and
<CODE>LINES</CODE> values are used.

</P>
<P>
If you wish to load only some of a table's columns, specify a field list:

</P>

<PRE>
mysql&#62; LOAD DATA INFILE 'persondata.txt'
           INTO TABLE persondata (col1,col2,...);
</PRE>

<P>
You must also specify a field list if the order of the fields in the input
file differs from the order of the columns in the table.  Otherwise,
<STRONG>MySQL</STRONG> cannot tell how to match up input fields with table columns.

</P>
<P>
If a row has too few fields, the columns for which no input field is present
are set to default values.  Default value assignment is described in
section <A HREF="manual.html#CREATE_TABLE">7.7  <CODE>CREATE TABLE</CODE> syntax</A>.

</P>
<P>
An empty field value is interpreted differently than if the field value
is missing:

</P>

<UL>
<LI>

For string types, the column is set to the empty string.

<LI>

For numeric types, the column is set to <CODE>0</CODE>.

<LI>

For date and time types, the column is set to the appropriate ``zero''
value for the type.
See section <A HREF="manual.html#Date_and_time_types">7.3.6  Date and time types</A>.
</UL>

<P>
<CODE>TIMESTAMP</CODE> columns are only set to the current date and time if there
is a <CODE>NULL</CODE> value for the column, or (for the first <CODE>TIMESTAMP</CODE>
column only) if the <CODE>TIMESTAMP</CODE> column is left out from the field list
when a field list is specified.

</P>
<P>
If an input row has too many fields, the extra fields are ignored and
the number of warnings is incremented.

</P>
<P>
<CODE>LOAD DATA INFILE</CODE> regards all input as strings, so you can't use
numeric values for <CODE>ENUM</CODE> or <CODE>SET</CODE> columns the way you can with
<CODE>INSERT</CODE> statements.  All <CODE>ENUM</CODE> and <CODE>SET</CODE> values must be
specified as strings!

</P>
<P>
<A NAME="IDX544"></A>
If you are using the C API, you can get information about the query by
calling the API function <CODE>mysql_info()</CODE> when the <CODE>LOAD DATA INFILE</CODE>
query finishes.  The format of the information string is shown below:

</P>

<PRE>
Records: 1  Deleted: 0  Skipped: 0  Warnings: 0
</PRE>

<P>
Warnings occur under the same circumstances as when values are inserted
via the <CODE>INSERT</CODE> statement (see section <A HREF="manual.html#INSERT">7.14  <CODE>INSERT</CODE> syntax</A>), except
that <CODE>LOAD DATA INFILE</CODE> also generates warnings when there are too few
or too many fields in the input row.  The warnings are not stored anywhere;
the number of warnings can only be used as an indication if everything went
well.  If you get warnings and want to know exactly why you got them, one way
to do this is to use <CODE>SELECT ... INTO OUTFILE</CODE> into another file and
compare this to your original input file.

</P>
<P>
For more information about the efficiency of <CODE>INSERT</CODE> versus
<CODE>LOAD DATA INFILE</CODE> and speeding up <CODE>LOAD DATA INFILE</CODE>,
See section <A HREF="manual.html#Insert_speed">10.5.6  Speed of <CODE>INSERT</CODE> queries</A>.

</P>
<P>
<A NAME="IDX545"></A>


<H2><A NAME="UPDATE" HREF="manual_toc.html#UPDATE">7.17  <CODE>UPDATE</CODE> syntax</A></H2>


<PRE>
UPDATE [LOW_PRIORITY] tbl_name SET col_name1=expr1,col_name2=expr2,...
    [WHERE where_definition] [LIMIT #]
</PRE>

<P>
<CODE>UPDATE</CODE> updates columns in existing table rows with new values.  The
<CODE>SET</CODE> clause indicates which columns to modify and the values they
should be given.  The <CODE>WHERE</CODE> clause, if given, specifies which rows
should be updated.  Otherwise all rows are updated.

</P>
<P>
If you specify the keyword <CODE>LOW_PRIORITY</CODE>, execution of the
<CODE>UPDATE</CODE> is delayed until no other clients are reading from the table.

</P>
<P>
If you access a column from <CODE>tbl_name</CODE> in an expression, <CODE>UPDATE</CODE> uses
the current value of the column.  For example, the following statement sets
the <CODE>age</CODE> column to one more than its current value:

</P>

<PRE>
mysql&#62; UPDATE persondata SET age=age+1;
</PRE>

<P>
<CODE>UPDATE</CODE> assignments are evaluated from left to right.  For example, the
following statement doubles the <CODE>age</CODE> column, then increments it:

</P>

<PRE>
mysql&#62; UPDATE persondata SET age=age*2, age=age+1;
</PRE>

<P>
If you set a column to the value it currently has, <STRONG>MySQL</STRONG> notices
this and doesn't update it.

</P>
<P>
<A NAME="IDX546"></A>
<CODE>UPDATE</CODE> returns the number of rows that were actually changed.
In <STRONG>MySQL</STRONG> 3.22 or later, the C API function <CODE>mysql_info()</CODE>
returns the number of rows that were matched and updated and the number of
warnings that occurred during the <CODE>UPDATE</CODE>.

</P>
<P>
In <STRONG>MySQL</STRONG> 3.23 you can use <CODE>LIMIT #</CODE> to ensure that only a given
number of rows are changed.

</P>
<P>
<A NAME="IDX547"></A>


<H2><A NAME="USE" HREF="manual_toc.html#USE">7.18  <CODE>USE</CODE> syntax</A></H2>


<PRE>
USE db_name
</PRE>

<P>
The <CODE>USE db_name</CODE> statement tells <STRONG>MySQL</STRONG> to use the <CODE>db_name</CODE>
database as the default database for subsequent queries.  The database remains
current until the end of the session, or until another <CODE>USE</CODE> statement
is issued:

</P>

<PRE>
mysql&#62; USE db1;
mysql&#62; SELECT count(*) FROM mytable;      # selects from db1.mytable
mysql&#62; USE db2;
mysql&#62; SELECT count(*) FROM mytable;      # selects from db2.mytable
</PRE>

<P>
Making a particular database current by means of the <CODE>USE</CODE> statement
does not preclude you from accessing tables in other databases.  The example
below accesses the <CODE>author</CODE> table from the <CODE>db1</CODE> database and the
<CODE>editor</CODE> table from the <CODE>db2</CODE> database:

</P>

<PRE>
mysql&#62; USE db1;
mysql&#62; SELECT author_name,editor_name FROM author,db2.editor
           WHERE author.editor_id = db2.editor.editor_id;
</PRE>

<P>
<A NAME="IDX548"></A>
<A NAME="IDX549"></A>
The <CODE>USE</CODE> statement is provided for Sybase compatibility.

</P>
<P>
<A NAME="IDX550"></A>
<A NAME="IDX551"></A>


<H2><A NAME="FLUSH" HREF="manual_toc.html#FLUSH">7.19  <CODE>FLUSH</CODE> syntax (clearing caches)</A></H2>


<PRE>
FLUSH flush_option [,flush_option]
</PRE>

<P>
You should use the <CODE>FLUSH</CODE> command if you want to clear some of the
internal caches <STRONG>MySQL</STRONG> uses.  To execute <CODE>FLUSH</CODE>, you must have
the <STRONG>reload</STRONG> privilege.

</P>
<P>
<CODE>flush_option</CODE> can be any of the following:

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><CODE>HOSTS</CODE> </TD><TD> Empties the host cache tables.  You should flush the
host tables if some of your hosts change IP number or if you get the
error message <CODE>Host ... is blocked</CODE>.  When more than
<CODE>max_connect_errors</CODE> errors occur in a row for a given host while
connection to the <STRONG>MySQL</STRONG> server, <STRONG>MySQL</STRONG> assumes
something is wrong and blocks the host from further connection requests.
Flushing the host tables allows the host to attempt to connect
again. See section <A HREF="manual.html#Blocked_host">18.2.3  <CODE>Host '...' is blocked</CODE> error</A>.) You can start <CODE>mysqld</CODE> with
<CODE>-O max_connection_errors=999999999</CODE> to avoid this error message.

</TR NOSAVE>
<TR><TD><CODE>LOGS</CODE> </TD><TD> Closes and reopens the standard and update log
files.  If you have specified the update log file without an extension,
the extension number of the new update log file will be incremented by
one relative to the previous file.  If you have used an extension in the
file name, MySQL will close and reopen the update log file.  On Unix you
can use this behaviour to your advantage by first moving the file to another
name and then issue <CODE>FLUSH LOGS</CODE>.

</TR NOSAVE>
<TR><TD><CODE>PRIVILEGES</CODE> </TD><TD> Reloads the privileges from the grant tables in
the <CODE>mysql</CODE> database.

</TR NOSAVE>
<TR><TD><CODE>TABLES</CODE> </TD><TD> Closes all open tables.

</TR NOSAVE>
<TR><TD><CODE>STATUS</CODE> </TD><TD> Resets most status variables to zero.
</TR>
</TABLE>

<P>
You can also access each of the commands shown above with the <CODE>mysqladmin</CODE>
utility, using the <CODE>flush-hosts</CODE>, <CODE>flush-logs</CODE>, <CODE>reload</CODE>
or <CODE>flush-tables</CODE> commands.

</P>
<P>
<A NAME="IDX552"></A>
<A NAME="IDX553"></A>


<H2><A NAME="KILL" HREF="manual_toc.html#KILL">7.20  <CODE>KILL</CODE> syntax</A></H2>


<PRE>
KILL thread_id
</PRE>

<P>
Each connection to <CODE>mysqld</CODE> runs in a separate thread.  You can see
which threads are running with the <CODE>SHOW PROCESSLIST</CODE> command, and kill
a thread with the <CODE>KILL thread_id</CODE> command.

</P>
<P>
If you have the <STRONG>process</STRONG> privilege, you can see and kill all threads.
Otherwise, you can see and kill only your own threads.

</P>
<P>
You can also use the <CODE>mysqladmin processlist</CODE> and <CODE>mysqladmin kill</CODE>
commands to examine and kill threads.

</P>
<P>
<A NAME="IDX554"></A>
<A NAME="IDX555"></A>
<A NAME="IDX556"></A>
<A NAME="IDX557"></A>
<A NAME="IDX558"></A>
<A NAME="IDX559"></A>
<A NAME="IDX560"></A>
<A NAME="IDX561"></A>
<A NAME="IDX562"></A>
<A NAME="IDX563"></A>
<A NAME="IDX564"></A>


<H2><A NAME="SHOW" HREF="manual_toc.html#SHOW">7.21  <CODE>SHOW</CODE> syntax (Get information about tables, columns,...)</A></H2>


<PRE>
   SHOW DATABASES [LIKE wild]
or SHOW TABLES [FROM db_name] [LIKE wild]
or SHOW COLUMNS FROM tbl_name [FROM db_name] [LIKE wild]
or SHOW INDEX FROM tbl_name [FROM db_name]
or SHOW STATUS
or SHOW VARIABLES [LIKE wild]
or SHOW [FULL] PROCESSLIST
or SHOW TABLE STATUS [FROM db_name] [LIKE wild]
or SHOW GRANTS FOR user
</PRE>

<P>
<CODE>SHOW</CODE> provides information about databases, tables, columns or the
server. If the <CODE>LIKE wild</CODE> part is used, the <CODE>wild</CODE> string can be a
string that uses the SQL <SAMP>`%'</SAMP> and <SAMP>`_'</SAMP> wildcard characters.

</P>
<P>
You can use <CODE>db_name.tbl_name</CODE> as an alternative to the <CODE>tbl_name
FROM db_name</CODE> syntax.  These two statements are equivalent:

</P>

<PRE>
mysql&#62; SHOW INDEX FROM mytable FROM mydb;
mysql&#62; SHOW INDEX FROM mydb.mytable;
</PRE>

<P>
<CODE>SHOW DATABASES</CODE> lists the databases on the <STRONG>MySQL</STRONG> server
host.  You can also get this list using the <CODE>mysqlshow</CODE> command.

</P>
<P>
<CODE>SHOW TABLES</CODE> lists the tables in a given database.  You can also
get this list using the <CODE>mysqlshow db_name</CODE> command.

</P>
<P>
<STRONG>Note:</STRONG> If a user doesn't have any privileges for a table, the table
will not show up in the output from <CODE>SHOW TABLES</CODE> or <CODE>mysqlshow
db_name</CODE>.

</P>
<P>
<CODE>SHOW COLUMNS</CODE> lists the columns in a given table.
If the column types are different than you expect them to be based on a
<CODE>CREATE TABLE</CODE> statement, note that MySQL sometimes changes column
types.
See section <A HREF="manual.html#Silent_column_changes">7.7.1  Silent column specification changes</A>.

</P>
<P>
The <CODE>DESCRIBE</CODE> statement provides information similar to
<CODE>SHOW COLUMNS</CODE>.
See section <A HREF="manual.html#DESCRIBE">7.23  <CODE>DESCRIBE</CODE> syntax (Get information about columns)</A>.

</P>
<P>
<CODE>SHOW TABLE STATUS</CODE> (new in version 3.23) works likes <CODE>SHOW
STATUS</CODE>, but provides a lot of information about each table. You can
also get this list using the <CODE>mysqlshow --status db_name</CODE> command.
The following columns are returned:

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><STRONG>Column</STRONG> </TD><TD> <STRONG>Meaning</STRONG>
</TR NOSAVE>
<TR><TD><CODE>Name</CODE> </TD><TD> Name of the table
</TR NOSAVE>
<TR><TD><CODE>Type</CODE> </TD><TD> Type of table (ISAM, MyISAM or HEAP)
</TR NOSAVE>
<TR><TD><CODE>Row_format</CODE> </TD><TD> The row storage format (Fixed, Dynamic, or Compressed)
</TR NOSAVE>
<TR><TD><CODE>Rows</CODE> </TD><TD> Number of rows
</TR NOSAVE>
<TR><TD><CODE>Avg_row_length</CODE> </TD><TD> Average row length
</TR NOSAVE>
<TR><TD><CODE>Data_length</CODE> </TD><TD> Length of the data file
</TR NOSAVE>
<TR><TD><CODE>Max_data_length</CODE> </TD><TD> Max length of the data file
</TR NOSAVE>
<TR><TD><CODE>Index_length</CODE> </TD><TD> Length of the index file
</TR NOSAVE>
<TR><TD><CODE>Data_free</CODE> </TD><TD> Number of allocated but not used bytes
</TR NOSAVE>
<TR><TD><CODE>Auto_increment</CODE> </TD><TD> Next autoincrement value
</TR NOSAVE>
<TR><TD><CODE>Create_time</CODE> </TD><TD> When the table was created
</TR NOSAVE>
<TR><TD><CODE>Update_time</CODE> </TD><TD> When the data file was last updated
</TR NOSAVE>
<TR><TD><CODE>Check_time</CODE> </TD><TD> When one last run a check on the table
</TR NOSAVE>
<TR><TD><CODE>Create_options</CODE> </TD><TD> Extra options used with <CODE>CREATE TABLE</CODE>
</TR NOSAVE>
<TR><TD><CODE>Comment</CODE> </TD><TD> The comment used when creating the table (or some information why MySQL couldn't access the table information).
</TR>
</TABLE>

<P>
<CODE>SHOW FIELDS</CODE> is a synonym for <CODE>SHOW COLUMNS</CODE> and
<CODE>SHOW KEYS</CODE> is a synonym for <CODE>SHOW INDEX</CODE>.  You can also
list a table's columns or indexes with <CODE>mysqlshow db_name tbl_name</CODE>
or <CODE>mysqlshow -k db_name tbl_name</CODE>.

</P>
<P>
<CODE>SHOW INDEX</CODE> returns the index information in a format that closely
resembles the <CODE>SQLStatistics</CODE> call in ODBC. The following columns
are returned:

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><STRONG>Column</STRONG> </TD><TD> <STRONG>Meaning</STRONG>
</TR NOSAVE>
<TR><TD><CODE>Table</CODE> </TD><TD> Name of the table
</TR NOSAVE>
<TR><TD><CODE>Non_unique</CODE> </TD><TD> 0 if the index can't contain duplicates.
</TR NOSAVE>
<TR><TD><CODE>Key_name</CODE> </TD><TD> Name of the index
</TR NOSAVE>
<TR><TD><CODE>Seq_in_index</CODE> </TD><TD> Column sequence number in index, starting with 1.
</TR NOSAVE>
<TR><TD><CODE>Column_name</CODE> </TD><TD> Column name.
</TR NOSAVE>
<TR><TD><CODE>Collation</CODE> </TD><TD> How the column is sorted in the index.  In
<STRONG>MySQL</STRONG>, this can have values <CODE>A</CODE> (Ascending) or <CODE>NULL</CODE>
(Not sorted).
</TR NOSAVE>
<TR><TD><CODE>Cardinality</CODE> </TD><TD> Number of unique values in the index.
This is updated by running <CODE>isamchk -a</CODE>.
</TR NOSAVE>
<TR><TD><CODE>Sub_part</CODE> </TD><TD> Number of indexed characters if the column is
only partly indexed. <CODE>NULL</CODE> if the entire key is indexed.
</TR>
</TABLE>

<P>
<A NAME="IDX565"></A>
<CODE>SHOW STATUS</CODE> provides server status information
(like <CODE>mysqladmin extended-status</CODE>). The output resembles that shown
below, though the format and numbers may differ somewhat:

</P>

<PRE>
+--------------------------+--------+
| Variable_name            | Value  |
+--------------------------+--------+
| Aborted_clients          | 0      |
| Aborted_connects         | 0      |
| Connections              | 17     |
| Created_tmp_tables       | 0      |
| Delayed_insert_threads   | 0      |
| Delayed_writes           | 0      |
| Delayed_errors           | 0      |
| Flush_commands           | 2      |
| Handler_delete           | 2      |
| Handler_read_first       | 0      |
| Handler_read_key         | 1      |
| Handler_read_next        | 0      |
| Handler_read_rnd         | 35     |
| Handler_update           | 0      |
| Handler_write            | 2      |
| Key_blocks_used          | 0      |
| Key_read_requests        | 0      |
| Key_reads                | 0      |
| Key_write_requests       | 0      |
| Key_writes               | 0      |
| Max_used_connections     | 1      |
| Not_flushed_key_blocks   | 0      |
| Not_flushed_delayed_rows | 0      |
| Open_tables              | 1      |
| Open_files               | 2      |
| Open_streams             | 0      |
| Opened_tables            | 11     |
| Questions                | 14     |
| Slow_queries             | 0      |
| Threads_connected        | 1      |
| Threads_running          | 1      |
| Uptime                   | 149111 |
+--------------------------+--------+
</PRE>

<P>
The status variables listed above have the following meaning:

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><CODE>Aborted_clients</CODE> </TD><TD> Number of connections that has been aborted because the client has died without closing the connection properly.
</TR NOSAVE>
<TR><TD><CODE>Aborted_connects</CODE> </TD><TD> Number of tries to connect to the MySQL server that has failed.
</TR NOSAVE>
<TR><TD><CODE>Connections</CODE> </TD><TD> Number of connection attempts to the MySQL server.
</TR NOSAVE>
<TR><TD><CODE>Created_tmp_tables</CODE> </TD><TD> Number of implicit temporary tables that has been created while executing statements.
</TR NOSAVE>
<TR><TD><CODE>Delayed_insert_threads</CODE> </TD><TD> Number of delayed insert handler threads in use.
</TR NOSAVE>
<TR><TD><CODE>Delayed_writes</CODE> </TD><TD> Number of rows written with <CODE>INSERT DELAYED</CODE>.
</TR NOSAVE>
<TR><TD><CODE>Delayed_errors</CODE> </TD><TD> Number of rows written with <CODE>INSERT DELAYED</CODE> for which some error occurred (probably <CODE>duplicate key</CODE>).
</TR NOSAVE>
<TR><TD><CODE>Flush_commands</CODE> </TD><TD> Number of executed <CODE>FLUSH</CODE> commands.
</TR NOSAVE>
<TR><TD><CODE>Handler_delete</CODE> </TD><TD> Number of requests to delete a row from a table.
</TR NOSAVE>
<TR><TD><CODE>Handler_read_first</CODE> </TD><TD> Number of requests to read the first row in a table.
</TR NOSAVE>
<TR><TD><CODE>Handler_read_key</CODE> </TD><TD> Number of requests to read a row based on a key.
</TR NOSAVE>
<TR><TD><CODE>Handler_read_next</CODE> </TD><TD> Number of requests to read next row in key order.
</TR NOSAVE>
<TR><TD><CODE>Handler_read_rnd</CODE> </TD><TD> Number of requests to read a row based on a fixed position.
</TR NOSAVE>
<TR><TD><CODE>Handler_update</CODE> </TD><TD> Number of requests to update a row in a table.
</TR NOSAVE>
<TR><TD><CODE>Handler_write</CODE> </TD><TD> Number of requests to insert a row in a table.
</TR NOSAVE>
<TR><TD><CODE>Key_blocks_used</CODE> </TD><TD> The number of used blocks in the key cache.
</TR NOSAVE>
<TR><TD><CODE>Key_read_requests</CODE> </TD><TD> The number of requests to read a key block from the cache.
</TR NOSAVE>
<TR><TD><CODE>Key_reads</CODE> </TD><TD> The number of physical reads of a key block from disk.
</TR NOSAVE>
<TR><TD><CODE>Key_write_requests</CODE> </TD><TD> The number of requests to write a key block to the cache.
</TR NOSAVE>
<TR><TD><CODE>Key_writes</CODE> </TD><TD> The number of physical writes of a key block to disk.
</TR NOSAVE>
<TR><TD><CODE>Max_used_connections</CODE> </TD><TD> The maximum number of connections that has been in use simultaneously.
</TR NOSAVE>
<TR><TD><CODE>Not_flushed_key_blocks</CODE> </TD><TD> Keys blocks in the key cache that has changed but hasn't yet been flushed to disk.
</TR NOSAVE>
<TR><TD><CODE>Not_flushed_delayed_rows</CODE> </TD><TD> Number of rows waiting to be written in <CODE>INSERT DELAY</CODE> queues.
</TR NOSAVE>
<TR><TD><CODE>Open_tables</CODE> </TD><TD> Number of tables that are open.
</TR NOSAVE>
<TR><TD><CODE>Open_files</CODE> </TD><TD> Number of files that are open.
</TR NOSAVE>
<TR><TD><CODE>Open_streams</CODE> </TD><TD> Number of streams that are open (used mainly for logging)
</TR NOSAVE>
<TR><TD><CODE>Opened_tables</CODE> </TD><TD> Number of tables that has been opened.
</TR NOSAVE>
<TR><TD><CODE>Questions</CODE> </TD><TD> Number of queries sent to the server.
</TR NOSAVE>
<TR><TD><CODE>Slow_queries</CODE> </TD><TD> Number of queries that has taken more than <CODE>long_query_time</CODE>
</TR NOSAVE>
<TR><TD><CODE>Threads_connected</CODE> </TD><TD> Number of currently open connections.
</TR NOSAVE>
<TR><TD><CODE>Threads_running</CODE> </TD><TD> Number of threads that are not sleeping.
</TR NOSAVE>
<TR><TD><CODE>Uptime</CODE> </TD><TD> How many seconds the server has been up.
</TR>
</TABLE>

<P>
Some comments about the above:

</P>

<UL>
<LI>

If <CODE>Opened_tables</CODE> is big, then your <CODE>table_cache</CODE>
variable is probably too small.
<LI>

If <CODE>key_reads</CODE> is big, then your <CODE>key_cache</CODE> is probably too
small.  The cache hit rate can be calculated with
<CODE>key_reads</CODE>/<CODE>key_read_requests</CODE>.
<LI>

If <CODE>Handler_read_rnd</CODE> is big, then you have a probably a lot of queries
that requires MySQL to scan whole tables or you have joins that doesn't use
keys properly.
</UL>

<P>
<CODE>SHOW VARIABLES</CODE> shows the values of the some of <STRONG>MySQL</STRONG> system
variables.  You can also get this information using the <CODE>mysqladmin
variables</CODE> command.  If the default values are unsuitable, you can set most
of these variables using command-line options when <CODE>mysqld</CODE> starts up.
The output resembles that shown below, though the format and numbers may
differ somewhat:

</P>

<PRE>
+------------------------+--------------------------+
| Variable_name          | Value                    |
+------------------------+--------------------------+
| back_log               | 5                        |
| connect_timeout        | 5                        |
| basedir                | /my/monty/               |
| datadir                | /my/monty/data/          |
| delayed_insert_limit   | 100                      |
| delayed_insert_timeout | 300                      |
| delayed_queue_size     | 1000                     |
| join_buffer_size       | 131072                   |
| flush_time             | 0                        |
| interactive_timeout    | 28800                    |
| key_buffer_size        | 1048540                  |
| language               | /my/monty/share/english/ |
| log                    | OFF                      |
| log_update             | OFF                      |
| long_query_time        | 10                       |
| low_priority_updates   | OFF                      |
| max_allowed_packet     | 1048576                  |
| max_connections        | 100                      |
| max_connect_errors     | 10                       |
| max_delayed_threads    | 20                       |
| max_heap_table_size    | 16777216                 |
| max_join_size          | 4294967295               |
| max_sort_length        | 1024                     |
| max_tmp_tables         | 32                       |
| net_buffer_length      | 16384                    |
| port                   | 3306                     |
| protocol-version       | 10                       |
| record_buffer          | 131072                   |
| skip_locking           | ON                       |
| socket                 | /tmp/mysql.sock          |
| sort_buffer            | 2097116                  |
| table_cache            | 64                       |
| thread_stack           | 131072                   |
| tmp_table_size         | 1048576                  |
| tmpdir                 | /machine/tmp/            |
| version                | 3.23.0-alpha-debug       |
| wait_timeout           | 28800                    |
+------------------------+--------------------------+
</PRE>

<P>
See section <A HREF="manual.html#Server_parameters">10.2.3  Tuning server parameters</A>.

</P>
<P>
<A NAME="IDX566"></A>
<A NAME="IDX567"></A>
<CODE>SHOW PROCESSLIST</CODE> shows you which threads are running.  You can
also get this information using the <CODE>mysqladmin processlist</CODE>
command.  If you have the <STRONG>process</STRONG> privilege, you can see all
threads.  Otherwise, you can see only your own threads.  See section <A HREF="manual.html#KILL">7.20  <CODE>KILL</CODE> syntax</A>.  If you don't use the the <CODE>FULL</CODE> option, then only
the first 100 characters of each query will be shown.

</P>
<P>
<CODE>SHOW GRANTS FOR user</CODE> lists the grant commands that must be issued to
duplicate the grants for a user.

</P>

<PRE>
mysql&#62; SHOW GRANTS FOR root@localhost;
+---------------------------------------------------------------------+
| Grants for root@localhost                                           |
+---------------------------------------------------------------------+
| GRANT ALL PRIVILEGES ON *.* TO 'root''localhost' WITH GRANT OPTION |
+---------------------------------------------------------------------+
</PRE>

<P>
<A NAME="IDX568"></A>
<A NAME="IDX569"></A>


<H2><A NAME="EXPLAIN" HREF="manual_toc.html#EXPLAIN">7.22  <CODE>EXPLAIN</CODE> syntax (Get information about a <CODE>SELECT</CODE>)</A></H2>


<PRE>
    EXPLAIN tbl_name
or  EXPLAIN SELECT select_options
</PRE>

<P>
<CODE>EXPLAIN tbl_name</CODE> is a synonym for <CODE>DESCRIBE tbl_name</CODE> or
<CODE>SHOW COLUMNS FROM tbl_name</CODE>.

</P>
<P>
When you precede a <CODE>SELECT</CODE> statement with the keyword <CODE>EXPLAIN</CODE>,
<STRONG>MySQL</STRONG> explains how it would process the <CODE>SELECT</CODE>, providing
information about how tables are joined and in which order.

</P>
<P>
With the help of <CODE>EXPLAIN</CODE>, you can see when you must add indexes
to tables to get a faster <CODE>SELECT</CODE> that uses indexes to find the
records. You can also see if the optimizer joins the tables in an optimal
order. To force the optimizer to use a specific join order for a
<CODE>SELECT</CODE> statement, add a <CODE>STRAIGHT_JOIN</CODE> clause.

</P>
<P>
For non-simple joins, <CODE>EXPLAIN</CODE> returns a row of information for each
table used in the <CODE>SELECT</CODE> statement. The tables are listed in the order
they would be read.  <STRONG>MySQL</STRONG> resolves all joins using a single-sweep
multi-join method. This means that <STRONG>MySQL</STRONG> reads a row from the first
table, then finds a matching row in the second table, then in the third table
and so on. When all tables are processed, it outputs the selected columns and
backtracks through the table list until a table is found for which there are
more matching rows. The next row is read from this table and the process
continues with the next table.

</P>
<P>
Output from <CODE>EXPLAIN</CODE> includes the following columns:

</P>
<DL COMPACT>

<DT><CODE>table</CODE>
<DD>
The table to which the row of output refers.

<DT><CODE>type</CODE>
<DD>
The join type.  Information about the various types is given below.

<DT><CODE>possible_keys</CODE>
<DD>
The <CODE>possible_keys</CODE> column indicates which indexes <STRONG>MySQL</STRONG>
could use to find the rows in this table. Note that this colums is
totally indepentent on the order of the tables. That means that some of
the keys in possible_keys may not the usable in practice with the
generated table order.

If this column is empty, there are no relevant indexes. In this case,
you may be able to improve the performance of your query by examining
the <CODE>WHERE</CODE> clause to see if it refers to some column or columns
that would be suitable for indexing.  If so, create an appropriate index
and check the query with <CODE>EXPLAIN</CODE> again. See section <A HREF="manual.html#ALTER_TABLE">7.8  <CODE>ALTER TABLE</CODE> syntax</A>.

To see what indexes a table has, use <CODE>SHOW INDEX FROM tbl_name</CODE>.

<DT><CODE>key</CODE>
<DD>
The <CODE>key</CODE> column indicates the key that <STRONG>MySQL</STRONG> actually
decided to use. The key is <CODE>NULL</CODE> if no index was chosen.

<DT><CODE>key_len</CODE>
<DD>
The <CODE>key_len</CODE> column indicates the length of the key that
<STRONG>MySQL</STRONG> decided to use.  The length is <CODE>NULL</CODE> if the
<CODE>key</CODE> is <CODE>NULL</CODE>. Note that this tell us how many parts of a
multi part key MySQL will actually use.

<DT><CODE>ref</CODE>
<DD>
The <CODE>ref</CODE> column shows which columns or constants are used with the
<CODE>key</CODE> to select rows from the table.

<DT><CODE>rows</CODE>
<DD>
The <CODE>rows</CODE> column indicates the number of rows <STRONG>MySQL</STRONG>
believe it must examine to execute the query.

<DT><CODE>Extra</CODE>
<DD>
If the <CODE>Extra</CODE> column includes the text <CODE>Only index</CODE>, this
means that information is retrieved from the table using only
information in the index tree. Normally, this is much faster than
scanning the entire table.

If the <CODE>Extra</CODE> column includes the text <CODE>where used</CODE>, it means
that a <CODE>WHERE</CODE> clause will be used to restrict which rows will be
matched against the next table or sent to the client.
</DL>

<P>
The different join types are listed below, ordered from best to worst type:

</P>
<P>
<A NAME="IDX570"></A>
<A NAME="IDX571"></A>
<DL COMPACT>

<DT><CODE>system</CODE>
<DD>
The table has only one row (= system table). This is a special case of
the <CODE>const</CODE> join type.

<A NAME="IDX572"></A>
<A NAME="IDX573"></A>
<DT><CODE>const</CODE>
<DD>
The table has at most one matching row, which will be read at the start
of the query. Since there is only one row, values from the column in
this row can be regarded as constants by the rest of the
optimizer. <CODE>const</CODE> tables are very fast as they are read only once!

<DT><CODE>eq_ref</CODE>
<DD>
One row will be read from this table for each combination of rows from
the previous tables.  This the best possible join type, other than the
<CODE>const</CODE> types.  It is used when all parts of an index are used by
the join and the index is <CODE>UNIQUE</CODE> or a <CODE>PRIMARY KEY</CODE>.

<DT><CODE>ref</CODE>
<DD>
All rows with matching index values will be read from this table for each
combination of rows from the previous tables.  <CODE>ref</CODE> is used if the join
uses only a leftmost prefix of the key, or if the key is not <CODE>UNIQUE</CODE>
or a <CODE>PRIMARY KEY</CODE> (in other words, if the join cannot select a single
row based on the key value).  If the key that is used matches only a few rows,
this join type is good.

<DT><CODE>range</CODE>
<DD>
Only rows that are in a given range will be retrieved, using an index to
select the rows.  The <CODE>ref</CODE> column indicates which index is used.

<DT><CODE>index</CODE>
<DD>
This is the same as <CODE>ALL</CODE>, except that only the index tree is
scanned.  This is usually faster than <CODE>ALL</CODE>, as the index file is usually
smaller than the data file.

<DT><CODE>ALL</CODE>
<DD>
A full table scan will be done for each combination of rows from the
previous tables.  This is normally not good if the table is the first
table not marked <CODE>const</CODE>, and usually <STRONG>very</STRONG> bad in all other
cases. You normally can avoid <CODE>ALL</CODE> by adding more indexes, so that
the row can be retrieved based on constant values or column values from
earlier tables.
</DL>

<P>
You can get a good indication of how good a join is by multiplying all values
in the <CODE>rows</CODE> column of the <CODE>EXPLAIN</CODE> output. This should tell you
roughly how many rows <STRONG>MySQL</STRONG> must examine to execute the query. This
number is also used when you restrict queries with the <CODE>max_join_size</CODE>
variable.
See section <A HREF="manual.html#Server_parameters">10.2.3  Tuning server parameters</A>.

</P>
<P>
The following example shows how a <CODE>JOIN</CODE> can be optimized progressively
using the information provided by <CODE>EXPLAIN</CODE>.

</P>
<P>
Suppose you have the <CODE>SELECT</CODE> statement shown below, that you examine
using <CODE>EXPLAIN</CODE>:

</P>

<PRE>
EXPLAIN SELECT tt.TicketNumber, tt.TimeIn,
            tt.ProjectReference, tt.EstimatedShipDate,
            tt.ActualShipDate, tt.ClientID,
            tt.ServiceCodes, tt.RepetitiveID,
            tt.CurrentProcess, tt.CurrentDPPerson,
            tt.RecordVolume, tt.DPPrinted, et.COUNTRY,
            et_1.COUNTRY, do.CUSTNAME
        FROM tt, et, et AS et_1, do
        WHERE tt.SubmitTime IS NULL
            AND tt.ActualPC = et.EMPLOYID
            AND tt.AssignedPC = et_1.EMPLOYID
            AND tt.ClientID = do.CUSTNMBR;
</PRE>

<P>
For this example, assume that:

</P>

<UL>
<LI>

The columns being compared have been declared as follows:

<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><STRONG>Table</STRONG> </TD><TD> <STRONG>Column</STRONG> </TD><TD> <STRONG>Column type</STRONG>
</TR NOSAVE>
<TR><TD><CODE>tt</CODE> </TD><TD> <CODE>ActualPC</CODE> </TD><TD> <CODE>CHAR(10)</CODE>
</TR NOSAVE>
<TR><TD><CODE>tt</CODE> </TD><TD> <CODE>AssignedPC</CODE> </TD><TD> <CODE>CHAR(10)</CODE>
</TR NOSAVE>
<TR><TD><CODE>tt</CODE> </TD><TD> <CODE>ClientID</CODE> </TD><TD> <CODE>CHAR(10)</CODE>
</TR NOSAVE>
<TR><TD><CODE>et</CODE> </TD><TD> <CODE>EMPLOYID</CODE> </TD><TD> <CODE>CHAR(15)</CODE>
</TR NOSAVE>
<TR><TD><CODE>do</CODE> </TD><TD> <CODE>CUSTNMBR</CODE> </TD><TD> <CODE>CHAR(15)</CODE>
</TR>
</TABLE>

<LI>

The tables have the indexes shown below:

<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><STRONG>Table</STRONG> </TD><TD> <STRONG>Index</STRONG>
</TR NOSAVE>
<TR><TD><CODE>tt</CODE> </TD><TD> <CODE>ActualPC</CODE>
</TR NOSAVE>
<TR><TD><CODE>tt</CODE> </TD><TD> <CODE>AssignedPC</CODE>
</TR NOSAVE>
<TR><TD><CODE>tt</CODE> </TD><TD> <CODE>ClientID</CODE>
</TR NOSAVE>
<TR><TD><CODE>et</CODE> </TD><TD> <CODE>EMPLOYID</CODE> (primary key)
</TR NOSAVE>
<TR><TD><CODE>do</CODE> </TD><TD> <CODE>CUSTNMBR</CODE> (primary key)
</TR>
</TABLE>

<LI>

The <CODE>tt.ActualPC</CODE> values aren't evenly distributed.
</UL>

<P>
Initially, before any optimizations have been performed, the <CODE>EXPLAIN</CODE>
statement produces the following information:

</P>

<PRE>
table type possible_keys                key  key_len ref  rows  Extra
et    ALL  PRIMARY                      NULL NULL    NULL 74
do    ALL  PRIMARY                      NULL NULL    NULL 2135
et_1  ALL  PRIMARY                      NULL NULL    NULL 74
tt    ALL  AssignedPC,ClientID,ActualPC NULL NULL    NULL 3872
      range checked for each record (key map: 35)
</PRE>

<P>
Since <CODE>type</CODE> is <CODE>ALL</CODE> for each table, this output indicates that
<STRONG>MySQL</STRONG> is doing a full join for all tables!  This will take quite a
long time, as the product of the number of rows in each table must be
examined!  For the case at hand, this is <CODE>74 * 2135 * 74 * 3872 =
45,268,558,720</CODE> rows.  If the tables were bigger, you can only imagine how
long it would take...

</P>
<P>
One problem here is that <STRONG>MySQL</STRONG> can't (yet) use indexes on columns
efficiently if they are declared differently.  In this context,
<CODE>VARCHAR</CODE> and <CODE>CHAR</CODE> are the same unless they are declared as
different lengths. Since <CODE>tt.ActualPC</CODE> is declared as <CODE>CHAR(10)</CODE>
and <CODE>et.EMPLOYID</CODE> is declared as <CODE>CHAR(15)</CODE>, there is a length
mismatch.

</P>
<P>
To fix this disparity between column lengths, use <CODE>ALTER TABLE</CODE> to
lengthen <CODE>ActualPC</CODE> from 10 characters to 15 characters:

</P>

<PRE>
mysql&#62; ALTER TABLE tt MODIFY ActualPC VARCHAR(15);
</PRE>

<P>
Now <CODE>tt.ActualPC</CODE> and <CODE>et.EMPLOYID</CODE> are both <CODE>VARCHAR(15)</CODE>.
Executing the <CODE>EXPLAIN</CODE> statement again produces this result:

</P>

<PRE>
table type   possible_keys   key     key_len ref         rows    Extra
tt    ALL    AssignedPC,ClientID,ActualPC NULL NULL NULL 3872    where used
do    ALL    PRIMARY         NULL    NULL    NULL        2135
      range checked for each record (key map: 1)
et_1  ALL    PRIMARY         NULL    NULL    NULL        74
      range checked for each record (key map: 1)
et    eq_ref PRIMARY         PRIMARY 15      tt.ActualPC 1
</PRE>

<P>
This is not perfect, but is much better (the product of the <CODE>rows</CODE>
values is now less by a factor of 74). This version is executed in a couple
of seconds.

</P>
<P>
A second alteration can be made to eliminate the column length mismatches
for the <CODE>tt.AssignedPC = et_1.EMPLOYID</CODE> and <CODE>tt.ClientID =
do.CUSTNMBR</CODE> comparisons:

</P>

<PRE>
mysql&#62; ALTER TABLE tt MODIFY AssignedPC VARCHAR(15),
                      MODIFY ClientID   VARCHAR(15);
</PRE>

<P>
Now <CODE>EXPLAIN</CODE> produces the output shown below:

</P>

<PRE>
table type   possible_keys   key     key_len ref            rows     Extra
et    ALL    PRIMARY         NULL    NULL    NULL           74
tt    ref    AssignedPC,ClientID,ActualPC ActualPC 15 et.EMPLOYID 52 where used
et_1  eq_ref PRIMARY         PRIMARY 15      tt.AssignedPC  1
do    eq_ref PRIMARY         PRIMARY 15      tt.ClientID    1
</PRE>

<P>
This is ``almost'' as good as it can get.

</P>
<P>
The remaining problem is that, by default, <STRONG>MySQL</STRONG> assumes that values
in the <CODE>tt.ActualPC</CODE> column are evenly distributed, and that isn't the
case for the <CODE>tt</CODE> table.  Fortunately, it is easy to tell <STRONG>MySQL</STRONG>
about this:

</P>

<PRE>
shell&#62; myisamchk --analyze PATH_TO_MYSQL_DATABASE/tt
shell&#62; mysqladmin refresh
</PRE>

<P>
Now the join is ``perfect'', and <CODE>EXPLAIN</CODE> produces this result:

</P>

<PRE>
table type   possible_keys   key     key_len ref            rows    Extra
tt    ALL    AssignedPC,ClientID,ActualPC NULL NULL NULL    3872    where used
et    eq_ref PRIMARY         PRIMARY 15      tt.ActualPC    1
et_1  eq_ref PRIMARY         PRIMARY 15      tt.AssignedPC  1
do    eq_ref PRIMARY         PRIMARY 15      tt.ClientID    1
</PRE>

<P>
Note that the <CODE>rows</CODE> column in the output from <CODE>EXPLAIN</CODE> is an
``educated guess'' from the <STRONG>MySQL</STRONG> join optimizer;  To optimize a
query, you should check if the numbers are even close to the truth.  If not,
you may get better performance by using <CODE>STRAIGHT_JOIN</CODE> in your
<CODE>SELECT</CODE> statement and trying to list the tables in a different order in
the <CODE>FROM</CODE> clause.

</P>
<P>
<A NAME="IDX574"></A>
<A NAME="IDX575"></A>


<H2><A NAME="DESCRIBE" HREF="manual_toc.html#DESCRIBE">7.23  <CODE>DESCRIBE</CODE> syntax (Get information about columns)</A></H2>


<PRE>
{DESCRIBE | DESC} tbl_name {col_name | wild}
</PRE>

<P>
<CODE>DESCRIBE</CODE> provides information about a table's columns.  <CODE>col_name</CODE>
may be a column name or a string containing the SQL <SAMP>`%'</SAMP> and <SAMP>`_'</SAMP>
wildcard characters.

</P>
<P>
If the column types are different than you expect them to be based on a
<CODE>CREATE TABLE</CODE> statement, note that MySQL sometimes changes column
types.
See section <A HREF="manual.html#Silent_column_changes">7.7.1  Silent column specification changes</A>.

</P>
<P>
<A NAME="IDX576"></A>
<A NAME="IDX577"></A>
This statement is provided for Oracle compatibility.

</P>
<P>
The <CODE>SHOW</CODE> statement provides similar information.
See section <A HREF="manual.html#SHOW">7.21  <CODE>SHOW</CODE> syntax (Get information about tables, columns,...)</A>.

</P>
<P>
<A NAME="IDX578"></A>
<A NAME="IDX579"></A>


<H2><A NAME="LOCK_TABLES" HREF="manual_toc.html#LOCK_TABLES">7.24  <CODE>LOCK TABLES/UNLOCK TABLES</CODE> syntax</A></H2>


<PRE>
LOCK TABLES tbl_name [AS alias] {READ | [LOW_PRIORITY] WRITE}
            [, tbl_name {READ | [LOW_PRIORITY] WRITE} ...]
...
UNLOCK TABLES
</PRE>

<P>
<CODE>LOCK TABLES</CODE> locks tables for the current thread.  <CODE>UNLOCK TABLES</CODE>
releases any locks held by the current thread.  All tables that are locked by
the current thread are automatically unlocked when the thread issues another
<CODE>LOCK TABLES</CODE>, or when the connection to the server is closed.

</P>
<P>
If a thread obtains a <CODE>READ</CODE> lock on a table, that thread (and all other
threads) can only read from the table. If a thread obtains a <CODE>WRITE</CODE>
lock on a table, then only the thread holding the lock can <CODE>READ</CODE> from
or <CODE>WRITE</CODE> to the table.  Other threads are blocked.

</P>
<P>
Each thread waits (without timing out) until it obtains all the locks it has
requested.

</P>
<P>
<CODE>WRITE</CODE> locks normally have higher priority than <CODE>READ</CODE> locks, to
ensure that updates are processed as soon as possible. This means that if one
thread obtains a <CODE>READ</CODE> lock and then another thread requests a
<CODE>WRITE</CODE> lock, subsequent <CODE>READ</CODE> lock requests will wait until the
<CODE>WRITE</CODE> thread has gotten the lock and released it.  You can use
<CODE>LOW_PRIORITY WRITE</CODE> locks to allow other threads to obtain <CODE>READ</CODE>
locks while the thread is waiting for the <CODE>WRITE</CODE> lock. You should only
use <CODE>LOW_PRIORITY WRITE</CODE> locks if you are sure that there will
eventually be a time when no threads will have a <CODE>READ</CODE> lock.

</P>
<P>
When you use <CODE>LOCK TABLES</CODE>, you must lock all tables that you are
going to use!  If you are using a table multiple times in a query (with
aliases), you must get a lock for each alias! This policy ensures that
table locking is deadlock free.

</P>
<P>
Note that you should <STRONG>NOT</STRONG> lock any tables that you are using with
<CODE>INSERT DELAYED</CODE>.  This is because that in this case the <CODE>INSERT</CODE>
is done by a separate thread. 

</P>
<P>
Normally, you don't have to lock tables, as all single <CODE>UPDATE</CODE> statements
are atomic; no other thread can interfere with any other currently executing
SQL statement. There are a few cases when you would like to lock tables
anyway:

</P>

<UL>
<LI>

If you are going to run many operations on a bunch of tables, it's much
faster to lock the tables you are going to use.  The downside is, of course,
that no other thread can update a <CODE>READ</CODE>-locked table and no other
thread can read a <CODE>WRITE</CODE>-locked table.
<LI>

<STRONG>MySQL</STRONG> doesn't support a transaction environment, so you must use
<CODE>LOCK TABLES</CODE> if you want to ensure that no other thread comes between a
<CODE>SELECT</CODE> and an <CODE>UPDATE</CODE>. The example shown below
requires <CODE>LOCK TABLES</CODE> in order to execute safely:


<PRE>
mysql&#62; LOCK TABLES trans READ, customer WRITE;
mysql&#62; select sum(value) from trans where customer_id= some_id;
mysql&#62; update customer set total_value=sum_from_previous_statement
           where customer_id=some_id;
mysql&#62; UNLOCK TABLES;
</PRE>

Without <CODE>LOCK TABLES</CODE>, there is a chance that another thread might
insert a new row in the <CODE>trans</CODE> table between execution of the
<CODE>SELECT</CODE> and <CODE>UPDATE</CODE> statements.
</UL>

<P>
By using incremental updates (<CODE>UPDATE customer SET
value=value+new_value</CODE>) or the <CODE>LAST_INSERT_ID()</CODE> function, you can
avoid using <CODE>LOCK TABLES</CODE> in many cases.

</P>
<P>
You can also solve some cases by using the user-level lock functions
<CODE>GET_LOCK()</CODE> and <CODE>RELEASE_LOCK()</CODE>.  These locks are saved in a hash
table in the server and implemented with <CODE>pthread_mutex_lock()</CODE> and
<CODE>pthread_mutex_unlock()</CODE> for high speed.
See section <A HREF="manual.html#Miscellaneous_functions">7.4.12  Miscellaneous functions</A>.

</P>
<P>
See section <A HREF="manual.html#Internal_locking">10.2.8  How MySQL locks tables</A>, for more information on locking policy.

</P>
<P>
<A NAME="IDX580"></A>


<H2><A NAME="SET_OPTION" HREF="manual_toc.html#SET_OPTION">7.25  <CODE>SET OPTION</CODE> syntax</A></H2>


<PRE>
SET [OPTION] SQL_VALUE_OPTION= value, ...
</PRE>

<P>
<CODE>SET OPTION</CODE> sets various options that affect the operation of the
server or your client.  Any option you set remains in effect until the
current session ends, or until you set the option to a different value.

</P>
<DL COMPACT>

<DT><CODE>CHARACTER SET character_set_name | DEFAULT</CODE>
<DD>
This maps all strings from and to the client with the given mapping.
Currently the only option for <CODE>character_set_name</CODE> is
<CODE>cp1251_koi8</CODE>, but you can easily add new mappings by editing the
<TT>`sql/convert.cc'</TT> file in the <STRONG>MySQL</STRONG> source distribution.  The
default mapping can be restored by using a <CODE>character_set_name</CODE> value of
<CODE>DEFAULT</CODE>.

Note that the syntax for setting the <CODE>CHARACTER SET</CODE> option differs
from the syntax for setting the other options.

<DT><CODE>PASSWORD = PASSWORD('some password')</CODE>
<DD>
<A NAME="IDX581"></A>
Set the password for the current user. Any non-anonymous user can change his
own password!

<DT><CODE>PASSWORD FOR user = PASSWORD('some password')</CODE>
<DD>
<A NAME="IDX582"></A>
Set the password for a specific user on the current server host. Only a user
with access to the <CODE>mysql</CODE> database can do this.  The user should be
given in <CODE>user@hostname</CODE> format, where <CODE>user</CODE> and <CODE>hostname</CODE>
are exactly as they are listed in the <CODE>User</CODE> and <CODE>Host</CODE> columns of
the <CODE>mysql.user</CODE> table entry.  For example, if you had an entry with
<CODE>User</CODE> and <CODE>Host</CODE> fields of <CODE>'bob'</CODE> and <CODE>'%.loc.gov'</CODE>,
you would write:


<PRE>
mysql&#62; SET PASSWORD FOR bob@"%.loc.gov" = PASSWORD("newpass");

or

mysql&#62; UPDATE mysql.user SET password=PASSWORD("newpass") where user="bob' and host="%.loc.gov";
</PRE>

<DT><CODE>SQL_AUTO_IS_NULL = 0 | 1</CODE>
<DD>
If set to <CODE>1</CODE> (default) then one can find the last inserted row
for a table with an auto_increment row with the following construct:
<CODE>WHERE auto_increment_column IS NULL</CODE>.  This is used by some
ODBC programs like Access.

<DT><CODE>SQL_BIG_TABLES = 0 | 1</CODE>
<DD>
<A NAME="IDX583"></A>
If set to <CODE>1</CODE>, all temporary tables are stored on disk rather than in
memory.  This will be a little slower, but you will not get the error
<CODE>The table tbl_name is full</CODE> for big <CODE>SELECT</CODE> operations that
require a large temporary table.  The default value for a new connection is
<CODE>0</CODE> (i.e., use in-memory temporary tables).

<DT><CODE>SQL_BIG_SELECTS = 0 | 1</CODE>
<DD>
If set to <CODE>0</CODE>, <STRONG>MySQL</STRONG> will abort if a <CODE>SELECT</CODE> is attempted
that probably will take a very long time. This is useful when an inadvisable
<CODE>WHERE</CODE> statement has been issued. A big query is defined as a
<CODE>SELECT</CODE> that probably will have to examine more than
<CODE>max_join_size</CODE> rows.  The default value for a new connection is
<CODE>1</CODE> (which will allow all <CODE>SELECT</CODE> statements).

<DT><CODE>SQL_LOW_PRIORITY_UPDATES = 0 | 1</CODE>
<DD>
If set to <CODE>1</CODE>, all <CODE>INSERT</CODE>, <CODE>UPDATE</CODE>, <CODE>DELETE</CODE> and
and <CODE>LOCK TABLE WRITE</CODE> statements wait until there is no pending
<CODE>SELECT</CODE> or <CODE>LOCK TABLE READ</CODE> on the affected table.

<DT><CODE>SQL_SELECT_LIMIT = value | DEFAULT</CODE>
<DD>
The maximum number of records to return from <CODE>SELECT</CODE> statements.  If
a <CODE>SELECT</CODE> has a <CODE>LIMIT</CODE> clause, the <CODE>LIMIT</CODE> takes precedence
over the value of <CODE>SQL_SELECT_LIMIT</CODE>.  The default value for a new
connection is ``unlimited''.  If you have changed the limit, the default value
can be restored by using a <CODE>SQL_SELECT_LIMIT</CODE> value of <CODE>DEFAULT</CODE>.

<DT><CODE>SQL_LOG_OFF = 0 | 1</CODE>
<DD>
If set to <CODE>1</CODE>, no logging will be done to the standard log for this
client, if the client has the <STRONG>process</STRONG> privilege.  This does not
affect the update log!

<DT><CODE>SQL_LOG_UPDATE = 0 | 1</CODE>
<DD>
If set to <CODE>0</CODE>, no logging will be done to the update log for the client,
if the client has the <STRONG>process</STRONG> privilege.  This does not affect the
standard log!

<DT><CODE>TIMESTAMP = timestamp_value | DEFAULT</CODE>
<DD>
Set the time for this client.  This is used to get the original timestamp if
you use the update log to restore rows.

<DT><CODE>LAST_INSERT_ID = #</CODE>
<DD>
Set the value to be returned from <CODE>LAST_INSERT_ID()</CODE>. This is stored in
the update log when you use <CODE>LAST_INSERT_ID()</CODE> in a command that updates
a table.

<DT><CODE>INSERT_ID = #</CODE>
<DD>
Set the value to be used by the following <CODE>INSERT</CODE> command when inserting
an <CODE>AUTO_INCREMENT</CODE> value.  This is mainly used with the update log.
</DL>

<P>
<A NAME="IDX584"></A>
<A NAME="IDX585"></A>


<H2><A NAME="GRANT" HREF="manual_toc.html#GRANT">7.26  <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> syntax</A></H2>


<PRE>
GRANT priv_type [(column_list)] [, priv_type [(column_list)] ...]
    ON {tbl_name | * | *.* | db_name.*}
    TO user_name [IDENTIFIED BY 'password']
        [, user_name [IDENTIFIED BY 'password'] ...]
    [WITH GRANT OPTION]

REVOKE priv_type [(column_list)] [, priv_type [(column_list)] ...]
    ON {tbl_name | * | *.* | db_name.*}
    FROM user_name [, user_name ...]
</PRE>

<P>
<CODE>GRANT</CODE> is implemented in <STRONG>MySQL</STRONG> 3.22.11 or later. For
earlier <STRONG>MySQL</STRONG> versions, the <CODE>GRANT</CODE> statement does nothing.

</P>
<P>
The <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> commands allow system administrators to
grant and revoke rights to <STRONG>MySQL</STRONG> users at four privilege levels:

</P>
<DL COMPACT>

<DT><STRONG>Global level</STRONG>
<DD>
Global privileges apply to all databases on a given server. These privileges
are stored in the <CODE>mysql.user</CODE> table.

<DT><STRONG>Database level</STRONG>
<DD>
Database privileges apply to all tables in a given database. These privileges
are stored in the <CODE>mysql.db</CODE> and <CODE>mysql.host</CODE> tables.

<DT><STRONG>Table level</STRONG>
<DD>
Table privileges apply to all columns in a given table. These privileges are
stored in the <CODE>mysql.tables_priv</CODE> table.

<DT><STRONG>Column level</STRONG>
<DD>
Column privileges apply to single columns in a given table. These privileges are
stored in the <CODE>mysql.columns_priv</CODE> table.
</DL>

<P>
For examples of how <CODE>GRANT</CODE> works, see section <A HREF="manual.html#Adding_users">6.13  Adding new user privileges to MySQL</A>.

</P>
<P>
For the <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> statements, <CODE>priv_type</CODE> may be
specified as any of the following:

</P>

<PRE>
ALL PRIVILEGES      FILE                RELOAD
ALTER               INDEX               SELECT
CREATE              INSERT              SHUTDOWN
DELETE              PROCESS             UPDATE
DROP                REFERENCES          USAGE
</PRE>

<P>
<CODE>ALL</CODE> is a synonym for <CODE>ALL PRIVILEGES</CODE>.  <CODE>REFERENCES</CODE> is not
yet implemented.  <CODE>USAGE</CODE> is currently a synonym for ``no privileges''.
It can be used when you want to create a user that has no privileges.

</P>
<P>
To revoke the <STRONG>grant</STRONG> privilege from a user, use a <CODE>priv_type</CODE>
value of <CODE>GRANT OPTION</CODE>:

</P>

<PRE>
REVOKE GRANT OPTION ON ... FROM ...;
</PRE>

<P>
The only <CODE>priv_type</CODE> values you can specify for a table are <CODE>SELECT</CODE>,
<CODE>INSERT</CODE>, <CODE>UPDATE</CODE>, <CODE>DELETE</CODE>, <CODE>CREATE</CODE>, <CODE>DROP</CODE>,
<CODE>GRANT</CODE>, <CODE>INDEX</CODE> and <CODE>ALTER</CODE>.

</P>
<P>
The only <CODE>priv_type</CODE> values you can specify for a column (that is, when
you use a <CODE>column_list</CODE> clause) are <CODE>SELECT</CODE>, <CODE>INSERT</CODE> and
<CODE>UPDATE</CODE>.

</P>
<P>
You can set global privileges by using <CODE>ON *.*</CODE> syntax.  You can set
database privileges by using <CODE>ON db_name.*</CODE> syntax. If you specify
<CODE>ON *</CODE> and you have a current database, you will set the privileges for
that database.  (<STRONG>Warning:</STRONG> If you specify <CODE>ON *</CODE> and you
<EM>don't</EM> have a current database, you will affect the global privileges!)

</P>
<P>
In order to accommodate granting rights to users from arbitrary hosts,
<STRONG>MySQL</STRONG> supports specifying the <CODE>user_name</CODE> value in the form
<CODE>user@host</CODE>.  If you want to specify a <CODE>user</CODE> string
containing special characters (such as <SAMP>`-'</SAMP>), or a <CODE>host</CODE> string
containing special characters or wildcard characters (such as <SAMP>`%'</SAMP>), you
can quote the user or host name (e.g., <CODE>'test-user'@'test-hostname'</CODE>).

</P>
<P>
You can specify wildcards in the hostname.  For example,
<CODE>user@"%.loc.gov"</CODE> applies to <CODE>user</CODE> for any host in the
<CODE>loc.gov</CODE> domain, and <CODE>user@"144.155.166.%"</CODE> applies to <CODE>user</CODE>
for any host in the <CODE>144.155.166</CODE> class C subnet.

</P>
<P>
The simple form <CODE>user</CODE> is a synonym for <CODE>user@"%"</CODE>.
<STRONG>Note:</STRONG> If you allow anonymous users to connect to the <STRONG>MySQL</STRONG>
server (which is the default), you should also add all local users as
<CODE>user@localhost</CODE> because otherwise the anonymous user entry for the
local host in the <CODE>mysql.user</CODE> table will be used when the user tries to
log into the <STRONG>MySQL</STRONG> server from the local machine!  Anonymous users
are defined by inserting entries with <CODE>User=''</CODE> into the
<CODE>mysql.user</CODE> table. You can verify if this applies to you by executing
this query:

</P>

<PRE>
mysql&#62; SELECT Host,User FROM mysql.user WHERE User='';
</PRE>

<P>
For the moment, <CODE>GRANT</CODE> only supports host, table, database and
column names up to 60 characters long. A user name can be up to 16
characters.

</P>
<P>
The privileges for a table or column are formed from the
logical OR of the privileges at each of the four privilege
levels.  For example, if the <CODE>mysql.user</CODE> table specifies that a
user has a global <STRONG>select</STRONG> privilege, this can't be denied by an
entry at the database, table or column level.

</P>
<P>
The privileges for a column can be calculated as follows:

</P>

<PRE>
global privileges
OR (database privileges AND host privileges)
OR table privileges
OR column privileges
</PRE>

<P>
In most cases, you grant rights to a user at only one of the privilege
levels, so life isn't normally as complicated as above. :) The details of the
privilege-checking procedure are presented in
section <A HREF="manual.html#Privilege_system">6  The MySQL access privilege system</A>.

</P>
<P>
If you grant privileges for a user/hostname combination that does not exist
in the <CODE>mysql.user</CODE> table, an entry is added and remains there until
deleted with a <CODE>DELETE</CODE> command.  In other words, <CODE>GRANT</CODE> may
create <CODE>user</CODE> table entries, but <CODE>REVOKE</CODE> will not remove them;
you must do that explicitly using <CODE>DELETE</CODE>.

</P>
<P>
<A NAME="IDX586"></A>
In <STRONG>MySQL</STRONG> 3.22.12 or later,
if a new user is created or if you have global grant privileges, the user's
password will be set to the password specified by the <CODE>IDENTIFIED BY</CODE>
clause, if one is given.  If the user already had a password, it is replaced
by the new one.

</P>
<P>
<STRONG>Warning:</STRONG> If you create a new user but do not specify an
<CODE>IDENTIFIED BY</CODE> clause, the user has no password.  This is insecure.

</P>
<P>
Passwords can also be set with the <CODE>SET PASSWORD</CODE> command.
See section <A HREF="manual.html#SET_OPTION">7.25  <CODE>SET OPTION</CODE> syntax</A>.

</P>
<P>
If you grant privileges for a database, an entry in the <CODE>mysql.db</CODE>
table is created if needed. When all privileges for the database have been
removed with <CODE>REVOKE</CODE>, this entry is deleted.

</P>
<P>
If a user doesn't have any privileges on a table, the table is not displayed
when the user requests a list of tables (e.g., with a <CODE>SHOW TABLES</CODE>
statement).

</P>
<P>
The <CODE>WITH GRANT OPTION</CODE> clause gives the user the ability to give
to other users any privileges the user has at the specified privilege level.
You should be careful to whom you give the <STRONG>grant</STRONG> privilege, as two
users with different privileges may be able to join privileges!

</P>
<P>
You cannot grant another user a privilege you don't have yourself;
the <STRONG>grant</STRONG> privilege allows you to give away only those privileges
you possess.

</P>
<P>
Be aware that when you grant a user the <STRONG>grant</STRONG> privilege at a
particular privilege level, any privileges the user already possesses (or
is given in the future!) at that level are also grantable by that user.
Suppose you grant a user the <STRONG>insert</STRONG> privilege on a database.  If
you then grant the <STRONG>select</STRONG> privilege on the database and specify
<CODE>WITH GRANT OPTION</CODE>, the user can give away not only the <STRONG>select</STRONG>
privilege, but also <STRONG>insert</STRONG>.  If you then grant the <STRONG>update</STRONG>
privilege to the user on the database, the user can give away the
<STRONG>insert</STRONG>, <STRONG>select</STRONG> and <STRONG>update</STRONG>.

</P>
<P>
You should not grant <STRONG>alter</STRONG> privileges to a normal user.  If you
do that, the user can try to subvert the privilege system by renaming
tables!

</P>
<P>
Note that if you are using table or column privileges for even one user, the
server examines table and column privileges for all users and this will slow
down <STRONG>MySQL</STRONG> a bit.

</P>
<P>
When <CODE>mysqld</CODE> starts, all privileges are read into memory.
Database, table and column privileges take effect at once and
user-level privileges take effect the next time the user connects.
Modifications to the grant tables that you perform using <CODE>GRANT</CODE> or
<CODE>REVOKE</CODE> are noticed by the server immediately.
If you modify the grant tables manually (using <CODE>INSERT</CODE>, <CODE>UPDATE</CODE>,
etc.), you should execute a <CODE>FLUSH PRIVILEGES</CODE> statement or run
<CODE>mysqladmin flush-privileges</CODE> to tell the server to reload the grant
tables.
See section <A HREF="manual.html#Privilege_changes">6.11  When privilege changes take effect</A>.

</P>
<P>
<A NAME="IDX587"></A>
The biggest differences between the ANSI SQL and <STRONG>MySQL</STRONG> versions of
<CODE>GRANT</CODE> are:

</P>

<UL>
<LI>

ANSI SQL doesn't have global or database-level privileges and ANSI SQL
doesn't support all privilege types that <STRONG>MySQL</STRONG> supports.

<LI>

When you drop a table in ANSI SQL, all privileges for the table are revoked.
If you revoke a privilege in ANSI SQL, all privileges that were granted based
on this privilege are also revoked. In <STRONG>MySQL</STRONG>, privileges can be
dropped only with explicit <CODE>REVOKE</CODE> commands or by manipulating the
<STRONG>MySQL</STRONG> grant tables.
</UL>

<P>
<A NAME="IDX588"></A>
<A NAME="IDX589"></A>
<A NAME="IDX590"></A>
<A NAME="IDX591"></A>


<H2><A NAME="CREATE_INDEX" HREF="manual_toc.html#CREATE_INDEX">7.27  <CODE>CREATE INDEX</CODE> syntax</A></H2>


<PRE>
CREATE [UNIQUE] INDEX index_name ON tbl_name (col_name[(length)],... )
</PRE>

<P>
The <CODE>CREATE INDEX</CODE> statement doesn't do anything in <STRONG>MySQL</STRONG> prior
to version 3.22.  In 3.22 or later, <CODE>CREATE INDEX</CODE> is mapped to an
<CODE>ALTER TABLE</CODE> statement to create indexes.
See section <A HREF="manual.html#ALTER_TABLE">7.8  <CODE>ALTER TABLE</CODE> syntax</A>.

</P>
<P>
Normally, you create all indexes on a table at the time the table itself
is created with <CODE>CREATE TABLE</CODE>.
See section <A HREF="manual.html#CREATE_TABLE">7.7  <CODE>CREATE TABLE</CODE> syntax</A>.
<CODE>CREATE INDEX</CODE> allows you to add indexes to existing tables.

</P>
<P>
A column list of the form <CODE>(col1,col2,...)</CODE> creates a multiple-column
index.  Index values are formed by concatenating the values of the given
columns.

</P>
<P>
For <CODE>CHAR</CODE> and <CODE>VARCHAR</CODE> columns, indexes can be created that
use only part of a column, using <CODE>col_name(length)</CODE> syntax.  (On
<CODE>BLOB</CODE> and <CODE>TEXT</CODE> columns the length is required). The
statement shown below creates an index using the first 10 characters of
the <CODE>name</CODE> column:

</P>

<PRE>
mysql&#62; CREATE INDEX part_of_name ON customer (name(10));
</PRE>

<P>
Since most names usually differ in the first 10 characters, this index should
not be much slower than an index created from the entire <CODE>name</CODE> column.
Also, using partial columns for indexes can make the index file much smaller,
which could save a lot of disk space and might also speed up <CODE>INSERT</CODE>
operations!

</P>
<P>
Note that you can only add a index on a column that can have <CODE>NULL</CODE>
values or on a <CODE>BLOB</CODE>/<CODE>TEXT</CODE> column if you are useing
<STRONG>MySQL</STRONG> version 3.23.2 or newer and are using the <CODE>MyISAM</CODE>
table type.

</P>
<P>
For more information about how <STRONG>MySQL</STRONG> uses indexes, see
section <A HREF="manual.html#MySQL_indexes">10.4  MySQL index use</A>.

</P>
<P>
<A NAME="IDX592"></A>


<H2><A NAME="DROP_INDEX" HREF="manual_toc.html#DROP_INDEX">7.28  <CODE>DROP INDEX</CODE> syntax</A></H2>


<PRE>
DROP INDEX index_name ON tbl_name
</PRE>

<P>
<CODE>DROP INDEX</CODE> drops the index named <CODE>index_name</CODE> from the table
<CODE>tbl_name</CODE>.  <CODE>DROP INDEX</CODE> doesn't do anything in <STRONG>MySQL</STRONG>
prior to version 3.22.  In 3.22 or later, <CODE>DROP INDEX</CODE> is mapped to an
<CODE>ALTER TABLE</CODE> statement to drop the index.
See section <A HREF="manual.html#ALTER_TABLE">7.8  <CODE>ALTER TABLE</CODE> syntax</A>.

</P>
<P>
<A NAME="IDX593"></A>


<H2><A NAME="Comments" HREF="manual_toc.html#Comments">7.29  Comment syntax</A></H2>

<P>
The <STRONG>MySQL</STRONG> server supports the <CODE># to end of line</CODE>, <CODE>--
to end of line</CODE> and <CODE>/* in-line or multiple-line */</CODE> comment
styles:

</P>

<PRE>
mysql&#62; select 1+1;     # This comment continues to the end of line
mysql&#62; select 1+1;     -- This comment continues to the end of line 
mysql&#62; select 1 /* this is an in-line comment */ + 1;
mysql&#62; select 1+
/*
this is a
multiple-line comment
*/
1;
</PRE>

<P>
Note that the <CODE>--</CODE> comment style requires you to have at least one space
after the <CODE>--</CODE>!

</P>
<P>
Although the server understands the comment syntax just described,
there are some limitations on the way that the <CODE>mysql</CODE> client
parses <CODE>/* ... */</CODE> comments:

</P>

<UL>
<LI>

Single-quote and double-quote characters are taken to indicate the beginning
of a quoted string, even within a comment.  If the quote is not matched by a
second quote within the comment, the parser doesn't realize the comment has
ended.  If you are running <CODE>mysql</CODE> interactively, you can tell that it
has gotten confused like this because the prompt changes from <CODE>mysql&#62;</CODE>
to <CODE>'&#62;</CODE> or <CODE>"&#62;</CODE>.

<LI>

A semicolon is taken to indicate the end of the current SQL statement
and anything following it to indicate the beginning of the next statement.
</UL>

<P>
These limitations apply both when you run <CODE>mysql</CODE> interactively
and when you put commands in a file and tell <CODE>mysql</CODE> to read its
input from that file with <CODE>mysql &#60; some-file</CODE>.

</P>
<P>
<STRONG>MySQL</STRONG> doesn't support the <SAMP>`--'</SAMP> ANSI SQL comment style.
See section <A HREF="manual.html#Missing_comments">5.4.7  <SAMP>`--'</SAMP> as the start of a comment</A>.

</P>
<P>
<A NAME="IDX594"></A>
<A NAME="IDX595"></A>
<A NAME="IDX596"></A>
<A NAME="IDX597"></A>
<A NAME="IDX598"></A>


<H2><A NAME="CREATE_FUNCTION" HREF="manual_toc.html#CREATE_FUNCTION">7.30  <CODE>CREATE FUNCTION/DROP FUNCTION</CODE> syntax</A></H2>


<PRE>
CREATE [AGGREGATE] FUNCTION function_name RETURNS {STRING|REAL|INTEGER}
       SONAME shared_library_name

DROP FUNCTION function_name
</PRE>

<P>
A user-definable function (UDF) is a way to extend <STRONG>MySQL</STRONG> with a new
function that works like native (built in) <STRONG>MySQL</STRONG> functions such as
<CODE>ABS()</CODE> and <CODE>CONCAT()</CODE>.

</P>
<P>
<CODE>AGGREGATE</CODE> is a new option for <STRONG>MySQL</STRONG> 3.23.  An
<CODE>AGGREGATE</CODE> function works exactly like a native <STRONG>MySQL</STRONG>
<CODE>GROUP</CODE> function like <CODE>SUM</CODE> or <CODE>COUNT()</CODE>.

</P>
<P>
<CODE>CREATE FUNCTION</CODE> saves the function's name, type and shared library
name in the <CODE>mysql.func</CODE> system table.  You must have the
<STRONG>insert</STRONG> and <STRONG>delete</STRONG> privileges for the <CODE>mysql</CODE> database
to create and drop functions.

</P>
<P>
All active functions are reloaded each time the server starts, unless
you start <CODE>mysqld</CODE> with the <CODE>--skip-grant-tables</CODE> option.  In
this case, UDF initialization is skipped and UDFs are unavailable.
(An active function is one that has been loaded with <CODE>CREATE FUNCTION</CODE>
and not removed with <CODE>DROP FUNCTION</CODE>.)

</P>
<P>
For instructions on writing user-definable functions, see section <A HREF="manual.html#Adding_functions">14  Adding new functions to MySQL</A>.  For the UDF mechanism to work, functions must be written in C or
C++, your operating system must support dynamic loading and you must have
compiled <CODE>mysqld</CODE> dynamically (not static).

</P>
<P>
<A NAME="IDX599"></A>
<A NAME="IDX600"></A>
<A NAME="IDX601"></A>


<H2><A NAME="Reserved_words" HREF="manual_toc.html#Reserved_words">7.31  Is MySQL picky about reserved words?</A></H2>

<P>
A common problem stems from trying to create a table with column names that
use the names of datatypes or functions built into <STRONG>MySQL</STRONG>, such as
<CODE>TIMESTAMP</CODE> or <CODE>GROUP</CODE>.  You're allowed to do it (for example,
<CODE>ABS</CODE> is an allowed column name), but whitespace is not allowed between
a function name and the <SAMP>`('</SAMP> when using functions whose names are also
column names.

</P>
<P>
The following words are explicitly reserved in <STRONG>MySQL</STRONG>. Most of
them are forbidden by ANSI SQL92 as column and/or table names
(for example, <CODE>group</CODE>).
A few are reserved because <STRONG>MySQL</STRONG> needs them and is
(currently) using a <CODE>yacc</CODE> parser:

</P>

<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><CODE>action</CODE> </TD><TD> <CODE>add</CODE> </TD><TD> <CODE>aggregate</CODE> </TD><TD> <CODE>all</CODE>
</TR NOSAVE>
<TR><TD><CODE>alter</CODE> </TD><TD> <CODE>after</CODE> </TD><TD> <CODE>and</CODE> </TD><TD> <CODE>as</CODE>
</TR NOSAVE>
<TR><TD><CODE>asc</CODE> </TD><TD> <CODE>avg</CODE> </TD><TD> <CODE>avg_row_length</CODE> </TD><TD> <CODE>auto_increment</CODE>
</TR NOSAVE>
<TR><TD><CODE>between</CODE> </TD><TD> <CODE>bigint</CODE> </TD><TD> <CODE>bit</CODE> </TD><TD> <CODE>binary</CODE>
</TR NOSAVE>
<TR><TD><CODE>blob</CODE> </TD><TD> <CODE>bool</CODE> </TD><TD> <CODE>both</CODE> </TD><TD> <CODE>by</CODE>
</TR NOSAVE>
<TR><TD><CODE>cascade</CODE> </TD><TD> <CODE>case</CODE> </TD><TD> <CODE>char</CODE> </TD><TD> <CODE>character</CODE>
</TR NOSAVE>
<TR><TD><CODE>change</CODE> </TD><TD> <CODE>check</CODE> </TD><TD> <CODE>checksum</CODE> </TD><TD> <CODE>column</CODE>
</TR NOSAVE>
<TR><TD><CODE>columns</CODE> </TD><TD> <CODE>comment</CODE> </TD><TD> <CODE>constraint</CODE> </TD><TD> <CODE>create</CODE>
</TR NOSAVE>
<TR><TD><CODE>cross</CODE> </TD><TD> <CODE>current_date</CODE> </TD><TD> <CODE>current_time</CODE> </TD><TD> <CODE>current_timestamp</CODE>
</TR NOSAVE>
<TR><TD><CODE>data</CODE> </TD><TD> <CODE>database</CODE> </TD><TD> <CODE>databases</CODE> </TD><TD> <CODE>date</CODE>
</TR NOSAVE>
<TR><TD><CODE>datetime</CODE> </TD><TD> <CODE>day</CODE> </TD><TD> <CODE>day_hour</CODE> </TD><TD> <CODE>day_minute</CODE>
</TR NOSAVE>
<TR><TD><CODE>day_second</CODE> </TD><TD> <CODE>dayofmonth</CODE> </TD><TD> <CODE>dayofweek</CODE> </TD><TD> <CODE>dayofyear</CODE>
</TR NOSAVE>
<TR><TD><CODE>dec</CODE> </TD><TD> <CODE>decimal</CODE> </TD><TD> <CODE>default</CODE> </TD><TD> <CODE>delayed</CODE>
</TR NOSAVE>
<TR><TD><CODE>delay_key_write</CODE> </TD><TD> <CODE>delete</CODE> </TD><TD> <CODE>desc</CODE> </TD><TD> <CODE>describe</CODE>
</TR NOSAVE>
<TR><TD><CODE>distinct</CODE> </TD><TD> <CODE>distinctrow</CODE> </TD><TD> <CODE>double</CODE> </TD><TD> <CODE>drop</CODE>
</TR NOSAVE>
<TR><TD><CODE>end</CODE> </TD><TD> <CODE>else</CODE> </TD><TD> <CODE>escape</CODE> </TD><TD> <CODE>escaped</CODE>
</TR NOSAVE>
<TR><TD><CODE>enclosed</CODE> </TD><TD> <CODE>enum</CODE> </TD><TD> <CODE>explain</CODE> </TD><TD> <CODE>exists</CODE>
</TR NOSAVE>
<TR><TD><CODE>fields</CODE> </TD><TD> <CODE>file</CODE> </TD><TD> <CODE>first</CODE> </TD><TD> <CODE>float</CODE>
</TR NOSAVE>
<TR><TD><CODE>float4</CODE> </TD><TD> <CODE>float8</CODE> </TD><TD> <CODE>flush</CODE> </TD><TD> <CODE>foreign</CODE>
</TR NOSAVE>
<TR><TD><CODE>from</CODE> </TD><TD> <CODE>for</CODE> </TD><TD> <CODE>full</CODE> </TD><TD> <CODE>function</CODE>
</TR NOSAVE>
<TR><TD><CODE>global</CODE> </TD><TD> <CODE>grant</CODE> </TD><TD> <CODE>grants</CODE> </TD><TD> <CODE>group</CODE>
</TR NOSAVE>
<TR><TD><CODE>having</CODE> </TD><TD> <CODE>heap</CODE> </TD><TD> <CODE>high_priority</CODE> </TD><TD> <CODE>hour</CODE>
</TR NOSAVE>
<TR><TD><CODE>hour_minute</CODE> </TD><TD> <CODE>hour_second</CODE> </TD><TD> <CODE>hosts</CODE> </TD><TD> <CODE>identified</CODE>
</TR NOSAVE>
<TR><TD><CODE>ignore</CODE> </TD><TD> <CODE>in</CODE> </TD><TD> <CODE>index</CODE> </TD><TD> <CODE>infile</CODE>
</TR NOSAVE>
<TR><TD><CODE>inner</CODE> </TD><TD> <CODE>insert</CODE> </TD><TD> <CODE>insert_id</CODE> </TD><TD> <CODE>int</CODE>
</TR NOSAVE>
<TR><TD><CODE>integer</CODE> </TD><TD> <CODE>interval</CODE> </TD><TD> <CODE>int1</CODE> </TD><TD> <CODE>int2</CODE>
</TR NOSAVE>
<TR><TD><CODE>int3</CODE> </TD><TD> <CODE>int4</CODE> </TD><TD> <CODE>int8</CODE> </TD><TD> <CODE>into</CODE>
</TR NOSAVE>
<TR><TD><CODE>if</CODE> </TD><TD> <CODE>is</CODE> </TD><TD> <CODE>isam</CODE> </TD><TD> <CODE>join</CODE>
</TR NOSAVE>
<TR><TD><CODE>key</CODE> </TD><TD> <CODE>keys</CODE> </TD><TD> <CODE>kill</CODE> </TD><TD> <CODE>last_insert_id</CODE>
</TR NOSAVE>
<TR><TD><CODE>leading</CODE> </TD><TD> <CODE>left</CODE> </TD><TD> <CODE>length</CODE> </TD><TD> <CODE>like</CODE>
</TR NOSAVE>
<TR><TD><CODE>lines</CODE> </TD><TD> <CODE>limit</CODE> </TD><TD> <CODE>load</CODE> </TD><TD> <CODE>local</CODE>
</TR NOSAVE>
<TR><TD><CODE>lock</CODE> </TD><TD> <CODE>logs</CODE> </TD><TD> <CODE>long</CODE> </TD><TD> <CODE>longblob</CODE>
</TR NOSAVE>
<TR><TD><CODE>longtext</CODE> </TD><TD> <CODE>low_priority</CODE> </TD><TD> <CODE>max</CODE> </TD><TD> <CODE>max_rows</CODE>
</TR NOSAVE>
<TR><TD><CODE>match</CODE> </TD><TD> <CODE>mediumblob</CODE> </TD><TD> <CODE>mediumtext</CODE> </TD><TD> <CODE>mediumint</CODE>
</TR NOSAVE>
<TR><TD><CODE>middleint</CODE> </TD><TD> <CODE>min_rows</CODE> </TD><TD> <CODE>minute</CODE> </TD><TD> <CODE>minute_second</CODE>
</TR NOSAVE>
<TR><TD><CODE>modify</CODE> </TD><TD> <CODE>month</CODE> </TD><TD> <CODE>monthname</CODE> </TD><TD> <CODE>myisam</CODE>
</TR NOSAVE>
<TR><TD><CODE>natural</CODE> </TD><TD> <CODE>numeric</CODE> </TD><TD> <CODE>no</CODE> </TD><TD> <CODE>not</CODE>
</TR NOSAVE>
<TR><TD><CODE>null</CODE> </TD><TD> <CODE>on</CODE> </TD><TD> <CODE>optimize</CODE> </TD><TD> <CODE>option</CODE>
</TR NOSAVE>
<TR><TD><CODE>optionally</CODE> </TD><TD> <CODE>or</CODE> </TD><TD> <CODE>order</CODE> </TD><TD> <CODE>outer</CODE>
</TR NOSAVE>
<TR><TD><CODE>outfile</CODE> </TD><TD> <CODE>pack_keys</CODE> </TD><TD> <CODE>partial</CODE> </TD><TD> <CODE>password</CODE>
</TR NOSAVE>
<TR><TD><CODE>precision</CODE> </TD><TD> <CODE>primary</CODE> </TD><TD> <CODE>procedure</CODE> </TD><TD> <CODE>process</CODE>
</TR NOSAVE>
<TR><TD><CODE>processlist</CODE> </TD><TD> <CODE>privileges</CODE> </TD><TD> <CODE>read</CODE> </TD><TD> <CODE>real</CODE>
</TR NOSAVE>
<TR><TD><CODE>references</CODE> </TD><TD> <CODE>reload</CODE> </TD><TD> <CODE>regexp</CODE> </TD><TD> <CODE>rename</CODE>
</TR NOSAVE>
<TR><TD><CODE>replace</CODE> </TD><TD> <CODE>restrict</CODE> </TD><TD> <CODE>returns</CODE> </TD><TD> <CODE>revoke</CODE>
</TR NOSAVE>
<TR><TD><CODE>rlike</CODE> </TD><TD> <CODE>row</CODE> </TD><TD> <CODE>rows</CODE> </TD><TD> <CODE>second</CODE>
</TR NOSAVE>
<TR><TD><CODE>select</CODE> </TD><TD> <CODE>set</CODE> </TD><TD> <CODE>show</CODE> </TD><TD> <CODE>shutdown</CODE>
</TR NOSAVE>
<TR><TD><CODE>smallint</CODE> </TD><TD> <CODE>soname</CODE> </TD><TD> <CODE>sql_big_tables</CODE> </TD><TD> <CODE>sql_big_selects</CODE>
</TR NOSAVE>
<TR><TD><CODE>sql_low_priority_updates</CODE> </TD><TD> <CODE>sql_log_off</CODE> </TD><TD> <CODE>sql_log_update</CODE> </TD><TD> <CODE>sql_select_limit</CODE>
</TR NOSAVE>
<TR><TD><CODE>sql_small_result</CODE> </TD><TD> <CODE>sql_big_result</CODE> </TD><TD> <CODE>sql_warnings</CODE> </TD><TD> <CODE>straight_join</CODE>
</TR NOSAVE>
<TR><TD><CODE>starting</CODE> </TD><TD> <CODE>status</CODE> </TD><TD> <CODE>string</CODE> </TD><TD> <CODE>table</CODE>
</TR NOSAVE>
<TR><TD><CODE>tables</CODE> </TD><TD> <CODE>temporary</CODE> </TD><TD> <CODE>terminated</CODE> </TD><TD> <CODE>text</CODE>
</TR NOSAVE>
<TR><TD><CODE>then</CODE> </TD><TD> <CODE>time</CODE> </TD><TD> <CODE>timestamp</CODE> </TD><TD> <CODE>tinyblob</CODE>
</TR NOSAVE>
<TR><TD><CODE>tinytext</CODE> </TD><TD> <CODE>tinyint</CODE> </TD><TD> <CODE>trailing</CODE> </TD><TD> <CODE>to</CODE>
</TR NOSAVE>
<TR><TD><CODE>type</CODE> </TD><TD> <CODE>use</CODE> </TD><TD> <CODE>using</CODE> </TD><TD> <CODE>unique</CODE>
</TR NOSAVE>
<TR><TD><CODE>unlock</CODE> </TD><TD> <CODE>unsigned</CODE> </TD><TD> <CODE>update</CODE> </TD><TD> <CODE>usage</CODE>
</TR NOSAVE>
<TR><TD><CODE>values</CODE> </TD><TD> <CODE>varchar</CODE> </TD><TD> <CODE>variables</CODE> </TD><TD> <CODE>varying</CODE>
</TR NOSAVE>
<TR><TD><CODE>varbinary</CODE> </TD><TD> <CODE>with</CODE> </TD><TD> <CODE>write</CODE> </TD><TD> <CODE>when</CODE>
</TR NOSAVE>
<TR><TD><CODE>where</CODE> </TD><TD> <CODE>year</CODE> </TD><TD> <CODE>year_month</CODE> </TD><TD> <CODE>zerofill</CODE>
</TR>
</TABLE>

<P>
The following symbols (from the table above) are disallowed by ANSI SQL
but allowed by <STRONG>MySQL</STRONG> as column/table names. This is because some
of these names are very natural names and a lot of people have already
used them.

</P>

<UL>
<LI><CODE>ACTION</CODE>

<LI><CODE>BIT</CODE>

<LI><CODE>DATE</CODE>

<LI><CODE>ENUM</CODE>

<LI><CODE>NO</CODE>

<LI><CODE>TEXT</CODE>

<LI><CODE>TIME</CODE>

<LI><CODE>TIMESTAMP</CODE>

</UL>



<H1><A NAME="Tutorial" HREF="manual_toc.html#Tutorial">8  MySQL Tutorial</A></H1>

<P>
This chapter provides a tutorial introduction to <STRONG>MySQL</STRONG> by showing
how to use the <CODE>mysql</CODE> client program to create and use a simple
database.  <CODE>mysql</CODE> (sometimes referred to as the ``terminal monitor'' or
just ``monitor'') is an interactive program that allows you to connect to a
<STRONG>MySQL</STRONG> server, run queries and view the results.  <CODE>mysql</CODE> may
also be used in batch mode: you place your queries in a file beforehand, then
tell <CODE>mysql</CODE> to execute the contents of the file.  Both ways of using
<CODE>mysql</CODE> are covered here.

</P>
<P>
To see a list of options provided by <CODE>mysql</CODE>, invoke it with
the <CODE>--help</CODE> option:

</P>

<PRE>
shell&#62; mysql --help
</PRE>

<P>
This chapter assumes that <CODE>mysql</CODE> is installed on your machine, and that
a <STRONG>MySQL</STRONG> server is available to which you can connect.  If this is
not true, contact your <STRONG>MySQL</STRONG> administrator.  (If <EM>you</EM> are the
administrator, you will need to consult other sections of this manual.)

</P>
<P>
The chapter describes the entire process of setting up and using a
database.  If you are interested only in accessing an already-existing
database, you may want to skip over the sections that describe how to
create the database and the tables it contains.

</P>
<P>
Since this chapter is tutorial in nature, many details are necessarily left
out.  Consult the relevant sections of the manual for more
information on the topics covered here.

</P>


<H2><A NAME="Connecting-disconnecting" HREF="manual_toc.html#Connecting-disconnecting">8.1  Connecting to and disconnecting from the server</A></H2>

<P>
To connect to the server, you'll usually need to provide a <STRONG>MySQL</STRONG>
user name when you invoke <CODE>mysql</CODE> and, most likely, a password.  If the
server runs on a machine other than the one where you log in, you'll also
need to specify a hostname.  Contact your administrator to find out what
connection parameters you should use to connect (i.e., what host, user name
and password to use).  Once you know the proper parameters, you should be
able to connect like this:

</P>

<PRE>
shell&#62; mysql -h host -u user -p
Enter password: ********
</PRE>

<P>
The <CODE>********</CODE> represents your password; enter it when <CODE>mysql</CODE>
displays the <CODE>Enter password:</CODE> prompt.

</P>
<P>
If that works, you should see some introductory information followed by a
<CODE>mysql&#62;</CODE> prompt:

</P>


<PRE>
shell&#62; mysql -h host -u user -p
Enter password: ********
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 459 to server version: 3.22.20a-log

Type 'help' for help.

mysql&#62; 
</PRE>

<P>
The prompt tells you that <CODE>mysql</CODE> is ready for you to enter commands.

</P>
<P>
Some <STRONG>MySQL</STRONG> installations allow users to connect as the ``anonymous''
(unnamed) user to the server running on the local host.  If this is the case
on your machine, you should be able to connect to that server by invoking
<CODE>mysql</CODE> without any options:

</P>

<PRE>
shell&#62; mysql
</PRE>

<P>
After you have connected successfully, you can disconnect any time by typing
<CODE>QUIT</CODE> at the <CODE>mysql&#62;</CODE> prompt:

</P>

<PRE>
mysql&#62; QUIT
Bye
</PRE>

<P>
You can also disconnect by typing control-D.

</P>
<P>
Most examples in the following sections assume you are connected to the
server.  They indicate this by the <CODE>mysql&#62;</CODE> prompt.

</P>


<H2><A NAME="Entering_queries" HREF="manual_toc.html#Entering_queries">8.2  Entering queries</A></H2>

<P>
Make sure you are connected to the server, as discussed in the previous
section.  Doing so will not in itself select any database to work with, but
that's okay.  At this point, it's more important to find out a little about
how to issue queries than to jump right in creating tables, loading data
into them and retrieving data from them.  This section describes the basic
principles of entering commands, using several queries you can try out to
familiarize yourself with how <CODE>mysql</CODE> works.

</P>
<P>
Here's a simple command that asks the server to tell you its version number
and the current date.  Type it in as shown below following the <CODE>mysql&#62;</CODE>
prompt and hit the RETURN key:

</P>

<PRE>
mysql&#62; SELECT VERSION(), CURRENT_DATE;
+--------------+--------------+
| version()    | CURRENT_DATE |
+--------------+--------------+
| 3.22.20a-log | 1999-03-19   |
+--------------+--------------+
1 row in set (0.01 sec)
mysql&#62;
</PRE>

<P>
This query illustrates several things about <CODE>mysql</CODE>:

</P>

<UL>
<LI>

A command normally consists of a SQL statement followed by a semicolon.
(There are some exceptions where a semicolon is not needed.  <CODE>QUIT</CODE>,
mentioned earlier, is one of them.  We'll get to others later.)

<LI>

When you issue a command, <CODE>mysql</CODE> sends it to the server for execution
and displays the results, then prints another <CODE>mysql&#62;</CODE> to indicate
that it is ready for another command.

<LI>

<CODE>mysql</CODE> displays query output as a table (rows and columns).  The first
row contains labels for the columns.  The rows following are the query
results.  Normally, column labels are the names of the columns you fetch from
database tables.  If you're retrieving the value of an expression rather than
a table column (as in the example just shown), <CODE>mysql</CODE> labels the column
using the expression itself.

<LI>

<CODE>mysql</CODE> shows how many rows were returned, and how long the query took
to execute, which gives you a rough idea of server performance.  These values
are imprecise because they represent wall clock time (not CPU or machine
time), and because they are affected by factors such as server load and
network latency.  (For brevity, the ``rows in set'' line is not shown in
the remaining examples in this chapter.)
</UL>

<P>
Keywords may be entered in any lettercase.  The following queries are
equivalent:

</P>

<PRE>
mysql&#62; SELECT VERSION(), CURRENT_DATE;
mysql&#62; select version(), current_date;
mysql&#62; SeLeCt vErSiOn(), current_DATE;
</PRE>

<P>
Here's another query.  It demonstrates that you can use <CODE>mysql</CODE> as a
simple calculator:

</P>

<PRE>
mysql&#62; SELECT SIN(PI()/4), (4+1)*5;
+-------------+---------+
| SIN(PI()/4) | (4+1)*5 |
+-------------+---------+
|    0.707107 |      25 |
+-------------+---------+
</PRE>

<P>
The commands shown thus far have been relatively short, single-line
statements.  You can even enter multiple statements on a single line.
Just end each one with a semicolon:

</P>

<PRE>
mysql&#62; SELECT VERSION(); SELECT NOW();
+--------------+
| version()    |
+--------------+
| 3.22.20a-log |
+--------------+

+---------------------+
| NOW()               |
+---------------------+
| 1999-03-19 00:15:33 |
+---------------------+
</PRE>

<P>
A command need not be given all on a single line, so lengthy commands that
require several lines are not a problem.  <CODE>mysql</CODE> determines where your
statement ends by looking for the terminating semicolon, not by looking for
the end of the input line.  (In other words, <CODE>mysql</CODE>
accepts free-format input:  it collects input lines but does not execute them
until it sees the semicolon.)

</P>
<P>
Here's a simple multiple-line statement:

</P>

<PRE>
mysql&#62; SELECT
    -&#62; USER()
    -&#62; ,
    -&#62; CURRENT_DATE;
+--------------------+--------------+
| USER()             | CURRENT_DATE |
+--------------------+--------------+
| joesmith@localhost | 1999-03-18   |
+--------------------+--------------+
</PRE>

<P>
In this example, notice how the prompt changes from <CODE>mysql&#62;</CODE> to
<CODE>-&#62;</CODE> after you enter the first line of a multiple-line query.  This is
how <CODE>mysql</CODE> indicates that it hasn't seen a complete statement and is
waiting for the rest.  The prompt is your friend, because it provides
valuable feedback.  If you use that feedback, you will always be aware of
what <CODE>mysql</CODE> is waiting for.

</P>
<P>
If you decide you don't want to execute a command that you are in the
process of entering, cancel it by typing <CODE>\c</CODE>:

</P>

<PRE>
mysql&#62; SELECT
    -&#62; USER()
    -&#62; \c
mysql&#62;
</PRE>

<P>
Here, too, notice the prompt.  It switches back to <CODE>mysql&#62;</CODE> after you
type <CODE>\c</CODE>, providing feedback to indicate that <CODE>mysql</CODE> is ready
for a new command.

</P>
<P>
The following table shows each of the prompts you may see and summarizes what
they mean about the state that <CODE>mysql</CODE> is in:

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><STRONG>Prompt</STRONG> </TD><TD> <STRONG>Meaning</STRONG>
</TR NOSAVE>
<TR><TD><CODE>mysql&#62;</CODE> </TD><TD> Ready for new command
</TR NOSAVE>
<TR><TD><CODE>    -&#62;</CODE> </TD><TD> Waiting for next line of multiple-line command
</TR NOSAVE>
<TR><TD><CODE>    '&#62;</CODE> </TD><TD> Waiting for next line, collecting a string that begins
with a single quote (<SAMP>`''</SAMP>)
</TR NOSAVE>
<TR><TD><CODE>    "&#62;</CODE> </TD><TD> Waiting for next line, collecting a string that begins
with a double quote (<SAMP>`"'</SAMP>)
</TR>
</TABLE>

<P>
Multiple-line statements commonly occur ``by accident'' when you intend to
issue a command on a single line, but forget the terminating semicolon.  In
this case, <CODE>mysql</CODE> waits for more input:

</P>

<PRE>
mysql&#62; SELECT USER()
    -&#62;
</PRE>

<P>
If this happens to you (you think you've entered a statement but the only
response is a <CODE>-&#62;</CODE> prompt), most likely <CODE>mysql</CODE> is waiting for the
semicolon.  If you don't notice what the prompt is telling you, you might sit
there for a while before realizing what you need to do.  Enter a semicolon to
complete the statement, and <CODE>mysql</CODE> will execute it:

</P>

<PRE>
mysql&#62; SELECT USER()
    -&#62; ;
+--------------------+
| USER()             |
+--------------------+
| joesmith@localhost |
+--------------------+
</PRE>

<P>
The <CODE>'&#62;</CODE> and <CODE>"&#62;</CODE> prompts occur during string collection.
In <STRONG>MySQL</STRONG>, you can write strings surrounded by either <SAMP>`''</SAMP>
or <SAMP>`"'</SAMP> characters (for example, <CODE>'hello'</CODE> or <CODE>"goodbye"</CODE>),
and <CODE>mysql</CODE> lets you enter strings that span multiple lines.  When you
see a <CODE>'&#62;</CODE> or <CODE>"&#62;</CODE> prompt, it means that you've entered a line
containing a string that begins with a <SAMP>`''</SAMP> or <SAMP>`"'</SAMP> quote character,
but have not yet entered the matching quote that terminates the string.
That's fine if you really are entering a multiple-line string, but how likely
is that?  Not very.  More often, the <CODE>'&#62;</CODE> and <CODE>"&#62;</CODE> prompts indicate
that you've inadvertantly left out a quote character.  For example:

</P>

<PRE>
mysql&#62; SELECT * FROM my_table WHERE name = "Smith AND age &#60; 30;
    "&#62;
</PRE>

<P>
If you enter this <CODE>SELECT</CODE> statement, then hit RETURN and wait for the
result, nothing will happen.  Instead of wondering, ``why does this
query take so long?,'' notice the clue provided by the <CODE>"&#62;</CODE> prompt.  It
tells you that <CODE>mysql</CODE> expects to see the rest of an unterminated
string.  (Do you see the error in the statement?  The string <CODE>"Smith</CODE> is
missing the second quote.)

</P>
<P>
At this point, what do you do?  The simplest thing is to cancel the command.
However, you cannot just type <CODE>\c</CODE> in this case, because <CODE>mysql</CODE>
interprets it as part of the string that it is collecting!  Instead, enter
the closing quote character (so <CODE>mysql</CODE> knows you've finished the
string), then type <CODE>\c</CODE>:

</P>

<PRE>
mysql&#62; SELECT * FROM my_table WHERE name = "Smith AND age &#60; 30;
    "&#62; "\c
mysql&#62;
</PRE>

<P>
The prompt changes back to <CODE>mysql&#62;</CODE>, indicating that <CODE>mysql</CODE>
is ready for a new command.

</P>
<P>
It's important to know what the <CODE>'&#62;</CODE> and <CODE>"&#62;</CODE> prompts signify,
because if you mistakenly enter an unterminated string, any further lines you
type will appear to be ignored by <CODE>mysql</CODE> -- including a line
containing <CODE>QUIT</CODE>!  This can be quite confusing, especially if you
don't know that you need to supply the terminating quote before you can
cancel the current command.

</P>


<H2><A NAME="Examples" HREF="manual_toc.html#Examples">8.3  Examples of common queries</A></H2>

<P>
Here follows examples of how to solve some common problems with
<STRONG>MySQL</STRONG>.

</P>
<P>
Some of the examples use the table <CODE>shop</CODE> to hold the price of each
article (item number) for certain traders (dealers).  Supposing that each
trader has a single fixed price per article, then (<CODE>item</CODE>,
<CODE>trader</CODE>) is a primary key for the records.

</P>
<P>
You can create the example table as:

</P>

<PRE>
CREATE TABLE shop (
 article INT(4) UNSIGNED ZEROFILL DEFAULT '0000' NOT NULL,
 dealer  CHAR(20)                 DEFAULT ''     NOT NULL,
 price   DOUBLE(16,2)             DEFAULT '0.00' NOT NULL,
 PRIMARY KEY(article, dealer));

INSERT INTO shop VALUES
(1,'A',3.45),(1,'B',3.99),(2,'A',10.99),(3,'B',1.45),(3,'C',1.69),
(3,'D',1.25),(4,'D',19.95);
</PRE>

<P>
Okay, so the example data is:

</P>

<PRE>
SELECT * FROM shop

+---------+--------+-------+
| article | dealer | price |
+---------+--------+-------+
|    0001 | A      |  3.45 |
|    0001 | B      |  3.99 |
|    0002 | A      | 10.99 |
|    0003 | B      |  1.45 |
|    0003 | C      |  1.69 |
|    0003 | D      |  1.25 |
|    0004 | D      | 19.95 |
+---------+--------+-------+
</PRE>



<H3><A NAME="example-Maximum-column" HREF="manual_toc.html#example-Maximum-column">8.3.1  The maximum value for column</A></H3>

<P>
``What's the highest item number?''

</P>

<PRE>
SELECT MAX(article) AS article FROM shop

+---------+
| article |
+---------+
|       4 |
+---------+
</PRE>



<H3><A NAME="example-Maximum-row" HREF="manual_toc.html#example-Maximum-row">8.3.2  The row holding the maximum of a certain column</A></H3>

<P>
``Find number, dealer, and price of the most expensive article.''

</P>
<P>
In ANSI SQL this is easily done with a sub-query:

</P>

<PRE>
SELECT article, dealer, price
FROM   shop
WHERE  price=(SELECT MAX(price) FROM shop)
</PRE>

<P>
In <STRONG>MySQL</STRONG> (which does not yet have sub-selects), just do it in
two steps:

</P>

<OL>
<LI>

Get the maximum price value from the table with a <CODE>SELECT</CODE> statement.
<LI>

Using this value compile the actual query:

<PRE>
SELECT article, dealer, price
FROM   shop
WHERE  price=19.95
</PRE>

</OL>

<P>
Another solution is to sort all rows descending by price and only
get the first row using the <STRONG>MySQL</STRONG> specific <CODE>LIMIT</CODE> clause:

</P>

<PRE>
SELECT article, dealer, price
FROM   shop
ORDER BY price DESC
LIMIT 1
</PRE>

<P>
<STRONG>Note</STRONG>:  If there are several most expensive articles (e.g. each 19.95)
the <CODE>LIMIT</CODE> solution shows only one of them!

</P>


<H3><A NAME="example-Maximum-column-group" HREF="manual_toc.html#example-Maximum-column-group">8.3.3  Maximum of column: per group: only the values</A></H3>

<P>
``What's the highest price per article?''

</P>

<PRE>
SELECT article, MAX(price) AS price
FROM   shop
GROUP BY article

+---------+-------+
| article | price |
+---------+-------+
|    0001 |  3.99 |
|    0002 | 10.99 |
|    0003 |  1.69 |
|    0004 | 19.95 |
+---------+-------+
</PRE>



<H3><A NAME="example-Maximum-column-group-row" HREF="manual_toc.html#example-Maximum-column-group-row">8.3.4  The rows holding the group-wise maximum of a certain field</A></H3>

<P>
``For each article, find the dealer(s) with the most expensive price.''

</P>
<P>
In ANSI SQL, I'd do it with a sub-query like this:

</P>

<PRE>
SELECT article, dealer, price
FROM   shop s1
WHERE  price=(SELECT MAX(s2.price)
              FROM shop s2
              WHERE s1.article = s2.article)
</PRE>

<P>
In <STRONG>MySQL</STRONG> it's best do it in several steps:

</P>

<OL>
<LI>

Get the list of (article,maxprice). See section <A HREF="manual.html#example-Maximum-column-group-row">8.3.4  The rows holding the group-wise maximum of a certain field</A>.
<LI>

For each article get the corresponding rows which have the stored maximum
price.
</OL>

<P>
This can easily be done with a temporary table:

</P>

<PRE>
CREATE TEMPORARY TABLE tmp (
        article INT(4) UNSIGNED ZEROFILL DEFAULT '0000' NOT NULL,
        price   DOUBLE(16,2)             DEFAULT '0.00' NOT NULL);

LOCK TABLES article read;

INSERT INTO tmp SELECT article, MAX(price) FROM shop GROUP BY article;

SELECT article, dealer, price FROM shop, tmp
WHERE shop.articel=tmp.articel AND shop.price=tmp.price;

UNLOCK TABLES;

DROP TABLE tmp;
</PRE>

<P>
If you don't use a <CODE>TEMPORARY</CODE> table, you must also lock the 'tmp' table.

</P>
<P>
``Can it be done with a single query?''

</P>
<P>
Yes, but only by using a quite inefficient trick that I call the
``MAX-CONCAT trick'':

</P>

<PRE>
SELECT article,
       SUBSTRING( MAX( CONCAT(LPAD(price,6,'0'),dealer) ), 7) AS dealer,
  0.00+LEFT(      MAX( CONCAT(LPAD(price,6,'0'),dealer) ), 6) AS price
FROM   shop
GROUP BY article;

+---------+--------+-------+
| article | dealer | price |
+---------+--------+-------+
|    0001 | B      |  3.99 |
|    0002 | A      | 10.99 |
|    0003 | C      |  1.69 |
|    0004 | D      | 19.95 |
+---------+--------+-------+
</PRE>

<P>
The last example can of course be made a bit more efficient by doing the
splitting of the concatenated column in the client.

</P>


<H3><A NAME="example-Foreign_keys" HREF="manual_toc.html#example-Foreign_keys">8.3.5  Using foreign keys</A></H3>

<P>
You don't need foreign keys to join 2 tables.

</P>
<P>
The only thing <STRONG>MySQL</STRONG> doesn't do is <CODE>CHECK</CODE> to make sure that
the keys you use really exist in the table(s) you're referencing and it
doesn't automatically delete rows from table with a foreign key
definition. If you use your keys like normal, it'll work just fine!

</P>


<PRE>
CREATE TABLE persons (
    id SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT, 
    name CHAR(60) NOT NULL,
    PRIMARY KEY (id)
);

CREATE TABLE shirts (
    id SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT,
    style ENUM('t-shirt', 'polo', 'dress') NOT NULL,
    color ENUM('red', 'blue', 'orange', 'white', 'black') NOT NULL,
    owner SMALLINT UNSIGNED NOT NULL REFERENCES persons,
    PRIMARY KEY (id)
);

INSERT INTO persons VALUES (NULL, 'Antonio Paz');

INSERT INTO shirts VALUES
(NULL, 'polo', 'blue', LAST_INSERT_ID()),
(NULL, 'dress', 'white', LAST_INSERT_ID()),
(NULL, 't-shirt', 'blue', LAST_INSERT_ID());

INSERT INTO persons VALUES (NULL, 'Lilliana Angelovska');

INSERT INTO shirts VALUES
(NULL, 'dress', 'orange', LAST_INSERT_ID()),
(NULL, 'polo', 'red', LAST_INSERT_ID()),
(NULL, 'dress', 'blue', LAST_INSERT_ID()),
(NULL, 't-shirt', 'white', LAST_INSERT_ID());

SELECT * FROM persons;
+----+---------------------+
| id | name                |
+----+---------------------+
|  1 | Antonio Paz         |
|  2 | Lilliana Angelovska |
+----+---------------------+

SELECT * FROM shirts;
+----+---------+--------+-------+
| id | style   | color  | owner |
+----+---------+--------+-------+
|  1 | polo    | blue   |     1 |
|  2 | dress   | white  |     1 |
|  3 | t-shirt | blue   |     1 |
|  4 | dress   | orange |     2 |
|  5 | polo    | red    |     2 |
|  6 | dress   | blue   |     2 |
|  7 | t-shirt | white  |     2 |
+----+---------+--------+-------+

SELECT s.* FROM persons p, shirts s
 WHERE p.name LIKE 'Lilliana%'
   AND s.owner = p.id
   AND s.color &#60;&#62; 'white';

+----+-------+--------+-------+
| id | style | color  | owner |
+----+-------+--------+-------+
|  4 | dress | orange |     2 |
|  5 | polo  | red    |     2 |
|  6 | dress | blue   |     2 |
+----+-------+--------+-------+
</PRE>



<H2><A NAME="Database_use" HREF="manual_toc.html#Database_use">8.4  Creating and using a database</A></H2>

<P>
Now that you know how to enter commands, it's time to access a database.

</P>
<P>
Suppose you have several pets in your home (your ``menagerie'') and you'd
like to keep track of various types of information about them.  You can do so
by creating tables to hold your data and loading them with the desired
information.  Then you can answer different sorts of questions about your
animals by retrieving data from the tables.  This section shows how to do
all that:

</P>

<UL>
<LI>

How to create a database
<LI>

How to create a table
<LI>

How to load data into the table
<LI>

How to retrieve data from the table in various ways
<LI>

How to use multiple tables
</UL>

<P>
The menagerie database will be simple (deliberately), but it is not difficult
to think of real-world situations in which a similar type of database might
be used.  For example, a database like this could be used by a farmer to keep
track of livestock, or by a veterinarian to keep track of patient records.

</P>
<P>
Use the <CODE>SHOW</CODE> statement to find out what databases currently exist
on the server:

</P>

<PRE>
mysql&#62; SHOW DATABASES;
+----------+
| Database |
+----------+
| mysql    |
| test     |
| tmp      |
+----------+
</PRE>

<P>
The list of databases is probably different on your machine, but the
<CODE>mysql</CODE> and <CODE>test</CODE> databases are likely to be among them.  The
<CODE>mysql</CODE> database is required because it describes user access
privileges.  The <CODE>test</CODE> database is often provided as a workspace for
users to try things out.

</P>
<P>
If the <CODE>test</CODE> database exists, try to access it:

</P>

<PRE>
mysql&#62; USE test
Database changed
</PRE>

<P>
Note that <CODE>USE</CODE>, like <CODE>QUIT</CODE>, does not require a semicolon.  (You
can terminate such statements with a semicolon if you like; it does no harm.)
The <CODE>USE</CODE> statement is special in another way, too:  it must be given on
a single line.

</P>
<P>
You can use the <CODE>test</CODE> database (if you have access to it) for the
examples that follow, but anything you create in that database can be
removed by anyone else with access to it.  For this reason, you should
probably ask your <STRONG>MySQL</STRONG> administrator for permission to use a
database of your own.  Suppose you want to call yours <CODE>menagerie</CODE>.  The
administrator needs to execute a command like this:

</P>

<PRE>
mysql&#62; GRANT ALL ON menagerie.* TO your_mysql_name;
</PRE>

<P>
where <CODE>your_mysql_name</CODE> is the <STRONG>MySQL</STRONG> user name assigned to
you.

</P>


<H3><A NAME="Creating_database" HREF="manual_toc.html#Creating_database">8.4.1  Creating and selecting a database</A></H3>

<P>
If the administrator creates your database for you when setting up your
permissions, you can begin using it.  Otherwise, you need to create it
yourself:

</P>

<PRE>
mysql&#62; CREATE DATABASE menagerie;
</PRE>

<P>
Under Unix, database names are case sensitive (unlike SQL keywords), so you
must always refer to your database as <CODE>menagerie</CODE>, not as
<CODE>Menagerie</CODE>, <CODE>MENAGERIE</CODE> or some other variant.  This is also true
for table names.  (Under Windows, this restriction does not apply, although
you must refer to databases and tables using the same lettercase throughout a
given query.)

</P>
<P>
Creating a database does not select it for use, you must do that explicitly.
To make <CODE>menagerie</CODE> the current database, use this command:

</P>

<PRE>
mysql&#62; USE menagerie
Database changed
</PRE>

<P>
Your database needs to be created only once, but you must select it for use
each time you begin a <CODE>mysql</CODE> session.  You can do this by issuing a
<CODE>USE</CODE> statement as shown above.  Alternatively, you can select the
database on the command line when you invoke <CODE>mysql</CODE>.  Just specify its
name after any connection parameters that you might need to provide.  For
example:

</P>

<PRE>
shell&#62; mysql -h host -u user -p menagerie
Enter password: ********
</PRE>

<P>
Note that <CODE>menagerie</CODE> is not your password on the command just shown.
If you want to supply your password on the command line after the <CODE>-p</CODE>
option, you must do so with no intervening space (e.g., as
<CODE>-pmypassword</CODE>, not as <CODE>-p mypassword</CODE>).  However, putting your
password on the command line is not recommended, because doing so exposes it
to snooping by other users logged in on your machine.

</P>


<H3><A NAME="Creating_tables" HREF="manual_toc.html#Creating_tables">8.4.2  Creating a table</A></H3>

<P>
Creating the database is the easy part, but at this point it's empty, as
<CODE>SHOW TABLES</CODE> will tell you:

</P>

<PRE>
mysql&#62; SHOW TABLES;
Empty set (0.00 sec)
</PRE>

<P>
The harder part is deciding what the structure of your database should be:
what tables you will need, and what columns will be in each of them.

</P>
<P>
You'll want a table that contains a record for each of your pets.  This can
be called the <CODE>pet</CODE> table, and it should contain, as a bare minimum,
each animal's name.  Since the name by itself is not very interesting, the
table should contain other information.  For example, if more than one person
in your family keeps pets, you might want to list each animal's owner.  You
might also want to record some basic descriptive information such as species
and sex.

</P>
<P>
How about age?  That might be of interest, but it's not a good thing to store
in a database.  Age changes as time passes, which means you'd have to update
your records often.  Instead, it's better to store a fixed value such as
date of birth.  Then, whenever you need age, you can calculate it as the
difference between the current date and the birth date.  <STRONG>MySQL</STRONG>
provides functions for doing date arithmetic, so this is not difficult.
Storing birth date rather than age has other advantages, too:

</P>

<UL>
<LI>

You can use the database for tasks such as generating reminders for upcoming
pet birthdays.  (If you think this type of query is somewhat silly, note that
it is the same question you might ask in the context of a business database
to identify clients to whom you'll soon need to send out birthday greetings,
for that computer-assisted personal touch.)

<LI>

You can calculate age in relation to dates other than the current date.  For
example, if you store death date in the database, you can easily calculate
how old a pet was when it died.
</UL>

<P>
You can probably think of other types of information that would be useful in
the <CODE>pet</CODE> table, but the ones identified so far are sufficient for now:
name, owner, species, sex, birth and death.

</P>
<P>
Use a <CODE>CREATE TABLE</CODE> statement to specify the layout of your table:

</P>

<PRE>
mysql&#62; CREATE TABLE pet (name VARCHAR(20), owner VARCHAR(20),
    -&#62; species VARCHAR(20), sex CHAR(1), birth DATE, death DATE);
</PRE>

<P>
<CODE>VARCHAR</CODE> is a good choice for the <CODE>name</CODE>, <CODE>owner</CODE> and
<CODE>species</CODE> columns since the column values will vary in length.  The
lengths of those columns need not all be the same, and need not be
<CODE>20</CODE>.  You can pick any length from <CODE>1</CODE> to <CODE>255</CODE>, whatever
seems most reasonable to you.  (If you make a poor choice and it turns
out later that you need a longer field, <STRONG>MySQL</STRONG> provides an
<CODE>ALTER TABLE</CODE> statement.)

</P>
<P>
Animal sex can be represented in a variety of ways, for example, <CODE>"m"</CODE>
and <CODE>"f"</CODE>, or perhaps <CODE>"male"</CODE> and <CODE>"female"</CODE>.  It's simplest
to use the single characters <CODE>"m"</CODE> and <CODE>"f"</CODE>.

</P>
<P>
The use of the <CODE>DATE</CODE> data type for the <CODE>birth</CODE> and <CODE>death</CODE>
columns is a fairly obvious choice.

</P>
<P>
Now that you have created a table, <CODE>SHOW TABLES</CODE> should produce some
output:

</P>

<PRE>
mysql&#62; SHOW TABLES;
+---------------------+
| Tables in menagerie |
+---------------------+
| pet                 |
+---------------------+
</PRE>

<P>
To verify that your table was created the way you expected, use
a <CODE>DESCRIBE</CODE> statement:

</P>

<PRE>
mysql&#62; DESCRIBE pet;
+---------+-------------+------+-----+---------+-------+
| Field   | Type        | Null | Key | Default | Extra |
+---------+-------------+------+-----+---------+-------+
| name    | varchar(20) | YES  |     | NULL    |       |
| owner   | varchar(20) | YES  |     | NULL    |       |
| species | varchar(20) | YES  |     | NULL    |       |
| sex     | char(1)     | YES  |     | NULL    |       |
| birth   | date        | YES  |     | NULL    |       |
| death   | date        | YES  |     | NULL    |       |
+---------+-------------+------+-----+---------+-------+
</PRE>

<P>
You can use <CODE>DESCRIBE</CODE> any time, for example, if you forget the names of
the columns in your table or what types they are.

</P>


<H3><A NAME="Loading_tables" HREF="manual_toc.html#Loading_tables">8.4.3  Loading data into a table</A></H3>

<P>
After creating your table, you need to populate it.  The <CODE>LOAD DATA</CODE> and
<CODE>INSERT</CODE> statements are useful for this.

</P>
<P>
Suppose your pet records can be described as shown below.
(Observe that <STRONG>MySQL</STRONG> expects dates in <CODE>YYYY-MM-DD</CODE> format;
this may be different than what you are used to.)

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><STRONG>name</STRONG> </TD><TD> <STRONG>owner</STRONG> </TD><TD> <STRONG>species</STRONG> </TD><TD> <STRONG>sex</STRONG> </TD><TD> <STRONG>birth</STRONG> </TD><TD> <STRONG>death</STRONG>
</TR NOSAVE>
<TR><TD>Fluffy </TD><TD> Harold </TD><TD> cat </TD><TD> f </TD><TD> 1993-02-04 </TD><TD>
</TR NOSAVE>
<TR><TD>Claws </TD><TD> Gwen </TD><TD> cat </TD><TD> m </TD><TD> 1994-03-17 </TD><TD>
</TR NOSAVE>
<TR><TD>Buffy </TD><TD> Harold </TD><TD> dog </TD><TD> f </TD><TD> 1989-05-13 </TD><TD>
</TR NOSAVE>
<TR><TD>Fang </TD><TD> Benny </TD><TD> dog </TD><TD> m </TD><TD> 1990-08-27 </TD><TD>
</TR NOSAVE>
<TR><TD>Bowser </TD><TD> Diane </TD><TD> dog </TD><TD> m </TD><TD> 1998-08-31 </TD><TD> 1995-07-29
</TR NOSAVE>
<TR><TD>Chirpy </TD><TD> Gwen </TD><TD> bird </TD><TD> f </TD><TD> 1998-09-11 </TD><TD>
</TR NOSAVE>
<TR><TD>Whistler </TD><TD> Gwen </TD><TD> bird </TD><TD> </TD><TD> 1997-12-09 </TD><TD>
</TR NOSAVE>
<TR><TD>Slim </TD><TD> Benny </TD><TD> snake </TD><TD> m </TD><TD> 1996-04-29 </TD><TD>
</TR>
</TABLE>

<P>
Since you are beginning with an empty table, an easy way to populate it is to
create a text file containing a row for each of your animals, then load the
contents of the file into the table with a single statement.

</P>
<P>
You could create a text file <TT>`pet.txt'</TT> containing one record per line,
with values separated by tabs, and given in the order in which the columns
were listed in the <CODE>CREATE TABLE</CODE> statement.  For missing values (such
as unknown sexes, or death dates for animals that are still living), you can
use <CODE>NULL</CODE> values.  To represent these in your text file, use
<CODE>\N</CODE>.  For example, the record for Whistler the bird would look like
this (where the whitespace between values is a single tab character):

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><CODE>Whistler</CODE> </TD><TD> <CODE>Gwen</CODE> </TD><TD> <CODE>bird</CODE> </TD><TD> <CODE>\N</CODE> </TD><TD> <CODE>1997-12-09</CODE> </TD><TD> <CODE>\N</CODE>
</TR>
</TABLE>

<P>
To load the text file <TT>`pet.txt'</TT> into the <CODE>pet</CODE> table, use this
command:

</P>

<PRE>
mysql&#62; LOAD DATA LOCAL INFILE "pet.txt" INTO TABLE pet;
</PRE>

<P>
You can specify the column value separator and end of line marker explicitly
in the <CODE>LOAD DATA</CODE> statement if you wish, but the defaults are tab and
linefeed.  These are sufficient for the statement to read the file
<TT>`pet.txt'</TT> properly.

</P>
<P>
When you want to add new records one at a time, the <CODE>INSERT</CODE> statement
is useful.  In its simplest form, you supply values for each column, in the
order in which the columns were listed in the <CODE>CREATE TABLE</CODE> statement.
Suppose Diane gets a new hamster named Puffball.  You could add a new record
using an <CODE>INSERT</CODE> statement like this:

</P>

<PRE>
mysql&#62; INSERT INTO pet
    -&#62; VALUES ('Puffball','Diane','hamster','f','1999-03-30',NULL);
</PRE>

<P>
Note that string and date values are specified as quoted strings here.  Also,
with <CODE>INSERT</CODE>, you can insert <CODE>NULL</CODE> directly to represent a
missing value.  You do not use <CODE>\N</CODE> like you do with <CODE>LOAD DATA</CODE>.

</P>
<P>
From this example, you should be able to see that there would be a lot more
typing involved to load
your records initially using several <CODE>INSERT</CODE> statements rather
than a single <CODE>LOAD DATA</CODE> statement.

</P>


<H3><A NAME="Retrieving_data" HREF="manual_toc.html#Retrieving_data">8.4.4  Retrieving information from a table</A></H3>

<P>
The <CODE>SELECT</CODE> statement is used to pull information from a table.
The general form of the statement is:

</P>

<PRE>
SELECT what_to_select
FROM which_table
WHERE conditions_to_satisfy
</PRE>

<P>
<CODE>what_to_select</CODE> indicates what you want to see.  This can be a list of
columns, or <CODE>*</CODE> to to indicate ``all columns.'' <CODE>which_table</CODE>
indicates the table from which you want to retrieve data.  The <CODE>WHERE</CODE>
clause is optional.  If it's present, <CODE>conditions_to_satisfy</CODE> specifies
conditions that rows must satisfy to qualify for retrieval.

</P>


<H4><A NAME="Selecting_all" HREF="manual_toc.html#Selecting_all">8.4.4.1  Selecting all data</A></H4>

<P>
The simplest form of <CODE>SELECT</CODE> retrieves everything from a table:

</P>

<PRE>
mysql&#62; SELECT * FROM pet;
+----------+--------+---------+------+------------+------------+
| name     | owner  | species | sex  | birth      | death      |
+----------+--------+---------+------+------------+------------+
| Fluffy   | Harold | cat     | f    | 1993-02-04 | NULL       |
| Claws    | Gwen   | cat     | m    | 1994-03-17 | NULL       |
| Buffy    | Harold | dog     | f    | 1989-05-13 | NULL       |
| Fang     | Benny  | dog     | m    | 1990-08-27 | NULL       |
| Bowser   | Diane  | dog     | m    | 1998-08-31 | 1995-07-29 |
| Chirpy   | Gwen   | bird    | f    | 1998-09-11 | NULL       |
| Whistler | Gwen   | bird    | NULL | 1997-12-09 | NULL       |
| Slim     | Benny  | snake   | m    | 1996-04-29 | NULL       |
| Puffball | Diane  | hamster | f    | 1999-03-30 | NULL       |
+----------+--------+---------+------+------------+------------+
</PRE>

<P>
This form of <CODE>SELECT</CODE> is useful if you want to review your entire table,
for instance, after you've just loaded it with your initial dataset.  As it
happens, the output just shown reveals an error in your data file:  Bowser
appears to have been born after he died!  Consulting your original pedigree
papers, you find that the correct birth year is 1989, not 1998.

</P>
<P>
There are are least a couple of ways to fix this:

</P>

<UL>
<LI>

Edit the file <TT>`pet.txt'</TT> to correct the error, then empty the table
and reload it using <CODE>DELETE</CODE> and <CODE>LOAD DATA</CODE>:


<PRE>
mysql&#62; DELETE FROM pet;
mysql&#62; LOAD DATA LOCAL INFILE "pet.txt" INTO TABLE pet;
</PRE>

However, if you do this, you must also re-enter the record for Puffball.

<LI>

Fix only the erroneous record with an <CODE>UPDATE</CODE> statement:


<PRE>
mysql&#62; UPDATE pet SET birth = "1989-08-31" WHERE name = "Bowser";
</PRE>

</UL>

<P>
As shown above, it is easy to retrieve an entire table.  But typically you
don't want to do that, particularly when the table becomes large.  Instead,
you're usually more interested in answering a particular question, in which
case you specify some constraints on the information you want.  Let's look at
some selection queries in terms of questions about your pets that they
answer.

</P>


<H4><A NAME="Selecting_rows" HREF="manual_toc.html#Selecting_rows">8.4.4.2  Selecting particular rows</A></H4>

<P>
You can select only particular rows from your table.  For example, if you want
to verify the change that you made to Bowser's birth date, select Bowser's
record like this:

</P>

<PRE>
mysql&#62; SELECT * FROM pet WHERE name = "Bowser";
+--------+-------+---------+------+------------+------------+
| name   | owner | species | sex  | birth      | death      |
+--------+-------+---------+------+------------+------------+
| Bowser | Diane | dog     | m    | 1989-08-31 | 1995-07-29 |
+--------+-------+---------+------+------------+------------+
</PRE>

<P>
The output confirms that the year is correctly recorded now as 1989, not 1998.

</P>
<P>
String comparisons are normally case-insensitive, so you can specify the
name as <CODE>"bowser"</CODE>, <CODE>"BOWSER"</CODE>, etc.  The query result will be
the same.

</P>
<P>
You can specify conditions on any column, not just <CODE>name</CODE>.  For example,
if you want to know which animals were born after 1998, test the <CODE>birth</CODE>
column:

</P>

<PRE>
mysql&#62; SELECT * FROM pet WHERE birth &#62;= "1998-1-1";
+----------+-------+---------+------+------------+-------+
| name     | owner | species | sex  | birth      | death |
+----------+-------+---------+------+------------+-------+
| Chirpy   | Gwen  | bird    | f    | 1998-09-11 | NULL  |
| Puffball | Diane | hamster | f    | 1999-03-30 | NULL  |
+----------+-------+---------+------+------------+-------+
</PRE>

<P>
You can combine conditions, for example, to locate female dogs:

</P>

<PRE>
mysql&#62; SELECT * FROM pet WHERE species = "dog" AND sex = "f";
+-------+--------+---------+------+------------+-------+
| name  | owner  | species | sex  | birth      | death |
+-------+--------+---------+------+------------+-------+
| Buffy | Harold | dog     | f    | 1989-05-13 | NULL  |
+-------+--------+---------+------+------------+-------+
</PRE>

<P>
The preceding query uses the <CODE>AND</CODE> logical operator.  There is also an
<CODE>OR</CODE> operator:

</P>

<PRE>
mysql&#62; SELECT * FROM pet WHERE species = "snake" OR species = "bird";
+----------+-------+---------+------+------------+-------+
| name     | owner | species | sex  | birth      | death |
+----------+-------+---------+------+------------+-------+
| Chirpy   | Gwen  | bird    | f    | 1998-09-11 | NULL  |
| Whistler | Gwen  | bird    | NULL | 1997-12-09 | NULL  |
| Slim     | Benny | snake   | m    | 1996-04-29 | NULL  |
+----------+-------+---------+------+------------+-------+
</PRE>

<P>
<CODE>AND</CODE> and <CODE>OR</CODE> may be intermixed.  If you do that, it's a good idea
to use parentheses to indicate how conditions should be grouped:

</P>

<PRE>
mysql&#62; SELECT * FROM pet WHERE (species = "cat" AND sex = "m")
    -&#62; OR (species = "dog" AND sex = "f");
+-------+--------+---------+------+------------+-------+
| name  | owner  | species | sex  | birth      | death |
+-------+--------+---------+------+------------+-------+
| Claws | Gwen   | cat     | m    | 1994-03-17 | NULL  |
| Buffy | Harold | dog     | f    | 1989-05-13 | NULL  |
+-------+--------+---------+------+------------+-------+
</PRE>



<H4><A NAME="Selecting_columns" HREF="manual_toc.html#Selecting_columns">8.4.4.3  Selecting particular columns</A></H4>

<P>
If you don't want to see entire rows from your table, just name the columns
in which you're interested, separated by commas.  For example, if you want to
know when your animals were born, select the <CODE>name</CODE> and <CODE>birth</CODE>
columns:

</P>

<PRE>
mysql&#62; SELECT name, birth FROM pet;
+----------+------------+
| name     | birth      |
+----------+------------+
| Fluffy   | 1993-02-04 |
| Claws    | 1994-03-17 |
| Buffy    | 1989-05-13 |
| Fang     | 1990-08-27 |
| Bowser   | 1989-08-31 |
| Chirpy   | 1998-09-11 |
| Whistler | 1997-12-09 |
| Slim     | 1996-04-29 |
| Puffball | 1999-03-30 |
+----------+------------+
</PRE>

<P>
To find out who owns pets, use this query:

</P>

<PRE>
mysql&#62; SELECT owner FROM pet;
+--------+
| owner  |
+--------+
| Harold |
| Gwen   |
| Harold |
| Benny  |
| Diane  |
| Gwen   |
| Gwen   |
| Benny  |
| Diane  |
+--------+
</PRE>

<P>
<A NAME="IDX602"></A>
However, notice that the query simply retrieves the <CODE>owner</CODE> field from
each record, and some of them appear more than once.  To minimize the output,
retrieve each unique output record just once by adding the keyword
<CODE>DISTINCT</CODE>:

</P>

<PRE>
mysql&#62; SELECT DISTINCT owner FROM pet;
+--------+
| owner  |
+--------+
| Benny  |
| Diane  |
| Gwen   |
| Harold |
+--------+
</PRE>

<P>
You can use a <CODE>WHERE</CODE> clause to combine row selection with column
selection.  For example, to get birth dates for dogs and cats only,
use this query:

</P>

<PRE>
mysql&#62; SELECT name, species, birth FROM pet
    -&#62; WHERE species = "dog" OR species = "cat";
+--------+---------+------------+
| name   | species | birth      |
+--------+---------+------------+
| Fluffy | cat     | 1993-02-04 |
| Claws  | cat     | 1994-03-17 |
| Buffy  | dog     | 1989-05-13 |
| Fang   | dog     | 1990-08-27 |
| Bowser | dog     | 1989-08-31 |
+--------+---------+------------+
</PRE>



<H4><A NAME="Sorting_rows" HREF="manual_toc.html#Sorting_rows">8.4.4.4  Sorting rows</A></H4>

<P>
You may have noticed in the preceding examples that the result rows are
displayed in no particular order.  However, it's often easier to examine
query output when the rows are sorted in some meaningful way.  To sort a
result, use an <CODE>ORDER BY</CODE> clause.

</P>
<P>
Here are animal birthdays, sorted by date:

</P>

<PRE>
mysql&#62; SELECT name, birth FROM pet ORDER BY birth;
+----------+------------+
| name     | birth      |
+----------+------------+
| Buffy    | 1989-05-13 |
| Bowser   | 1989-08-31 |
| Fang     | 1990-08-27 |
| Fluffy   | 1993-02-04 |
| Claws    | 1994-03-17 |
| Slim     | 1996-04-29 |
| Whistler | 1997-12-09 |
| Chirpy   | 1998-09-11 |
| Puffball | 1999-03-30 |
+----------+------------+
</PRE>

<P>
To sort in reverse order, add the <CODE>DESC</CODE> (descending) keyword to the
name of the column you are sorting by:

</P>

<PRE>
mysql&#62; SELECT name, birth FROM pet ORDER BY birth DESC;
+----------+------------+
| name     | birth      |
+----------+------------+
| Puffball | 1999-03-30 |
| Chirpy   | 1998-09-11 |
| Whistler | 1997-12-09 |
| Slim     | 1996-04-29 |
| Claws    | 1994-03-17 |
| Fluffy   | 1993-02-04 |
| Fang     | 1990-08-27 |
| Bowser   | 1989-08-31 |
| Buffy    | 1989-05-13 |
+----------+------------+
</PRE>

<P>
You can sort on multiple columns.  For example, to sort by type of
animal, then by birth date within animal type with youngest animals first,
use the following query:

</P>

<PRE>
mysql&#62; SELECT name, species, birth FROM pet ORDER BY species, birth DESC;
+----------+---------+------------+
| name     | species | birth      |
+----------+---------+------------+
| Chirpy   | bird    | 1998-09-11 |
| Whistler | bird    | 1997-12-09 |
| Claws    | cat     | 1994-03-17 |
| Fluffy   | cat     | 1993-02-04 |
| Fang     | dog     | 1990-08-27 |
| Bowser   | dog     | 1989-08-31 |
| Buffy    | dog     | 1989-05-13 |
| Puffball | hamster | 1999-03-30 |
| Slim     | snake   | 1996-04-29 |
+----------+---------+------------+
</PRE>

<P>
Note that the <CODE>DESC</CODE> keyword applies only to the column name immediately
preceding it (<CODE>birth</CODE>); <CODE>species</CODE> values are still sorted in
ascending order.

</P>


<H4><A NAME="Date_calculations" HREF="manual_toc.html#Date_calculations">8.4.4.5  Date calculations</A></H4>

<P>
<STRONG>MySQL</STRONG> provides several functions that you can use to perform
calculations on dates, for example, to calculate ages or extract
parts of dates.

</P>
<P>
To determine how many years old each of your pets is, compute age as the
difference between the birth date and the current date.  Do this by
converting the two dates to days, take the difference, and divide by 365 (the
number of days in a year):

</P>

<PRE>
mysql&#62; SELECT name, (TO_DAYS(NOW())-TO_DAYS(birth))/365 FROM pet;
+----------+-------------------------------------+
| name     | (TO_DAYS(NOW())-TO_DAYS(birth))/365 |
+----------+-------------------------------------+
| Fluffy   |                                6.15 |
| Claws    |                                5.04 |
| Buffy    |                                9.88 |
| Fang     |                                8.59 |
| Bowser   |                                9.58 |
| Chirpy   |                                0.55 |
| Whistler |                                1.30 |
| Slim     |                                2.92 |
| Puffball |                                0.00 |
+----------+-------------------------------------+
</PRE>

<P>
Although the query works, there are some things about it that could be
improved.  First, the result could be scanned more easily if the rows were
presented in some order.  Second, the heading for the age column isn't very
meaningful.

</P>
<P>
The first problem can be handled by adding an <CODE>ORDER BY name</CODE> clause to
sort the output by name.  To deal with the column heading, provide a name for
the column so that a different label appears in the output (this is called a
column alias):

</P>

<PRE>
mysql&#62; SELECT name, (TO_DAYS(NOW())-TO_DAYS(birth))/365 AS age
    -&#62; FROM pet ORDER BY name;
+----------+------+
| name     | age  |
+----------+------+
| Bowser   | 9.58 |
| Buffy    | 9.88 |
| Chirpy   | 0.55 |
| Claws    | 5.04 |
| Fang     | 8.59 |
| Fluffy   | 6.15 |
| Puffball | 0.00 |
| Slim     | 2.92 |
| Whistler | 1.30 |
+----------+------+
</PRE>

<P>
To sort the output by <CODE>age</CODE> rather than <CODE>name</CODE>, just use a
different <CODE>ORDER BY</CODE> clause:

</P>

<PRE>
mysql&#62;  SELECT name, (TO_DAYS(NOW())-TO_DAYS(birth))/365 AS age
    -&#62;  FROM pet ORDER BY age;
+----------+------+
| name     | age  |
+----------+------+
| Puffball | 0.00 |
| Chirpy   | 0.55 |
| Whistler | 1.30 |
| Slim     | 2.92 |
| Claws    | 5.04 |
| Fluffy   | 6.15 |
| Fang     | 8.59 |
| Bowser   | 9.58 |
| Buffy    | 9.88 |
+----------+------+
</PRE>

<P>
A similar query can be used to determine age at death for animals that have
died.  You determine which animals these are by checking whether or not the
<CODE>death</CODE> value is <CODE>NULL</CODE>.  Then, for those with non-<CODE>NULL</CODE>
values, compute the difference between the <CODE>death</CODE> and <CODE>birth</CODE>
values:

</P>

<PRE>
mysql&#62;  SELECT name, birth, death, (TO_DAYS(death)-TO_DAYS(birth))/365 AS age
    -&#62;  FROM pet WHERE death IS NOT NULL ORDER BY age;
+--------+------------+------------+------+
| name   | birth      | death      | age  |
+--------+------------+------------+------+
| Bowser | 1989-08-31 | 1995-07-29 | 5.91 |
+--------+------------+------------+------+
</PRE>

<P>
The query uses <CODE>death IS NOT NULL</CODE> rather than <CODE>death != NULL</CODE>
because <CODE>NULL</CODE> is a special value.  This is explained later.
See section <A HREF="manual.html#Working_with_NULL">8.4.4.6  Working with <CODE>NULL</CODE> values</A>.

</P>
<P>
What if you want to know which animals have birthdays next month?  For this
type of calculation, year and day are irrelevant, you simply want to extract
the month part of the <CODE>birth</CODE> column.  <STRONG>MySQL</STRONG> provides several
date-part extraction functions, such as <CODE>YEAR()</CODE>, <CODE>MONTH()</CODE> and
<CODE>DAYOFMONTH()</CODE>.  <CODE>MONTH()</CODE> is the appropriate function here.  To
see how it works, run a simple query that displays the value of both
<CODE>birth</CODE> and <CODE>MONTH(birth)</CODE>:

</P>

<PRE>
mysql&#62; SELECT name, birth, MONTH(birth) FROM pet;
+----------+------------+--------------+
| name     | birth      | MONTH(birth) |
+----------+------------+--------------+
| Fluffy   | 1993-02-04 |            2 |
| Claws    | 1994-03-17 |            3 |
| Buffy    | 1989-05-13 |            5 |
| Fang     | 1990-08-27 |            8 |
| Bowser   | 1989-08-31 |            8 |
| Chirpy   | 1998-09-11 |            9 |
| Whistler | 1997-12-09 |           12 |
| Slim     | 1996-04-29 |            4 |
| Puffball | 1999-03-30 |            3 |
+----------+------------+--------------+
</PRE>

<P>
Finding animals with birthdays in the upcoming month is easy, too.  Suppose
the current month is April.  Then the month value is <CODE>4</CODE> and you look
for animals born in May (month 5) like this:

</P>

<PRE>
mysql&#62; SELECT name, birth FROM pet WHERE MONTH(birth) = 5;
+-------+------------+
| name  | birth      |
+-------+------------+
| Buffy | 1989-05-13 |
+-------+------------+
</PRE>

<P>
There is a small complication if the current month is December, of course.
You don't just add one to the month number (<CODE>12</CODE>) and look for animals
born in month 13, because there is no such month.  Instead, you look for
animals born in January (month 1).

</P>
<P>
You can even write the query so that it works no matter what the current
month is.  That way you don't have to use a particular month number
in the query.  <CODE>DATE_ADD()</CODE> allows you to add a time interval to a
given date.  If you add a month to the value of <CODE>NOW()</CODE>, then extract
the month part with <CODE>MONTH()</CODE>, the result produces the month in which to
look for birthdays:

</P>

<PRE>
mysql&#62; SELECT name, birth FROM pet
    -&#62; WHERE MONTH(birth) = MONTH(DATE_ADD(NOW(), INTERVAL 1 MONTH));
</PRE>

<P>
A different way to accomplish the same task is to add <CODE>1</CODE> to get the
next month after the current one (after using the modulo function (<CODE>MOD</CODE>)
to ``wrap around'' the month value to <CODE>0</CODE> if it is currently
<CODE>12</CODE>):

</P>

<PRE>
mysql&#62; SELECT name, birth FROM pet
    -&#62; WHERE MONTH(birth) = MOD(MONTH(NOW()), 12) + 1;
</PRE>

<P>
Note that <CODE>MONTH</CODE> return a number between 1 and 12. And
<CODE>MOD(something,12)</CODE> returns a number between 0 and 11. So the
addition has to be after the <CODE>MOD()</CODE> oterwise we would go from
November (11) to January (1).

</P>


<H4><A NAME="Working_with_NULL" HREF="manual_toc.html#Working_with_NULL">8.4.4.6  Working with <CODE>NULL</CODE> values</A></H4>

<P>
The <CODE>NULL</CODE> value can be surprising until you get used to it.
Conceptually, <CODE>NULL</CODE> means ``missing value'' or ``unknown value'' and it
is treated somewhat differently than other values.  To test for <CODE>NULL</CODE>,
you cannot use the arithmetic comparison operators such as <CODE>=</CODE>, <CODE>&#60;</CODE>
or <CODE>!=</CODE>.  To demonstrate this for yourself, try the following query:

</P>

<PRE>
mysql&#62; SELECT 1 = NULL, 1 != NULL, 1 &#60; NULL, 1 &#62; NULL;
+----------+-----------+----------+----------+
| 1 = NULL | 1 != NULL | 1 &#60; NULL | 1 &#62; NULL |
+----------+-----------+----------+----------+
|     NULL |      NULL |     NULL |     NULL |
+----------+-----------+----------+----------+
</PRE>

<P>
Clearly you get no meaningful results from these comparisons.  Use
the <CODE>IS NULL</CODE> and <CODE>IS NOT NULL</CODE> operators instead:

</P>

<PRE>
mysql&#62; SELECT 1 IS NULL, 1 IS NOT NULL;
+-----------+---------------+
| 1 IS NULL | 1 IS NOT NULL |
+-----------+---------------+
|         0 |             1 |
+-----------+---------------+
</PRE>

<P>
In <STRONG>MySQL</STRONG>, 0 means false and 1 means true.

</P>
<P>
This special treatment of <CODE>NULL</CODE> is why, in the previous section, it
was necessary to determine which animals are no longer alive using
<CODE>death IS NOT NULL</CODE> instead of <CODE>death != NULL</CODE>.

</P>


<H4><A NAME="Pattern_matching" HREF="manual_toc.html#Pattern_matching">8.4.4.7  Pattern matching</A></H4>

<P>
<STRONG>MySQL</STRONG> provides standard SQL pattern matching as well as a form of
pattern matching based on extended regular expressions similar to those used
by Unix utilities such as <CODE>vi</CODE>, <CODE>grep</CODE> and <CODE>sed</CODE>.

</P>
<P>
SQL pattern matching allows you to use <SAMP>`_'</SAMP> to match any single
character, and <SAMP>`%'</SAMP> to match an arbitrary number of characters (including
zero characters).  In MySQL, SQL patterns are case insensitive by default.
Some examples are shown below.  Note that you do not use <CODE>=</CODE> or
<CODE>!=</CODE> when you use SQL patterns; use the <CODE>LIKE</CODE> or <CODE>NOT LIKE</CODE>
comparison operators instead.

</P>
<P>
To find names beginning with <SAMP>`b'</SAMP>:

</P>

<PRE>
mysql&#62; SELECT * FROM pet WHERE name LIKE "b%";
+--------+--------+---------+------+------------+------------+
| name   | owner  | species | sex  | birth      | death      |
+--------+--------+---------+------+------------+------------+
| Buffy  | Harold | dog     | f    | 1989-05-13 | NULL       |
| Bowser | Diane  | dog     | m    | 1989-08-31 | 1995-07-29 |
+--------+--------+---------+------+------------+------------+
</PRE>

<P>
To find names ending with <SAMP>`fy'</SAMP>:

</P>

<PRE>
mysql&#62; SELECT * FROM pet WHERE name LIKE "%fy";
+--------+--------+---------+------+------------+-------+
| name   | owner  | species | sex  | birth      | death |
+--------+--------+---------+------+------------+-------+
| Fluffy | Harold | cat     | f    | 1993-02-04 | NULL  |
| Buffy  | Harold | dog     | f    | 1989-05-13 | NULL  |
+--------+--------+---------+------+------------+-------+
</PRE>

<P>
To find names containing a <SAMP>`w'</SAMP>:

</P>

<PRE>
mysql&#62; SELECT * FROM pet WHERE name LIKE "%w%";
+----------+-------+---------+------+------------+------------+
| name     | owner | species | sex  | birth      | death      |
+----------+-------+---------+------+------------+------------+
| Claws    | Gwen  | cat     | m    | 1994-03-17 | NULL       |
| Bowser   | Diane | dog     | m    | 1989-08-31 | 1995-07-29 |
| Whistler | Gwen  | bird    | NULL | 1997-12-09 | NULL       |
+----------+-------+---------+------+------------+------------+
</PRE>

<P>
To find names containing exactly five characters, use the <SAMP>`_'</SAMP> pattern
character:

</P>

<PRE>
mysql&#62; SELECT * FROM pet WHERE name LIKE "_____";
+-------+--------+---------+------+------------+-------+
| name  | owner  | species | sex  | birth      | death |
+-------+--------+---------+------+------------+-------+
| Claws | Gwen   | cat     | m    | 1994-03-17 | NULL  |
| Buffy | Harold | dog     | f    | 1989-05-13 | NULL  |
+-------+--------+---------+------+------------+-------+
</PRE>

<P>
The other type of pattern matching provided by <STRONG>MySQL</STRONG> uses extended
regular expressions.  When you test for a match for this type of pattern, use
the <CODE>REGEXP</CODE> and <CODE>NOT REGEXP</CODE> operators (or <CODE>RLIKE</CODE> and
<CODE>NOT RLIKE</CODE>, which are synonyms).

</P>
<P>
Some characteristics of extended regular expressions are:

</P>

<UL>
<LI>

<SAMP>`.'</SAMP> matches any single character.

<LI>

A character class <SAMP>`[...]'</SAMP> matches any character within the brackets.
For example, <SAMP>`[abc]'</SAMP> matches <SAMP>`a'</SAMP>, <SAMP>`b'</SAMP> or <SAMP>`c'</SAMP>.  To name a
range of characters, use a dash.  <SAMP>`[a-z]'</SAMP> matches any lowercase letter,
whereas <SAMP>`[0-9]'</SAMP> matches any digit.

<LI>

<SAMP>`*'</SAMP> matches zero or more instances of the thing preceding it.  For
example, <SAMP>`x*'</SAMP> matches any number of <SAMP>`x'</SAMP> characters,
<SAMP>`[0-9]*'</SAMP> matches any number of digits, and <SAMP>`.*'</SAMP> matches any
number of anything.

<LI>

Regular expressions are case sensitive, but you can use a character class to
match both lettercases if you wish.  For example, <SAMP>`[aA]'</SAMP> matches
lowercase or uppercase <SAMP>`a'</SAMP> and <SAMP>`[a-zA-Z]'</SAMP> matches any letter in
either case.

<LI>

The pattern matches if it occurs anywhere in the value being tested
(SQL patterns match only if they match the entire value).

<LI>

To anchor a pattern so that it must match the beginning or end of the value
being tested, use <SAMP>`^'</SAMP> at the beginning or <SAMP>`$'</SAMP> at the end of the
pattern.
</UL>

<P>
To demonstrate how extended regular expressions work, the <CODE>LIKE</CODE> queries
shown above are rewritten below to use <CODE>REGEXP</CODE>:

</P>
<P>
To find names beginning with <SAMP>`b'</SAMP>, use <SAMP>`^'</SAMP> to match the beginning of
the name and <SAMP>`[bB]'</SAMP> to match either lowercase or uppercase <SAMP>`b'</SAMP>:

</P>

<PRE>
mysql&#62; SELECT * FROM pet WHERE name REGEXP "^[bB]";
+--------+--------+---------+------+------------+------------+
| name   | owner  | species | sex  | birth      | death      |
+--------+--------+---------+------+------------+------------+
| Buffy  | Harold | dog     | f    | 1989-05-13 | NULL       |
| Bowser | Diane  | dog     | m    | 1989-08-31 | 1995-07-29 |
+--------+--------+---------+------+------------+------------+
</PRE>

<P>
To find names ending with <SAMP>`fy'</SAMP>, use <SAMP>`$'</SAMP> to match the end of the
name:

</P>

<PRE>
mysql&#62; SELECT * FROM pet WHERE name REGEXP "fy$";
+--------+--------+---------+------+------------+-------+
| name   | owner  | species | sex  | birth      | death |
+--------+--------+---------+------+------------+-------+
| Fluffy | Harold | cat     | f    | 1993-02-04 | NULL  |
| Buffy  | Harold | dog     | f    | 1989-05-13 | NULL  |
+--------+--------+---------+------+------------+-------+
</PRE>

<P>
To find names containing a <SAMP>`w'</SAMP>, use
<SAMP>`[wW]'</SAMP> to match either lowercase or uppercase <SAMP>`w'</SAMP>:

</P>

<PRE>
mysql&#62; SELECT * FROM pet WHERE name REGEXP "[wW]";
+----------+-------+---------+------+------------+------------+
| name     | owner | species | sex  | birth      | death      |
+----------+-------+---------+------+------------+------------+
| Claws    | Gwen  | cat     | m    | 1994-03-17 | NULL       |
| Bowser   | Diane | dog     | m    | 1989-08-31 | 1995-07-29 |
| Whistler | Gwen  | bird    | NULL | 1997-12-09 | NULL       |
+----------+-------+---------+------+------------+------------+
</PRE>

<P>
Since a regular expression pattern matches if it occurs anywhere in the
value, it is not necessary in the previous query to put a wildcard on either
side of the pattern to get it to match the entire value like it would be if
you used an SQL pattern.

</P>
<P>
To find names containing exactly five characters, use <SAMP>`^'</SAMP> and <SAMP>`$'</SAMP>
to match the beginning and end of the name, and five instances of <SAMP>`.'</SAMP>
in between:

</P>

<PRE>
mysql&#62; SELECT * FROM pet WHERE name REGEXP "^.....$";
+-------+--------+---------+------+------------+-------+
| name  | owner  | species | sex  | birth      | death |
+-------+--------+---------+------+------------+-------+
| Claws | Gwen   | cat     | m    | 1994-03-17 | NULL  |
| Buffy | Harold | dog     | f    | 1989-05-13 | NULL  |
+-------+--------+---------+------+------------+-------+
</PRE>

<P>
You could also write the previous query using the <SAMP>`{n}'</SAMP>
``repeat-<CODE>n</CODE>-times'' operator:

</P>

<PRE>
mysql&#62; SELECT * FROM pet WHERE name REGEXP "^.{5}$";
+-------+--------+---------+------+------------+-------+
| name  | owner  | species | sex  | birth      | death |
+-------+--------+---------+------+------------+-------+
| Claws | Gwen   | cat     | m    | 1994-03-17 | NULL  |
| Buffy | Harold | dog     | f    | 1989-05-13 | NULL  |
+-------+--------+---------+------+------------+-------+
</PRE>



<H4><A NAME="Counting_rows" HREF="manual_toc.html#Counting_rows">8.4.4.8  Counting rows</A></H4>

<P>
Databases are often used to answer the question, ``how often does a certain
type of data occur in a table?''  For example, you might want to know how
many pets you have, or how many pets each owner has, or you might want to
perform various kinds of censuses on your animals.

</P>
<P>
Counting the total number of animals you have is the same question as ``how
many rows are in the <CODE>pet</CODE> table?,'' since there is one record per pet.
The <CODE>COUNT()</CODE> function counts the number of non-<CODE>NULL</CODE> results, so
the query to count your animals looks like this:

</P>

<PRE>
mysql&#62; SELECT COUNT(*) FROM pet;
+----------+
| COUNT(*) |
+----------+
|        9 |
+----------+
</PRE>

<P>
Earlier, you retrieved the names of the people who owned pets.  You can
use <CODE>COUNT()</CODE> if you want to find out how many pets each owner has:

</P>

<PRE>
mysql&#62; SELECT owner, COUNT(*) FROM pet GROUP BY owner;
+--------+----------+
| owner  | COUNT(*) |
+--------+----------+
| Benny  |        2 |
| Diane  |        2 |
| Gwen   |        3 |
| Harold |        2 |
+--------+----------+
</PRE>

<P>
Note the use of <CODE>GROUP BY</CODE> to group together all records for each
<CODE>owner</CODE>.  Without it, all you get is an error message:

</P>

<PRE>
mysql&#62; SELECT owner, COUNT(owner) FROM pet;
ERROR 1140 at line 1: Mixing of GROUP columns (MIN(),MAX(),COUNT()...)
with no GROUP columns is illegal if there is no GROUP BY clause
</PRE>

<P>
<CODE>COUNT()</CODE> and <CODE>GROUP BY</CODE> are useful for characterizing your
data in various ways.  The following examples show different ways to
perform animal census operations.

</P>
<P>
Number of animals per species:

</P>

<PRE>
mysql&#62; SELECT species, COUNT(*) FROM pet GROUP BY species;
+---------+----------+
| species | COUNT(*) |
+---------+----------+
| bird    |        2 |
| cat     |        2 |
| dog     |        3 |
| hamster |        1 |
| snake   |        1 |
+---------+----------+
</PRE>

<P>
Number of animals per sex:

</P>

<PRE>
mysql&#62; SELECT sex, COUNT(*) FROM pet GROUP BY sex;
+------+----------+
| sex  | COUNT(*) |
+------+----------+
| NULL |        1 |
| f    |        4 |
| m    |        4 |
+------+----------+
</PRE>

<P>
(In this output, <CODE>NULL</CODE> indicates ``sex unknown.'')

</P>
<P>
Number of animals per combination of species and sex:

</P>

<PRE>
mysql&#62; SELECT species, sex, COUNT(*) FROM pet GROUP BY species, sex;
+---------+------+----------+
| species | sex  | COUNT(*) |
+---------+------+----------+
| bird    | NULL |        1 |
| bird    | f    |        1 |
| cat     | f    |        1 |
| cat     | m    |        1 |
| dog     | f    |        1 |
| dog     | m    |        2 |
| hamster | f    |        1 |
| snake   | m    |        1 |
+---------+------+----------+
</PRE>

<P>
You need not retrieve an entire table when you use <CODE>COUNT()</CODE>.  For
example, the previous query, when performed just on dogs and cats, looks like
this:

</P>

<PRE>
mysql&#62; SELECT species, sex, COUNT(*) FROM pet
    -&#62; WHERE species = "dog" OR species = "cat"
    -&#62; GROUP BY species, sex;
+---------+------+----------+
| species | sex  | COUNT(*) |
+---------+------+----------+
| cat     | f    |        1 |
| cat     | m    |        1 |
| dog     | f    |        1 |
| dog     | m    |        2 |
+---------+------+----------+
</PRE>

<P>
Or, if you wanted the number of animals per sex only for known-sex animals:

</P>

<PRE>
mysql&#62; SELECT species, sex, COUNT(*) FROM pet
    -&#62; WHERE sex IS NOT NULL
    -&#62; GROUP BY species, sex;
+---------+------+----------+
| species | sex  | COUNT(*) |
+---------+------+----------+
| bird    | f    |        1 |
| cat     | f    |        1 |
| cat     | m    |        1 |
| dog     | f    |        1 |
| dog     | m    |        2 |
| hamster | f    |        1 |
| snake   | m    |        1 |
+---------+------+----------+
</PRE>



<H3><A NAME="Multiple_tables" HREF="manual_toc.html#Multiple_tables">8.4.5  Using more than one table</A></H3>

<P>
The <CODE>pet</CODE> table keeps track of which pets you have.  If you want to
record other information about them, such as events in their lives like
visits to the vet or when litters are born, you need another table.  What
should this table look like?

</P>

<UL>
<LI>

It needs to contain the pet name so you know which animal each event pertains
to.

<LI>

It needs a date so you know when the event occurred.

<LI>

It needs a field to describe the event.

<LI>

If you want to be able to categorize events, it would be useful to have an
event type field.
</UL>

<P>
Given these considerations, the <CODE>CREATE TABLE</CODE> statement for the
<CODE>event</CODE> table might look like this:

</P>

<PRE>
mysql&#62; CREATE TABLE event (name VARCHAR(20), date DATE,
    -&#62; type VARCHAR(15), remark VARCHAR(255));
</PRE>

<P>
As with the <CODE>pet</CODE> table, it's easiest to load the initial records
by creating a tab-delimited text file containing the information:

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD>Fluffy </TD><TD> 1995-05-15 </TD><TD> litter </TD><TD> 4 kittens, 3 female, 1 male
</TR NOSAVE>
<TR><TD>Buffy </TD><TD> 1993-06-23 </TD><TD> litter </TD><TD> 5 puppies, 2 female, 3 male
</TR NOSAVE>
<TR><TD>Buffy </TD><TD> 1994-06-19 </TD><TD> litter </TD><TD> 3 puppies, 3 female
</TR NOSAVE>
<TR><TD>Chirpy </TD><TD> 1999-03-21 </TD><TD> vet </TD><TD> needed beak straightened
</TR NOSAVE>
<TR><TD>Slim </TD><TD> 1997-08-03 </TD><TD> vet </TD><TD> broken rib
</TR NOSAVE>
<TR><TD>Bowser </TD><TD> 1991-10-12 </TD><TD> kennel
</TR NOSAVE>
<TR><TD>Fang </TD><TD> 1991-10-12 </TD><TD> kennel
</TR NOSAVE>
<TR><TD>Fang </TD><TD> 1998-08-28 </TD><TD> birthday </TD><TD> Gave him a new chew toy
</TR NOSAVE>
<TR><TD>Claws </TD><TD> 1998-03-17 </TD><TD> birthday </TD><TD> Gave him a new flea collar
</TR NOSAVE>
<TR><TD>Whistler </TD><TD> 1998-12-09 </TD><TD> birthday </TD><TD> First birthday
</TR>
</TABLE>

<P>
Load the records like this:

</P>

<PRE>
mysql&#62; LOAD DATA LOCAL INFILE "event.txt" INTO TABLE event;
</PRE>

<P>
Based on what you've learned from the queries you've run on the <CODE>pet</CODE>
table, you should be able to perform retrievals on the records in the
<CODE>event</CODE> table; the principles are the same.  But when is the
<CODE>event</CODE> table by itself insufficient to answer questions you might ask?

</P>
<P>
Suppose you want to find out the ages of each pet when they had their
litters.  The <CODE>event</CODE> table indicates when this occurred, but to
calculate age of the mother, you need her birth date.  Since that is
stored in the <CODE>pet</CODE> table, you need both tables for the query:

</P>

<PRE>
mysql&#62; SELECT pet.name, (TO_DAYS(date) - TO_DAYS(birth))/365 AS age, remark
    -&#62; FROM pet, event
    -&#62; WHERE pet.name = event.name AND type = "litter";
+--------+------+-----------------------------+
| name   | age  | remark                      |
+--------+------+-----------------------------+
| Fluffy | 2.27 | 4 kittens, 3 female, 1 male |
| Buffy  | 4.12 | 5 puppies, 2 female, 3 male |
| Buffy  | 5.10 | 3 puppies, 3 female         |
+--------+------+-----------------------------+
</PRE>

<P>
There are several things to note about this query:

</P>

<UL>
<LI>

The <CODE>FROM</CODE> clause lists two tables since the query needs to pull
information from both of them.

<LI>

When combining (joining) information from multiple tables, you need to
specify how records in one table can be matched to records in the other.
This is easy since they both have a <CODE>name</CODE> column.  The query uses
<CODE>WHERE</CODE> clause to match up records in the two tables based on the
<CODE>name</CODE> values.

<LI>

Since the <CODE>name</CODE> column occurs in both tables, you must be specific
about which table you mean when referring to the column.  This is done
by prepending the table name to the column name.
</UL>

<P>
You need not have two different tables to perform a join.  Sometimes it is
useful to join a table to itself, if you want to compare records in a table
to other records in that same table.  For example, to find breeding pairs
among your pets, you can join the <CODE>pet</CODE> table with itself to pair up
males and females of like species:

</P>

<PRE>
mysql&#62; SELECT p1.name, p1.sex, p2.name, p2.sex, p1.species
    -&#62; FROM pet AS p1, pet AS p2
    -&#62; WHERE p1.species = p2.species AND p1.sex = "f" AND p2.sex = "m";
+--------+------+--------+------+---------+
| name   | sex  | name   | sex  | species |
+--------+------+--------+------+---------+
| Fluffy | f    | Claws  | m    | cat     |
| Buffy  | f    | Fang   | m    | dog     |
| Buffy  | f    | Bowser | m    | dog     |
+--------+------+--------+------+---------+
</PRE>

<P>
In this query, we specify aliases for the table name in order to be able
to refer to the columns and keep straight which instance of the table
each column reference is associated with.

</P>


<H2><A NAME="Getting_information" HREF="manual_toc.html#Getting_information">8.5  Getting information about databases and tables</A></H2>

<P>
What if you forget the name of a database or table, or what the structure of
a given table is (e.g., what its columns are called)?  <STRONG>MySQL</STRONG>
addresses this problem through several statements that provide information
about the databases and tables it supports.

</P>
<P>
You have already seen <CODE>SHOW DATABASES</CODE>, which lists the databases
managed by the server.  To find out which database is currently selected,
use the <CODE>DATABASE()</CODE> function:

</P>

<PRE>
mysql&#62; SELECT DATABASE();
+------------+
| DATABASE() |
+------------+
| menagerie  |
+------------+
</PRE>

<P>
If you haven't selected any database yet, the result is blank.

</P>
<P>
To find out what tables the current database contains (for example, when
you're not sure about the name of a table), use this command:

</P>

<PRE>
mysql&#62; SHOW TABLES;
+---------------------+
| Tables in menagerie |
+---------------------+
| event               |
| pet                 |
+---------------------+
</PRE>

<P>
If you want to find out about the structure of a table, the <CODE>DESCRIBE</CODE>
command is useful; it displays information about each of a table's columns:

</P>

<PRE>
mysql&#62; DESCRIBE pet;
+---------+-------------+------+-----+---------+-------+
| Field   | Type        | Null | Key | Default | Extra |
+---------+-------------+------+-----+---------+-------+
| name    | varchar(20) | YES  |     | NULL    |       |
| owner   | varchar(20) | YES  |     | NULL    |       |
| species | varchar(20) | YES  |     | NULL    |       |
| sex     | char(1)     | YES  |     | NULL    |       |
| birth   | date        | YES  |     | NULL    |       |
| death   | date        | YES  |     | NULL    |       |
+---------+-------------+------+-----+---------+-------+
</PRE>

<P>
<CODE>Field</CODE> indicates the column name, <CODE>Type</CODE> is the data type for
the column, <CODE>Null</CODE> indicates whether or not the column can contain
<CODE>NULL</CODE> values, <CODE>Key</CODE> indicates whether or not the column is
indexed and <CODE>Default</CODE> specifies the column's default value.

</P>
<P>
If you have indexes on a table,
<CODE>SHOW INDEX FROM tbl_name</CODE> produces information about them.

</P>


<H2><A NAME="Batch_mode" HREF="manual_toc.html#Batch_mode">8.6  Using <CODE>mysql</CODE> in batch mode</A></H2>

<P>
In the previous sections, you used <CODE>mysql</CODE> interactively to enter
queries and view the results.  You can also run <CODE>mysql</CODE> in batch
mode.  To do this, put the commands you want to run in a file, then
tell <CODE>mysql</CODE> to read its input from the file:

</P>

<PRE>
shell&#62; mysql &#60; batch-file
</PRE>

<P>
If you need to specify connection parameters on the command line, the
command might look like this:

</P>

<PRE>
shell&#62; mysql -h host -u user -p &#60; batch-file
Enter password: ********
</PRE>

<P>
When you use <CODE>mysql</CODE> this way, you are creating a script file, then
executing the script.

</P>
<P>
Why use a script?  Here are a few reasons:

</P>

<UL>
<LI>

If you run a query repeatedly (say, every day or every week), making it a
script allows you to avoid retyping it each time you execute it.

<LI>

You can generate new queries from existing ones that are similar by copying
and editing script files.

<LI>

Batch mode can also be useful while you're developing a query, particularly
for multiple-line commands or multiple-statement sequences of commands.  If
you make a mistake, you don't have to retype everything.  Just edit your
script to correct the error, then tell <CODE>mysql</CODE> to execute it again.

<LI>

If you have a query that produces a lot of output, you can run the output
through a pager rather than watching it scroll off the top of your screen:


<PRE>
shell&#62; mysql &#60; batch-file | more
</PRE>

<LI>

You can catch the output in a file for further processing:


<PRE>
shell&#62; mysql &#60; batch-file &#62; mysql.out
</PRE>

<LI>

You can distribute your script to other people so they can run the commands,
too.

<LI>

Some situations do not allow for interactive use, for example, when you run
a query from a <CODE>cron</CODE> job.  In this case, you must use batch mode.
</UL>

<P>
The default output format is different (more concise) when you run
<CODE>mysql</CODE> in batch mode than when you use it interactively.  For
example, the output of <CODE>SELECT DISTINCT species FROM pet</CODE> looks like
this when run interactively:

</P>

<PRE>
+---------+
| species |
+---------+
| bird    |
| cat     |
| dog     |
| hamster |
| snake   |
+---------+
</PRE>

<P>
But like this when run in batch mode:

</P>

<PRE>
species
bird
cat
dog
hamster
snake
</PRE>

<P>
If you want to get the interactive output format in batch mode, use
<CODE>mysql -t</CODE>.  To echo to the output the commands that are executed, use
<CODE>mysql -vvv</CODE>.

</P>


<H2><A NAME="Twin" HREF="manual_toc.html#Twin">8.7  Queries from twin project</A></H2>

<P>
At Analytikerna and Lentus, we have been doing the systems and field work
for a big research project. This project is a collaboration between the
Institute of Environmental Medicine at Karolinska Institutet Stockholm
and the Section on Clinical Research in Aging and Psychology at the
University of Southern California.

</P>
<P>
The project involves a screening part where all twins in Sweden older
than 65 years are interviewed by telephone. Twins who meet certain
criteria are passed on to the next stage. In this latter stage, twins who
want to participate are visited by a doctor/nurse team. Some of the
examinations include physical and neuropsychological examination,
laboratory testing, neuroimaging, psychological status assessment, and family
history collection. In addition, data are collected on medical and
environmental risk factors.

</P>
<P>
More information about Twin studies can be found at:

</P>

<PRE>
http://www.imm.ki.se/TWIN/TWINUKW.HTM
</PRE>

<P>
The latter part of the project is administered with a web interface
written using Perl and <STRONG>MySQL</STRONG>.

</P>
<P>
Each night all data from the interviews are moved into a <STRONG>MySQL</STRONG>
database.

</P>



<H3><A NAME="Twin_pool" HREF="manual_toc.html#Twin_pool">8.7.1  Find all non-distributed twins</A></H3>

<P>
The following query is used to determine who goes into the second part of the
project:

</P>

<PRE>
select
        concat(p1.id, p1.tvab) + 0 as tvid,
        concat(p1.christian_name, " ", p1.surname) as Name,
        p1.postal_code as Code,
        p1.city as City,
        pg.abrev as Area,
        if(td.participation = "Aborted", "A", " ") as A,
        p1.dead as dead1,
        l.event as event1,
        td.suspect as tsuspect1,
        id.suspect as isuspect1,
        td.severe as tsevere1,
        id.severe as isevere1,
        p2.dead as dead2,
        l2.event as event2,
        h2.nurse as nurse2,
        h2.doctor as doctor2,
        td2.suspect as tsuspect2,
        id2.suspect as isuspect2,
        td2.severe as tsevere2,
        id2.severe as isevere2,
        l.finish_date
from
        twin_project as tp
        /* For Twin 1 */
        left join twin_data as td on tp.id = td.id and tp.tvab = td.tvab
        left join informant_data as id on tp.id = id.id and tp.tvab = id.tvab
        left join harmony as h on tp.id = h.id and tp.tvab = h.tvab
        left join lentus as l on tp.id = l.id and tp.tvab = l.tvab
        /* For Twin 2 */
        left join twin_data as td2 on p2.id = td2.id and p2.tvab = td2.tvab
        left join informant_data as id2 on p2.id = id2.id and p2.tvab = id2.tvab
        left join harmony as h2 on p2.id = h2.id and p2.tvab = h2.tvab
        left join lentus as l2 on p2.id = l2.id and p2.tvab = l2.tvab,
        person_data as p1,
        person_data as p2,
        postal_groups as pg
where
        /* p1 gets main twin and p2 gets his/her twin. */
        /* ptvab is a field inverted from tvab */
        p1.id = tp.id and p1.tvab = tp.tvab and
        p2.id = p1.id and p2.ptvab = p1.tvab and
        /* Just the sceening survey */
        tp.survey_no = 5 and
        /* Skip if partner died before 65 but allow emigration (dead=9) */
        (p2.dead = 0 or p2.dead = 9 or
         (p2.dead = 1 and
          (p2.death_date = 0 or
           (((to_days(p2.death_date) - to_days(p2.birthday)) / 365)
            &#62;= 65))))
        and
        (
        /* Twin is suspect */
        (td.future_contact = 'Yes' and td.suspect = 2) or
        /* Twin is suspect - Informant is Blessed */
        (td.future_contact = 'Yes' and td.suspect = 1 and id.suspect = 1) or
        /* No twin - Informant is Blessed */
        (ISNULL(td.suspect) and id.suspect = 1 and id.future_contact = 'Yes') or
        /* Twin broken off - Informant is Blessed */
        (td.participation = 'Aborted'
         and id.suspect = 1 and id.future_contact = 'Yes') or
        /* Twin broken off - No inform - Have partner */
        (td.participation = 'Aborted' and ISNULL(id.suspect) and p2.dead = 0))
        and
        l.event = 'Finished'
        /* Get at area code */
        and substring(p1.postal_code, 1, 2) = pg.code
        /* Not already distributed */
        and (h.nurse is NULL or h.nurse=00 or h.doctor=00)
        /* Has not refused or been aborted */
        and not (h.status = 'Refused' or h.status = 'Aborted'
        or h.status = 'Died' or h.status = 'Other')
order by
        tvid;
</PRE>

<P>
Some explanations:
<DL COMPACT>

<DT><CODE>concat(p1.id, p1.tvab) + 0 as tvid</CODE>
<DD>
We want to sort on the concatenated <CODE>id</CODE> and <CODE>tvab</CODE> in
numerical order. Adding <CODE>0</CODE> to the result causes <STRONG>MySQL</STRONG> to
treat the result as a number.
<DT>column <CODE>id</CODE>
<DD>
This identifies a pair of twins. It is a key in all tables.
<DT>column <CODE>tvab</CODE>
<DD>
This identifies a twin in a pair. It has a value of <CODE>1</CODE> or <CODE>2</CODE>.
<DT>column <CODE>ptvab</CODE>
<DD>
This is an inverse of <CODE>tvab</CODE>. When <CODE>tvab</CODE> is <CODE>1</CODE> this is
<CODE>2</CODE>, and vice versa. It exists to save typing and to make it easier for
<STRONG>MySQL</STRONG> to optimize the query.
</DL>

<P>
This query demonstrates, among other things, how to do lookups on a
table from the same table with a join (<CODE>p1</CODE> and <CODE>p2</CODE>). In the example, this
is used to check whether a twin's partner died before the age of 65. If so,
the row is not returned.

</P>
<P>
All of the above exist in all tables with twin-related information. We
have a key on both <CODE>id,tvab</CODE> (all tables) and <CODE>id,ptvab</CODE>
(<CODE>person_data</CODE>) to make queries faster.

</P>
<P>
On our production machine (A 200MHz UltraSPARC), this query returns
about 150-200 rows and takes less than one second.

</P>
<P>
The current number of records in the tables used above:
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><STRONG>Table</STRONG> </TD><TD> <STRONG>Rows</STRONG>
</TR NOSAVE>
<TR><TD><CODE>person_data</CODE> </TD><TD> 71074
</TR NOSAVE>
<TR><TD><CODE>lentus</CODE> </TD><TD> 5291
</TR NOSAVE>
<TR><TD><CODE>twin_project</CODE> </TD><TD> 5286
</TR NOSAVE>
<TR><TD><CODE>twin_data</CODE> </TD><TD> 2012
</TR NOSAVE>
<TR><TD><CODE>informant_data</CODE> </TD><TD> 663
</TR NOSAVE>
<TR><TD><CODE>harmony</CODE> </TD><TD> 381
</TR NOSAVE>
<TR><TD><CODE>postal_groups</CODE> </TD><TD> 100
</TR>
</TABLE>

</P>


<H3><A NAME="Twin_event" HREF="manual_toc.html#Twin_event">8.7.2  Show a table on twin pair status</A></H3>

<P>
Each interview ends with a status code called <CODE>event</CODE>. The query
shown below is used to display a table over all twin pairs combined by
event. This indicates in how many pairs both twins are finished, in how many
pairs one twin is finished and the other refused, and so on.

</P>

<PRE>
select
        t1.event,
        t2.event,
        count(*)
from
        lentus as t1,
        lentus as t2,
        twin_project as tp
where
        /* We are looking at one pair at a time */
        t1.id = tp.id
        and t1.tvab=tp.tvab
        and t1.id = t2.id
        /* Just the sceening survey */
        and tp.survey_no = 5
        /* This makes each pair only appear once */
        and t1.tvab='1' and t2.tvab='2'
group by
        t1.event, t2.event;

</PRE>

<P>
<A NAME="IDX603"></A>


<H1><A NAME="Server" HREF="manual_toc.html#Server">9  MySQL server functions</A></H1>

<P>
<A NAME="IDX604"></A>
<A NAME="IDX605"></A>


<H2><A NAME="Languages" HREF="manual_toc.html#Languages">9.1  What languages are supported by MySQL?</A></H2>

<P>
<CODE>mysqld</CODE> can issue error messages in the following languages: Czech,
Dutch, English (the default), Estonia, French, German, Hungarian, Italian,
Norwegian, Norwegian-ny, Polish, Portuguese, Spanish and Swedish.

</P>
<P>
To start <CODE>mysqld</CODE> with a particular language, use either the
<CODE>--language=lang</CODE> or <CODE>-L lang</CODE> options. For example:

</P>

<PRE>
shell&#62; mysqld --language=swedish
</PRE>

<P>
or:

</P>

<PRE>
shell&#62; mysqld --language=/usr/local/share/swedish
</PRE>

<P>
Note that all language names are specified in lowercase.

</P>
<P>
The language files are located (by default) in
<TT>`<VAR>mysql_base_dir</VAR>/share/<VAR>LANGUAGE</VAR>/'</TT>.

</P>
<P>
To update the error message file, you should edit the <TT>`errmsg.txt'</TT> file
and execute the following command to generate the <TT>`errmsg.sys'</TT> file:

</P>

<PRE>
shell&#62; comp_err errmsg.txt errmsg.sys
</PRE>

<P>
If you upgrade to a newer version of <STRONG>MySQL</STRONG>, remember to repeat
your changes with the new <TT>`errmsg.txt'</TT> file.

</P>



<H3><A NAME="Character_sets" HREF="manual_toc.html#Character_sets">9.1.1  The character set used for data and sorting</A></H3>

<P>
By default, <STRONG>MySQL</STRONG> uses the ISO-8859-1 (Latin1) character
set. This is the character set used in the USA and western Europe.

</P>
<P>
The character set determines what characters are allowed in names and how
things are sorted by the <CODE>ORDER BY</CODE> and <CODE>GROUP BY</CODE> clauses of
the <CODE>SELECT</CODE> statement.

</P>
<P>
You can change the character set at compile time by using the
<CODE>--with-charset=charset</CODE> option to <CODE>configure</CODE>.
See section <A HREF="manual.html#Quick_install">4.7.1  Quick installation overview</A>.

</P>
<P>
To add another character set to <STRONG>MySQL</STRONG>, use the following procedure:

</P>


<H3><A NAME="Adding_character_set" HREF="manual_toc.html#Adding_character_set">9.1.2  Adding a new character set</A></H3>


<OL>
<LI>

Choose a name for the character set, denoted <CODE>MYSET</CODE> below.

<LI>

Create the file
<TT>`strings/ctype-MYSET.c'</TT> in the <STRONG>MySQL</STRONG> source distribution.

<LI>

Look at one of the existing <TT>`ctype-*.c'</TT> files to see what needs to be
defined. Note that the arrays in your file must have names like
<CODE>ctype_MYSET</CODE>, <CODE>to_lower_MYSET</CODE> and so on.

<CODE>to_lower[]</CODE> and <CODE>to_upper[]</CODE> are simple arrays that hold the
lowercase and uppercase characters corresponding to each member of the
character set.  For example:


<PRE>
to_lower['A'] should contain 'a'
to_upper['a'] should contain 'A'
</PRE>

<CODE>sort_order[]</CODE> is a map indicating how characters should be ordered for
comparison and sorting purposes.  For many character sets, this is the same as
<CODE>to_upper[]</CODE> (which means sorting will be case insensitive).
<STRONG>MySQL</STRONG> will sort characters based on the value of
<CODE>sort_order[character]</CODE>.

<CODE>ctype[]</CODE> is an array of bit values, with one element for one character.
(Note that <CODE>to_lower[]</CODE>, <CODE>to_upper[]</CODE> and <CODE>sort_order[]</CODE>
are indexed by character value, but <CODE>ctype[]</CODE> is indexed by character
value + 1.  This is an old legacy to be able to handle EOF.)
You can find the following bitmask definitions in <TT>`m_ctype.h'</TT>:


<PRE>
#define _U      01      /* Upper case */
#define _L      02      /* Lower case */
#define _N      04      /* Numeral (digit) */
#define _S      010     /* Spacing character */
#define _P      020     /* Punctuation */
#define _C      040     /* Control character */
#define _B      0100    /* Blank */
#define _X      0200    /* heXadecimal digit */
</PRE>

The <CODE>ctype[]</CODE> entry for each character should be the union of the
applicable bitmask values that describe the character.
For example, <CODE>'A'</CODE> is an uppercase character (<CODE>_U</CODE>) as well as a
hexadecimal digit (<CODE>_X</CODE>), so <CODE>ctype['A'+1]</CODE> should contain the value:

<PRE>
_U + _X = 01 + 0200 = 0201
</PRE>

<LI>

Add a unique number for your character set to <TT>`include/m_ctype.h.in'</TT>.

<LI>

Add the character set name to the <CODE>CHARSETS_AVAILABLE</CODE> list in
<CODE>configure.in</CODE>.

<LI>

Reconfigure, recompile and test.
</OL>

<P>
<A NAME="IDX606"></A>


<H3><A NAME="Multi-byte_characters" HREF="manual_toc.html#Multi-byte_characters">9.1.3  Multi-byte character support</A></H3>

<P>
If you are creating a multi-byte character set, you can use the
<CODE>_MB</CODE> macros.  In <TT>`include/m_ctype.h.in'</TT>, add:

</P>

<PRE>
#define MY_CHARSET_MYSET  X
#if MY_CHARSET_CURRENT == MY_CHARSET_MYSET
#define USE_MB
#define USE_MB_IDENT
#define ismbchar(p, end)  (...)
#define ismbhead(c)       (...)
#define mbcharlen(c)      (...)
#define MBMAXLEN          N
#endif
</PRE>

<P>
Where:

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><CODE>MY_CHARSET_MYSET</CODE> </TD><TD> A unique character set value.
</TR NOSAVE>
<TR><TD><CODE>USE_MB</CODE> </TD><TD> This character set has multi-byte
characters, handled by <CODE>ismbhead()</CODE> and <CODE>mbcharlen()</CODE>
</TR NOSAVE>
<TR><TD><CODE>USE_MB_IDENT</CODE> </TD><TD> (optional) If defined, you can use table and
column names that use multi-byte characters
</TR NOSAVE>
<TR><TD><CODE>ismbchar(p, e)</CODE> </TD><TD> return 0 if <CODE>p</CODE> is not a multi-byte
character string, or the size of the character (in bytes) if it is.  <CODE>p</CODE>
and <CODE>e</CODE> point to the beginning and end of the string.
Check from <CODE>(char*)p</CODE> to <CODE>(char*)e-1</CODE>.
</TR NOSAVE>
<TR><TD><CODE>ismbhead(c)</CODE> </TD><TD> True if <CODE>c</CODE> is the first character of
a multi-byte character string
</TR NOSAVE>
<TR><TD><CODE>mbcharlen(c)</CODE> </TD><TD> Size of a multi-byte character string if
<CODE>c</CODE> is the first character of such a string
</TR NOSAVE>
<TR><TD><CODE>MBMAXLEN</CODE> </TD><TD> Size in bytes of the largest character in
the set
</TR>
</TABLE>

<P>
<A NAME="IDX607"></A>


<H2><A NAME="Update_log" HREF="manual_toc.html#Update_log">9.2  The update log</A></H2>

<P>
When started with the <CODE>--log-update=file_name</CODE> option, <CODE>mysqld</CODE>
writes a log file containing all SQL commands that update data. The file is
written in the data directory and has a name of <CODE>file_name.#</CODE>, where
<CODE>#</CODE> is a number that is incremented each time you execute
<CODE>mysqladmin refresh</CODE> or <CODE>mysqladmin flush-logs</CODE>, the <CODE>FLUSH
LOGS</CODE> statement, or restart the
server.

</P>
<P>
If you use the <CODE>--log</CODE> or <CODE>-l</CODE> options, <CODE>mysqld</CODE> writes a
general log with a filename of <TT>`hostname.log'</TT>, and restarts and
refreshes do not cause a new log file to be generated (although it is closed
and reopened). By default, the <CODE>mysql.server</CODE> script starts the
<STRONG>MySQL</STRONG> server with the <CODE>-l</CODE> option.  If you need better
performance when you start using <STRONG>MySQL</STRONG> in a production environment,
you can remove the <CODE>-l</CODE> option from <CODE>mysql.server</CODE>.

</P>
<P>
Update logging is smart since it logs only statements that really update
data. So an <CODE>UPDATE</CODE> or a <CODE>DELETE</CODE> with a <CODE>WHERE</CODE> that finds no
rows is not written to the log. It even skips <CODE>UPDATE</CODE> statements that
set a column to the value it already has.

</P>
<P>
If you want to update a database from update log files, you could do the
following (assuming your update logs have names of the form
<TT>`file_name.#'</TT>):

</P>

<PRE>
shell&#62; ls -1 -t -r file_name.[0-9]* | xargs cat | mysql
</PRE>

<P>
<CODE>ls</CODE> is used to get all the log files in the right order.

</P>
<P>
This can be useful if you have to revert to backup files after a crash
and you want to redo the updates that occurred between the time of the backup
and the crash.

</P>
<P>
<A NAME="IDX608"></A>
<A NAME="IDX609"></A>
<A NAME="IDX610"></A>
<A NAME="IDX611"></A>
You can also use the update logs when you have a mirrored database on
another host and you want to replicate the changes that have been made
to the master database.

</P>
<P>
<A NAME="IDX612"></A>
<A NAME="IDX613"></A>


<H2><A NAME="Table_size" HREF="manual_toc.html#Table_size">9.3  How big MySQL tables can be</A></H2>

<P>
<STRONG>MySQL</STRONG> 3.22 has a 4G limit on table size. With the new MyISAM in
<STRONG>MySQL</STRONG> 3.23 the maximum table size is pushed up to 8 million terabytes
(2 ^ 63 bytes).

</P>
<P>
Note however that operating systems have their own file size limits.  On
Linux, the current limit is 2G; on Solaris 2.5.1, the limit is 4G; on
Solaris 2.6, the limit is 1000G.  This means that the table size for 
<STRONG>MySQL</STRONG> is normally limited by the operating system.

</P>
<P>
By default, <STRONG>MySQL</STRONG> tables have a maximum size of about 4G.  You can
check the maximum table size for a table with the <CODE>SHOW TABLE STATUS</CODE>
command or with the <CODE>myisamchk -dv table_name</CODE>.
See section <A HREF="manual.html#SHOW">7.21  <CODE>SHOW</CODE> syntax (Get information about tables, columns,...)</A>.

</P>
<P>
If you need bigger tables than 4G (and your operating system supports
this), you should set the <CODE>AVG_ROW_LENGTH</CODE> and <CODE>MAX_ROWS</CODE>
parameter when you create your table.  See section <A HREF="manual.html#CREATE_TABLE">7.7  <CODE>CREATE TABLE</CODE> syntax</A>.  You can
also set these later with <CODE>ALTER TABLE</CODE>. See section <A HREF="manual.html#ALTER_TABLE">7.8  <CODE>ALTER TABLE</CODE> syntax</A>.

</P>
<P>
If your big table is going to be read-only, you could use
<CODE>myisampack</CODE> to merge and compress many tables to one.
<CODE>myisampack</CODE> usually compresses a table by at least 50%, so you can
have, in effect, much bigger tables.  See section <A HREF="manual.html#myisampack">12.5  The MySQL compressed read-only table generator</A>.

</P>
<P>
Another solution can be the included MERGE library, which allows you to
handle a collection of identical tables as one.  (Identical in this case
means that all tables are created with identical column information.)
Currently MERGE can only be used to scan a collection of tables because it
doesn't support indexes. We will add indexes to this in the near future.

</P>
<P>
<A NAME="IDX614"></A>
<A NAME="IDX615"></A>
<A NAME="IDX616"></A>
<A NAME="IDX617"></A>


<H2><A NAME="Table_types" HREF="manual_toc.html#Table_types">9.4  MySQL table types</A></H2>

<P>
With MySQL you can currently (version 3.23.6) choose between tree basic
table formats. When you create a new table, you can tell <STRONG>MySQL</STRONG>
which table type it should use for the table.  <STRONG>MySQL</STRONG> will
always create a <CODE>.frm</CODE> file to hold the table and column
definitions.  Depending on the table type the index and data will be
stored in other files.

</P>
<P>
You can convert tables between different types with the <CODE>ALTER
TABLE</CODE> statement. See section <A HREF="manual.html#ALTER_TABLE">7.8  <CODE>ALTER TABLE</CODE> syntax</A>.

</P>
<DL COMPACT>

<DT>@bullet{<CODE>MyISAM</CODE>}
<DD>
<CODE>MyISAM</CODE> is the default table type in <STRONG>MySQL</STRONG> 3.23. It's
based on the <CODE>ISAM</CODE> code and has a lot of useful extensions.

The index is stored in a file with the <CODE>.MYI</CODE> (MYindex) extension
and the data is stored in file with the <CODE>.MYD</CODE> (MYData) extension.
You can check/repair <CODE>MyISAM</CODE> tables with the <CODE>myisamchk</CODE>
utility. See section <A HREF="manual.html#Crash_recovery">13.4  Using <CODE>myisamchk</CODE> for crash recovery</A>.

The following is new in <CODE>MyISAM</CODE>:


<UL>
<LI>

One can <CODE>INSERT</CODE> new rows in a table without deleted rows,
at the same times as other threads are reading from the table.
<LI>

Supports for big files (63 bit) on filesystems/operating systems that
support big files.
<LI>

All data are stored with low byte first. This makes the data machine and
OS independent. The only requirement is that the machine uses 2
complement signed integers (as every machine for the last 20 years has)
and IEEE floating point format (also totally dominant among mainstream
machines). The only area of machines that may not support binary
compatibility are embedded systems (since they sometimes have peculiar
processors).
<LI>

All number keys are stored with high byte first to give better index
compression.
<LI>

Internal handling of one <CODE>AUTO_INCREMENT</CODE> column. <CODE>MyISAM</CODE>
will automatically update this on <CODE>INSERT/UPDATE</CODE>. The
<CODE>AUTO_INCREMENT</CODE> value can be reset with <CODE>myisamchk</CODE>. This
will make <CODE>AUTO_INCREMENT</CODE> columns faster and old numbers will not
be reused as with the old ISAM. Note that when a <CODE>AUTO_INCREMENT</CODE>
is defined on the end of a multi-part-key the old behavior is still present.
<LI>

<CODE>BLOB</CODE> and <CODE>TEXT</CODE> columns can be indexed.
<LI>

<CODE>NULL</CODE> values are allowed in indexed columns.  This takes 0-1
bytes/key.
<LI>

Maximum key length is now 500 bytes by default. In cases of keys longer
than 250 bytes, a bigger key block size than the default of 1024 bytes
is used for this key.
<LI>

Maximum number of keys/table enlarged to 32 as default. This can be
enlarged to 64 without having to recompile <CODE>myisamchk</CODE>.
<LI>

There is a flag in the <CODE>MyISAM</CODE> file that indicates whether or not the
table was closed correctly.  This will soon be used for automatic repair
in the <STRONG>MySQL</STRONG> server.
<LI>

<CODE>myisamchk</CODE> will now mark tables as checked. <CODE>myisamchk
--fast</CODE> will only check those tables that don't have this mark.
<LI>

<CODE>myisamchk -a</CODE> stores statistics for key parts (and not only for
whole keys as in <CODE>ISAM</CODE>).
<LI>

Dynamic size rows will now be much less fragmented when mixing deletes
with updates and inserts.  This is done by automatically combining adjacent
deleted blocks and by extending blocks if the next block is deleted.
<LI>

<CODE>myisampack</CODE> can pack <CODE>BLOB</CODE> and <CODE>VARCHAR</CODE> columns.
</UL>

<CODE>MyISAM</CODE> also supports the following things, which <STRONG>MySQL</STRONG>
will be able to use in the near future.


<UL>
<LI>

Support for a true <CODE>VARCHAR</CODE> type; A <CODE>VARCHAR</CODE> column starts
with a length stored in 2 bytes.
<LI>

Tables with <CODE>VARCHAR</CODE> may have fixed or dynamic record length.
<LI>

<CODE>VARCHAR</CODE> and <CODE>CHAR</CODE> may be up to 64K.
All key segments have their own language definition. This will enable
<STRONG>MySQL</STRONG> to have different language definitions per column.
<LI>

A hashed computed index can be used for <CODE>UNIQUE</CODE>; This will allow
you to have <CODE>UNIQUE</CODE> on any combination of columns in a table. (You
can't search on a <CODE>UNIQUE</CODE> computed index, however.)
</UL>

You can also use the deprecated ISAM table type. This will disappear in
rather soon since <CODE>MyISAM</CODE> is a better implementation of the same
thing. ISAM uses a <CODE>B-tree</CODE> index. The index is stored in a file
with the <CODE>.ISM</CODE> extension and the data is stored in file with the
<CODE>.ISD</CODE> extension.  You can check/repair ISAM tables with the
<CODE>isamchk</CODE> utility. See section <A HREF="manual.html#Crash_recovery">13.4  Using <CODE>myisamchk</CODE> for crash recovery</A>. ISAM tables are not
binary portable across OS/Platforms.

<CODE>ISAM</CODE> has the following features/properties:


<UL>
<LI>Compressed and fixed length keys

<LI>Fixed and dynamic record length

<LI>16 keys with 16 key parts / key

<LI>Max key length 256 (default)

<LI>Data is stored in machine format;  Fast but is machine/OS dependent.

</UL>

<DT>@bullet{<CODE>HEAP</CODE>}
<DD>
<CODE>HEAP</CODE> tables use a hashed index and are stored in memory.  This
makes them very fast, but if <STRONG>MySQL</STRONG> crashes you will lose all
data stored in them.  <CODE>HEAP</CODE> is very usable as temporary tables!


<PRE>
CREATE TABLE test TYPE=HEAP SELECT ip,SUM(downloads) as down
        FROM log_table GROUP BY ip;
SELECT COUNT(ip),AVG(down) FROM test;
DROP TABLE test;
</PRE>

Here are some things you should consider when you use <CODE>HEAP</CODE> tables:


<UL>
<LI>

You should always use specify <CODE>MAX_ROWS</CODE> in the <CODE>CREATE</CODE> statement 
to ensure that you accidently do not use all memory.
<LI>

Indexes will only be used with <CODE>=</CODE> and <CODE>&#60;=&#62;</CODE> (but are VERY fast).
<LI>

<CODE>HEAP</CODE> tables uses a fixed record length format.
<LI>

<CODE>HEAP</CODE> doesn't support <CODE>BLOB</CODE>/<CODE>TEXT</CODE> columns.
<LI>

<CODE>HEAP</CODE> doesn't support <CODE>AUTO_INCREMENT</CODE> columns.
<LI>

<CODE>HEAP</CODE> doesn't support an index on a <CODE>NULL</CODE> column.
<LI>

You can have non-unique keys in a <CODE>HEAP</CODE> table (not that normal
with hashed tables).
<LI>

<CODE>HEAP</CODE> tables are shared between all clients (just like any other
table).
<LI>

Data for <CODE>HEAP</CODE> tables are allocated in small blocks. The tables
are 100% dynamic (on inserting). No overflow areas and no extra key
space is needed.  Deleted rows are put in a linked list and will be
reused when you insert new data into the table.
<LI>

To free memory, you should execute <CODE>DELETE FROM heap_table</CODE> or
<CODE>DROP TABLE heap_table</CODE>.
<LI>

To ensure that you accidentally don't do anything stupid, you can't create
<CODE>HEAP</CODE> tables bigger than <CODE>max_heap_table_size</CODE>.
</UL>

</DL>

<P>
<A NAME="IDX618"></A>
<A NAME="IDX619"></A>


<H1><A NAME="Performance" HREF="manual_toc.html#Performance">10  Getting maximum performance from MySQL</A></H1>

<P>
Optimization is a complicated task since it ultimately requires
understanding of the whole system. While it may be possible to do some
local optimizations with small knowledge of your system/application, the
more optimal you want your system to become the more you will have to
know about it.

</P>
<P>
So this chapter will try to explain and give some examples of different
ways to optimize MySQL. But remember that there are always some
(increasingly harder) ways to make the system even faster left to do.

</P>



<H2><A NAME="Optimize_Basics" HREF="manual_toc.html#Optimize_Basics">10.1  Optimization overview</A></H2>

<P>
The most important part for getting a system fast is of course the basic
design. You also need to know that kinds of things your system will be
doing. That is your bottlenecks are.

</P>
<P>
The most common bottlenecks are.

<UL>
<LI>Disk seeks

It takes time for the disk to find a piece of data. With modern disk in
1999 the mean time for this is usually lower than 10ms. So we can in
theory do about 1000 seeks a second. This time improves slowly with new
disks and is very hard to optimize for a single table. The way to
optimize this is to spread the data on more than one disk.
<LI>Disk reading/writing

When the disk is at the correct position we need to read the data. With
modern disks in 1999 one disks delivers something like 10-20Mb/s. This
is easier to optimize than seeks since you can read in parallel from
multiple disks.
<LI>CPU cycles

When we have got the data into main memory (or if it already where
there) we need to process it to get to our result. When we have small
tables compared to the memory this is the most common limiting
factor. But then with small tables speed is usually not the problem.
<LI>Memory bandwidth

When the CPU needs more data than that fits in the cpu cache the main
memory bandwidth becomes a bottleneck. This is a uncommoon bottleneck
for most systems but one should be aware of it.
</UL>



<H2><A NAME="System" HREF="manual_toc.html#System">10.2  System/Compile time and startup parameter tuning</A></H2>

<P>
We start with the system level things sine some of these decisions have
to be made very early. In other cases a fast look at this part may
suffice since it not that important for the big gains. But it is always
nice to have a feeling about how much one gould gain by chancing things
at this level.

</P>
<P>
The default OS to use is really important!  To get the most use of
multiple CPU machines one should use Solaris (because the threads works
really nice) or Linux (because the 2.2 kernel has really good SMP
support). Also on 32bit machines Linux has a 2G file size limit by
default. Hopefully this will be fixed soon when new filesystems is
released (XFS).

</P>
<P>
Since we have not run production MySQL on that many platforms we advice
you to test your intended platform before choosing it if possible.

</P>
<P>
Other tips:

<UL>
<LI>

If you have enough ram, you could remove all swap devices. Some
operating systems will use a SWAP device in some contexts even if you
have free memory.
<LI>

Use the <CODE>--skip-locking</CODE> <STRONG>MySQL</STRONG> option to avoid external
locking. Note that this will not impact <STRONG>MySQL</STRONG> functionality as
long that only run one server. Just remember to take down the server (or
lock relevant parts) before you run <CODE>myisamchk</CODE>. On some system
this switch is mandatory since the external locking does not work in any
case.

The <CODE>--skip-locking</CODE> option is on by default when compiling with
MIT-pthreads, because <CODE>flock()</CODE> isn't fully supported by
MIT-pthreads on all platforms.

The only case when you can't use <CODE>--skip-locking</CODE> is if you run
multiple <STRONG>MySQL</STRONG> SERVERS (not clients) on the same data. Or run
<CODE>myisamchk</CODE> on the table without first flushing and locking the
<CODE>mysqld</CODE> server tables first.

You can still use <CODE>LOCK TABLES</CODE> / <CODE>UNLOCK TABLES</CODE> even if you
are using <CODE>--skip-locking</CODE>
</UL>



<H3><A NAME="Compile_and_link_options" HREF="manual_toc.html#Compile_and_link_options">10.2.1  How compiling and linking affects the speed of MySQL</A></H3>

<P>
Most of the following tests are done on Linux and with the
<STRONG>MySQL</STRONG> benchmarks, but they should give some indication for
other operating systems and workloads.

</P>
<P>
You get the fastest executable when you link with <CODE>-static</CODE>. Using Unix
sockets rather than TCP/IP to connect to a database also gives better
performance.

</P>
<P>
On Linux, you will get the fastest code when compiling with <CODE>pgcc</CODE>
and <CODE>-O6</CODE>. To compile <TT>`sql_yacc.cc'</TT> with these options, you
need about 200M memory because <CODE>gcc/pgcc</CODE> needs a lot of memory to
make all functions inline. You should also set <CODE>CXX=gcc</CODE> when
configuring <STRONG>MySQL</STRONG> to avoid inclusion of the <CODE>libstdc++</CODE>
library (it is not needed).

</P>
<P>
By just using a better compiler and/or better compiler options you can
get a 10-30 % speed increase in your application.  This is particularly
important if you compile the SQL server yourselves!  

</P>
<P>
On Intel you should for example use pgcc or the Cygnus CodeFusion compiler
to get maximum speed. We have tested the new Fujitsu compiler but it is
not yet bug free enough to compile MySQL with optimizations on.

</P>
<P>
Here is a list of some mesurements that we have done:

<UL>
<LI>

If you use <CODE>pgcc</CODE> and compile everything with <CODE>-O6</CODE>, the
<CODE>mysqld</CODE> server is 11% faster than with <CODE>gcc</CODE> versions
older than <CODE>gcc</CODE> 2.95.2.

<LI>

If you link dynamically (without <CODE>-static</CODE>), the result is 13%
slower.  Note that you still can use a dynamic linked MySQL library. It
is only the server that is critical for performance.

<LI>

If you connect using TCP/IP rather than Unix sockets, the result is 7.5%
slower.

<LI>

On a Sun SPARCstation 10, <CODE>gcc</CODE> 2.7.3 is 13% faster than Sun Pro C++ 4.2.

<LI>

On Solaris 2.5.1, MIT-pthreads is 8-12% slower than Solaris native
threads on a single processor. With more load/cpus the difference should
get bigger.
</UL>

<P>
The <STRONG>MySQL</STRONG>-Linux distribution provided by TcX is compiled with
<CODE>pgcc</CODE> and linked statically.

</P>


<H3><A NAME="Disk_issues" HREF="manual_toc.html#Disk_issues">10.2.2  Disk issues</A></H3>


<UL>
<LI>

As mentioned before disks seeks are a big performance bottleneck. This
problems gets more and more apparent when the data starts to grow so
large that effective caching becomes impossible. For large databases,
where you access data more or less random, you can count on that you
will need at least one disk seek to read and a couple of disk seeks to
write things. To minimize this problem use disks with low seek times.
<LI>

To increase the number of available disk spindles (and thereby reduce
the seek overhead) it is possible to either symlink files to different
disks or stripe the disks.
<DL COMPACT>

<DT><STRONG>Using symbolic links</STRONG>
<DD>
This means that you symlink the index or/and data file(s) from the
normal data directory to another disk (that may also be striped). This
makes both the seek and read times better (if the disk are not used for
other things). See section <A HREF="manual.html#Symbolic_links">10.2.2.1  Using symbolic links for databases and tables</A>.
<DT><STRONG>Striping</STRONG>
<DD>
Striping means that you have many disks and put the first block on the
first disk, the second block on the second disk, and the Nth on the (Nth
mod number_of_disks) disk, and so on. This means if your normal data
size is less than the stripe size (or perfectly aligned) you will get
much better performance. Note that striping if very dependent on the OS
and stripe-size. So benchmark your application with different
stripe-sizes. See section <A HREF="manual.html#Benchmarks">10.8  Using your own benchmarks</A>.

Note that the speed difference for striping is <STRONG>very</STRONG> dependent
on the parameters. Depending on how you set the striping parameters and
number of disks you may get difference in orders of magnitude. Note that
you have to choose to optimize for random or sequential access.
</DL>
<LI>

For reliability you may want to use RAID 0+1 (striping + mirroring), but
in this case you will need 2*N drives to hold N drives of data. This is
probably the best option if you have the money for it!  You may however
also have to invest in some volume management software to handle it
efficiently.
<LI>

A good option is to have semi-important data (that can be re-generated)
on RAID 0 disk while store really important data (like host information
and logs) on a RAID 0+1 or RAID N disks. RAID N can be a problem if you
have many writes because of the time to update the parity bits.
<LI>

You may also set the parameters for the file system that the database
uses. One easy change is to mount the file system with the noatime
option. That makes it skip the updating of the last access time in the
inode and by this will avoid some disk seeks.
</UL>



<H4><A NAME="Symbolic_links" HREF="manual_toc.html#Symbolic_links">10.2.2.1  Using symbolic links for databases and tables</A></H4>

<P>
You can move tables and databases from the database directory to other
locations and replace them with symbolic links to the new locations.
You might want to do this, for example, to move a database to a file
system with more free space.

</P>
<P>
If <STRONG>MySQL</STRONG> notices that a table is a symbolically-linked, it will
resolve the symlink and use the table it points to instead. This works
on all systems that support the <CODE>realpath()</CODE> call (at least Linux
and Solaris support <CODE>realpath()</CODE>)!  On systems that don't support
<CODE>realpath()</CODE>, you should not access the table through the real path
and through the symlink at the same time!  If you do, the table will be
inconsistent after any update.

</P>
<P>
<STRONG>MySQL</STRONG> doesn't support linking of databases by default.  Things
will work fine as long as you don't make a symbolic link between
databases.  Suppose you have a database <CODE>db1</CODE> under the
<STRONG>MySQL</STRONG> data directory, and then make a symlink <CODE>db2</CODE> that
points to <CODE>db1</CODE>:

</P>

<PRE>
shell&#62; cd /path/to/datadir
shell&#62; ln -s db1 db2
</PRE>

<P>
Now, for any table <CODE>tbl_a</CODE> in <CODE>db1</CODE>, there also appears to be
a table <CODE>tbl_a</CODE> in <CODE>db2</CODE>.  If one thread updates <CODE>db1.tbl_a</CODE>
and another thread updates <CODE>db2.tbl_a</CODE>, there will be problems.

</P>
<P>
If you really need this, you must change the following code in
<TT>`mysys/mf_format.c'</TT>:

</P>

<PRE>
if (!lstat(to,&#38;stat_buff))  /* Check if it's a symbolic link */
    if (S_ISLNK(stat_buff.st_mode) &#38;& realpath(to,buff))
</PRE>

<P>
Change the code to this:

</P>

<PRE>
if (realpath(to,buff))
</PRE>

<P>
<A NAME="IDX620"></A>


<H3><A NAME="Server_parameters" HREF="manual_toc.html#Server_parameters">10.2.3  Tuning server parameters</A></H3>

<P>
You can get the default buffer sizes used by the <CODE>mysqld</CODE> server
with this command:

</P>

<PRE>
shell&#62; mysqld --help
</PRE>

<P>
This command produces a list of all <CODE>mysqld</CODE> options and configurable
variables. The output includes the default values and looks something
like this:

</P>

<PRE>
Possible variables for option --set-variable (-O) are:
back_log              current value: 5
connect_timeout       current value: 5
delayed_insert_timeout  current value: 300
delayed_insert_limit  current value: 100
delayed_queue_size    current value: 1000
flush_time            current value: 0
interactive_timeout   current value: 28800
join_buffer_size      current value: 131072
key_buffer_size       current value: 1048540
lower_case_table_names  current value: 0
long_query_time       current value: 10
max_allowed_packet    current value: 1048576
max_connections       current value: 100
max_connect_errors    current value: 10
max_delayed_threads   current value: 20
max_heap_table_size   current value: 16777216
max_join_size         current value: 4294967295
max_sort_length       current value: 1024
max_tmp_tables        current value: 32
max_write_lock_count  current value: 4294967295
net_buffer_length     current value: 16384
query_buffer_size     current value: 0
record_buffer         current value: 131072
sort_buffer           current value: 2097116
table_cache           current value: 64
thread_concurrency    current value: 10
tmp_table_size        current value: 1048576
thread_stack          current value: 131072
wait_timeout          current value: 28800
</PRE>

<P>
If there is a <CODE>mysqld</CODE> server currently running, you can see what
values it actually is using for the variables by executing this command:

</P>

<PRE>
shell&#62; mysqladmin variables
</PRE>

<P>
Each option is described below. Values for buffer sizes, lengths and stack
sizes are given in bytes.  You can specify values with a suffix of <SAMP>`K'</SAMP>
or <SAMP>`M'</SAMP> to indicate kilobytes or megabytes. For example, <CODE>16M</CODE>
indicates 16 megabytes.  Case of suffix letters does not matter;
<CODE>16M</CODE> and <CODE>16m</CODE> are equivalent.

</P>
<P>
You can also see some statistics from a running server by the command
<CODE>SHOW STATUS</CODE>. See section <A HREF="manual.html#SHOW">7.21  <CODE>SHOW</CODE> syntax (Get information about tables, columns,...)</A>.

</P>
<DL COMPACT>

<DT><CODE><CODE>ansi_mode</CODE>.</CODE>
<DD>
Is <CODE>ON</CODE> if <CODE>mysqld</CODE> was started with <CODE>--ansi</CODE>.
See section <A HREF="manual.html#Ansi_mode">5.2  Runnning MySQL in ANSI mode</A>.

<DT><CODE><CODE>back_log</CODE></CODE>
<DD>
The number of outstanding connection requests <STRONG>MySQL</STRONG> can have. This
comes into play when the main <STRONG>MySQL</STRONG> thread gets <STRONG>VERY</STRONG>
many connection requests in a very short time. It then takes some time
(although very little) for the main thread to check the connection and start
a new thread. The <CODE>back_log</CODE> value indicates how many requests can be
stacked during this short time before <STRONG>MySQL</STRONG> momentarily stops
answering new requests. You need to increase this only if you expect a large
number of connections in a short period of time.

In other words, this value is the size of the listen queue for incoming
TCP/IP connections.  Your operating system has its own limit on the size
of this queue.  The manual page for the Unix <CODE>listen(2)</CODE> system
call should have more details.  Check your OS documentation for the
maximum value for this variable.  Attempting to set <CODE>back_log</CODE>
higher than your operating system limit will be ineffective.

<DT><CODE><CODE>concurrent_inserts</CODE></CODE>
<DD>
If <CODE>ON</CODE> (the default), <CODE>MySQL</CODE> will allow you to use <CODE>INSERT</CODE>
on <CODE>MyISAM</CODE> tables at the same time as you run <CODE>SELECT</CODE> queries
on them.  You can turn this option off by starting mysqld with <CODE>--safe</CODE>
or <CODE>--skip-new</CODE>.

<DT><CODE><CODE>connect_timeout</CODE></CODE>
<DD>
The number of seconds the <CODE>mysqld</CODE> server is waiting for a connect
packet before responding with <CODE>Bad handshake</CODE>.

<DT><CODE><CODE>delayed_insert_timeout</CODE></CODE>
<DD>
How long a <CODE>INSERT DELAYED</CODE> thread should wait for <CODE>INSERT</CODE>
statements before terminating.

<DT><CODE><CODE>delayed_insert_limit</CODE></CODE>
<DD>
After inserting <CODE>delayed_insert_limit</CODE> rows, the <CODE>INSERT
DELAYED</CODE> handler will check if there are any <CODE>SELECT</CODE> statements
pending. If so, it allows these to execute before continuing.

<DT><CODE><CODE>delay_key_write</CODE></CODE>
<DD>
If enabled (is on by default), MySQL will honor the
<CODE>delay_key_write</CODE> option <CODE>CREATE TABLE</CODE>.  This means that the
key buffer for tables with this option will not get flushed on every
index update, but only when a table is closed.  This will speed up
writes on keys a lot but you should add automatic checking of all tables
with <CODE>myisamchk --fast --force</CODE> if you use this.  Note that if you
start <CODE>mysqld</CODE> with the <CODE>--delay-key-write_for_all_tables</CODE>
option this means that all tables will be threaded as if they where
created with the <CODE>delay_key_write</CODE> option.  You can clear this flag
by starting <CODE>mysqld</CODE> with <CODE>--skip-new</CODE> or <CODE>--safe-mode</CODE>.

<DT><CODE><CODE>delayed_queue_size</CODE></CODE>
<DD>
How big a queue (in rows) should be allocated for handling <CODE>INSERT DELAYED</CODE>.
If the queue becomes full, any client that does <CODE>INSERT DELAYED</CODE> will wait until
there is room in the queue again.

<DT><CODE><CODE>flush_time</CODE></CODE>
<DD>
If this is set to a non-zero value, then every <CODE>flush_time</CODE> seconds all
tables will be closed (to free up resources and sync things to disk).

<DT><CODE><CODE>init_file</CODE></CODE>
<DD>
The name of the file specified with the <CODE>--init-file</CODE> option when
you start the server.  This is a file of SQL statements you want the
server to execute when it starts.

<DT><CODE><CODE>interactive_timeout</CODE></CODE>
<DD>
The number of seconds the server waits for activity on a interactive 
connection before closing it.  An interactive client is defined as a
client that uses the <CODE>CLIENT_INTERACTIVE</CODE> option to
<CODE>mysql_real_connect()</CODE>.  See also <CODE>wait_timeout</CODE>.

<DT><CODE><CODE>join_buffer_size</CODE></CODE>
<DD>
The size of the buffer that is used for full joins (joins that do not
use indexes).  The buffer is allocated one time for each full join
between two tables. Increase this value to get a faster full join when
adding indexes is not possible. (Normally the best way to get fast joins
is to add indexes.)

<DT><CODE><CODE>key_buffer_size</CODE></CODE>
<DD>
Index blocks are buffered and are shared by all threads.
<CODE>key_buffer_size</CODE> is the size of the buffer used for index blocks.

Increase this get better index handling (for all reads and multiple
writes) to as much as you can afford.  If you make this too big the
system will starte to page and go REAL slow. Remember that since <STRONG>MySQL</STRONG>
does not cache data read that you will have to leave some room for the
OS filesystem cache.

To get even more speed when writing many rows at the same time use
<CODE>LOCK TABLES</CODE>.  See section <A HREF="manual.html#LOCK_TABLES">7.24  <CODE>LOCK TABLES/UNLOCK TABLES</CODE> syntax</A>.

<DT><CODE><CODE>long_query_time</CODE></CODE>
<DD>
If a query takes longer than this (in seconds), the <CODE>Slow_queries</CODE> counter
will be incremented.

<DT><CODE><CODE>max_allowed_packet</CODE></CODE>
<DD>
The maximum size of one packet. The message buffer is initialized to
<CODE>net_buffer_length</CODE> bytes, but can grow up to <CODE>max_allowed_packet</CODE>
bytes when needed.  This value by default is small to catch big (possibly
wrong) packets.  You must increase this value if you are using big
<CODE>BLOB</CODE> columns. It should be as big as the biggest <CODE>BLOB</CODE> you want
to use.

<DT><CODE><CODE>max_connections</CODE></CODE>
<DD>
The number of simultaneous clients allowed. Increasing this value increases
the number of file descriptors that <CODE>mysqld</CODE> requires.  See below for
comments on file descriptor limits. See section <A HREF="manual.html#Too_many_connections">18.2.4  <CODE>Too many connections</CODE> error</A>.

<DT><CODE><CODE>max_connect_errors</CODE></CODE>
<DD>
If there is more than this number of interrupted connections from a host
this host will be blocked for further connections.  You can unblock a host
with the command <CODE>FLUSH HOSTS</CODE>.

<DT><CODE><CODE>max_delayed_threads</CODE></CODE>
<DD>
Don't start more than this number of threads to handle <CODE>INSERT DELAYED</CODE>
statements.  If you try to insert data in a new table after all <CODE>INSERT
DELAYED</CODE> threads are in use, the row will be inserted as if the
<CODE>DELAYED</CODE> attribute wasn't specified.

<DT><CODE><CODE>max_join_size</CODE></CODE>
<DD>
Joins that are probably going to read more than <CODE>max_join_size</CODE>
records return an error. Set this value if your users tend to perform joins
without a <CODE>WHERE</CODE> clause that take a long time and return
millions of rows.

<DT><CODE><CODE>max_sort_length</CODE></CODE>
<DD>
The number of bytes to use when sorting <CODE>BLOB</CODE> or <CODE>TEXT</CODE>
values (only the first <CODE>max_sort_length</CODE> bytes of each value
are used; the rest are ignored).

<DT><CODE><CODE>max_tmp_tables</CODE></CODE>
<DD>
(This option doesn't yet do anything).
Maximum number of temporary tables a client can keep open at the same time.

<DT><CODE><CODE>net_buffer_length</CODE></CODE>
<DD>
The communication buffer is reset to this size between queries. This
should not normally be changed, but if you have very little memory, you
can set it to the expected size of a query.  (That is, the expected length of
SQL statements sent by clients.  If statements exceed this length, the buffer
is automatically enlarged, up to <CODE>max_allowed_packet</CODE> bytes.)

<DT><CODE><CODE>net_retry_count</CODE></CODE>
<DD>
If a read on a communication port is interrupted, retry this many times
before giving up.  This value should be quite high on <CODE>FreeBSD</CODE> as
internal interrupts is sent to all threads.

<DT><CODE><CODE>record_buffer</CODE></CODE>
<DD>
Each thread that does a sequential scan allocates a buffer of this
size for each table it scans. If you do many sequential scans, you may
want to increase this value.

<DT><CODE><CODE>skip_show_databases</CODE></CODE>
<DD>
This prevents people from doing <CODE>SHOW DATABASES</CODE>, if they don't
have the <CODE>PROCESS_PRIV</CODE> privilege. This can improve security if
you're concerned about people being able to see what databases and
tables other users have.

<DT><CODE><CODE>sort_buffer</CODE></CODE>
<DD>
Each thread that needs to do a sort allocates a buffer of this
size. Increase this value for faster <CODE>ORDER BY</CODE> or <CODE>GROUP BY</CODE>
operations.
See section <A HREF="manual.html#Temporary_files">18.5  Where MySQL stores temporary files</A>.

<DT><CODE><CODE>table_cache</CODE></CODE>
<DD>
The number of open tables for all threads. Increasing this value increases
the number of file descriptors that <CODE>mysqld</CODE> requires.  <STRONG>MySQL</STRONG>
needs two file descriptors for each unique open table.  See below for
comments on file descriptor limits.  For information about how the table
cache works, see section <A HREF="manual.html#Table_cache">10.2.4  How MySQL opens and closes tables</A>.

<DT><CODE><CODE>tmp_table_size</CODE></CODE>
<DD>
If a temporary table exceeds this size, <STRONG>MySQL</STRONG> generates an error of
the form <CODE>The table tbl_name is full</CODE>. Increase the value of
<CODE>tmp_table_size</CODE> if you do many advanced <CODE>GROUP BY</CODE> queries.

<DT><CODE><CODE>thread_concurrency</CODE></CODE>
<DD>
On Solaris, <CODE>mysqld</CODE> will call <CODE>thr_setconcurrency()</CODE> with
this value.  <CODE>thr_setconcurrency()</CODE> permits the application to give
the threads system a hint, for the desired number of threads that should
be run at the same time.

<DT><CODE><CODE>thread_stack</CODE></CODE>
<DD>
The stack size for each thread.  Many of the limits detected by the
<CODE>crash-me</CODE> test are dependent on this value. The default is
large enough for normal operation.  See section <A HREF="manual.html#Benchmarks">10.8  Using your own benchmarks</A>.

<DT><CODE><CODE>wait_timeout</CODE></CODE>
<DD>
The number of seconds the server waits for activity on a connection before
closing it. See also <CODE>interactive_timeout</CODE>.
</DL>

<P>
<STRONG>MySQL</STRONG> uses algorithms that are very scalable, so you can usually
run with very little memory or give <STRONG>MySQL</STRONG> more memory to get
better performance.

</P>
<P>
If you have much memory and many tables and want maximum
performance with a moderate number of clients, you should use something
like this:

</P>

<PRE>
shell&#62; safe_mysqld -O key_buffer=16M -O table_cache=128 \
           -O sort_buffer=4M -O record_buffer=1M &#38;
</PRE>

<P>
If you have little memory and lots of connections, use something like this:

</P>

<PRE>
shell&#62; safe_mysqld -O key_buffer=512k -O sort_buffer=100k \
           -O record_buffer=100k &#38;
</PRE>

<P>
or even:

</P>

<PRE>
shell&#62; safe_mysqld -O key_buffer=512k -O sort_buffer=16k \
           -O table_cache=32 -O record_buffer=8k -O net_buffer=1K &#38;
</PRE>

<P>
If there are very many connections, ``swapping problems'' may occur unless
<CODE>mysqld</CODE> has been configured to use very little memory for each
connection. <CODE>mysqld</CODE> performs better if you have enough memory for all
connections, of course.

</P>
<P>
Note that if you change an option to <CODE>mysqld</CODE>, it remains in effect only
for that instance of the server.

</P>
<P>
To see the effects of a parameter change, do something like this:

</P>

<PRE>
shell&#62; mysqld -O key_buffer=32m --help
</PRE>

<P>
Make sure that the <CODE>--help</CODE> option is last; otherwise, the effect of any
options listed after it on the command line will not be reflected in the
output.

</P>
<P>
<A NAME="IDX621"></A>
<A NAME="IDX622"></A>


<H3><A NAME="Table_cache" HREF="manual_toc.html#Table_cache">10.2.4  How MySQL opens and closes tables</A></H3>

<P>
<CODE>table_cache</CODE>, <CODE>max_connections</CODE> and <CODE>max_tmp_tables</CODE>
affect the maximum number of files the server keeps open.  If you
increase one or both of these values, you may run up against a limit
imposed by your operating system on the per-process number of open file
descriptors.  However, you can increase the limit on many systems.
Consult your OS documentation to find out how to do this, because the
method for changing the limit varies widely from system to system.

</P>
<P>
<CODE>table_cache</CODE> is related to <CODE>max_connections</CODE>.
For example, for 200 open connections, you should have a table cache of
at least <CODE>200 * n</CODE>, where <CODE>n</CODE> is the maximum number of tables in
a join.

</P>
<P>
The cache of open tables can grow to a maximum of <CODE>table_cache</CODE>
(default 64; this can be changed with with the <CODE>-O table_cache=#</CODE>
option to <CODE>mysqld</CODE>).  A table is never closed, except when the
cache is full and another thread tries to open a table or if you use
<CODE>mysqladmin refresh</CODE> or <CODE>mysqladmin flush-tables</CODE>.

</P>
<P>
When the table cache fills up, the server uses the following procedure
to locate a cache entry to use:

</P>

<UL>
<LI>

Tables that are not currently in use are released, in least-recently-used
order.

<LI>

If the cache is full and no tables can be released, but a new table needs to
be opened, the cache is temporarily extended as necessary.

<LI>

If the cache is in a temporarily-extended state and a table goes from in-use
to not-in-use state, it is closed and released from the cache.
</UL>

<P>
A table is opened for each concurrent access. This means that
if you have two threads accessing the same table or access the table
twice in the same query (with <CODE>AS</CODE>) the table needs to be opened twice.
The first open of any table takes two file descriptors; each additional
use of the table takes only one file descriptor.  The extra descriptor
for the first open is used for the index file; this descriptor is shared
among all threads.

</P>


<H3><A NAME="Creating_many_tables" HREF="manual_toc.html#Creating_many_tables">10.2.5  Drawbacks of creating large numbers of tables in the same database</A></H3>

<P>
If you have many files in a directory, open, close and create operations will
be slow.  If you execute <CODE>SELECT</CODE> statements on many different tables,
there will be a little overhead when the table cache is full, because for
every table that has to be opened, another must be closed. You can reduce
this overhead by making the table cache larger.

</P>


<H3><A NAME="Open_tables" HREF="manual_toc.html#Open_tables">10.2.6  Why so many open tables?</A></H3>

<P>
When you run <CODE>mysqladmin status</CODE>, you'll see something like this:

</P>

<PRE>
Uptime: 426 Running threads: 1 Questions: 11082 Reloads: 1 Open tables: 12
</PRE>

<P>
This can be somewhat perplexing if you only have 6 tables.

</P>
<P>
<STRONG>MySQL</STRONG> is multithreaded, so it may have many queries on the same
table simultaneously. To minimize the problem with two threads having
different states on the same file, the table is opened independently by
each concurrent thread. This takes some memory and one extra file
descriptor for the data file. The index file descriptor is shared
between all threads.

</P>
<P>
<A NAME="IDX623"></A>


<H3><A NAME="Memory_use" HREF="manual_toc.html#Memory_use">10.2.7  How MySQL uses memory</A></H3>

<P>
The list below indicates some of the ways that the <CODE>mysqld</CODE> server
uses memory.  Where applicable, the name of the server variable relevant
to the memory use is given.

</P>

<UL>
<LI>

The key buffer (variable <CODE>key_buffer_size</CODE>) is shared by all
threads; Other buffers used by the server are allocated as
needed. See section <A HREF="manual.html#Server_parameters">10.2.3  Tuning server parameters</A>.

<LI>

Each connection uses some thread specific space; A stack (default 64K,
variable <CODE>thread_stack</CODE>) a connection buffer (variable
<CODE>net_buffer_length</CODE>), and a result buffer (variable
<CODE>net_buffer_length</CODE>). The connection buffer and result buffer are
dynamically enlarged up to <CODE>max_allowed_packet</CODE> when needed.  When
a query is running a copy of the current query string is also allocated.

<LI>

All threads share the same base memory.

<LI>

Nothing is memory-mapped yet (except compressed tables, but that's
another story). This is because the 32-bit memory space of 4GB is not
large enough for most large tables. When systems with a 64-bit
address-space become more common we may add general support for
memory-mapping.

<LI>

Each request doing a sequential scan over a table allocates a read buffer
(variable <CODE>record_buffer</CODE>).

<LI>

All joins are done in one pass and most joins can be done without even
using a temporary table. Most temporary tables are memory-based (HEAP)
tables.  Temporary tables with a big record length (calculated as the
sum of all column lengths) or that contain <CODE>BLOB</CODE> columns are
stored on disk.  

One problem in <STRONG>MySQL</STRONG> versions before 3.23.2 is that if a HEAP table
exceeds the size of <CODE>tmp_table_size</CODE>, you get the error <CODE>The
table tbl_name is full</CODE>. In newer versions this is handled by
automatically changing the in-memory (HEAP) table to a disk-based
(MyISAM) table as necessary. To work around this problem, you can
increase the temporary table size by setting the <CODE>tmp_table_size</CODE>
option to <CODE>mysqld</CODE>, or by setting the SQL option
<CODE>SQL_BIG_TABLES</CODE> in the client program.  See section <A HREF="manual.html#SET_OPTION">7.25  <CODE>SET OPTION</CODE> syntax</A>. In <STRONG>MySQL</STRONG> 3.20, the maximum size of the
temporary table was <CODE>record_buffer*16</CODE>, so if you are using this
version, you have to increase the value of <CODE>record_buffer</CODE>. You can
also start <CODE>mysqld</CODE> with the <CODE>--big-tables</CODE> option to always
store temporary tables on disk, however, this will affect the speed of
many complicated queries.

<LI>

Most requests doing a sort allocate a sort buffer and one or two temporary
files. See section <A HREF="manual.html#Temporary_files">18.5  Where MySQL stores temporary files</A>.

<LI>

Almost all parsing and calculating is done in a local memory store. No
memory overhead is needed for small items and the normal slow memory
allocation and freeing is avoided. Memory is allocated only for
unexpectedly large strings (this is done with <CODE>malloc()</CODE> and
<CODE>free()</CODE>).

<LI>

Each index file is opened once and the data file is opened once for each
concurrently-running thread. For each concurrent thread, a table structure,
column structures for each column, and a buffer of size <CODE>3 * n</CODE> is
allocated (where <CODE>n</CODE> is the maximum row length, not counting <CODE>BLOB</CODE>
columns). A <CODE>BLOB</CODE> uses 5 to 8 bytes plus the length of the <CODE>BLOB</CODE>
data.

<LI>

For each table having <CODE>BLOB</CODE> columns, a buffer is enlarged dynamically
to read in larger <CODE>BLOB</CODE> values. If you scan a table, a buffer as large
as the largest <CODE>BLOB</CODE> value is allocated.

<LI>

Table handlers for all in-use tables are saved in a cache and managed as a
FIFO. Normally the cache has 64 entries. If a table has been used by two
running threads at the same time, the cache contains two entries for the
table.
See section <A HREF="manual.html#Table_cache">10.2.4  How MySQL opens and closes tables</A>.

<LI>

A <CODE>mysqladmin flush-tables</CODE> command closes all tables that are not in
use and marks all in-use tables to be closed when the currently executing
thread finishes. This will effectively free most in-use memory.
</UL>

<P>
<CODE>ps</CODE> and other system status programs may report that <CODE>mysqld</CODE>
uses a lot of memory. This may be caused by thread-stacks on different
memory addresses. For example, the Solaris version of <CODE>ps</CODE> counts
the unused memory
between stacks as used memory. You can verify this by checking available
swap with <CODE>swap -s</CODE>. We have tested <CODE>mysqld</CODE> with commercial
memory-leakage detectors, so there should be no memory leaks.

</P>


<H3><A NAME="Internal_locking" HREF="manual_toc.html#Internal_locking">10.2.8  How MySQL locks tables</A></H3>

<P>
All locking in <STRONG>MySQL</STRONG> is deadlock-free.  This is managed by always
requesting all needed locks at once at the beginning of a query and always
locking the tables in the same order.

</P>
<P>
The locking method <STRONG>MySQL</STRONG> uses for <CODE>WRITE</CODE> locks works as follows:

</P>

<UL>
<LI>

If there are no locks on the table, put a write lock on it.
<LI>

Otherwise, put the lock request in the write lock queue.
</UL>

<P>
The locking method <STRONG>MySQL</STRONG> uses for <CODE>READ</CODE> locks works as follows:

</P>

<UL>
<LI>

If there are no write locks on the table, put a read lock on it.
<LI>

Otherwise, put the lock request in the read lock queue.
</UL>

<P>
When a lock is released, the lock is made available to the threads
in the write lock queue, then to the threads in the read lock queue.

</P>
<P>
This means that if you have many updates on a table, <CODE>SELECT</CODE>
statements will wait until there are no more updates.

</P>
<P>
To work around this for the case where you want to do many <CODE>INSERT</CODE> and
<CODE>SELECT</CODE> operations on a table, you can insert rows in a temporary
table and update the real table with the records from the temporary table
once in a while.

</P>
<P>
This can be done with the following code:

<PRE>
mysql&#62; LOCK TABLES real_table WRITE, insert_table WRITE;
mysql&#62; insert into real_table select * from insert_table;
mysql&#62; delete from insert_table;
mysql&#62; UNLOCK TABLES;
</PRE>

<P>
You can use the <CODE>LOW_PRIORITY</CODE> options with <CODE>INSERT</CODE> if you
want to prioritize retrieval in some specific cases.  See section <A HREF="manual.html#INSERT">7.14  <CODE>INSERT</CODE> syntax</A>.

</P>
<P>
You could also change the locking code in <TT>`mysys/thr_lock.c'</TT> to use a
single queue.  In this case, write locks and read locks would have the same
priority, which might help some applications.

</P>


<H3><A NAME="Table_locking" HREF="manual_toc.html#Table_locking">10.2.9  Table locking issues</A></H3>

<P>
The table locking code in <STRONG>MySQL</STRONG> is deadlock free.

</P>
<P>
<STRONG>MySQL</STRONG> uses table locking (instead of row locking or column
locking) to achieve a very high lock speed.  For large tables, table
locking is for most applications MUCH better than row locking, but there
are of course some pitfalls.

</P>
<P>
In <STRONG>MySQL</STRONG> 3.23.7 and above, you can insert rows into
<CODE>MyISAM</CODE> tables at the same time as other threads are reading from
the table.  Note that currently this only works if there are no deleted
rows in the table.

</P>
<P>
Table locking enables many threads to read from a table at the same
time, but if a thread wants to write to a table, it must first get
exclusive access.  During the update all others threads that want to
access this particular table will wait until the update is ready.

</P>
<P>
As updates of databases normally are considered to be more important
than <CODE>SELECT</CODE>, all statements that update a table have higher
priority than statements that retrieve information from a table. This
should ensure that updates are not 'starved' because one issues a lot of
heavy queries against a specific table.

</P>
<P>
Starting from <STRONG>MySQL 3.23.7</STRONG> one can use the
<CODE>max_write_lock_count</CODE> variable to force <STRONG>MySQL</STRONG> to issue
a <CODE>SELECT</CODE> after a specific number of inserts on a table. 

</P>
<P>
One main problem with this is the following:

</P>

<UL>
<LI>

A client issues a <CODE>SELECT</CODE> that takes a long time to run.
<LI>

Another client then issues an <CODE>UPDATE</CODE> on a used table;  This client
will wait until the <CODE>SELECT</CODE> is finished
<LI>

Another client issues another <CODE>SELECT</CODE> statement on the same table;  As
<CODE>UPDATE</CODE> has higher priority than <CODE>SELECT</CODE>, this <CODE>SELECT</CODE>
will wait for the <CODE>UPDATE</CODE> to finish.  It will also wait for the first
<CODE>SELECT</CODE> to finish!
</UL>

<P>
Some possible solutions to this problem are:

</P>

<UL>
<LI>

Try to get the <CODE>SELECT</CODE> statements to run faster;  You may have to create
some summary tables to do this.

<LI>

Start <CODE>mysqld</CODE> with <CODE>--low-priority-updates</CODE>.  This will give
all statements that update (modify) a table lower priority than a <CODE>SELECT</CODE>
statement. In this case the last <CODE>SELECT</CODE> statement in the previous
scenario would execute before the <CODE>INSERT</CODE> statement.

<LI>

You can give a specific <CODE>INSERT</CODE>,<CODE>UPDATE</CODE> or <CODE>DELETE</CODE> statement
lower priority with the <CODE>LOW_PRIORITY</CODE> attribute.

<LI>

Start <CODE>mysqld</CODE> with a low value for <STRONG>max_write_lock_count</STRONG> to give
<CODE>READ</CODE> locks after a certain number of <CODE>WRITE</CODE> locks.

<LI>

You can specify that all updates from a specific thread should be done with
low priority by using the SQL command: <CODE>SET SQL_LOW_PRIORITY_UPDATES=1</CODE>.
See section <A HREF="manual.html#SET_OPTION">7.25  <CODE>SET OPTION</CODE> syntax</A>.

<LI>

You can specify that a specific <CODE>SELECT</CODE> is very important with the
<CODE>HIGH_PRIORITY</CODE> attribute. See section <A HREF="manual.html#SELECT">7.12  <CODE>SELECT</CODE> syntax</A>.

<LI>

If you have problems with <CODE>INSERT</CODE> combined with <CODE>SELECT</CODE>,
switch to use the new <CODE>MyISAM</CODE> tables as these supports concurrent
<CODE>SELECT</CODE>s and <CODE>INSERT</CODE>s.

<LI>

If you mainly mix <CODE>INSERT</CODE> and <CODE>SELECT</CODE> statements, the
<CODE>DELAYED</CODE> attribute to <CODE>INSERT</CODE> will probably solve your problems.
See section <A HREF="manual.html#INSERT">7.14  <CODE>INSERT</CODE> syntax</A>.

<LI>

If you have problems with <CODE>SELECT</CODE> and <CODE>DELETE</CODE>, the <CODE>LIMIT</CODE>
option to <CODE>DELETE</CODE> may help. See section <A HREF="manual.html#DELETE">7.11  <CODE>DELETE</CODE> syntax</A>.
</UL>



<H2><A NAME="Data_size" HREF="manual_toc.html#Data_size">10.3  Get your data as small as possible</A></H2>

<P>
One of the most basic optimization is to get your data (and indexes) to
take as little space on the disk (and in memory) as possible. This can
give huge improvements since disk reads are faster and normally less
main memory will also be used. Indexing also takes less resources if
done on smaller columns.

</P>
<P>
You can get better performance on a table and minimize storage space
using the techniques listed below:

</P>

<UL>
<LI>

Use the most efficient (smallest) types possible. <STRONG>MySQL</STRONG> has a
many specialized types that save disk space and memory.
<LI>

Use the smaller integer types if possible to get smaller tables. For
example, <CODE>MEDIUMINT</CODE> is often better than <CODE>INT</CODE>.
<LI>

Declare columns to be <CODE>NOT NULL</CODE> if possible. It makes everything
faster and you save one bit per column. Note that if you really need
<CODE>NULL</CODE> in your application you should definitely use it. Just avoid
haveing it on all columns by default.
<LI>

If you don't have any variable-length columns (<CODE>VARCHAR</CODE>,
<CODE>TEXT</CODE> or <CODE>BLOB</CODE> columns), a fixed-size record format is
used. This is faster but unfortunately may waste some space.
See section <A HREF="manual.html#Choosing_table_type">10.6  Choosing a table type</A>.
<LI>

Each table should have as short as possible primary index. This makes
identification of one row easy and efficient.
<LI>

For each table you have to decide which storage/index method to
use. See section <A HREF="manual.html#Table_types">9.4  MySQL table types</A>. See also See section <A HREF="manual.html#Choosing_table_type">10.6  Choosing a table type</A>.
<LI>

Only create the indexes that you really need. Indexes are good for
retrieval but bad when you need to store things fast. If you mostly
access a table by searching on a combination of columns, make an index
on them. The first index part should be the most used column. If you are
ALWAYS using many columns you should use the column with more duplicates
first to get better compression of the index.
<LI>

If its very likely that an index has unique prefix on the first number
of characters, it's better that only index this prefix. <STRONG>MySQL</STRONG>
supports an index on a part of a character column. Shorter indexes is
faster not only because they take less disk space but also because they
will give you more hits in the index cache and thus fewer disk
seeks. See section <A HREF="manual.html#Server_parameters">10.2.3  Tuning server parameters</A>.
<LI>

In some circumstances it can be beneficial to split a table that is
scanned very often into two. Especially if it is a dynamic format table
and it is possible to a smaller static format table that can be used to
find the relevant rows then scanning.
</UL>



<H2><A NAME="MySQL_indexes" HREF="manual_toc.html#MySQL_indexes">10.4  MySQL index use</A></H2>

<P>
Indexes are used to find find a row with a specific calue on one column
fast. Without a index MySQL has to start with the first record and then
read through the whole table until it find the relevent rows. The bigger
the table the more this costs. If the table has a index for the colums
in question MySQL can get fast a possition to seek to in the middle of
the data file without having to look at all data. If a table have 1000
rows this is at least 100 times faster than reading sequentially. Note
that is you need to access almost all 1000 rows it is faster to read
sequentially since we when avoid disk seeks.

</P>
<P>
All MySQL indexes (<CODE>PRIMARY</CODE>, <CODE>UNIQUE</CODE> and <CODE>INDEX</CODE>) are
stored in B-trees. Strings are automatically prefix- and end-space
compressed. See section <A HREF="manual.html#CREATE_INDEX">7.27  <CODE>CREATE INDEX</CODE> syntax</A>.

</P>
<P>
Indexes are used to:

<UL>
<LI>

Quickly find the rows that match a <CODE>WHERE</CODE> clause.

<LI>

Retrieve rows from other tables when performing joins.

<LI>

Find the <CODE>MAX()</CODE> or <CODE>MIN()</CODE> value for a specific indexed
column.

<LI>

Sort or group a table if the sorting or grouping is done on a leftmost
prefix of a usable key (e.g., <CODE>ORDER BY key_part_1,key_part_2 </CODE>). The
key is read in reverse order if all key parts are followed by <CODE>DESC</CODE>.

<LI>

In some cases a querey can be optimized to retrieve values without
consulting the data file. If all used columns for some table are numeric
and form a leftmost prefix for some key, the values may be retrieved
from the index tree for greater speed.

</UL>

<P>
Suppose you issue the following <CODE>SELECT</CODE> statement:

</P>

<PRE>
mysql&#62; SELECT * FROM tbl_name WHERE col1=val1 AND col2=val2;
</PRE>

<P>
If a multiple-column index exists on <CODE>col1</CODE> and <CODE>col2</CODE>, the
appropriate rows can be fetched directly. If separate single-column
indexes exist on <CODE>col1</CODE> and <CODE>col2</CODE>, the optimizer tries to
find the most restrictive index by deciding which index will find fewer
rows and using that index to fetch the rows.

</P>
<P>
<A NAME="IDX624"></A>
<A NAME="IDX625"></A>
If the table has a multiple-column index, any leftmost prefix of the
index can be used by the optimizer to find rows. For example, if you
have a three-column index on <CODE>(col1,col2,col3)</CODE>, you have indexed
search capabilities on <CODE>(col1)</CODE>, <CODE>(col1,col2)</CODE> and
<CODE>(col1,col2,col3)</CODE>.

</P>
<P>
<STRONG>MySQL</STRONG> can't use a partial index if the columns don't form a
leftmost prefix of the index.  Suppose you have the <CODE>SELECT</CODE>
statements shown below:

</P>

<PRE>
mysql&#62; SELECT * FROM tbl_name WHERE col1=val1;
mysql&#62; SELECT * FROM tbl_name WHERE col2=val2;
mysql&#62; SELECT * FROM tbl_name WHERE col2=val2 AND col3=val3;
</PRE>

<P>
If an index exists on <CODE>(col1,col2,col3)</CODE>, only the first query
shown above uses the index. The second and third queries do involve
indexed columns, but <CODE>(col2)</CODE> and <CODE>(col2,col3)</CODE> are not
leftmost prefixes of <CODE>(col1,col2,col3)</CODE>.

</P>
<P>
<A NAME="IDX626"></A>
<A NAME="IDX627"></A>
<A NAME="IDX628"></A>
<A NAME="IDX629"></A>
<STRONG>MySQL</STRONG> also uses indexes for <CODE>LIKE</CODE> comparisons if the argument
to <CODE>LIKE</CODE> is a constant string that doesn't start with a wildcard
character.  For example, the following <CODE>SELECT</CODE> statements use indexes:

</P>

<PRE>
mysql&#62; select * from tbl_name where key_col LIKE "Patrick%";
mysql&#62; select * from tbl_name where key_col LIKE "Pat%_ck%";
</PRE>

<P>
In the first statement, only rows with <CODE>"Patrick" &#60;= key_col &#60;
"Patricl"</CODE> are considered.  In the second statement, only rows with
<CODE>"Pat" &#60;= key_col &#60; "Pau"</CODE> are considered.

</P>
<P>
The following <CODE>SELECT</CODE> statements will not use indexes:

<PRE>
mysql&#62; select * from tbl_name where key_col LIKE "%Patrick%";
mysql&#62; select * from tbl_name where key_col LIKE other_col;
</PRE>

<P>
In the first statement, the <CODE>LIKE</CODE> value begins with a wildcard character.
In the second statement, the <CODE>LIKE</CODE> value is not a constant.

</P>
<P>
<A NAME="IDX630"></A>
<A NAME="IDX631"></A>
Searching using <CODE>column_name IS NULL</CODE> will use indexes if column_name
is a index.

</P>
<P>
<STRONG>MySQL</STRONG> normally uses the index that finds least number of rows. An
index is used for columns that you compare with the following operators:
<CODE>=</CODE>, <CODE>&#62;</CODE>, <CODE>&#62;=</CODE>, <CODE>&#60;</CODE>, <CODE>&#60;=</CODE>, <CODE>BETWEEN</CODE> and a
<CODE>LIKE</CODE> with a non-wildcard prefix like <CODE>'something%'</CODE>.

</P>
<P>
Any index that doesn't span all <CODE>AND</CODE> levels in the <CODE>WHERE</CODE> clause
is not used to optimize the query.

</P>
<P>
The following <CODE>WHERE</CODE> clauses use indexes:

<PRE>
... WHERE index_part1=1 AND index_part2=2
... WHERE index=1 OR A=10 AND index=2      /* index = 1 OR index = 2 */
... WHERE index_part1='hello' AND index_part_3=5
          /* optimized like "index_part1='hello'" */
</PRE>

<P>
These <CODE>WHERE</CODE> clauses do <STRONG>NOT</STRONG> use indexes:

<PRE>
... WHERE index_part2=1 AND index_part3=2  /* index_part_1 is not used */
... WHERE index=1 OR A=10                  /* No index */
... WHERE index_part1=1 OR index_part2=10  /* No index spans all rows */
</PRE>



<H2><A NAME="Query_Speed" HREF="manual_toc.html#Query_Speed">10.5  Speed of queries that access or update data</A></H2>

<P>
First, one thing that affects all queries: The more complex permission
system setup you have, the more overhead you get. 

</P>
<P>
If you do not have any <CODE>GRANT</CODE> statements done MySQL will optimize
the permission checking somewhat. So if you have a very high volume it
may be worth the time to avoid grants. Otherwise more permission check
results in a larger overhead.

</P>
<P>
If your problem is with some explicit <STRONG>MySQL</STRONG> function, you can
always time this in the <STRONG>MySQL</STRONG> client:

</P>

<PRE>
mysql&#62; select benchmark(1000000,1+1);
+------------------------+
| benchmark(1000000,1+1) |
+------------------------+
|                      0 |
+------------------------+
1 row in set (0.32 sec)
</PRE>

<P>
The above shows that <STRONG>MySQL</STRONG> can execute 1,000,000 <CODE>+</CODE>
expressions in 0.32 seconds on a <CODE>PentiumII 400MHz</CODE>.

</P>
<P>
All <STRONG>MySQL</STRONG> functions should be very optimized, but there may be
some exceptions and the <CODE>benchmark(loop_count,expression)</CODE> is a
great tool to find if this is a problem with your query.

</P>



<H3><A NAME="Estimating_performance" HREF="manual_toc.html#Estimating_performance">10.5.1  Estimating query performance</A></H3>

<P>
In most cases you can estimate the performance by counting disk seeks.
For small tables you can usually find the row in 1 disk seek (as the
index is probably cached).  For bigger tables, you can estimate that,
(using B++ tree indexes), you will need: <CODE>log(row_count) /
log(index_block_length / 3 * 2 / (index_length + data_pointer_length)) +
1</CODE> seeks to find a row.

</P>
<P>
In <STRONG>MySQL</STRONG> an index block is usually 1024 bytes and the data
pointer is usually 4 bytes, which gives for a 500,000 row table with a
index length of 3 (medium integer) gives you:
<CODE>log(500,000)/log(1024/3*2/(3+4)) + 1</CODE> = 4 seeks.

</P>
<P>
As the above index would require about 500,000 * 7 * 3/2 = 5.2M,
(assuming that the index buffers are filled to 2/3 (which is typical)
you will probably have much of the index in memory and you will probably
only need 1-2 calls to read data from the OS to find the row.

</P>
<P>
For writes you will however need 4 seek requests (as above) to find
where to place the new index and normally 2 seeks to update the index
and write the row.

</P>
<P>
Note that the above doesn't mean that your application will slowly
degenerate by N log N!  As long as everything is cached by the OS or SQL
server things will only go marginally slower while the table gets
bigger. After the data gets too big to be cached, things will start to
go much slower until your applications is only bound by disk-seeks
(which increase by N log N). To avoid this increase the index cache as
the data grows. See section <A HREF="manual.html#Server_parameters">10.2.3  Tuning server parameters</A>.

</P>


<H3><A NAME="SELECT_speed" HREF="manual_toc.html#SELECT_speed">10.5.2  Speed of <CODE>SELECT</CODE> queries</A></H3>

<P>
In general, when you want to make a slow <CODE>SELECT ... WHERE</CODE> faster,
the first thing to check is whether or not you can add an
index. See section <A HREF="manual.html#MySQL_indexes">10.4  MySQL index use</A>. All references between different tables
should usually be done with indexes. You can use the <CODE>EXPLAIN</CODE>
command to determine which indexes are used for a <CODE>SELECT</CODE>.
See section <A HREF="manual.html#EXPLAIN">7.22  <CODE>EXPLAIN</CODE> syntax (Get information about a <CODE>SELECT</CODE>)</A>.

</P>
<P>
Some general tips:

</P>

<UL>
<LI>

To help <STRONG>MySQL</STRONG> optimize queries better, run <CODE>myisamchk
--analyze</CODE> on a table after it has been loaded with relevant data. This
updates a value for each index that indicates the average number of rows
that have the same value.  (For unique indexes, this is always 1, of
course.)
<LI>

To sort an index and data according to an index, use <CODE>myisamchk
--sort-index --sort-records=1</CODE> (if you want to sort on index 1). If you
have a unique index from which you want to read all records in order
according to that index, this is a good way to make that faster.  Note
however that this sorting isn't written optimally and will take a long
time for a large table!
</UL>

<P>
<A NAME="IDX632"></A>


<H3><A NAME="Where_optimizations" HREF="manual_toc.html#Where_optimizations">10.5.3  How MySQL optimizes <CODE>WHERE</CODE> clauses</A></H3>

<P>
The where optimizes are put in the <CODE>SELECT</CODE> part here since they
are mostly used there. But the same optimizations are used for there in
<CODE>DELETE</CODE> and <CODE>UPDATE</CODE> statements.

</P>
<P>
Also note that this section is incomplete. <STRONG>MySQL</STRONG> does many
optimizations and we have not had time to document them all.

</P>
<P>
Some of the optimizations performed by <STRONG>MySQL</STRONG> are listed below:

</P>

<UL>
<LI>

Removal of unnecessary parentheses:

<PRE>
   ((a AND b) AND c OR (((a AND b) AND (c AND d))))
-&#62; (a AND b AND c) OR (a AND b AND c AND d)
</PRE>

<LI>

Constant folding:

<PRE>
   (a&#60;b AND b=c) AND a=5
-&#62; b&#62;5 AND b=c AND a=5
</PRE>

<LI>

Constant condition removal (needed because of constant folding):

<PRE>
   (B&#62;=5 AND B=5) OR (B=6 AND 5=5) OR (B=7 AND 5=6)
-&#62; B=5 OR B=6
</PRE>

<LI>

Constant expressions used by indexes are evaluated only once.
<LI>

<CODE>COUNT(*)</CODE> on a single table without a <CODE>WHERE</CODE> is retrieved
directly from the table information.  This is also done for any <CODE>NOT NULL</CODE>
expression when used with only one table.
<LI>

Early detection of invalid constant expressions. <STRONG>MySQL</STRONG> quickly
detects that some <CODE>SELECT</CODE> statements are impossible and returns no rows.
<LI>

<CODE>HAVING</CODE> is merged with <CODE>WHERE</CODE> if you don't use <CODE>GROUP
BY</CODE> or group functions (<CODE>COUNT()</CODE>, <CODE>MIN()</CODE>...)
<LI>

For each sub join, a simpler <CODE>WHERE</CODE> is constructed to get a fast
<CODE>WHERE</CODE> evaluation for each sub join and also to skip records as
soon as possible.
<A NAME="IDX633"></A>
<A NAME="IDX634"></A>
<LI>

All constant tables are read first, before any other tables in the query.
A constant table is:

<UL>
<LI>

An empty table or a table with 1 row.
<LI>

A table that is used with a <CODE>WHERE</CODE> clause on a <CODE>UNIQUE</CODE>
index, or a <CODE>PRIMARY KEY</CODE>, where all index parts are used with constant
expressions and the index parts are defined as <CODE>NOT NULL</CODE>.
</UL>

All the following tables are used as constant tables:

<PRE>
mysql&#62; SELECT * FROM t WHERE primary_key=1;
mysql&#62; SELECT * FROM t1,t2
           WHERE t1.primary_key=1 AND t2.primary_key=t1.id;
</PRE>

<LI>

The best join combination to join the tables is found by trying all
possibilities :(. If all columns in <CODE>ORDER BY</CODE> and in <CODE>GROUP
BY</CODE> come from the same table, then this table is preferred first when
joining.
<LI>

If there is an <CODE>ORDER BY</CODE> clause and a different <CODE>GROUP BY</CODE> clause,
or if the <CODE>ORDER BY</CODE> or <CODE>GROUP BY</CODE>
contains columns from tables other than the first table in the join
queue, a temporary table is created.
<LI>

If you use <CODE>SQL_SMALL_RESULT</CODE>, <STRONG>MySQL</STRONG> will use an in-memory
temporary table.
<LI>

As <CODE>DISTINCT</CODE> is converted to a <CODE>GROUP BY</CODE> on all columns,
<CODE>DISTINCT</CODE> combined with <CODE>ORDER BY</CODE> will in many cases also need
a temporary table.
<LI>

Each table index is queried and the best index that spans fewer than 30% of
the rows is used. If no such index can be found, a quick table scan is used.
<LI>

In some cases, <STRONG>MySQL</STRONG> can read rows from the index without even
consulting the data file.  If all columns used from the index are numeric,
then only the index tree is used to resolve the query.
<LI>

Before each record is output, those that do not match the <CODE>HAVING</CODE> clause
are skipped.
</UL>

<P>
Some examples of queries that are very fast:

</P>

<PRE>
mysql&#62; SELECT COUNT(*) FROM tbl_name;
mysql&#62; SELECT MIN(key_part1),MAX(key_part1) FROM tbl_name;
mysql&#62; SELECT MAX(key_part2) FROM tbl_name
           WHERE key_part_1=constant;
mysql&#62; SELECT ... FROM tbl_name
           ORDER BY key_part1,key_part2,... LIMIT 10;
mysql&#62; SELECT ... FROM tbl_name
           ORDER BY key_part1 DESC,key_part2 DESC,... LIMIT 10;
</PRE>

<P>
The following queries are resolved using only the index tree (assuming
the indexed columns are numeric):

</P>

<PRE>
mysql&#62; SELECT key_part1,key_part2 FROM tbl_name WHERE key_part1=val;
mysql&#62; SELECT COUNT(*) FROM tbl_name
           WHERE key_part1=val1 AND key_part2=val2;
mysql&#62; SELECT key_part2 FROM tbl_name GROUP BY key_part1;
</PRE>

<P>
The following queries use indexing to retrieve the rows in sorted
order without a separate sorting pass:

</P>

<PRE>
mysql&#62; SELECT ... FROM tbl_name ORDER BY key_part1,key_part2,...
mysql&#62; SELECT ... FROM tbl_name ORDER BY key_part1 DESC,key_part2 DESC,...
</PRE>



<H3><A NAME="LEFT_JOIN_optimization" HREF="manual_toc.html#LEFT_JOIN_optimization">10.5.4  How MySQL optimizes <CODE>LEFT JOIN</CODE></A></H3>

<P>
<CODE>A LEFT JOIN B</CODE> is in <STRONG>MySQL</STRONG> implemented as follows

</P>

<UL>
<LI>

The table <CODE>B</CODE> is set to be dependent on table <CODE>A</CODE>.
<LI>

The table <CODE>A</CODE> is set to be dependent on all tables (except <CODE>B</CODE>)
that are used in the <CODE>LEFT JOIN</CODE> condition.
<LI>

All <CODE>LEFT JOIN</CODE> conditions are moved to the <CODE>WHERE</CODE> clause.
<LI>

All standard join optimizations are done, with the exception that a table is
always read after all tables it is dependent on.  If there is a circular
dependence then <STRONG>MySQL</STRONG> will issue an error.
<LI>

All standard <CODE>WHERE</CODE> optimzations are done.
<LI>

If there is a row in <CODE>A</CODE> that matches the <CODE>WHERE</CODE> clause, but there
wasn't any row in <CODE>B</CODE> that matched the <CODE>LEFT JOIN</CODE> condition,
then an extra <CODE>B</CODE> row is generated with all columns set to <CODE>NULL</CODE>.
<LI>

If you use <CODE>LEFT JOIN</CODE> to find rows that doesn't exist in some
table and you have the following test: <CODE>column_name IS NULL</CODE> in the
<CODE>WHERE</CODE> part, where column_name is a column that is declared as
<CODE>NOT NULL</CODE>, then <CODE>MySQL</CODE> will stop searching after more rows
(for a particular key combination) after it has found one row that
matches the <CODE>LEFT JOIN</CODE> condition.
</UL>



<H3><A NAME="LIMIT_optimization" HREF="manual_toc.html#LIMIT_optimization">10.5.5  How MySQL optimizes <CODE>LIMIT</CODE></A></H3>

<P>
In some cases <STRONG>MySQL</STRONG> will handle the query differently when you are
using <CODE>LIMIT #</CODE> and not using <CODE>HAVING</CODE>:

</P>

<UL>
<LI>

If you are selecting only a few rows with <CODE>LIMIT</CODE>, <STRONG>MySQL</STRONG>
will use indexes in some cases when it normally would prefer to do a
full table scan.
<LI>

If you use <CODE>LIMIT #</CODE> with <CODE>ORDER BY</CODE>, <STRONG>MySQL</STRONG> will end the
sorting as soon as it has found the first <CODE>#</CODE> lines instead of sorting
the whole table.
<LI>

When combining <CODE>LIMIT #</CODE> with <CODE>DISTINCT</CODE>, <STRONG>MySQL</STRONG> will stop
as soon as it finds <CODE>#</CODE> unique rows.
<LI>

In some cases a <CODE>GROUP BY</CODE> can be resolved by reading the key in order 
(or do a sort on the key) and then calculate summaries until the
key value changes.  In this case <CODE>LIMIT #</CODE> will not calculate any
unnecessary <CODE>GROUP</CODE>'s.
<LI>

As soon as <STRONG>MySQL</STRONG> has sent the first <CODE>#</CODE> rows to the client, it
will abort the query.
<LI>

<CODE>LIMIT 0</CODE> will always quickly return an empty set.  This is useful
to check the query and to get the column types of the result columns.
<LI>

The size of temporary tables uses the <CODE>LIMIT #</CODE> to calculate how much
space is needed to resolve the query.
</UL>



<H3><A NAME="Insert_speed" HREF="manual_toc.html#Insert_speed">10.5.6  Speed of <CODE>INSERT</CODE> queries</A></H3>

<P>
The time to insert a record consists approximately of:

</P>

<UL>
<LI>

Connect:                 (3)
<LI>

Sending query to server: (2)
<LI>

Parsing query:           (2)
<LI>

Inserting record:        (1 x size of record)
<LI>

Inserting indexes:       (1 x number of indexes)
<LI>

Close:                   (1)
</UL>

<P>
Where the numbers are somewhat proportional to the overall time. This
does not take into consideration the initial overhead to open tables
(which is done once for each concurrently-running query).

</P>
<P>
The size of the table slows down the insertion of indexes by N log N
(B-trees).

</P>
<P>
Some ways to speed up inserts:

</P>

<UL>
<LI>

If you are inserting many rows from the same client at the same time use
multiple value lists <CODE>INSERT</CODE> statements. This is much faster (many
times in some cases) than using separate <CODE>INSERT</CODE> statements.
<LI>

If you are inserting a lot of rows from different clients, you can get
higher speed by using the <CODE>INSERT DELAYED</CODE> statement. See section <A HREF="manual.html#INSERT">7.14  <CODE>INSERT</CODE> syntax</A>.
<LI>

Note that with <CODE>MyISAM</CODE> you can insert rows at the same time
<CODE>SELECT</CODE>s are running if there are no deleted rows in the tables.
<LI>

When loading a table from a text file, use <CODE>LOAD DATA INFILE</CODE>. This
is usually 20 times faster than using a lot of <CODE>INSERT</CODE> statements.
See section <A HREF="manual.html#LOAD_DATA">7.16  <CODE>LOAD DATA INFILE</CODE> syntax</A>.
<LI>

It is possible with some extra work to make <CODE>LOAD DATA INFILE</CODE> run even
faster when the table has many indexes. Use the following procedure:


<OL>
<LI>

Optionally create the table with <CODE>CREATE TABLE</CODE>. For example using
<CODE>mysql</CODE> or Perl-DBI.

<LI>

Execute a <CODE>FLUSH TABLES</CODE> statement or the shell command <CODE>mysqladmin
flush-tables</CODE>.

<LI>

Use <CODE>myisamchk --keys-used=0 -rq /path/to/db/tbl_name</CODE>. This will
remove all usage of all indexes from the table.

<LI>

Insert data into the table with <CODE>LOAD DATA INFILE</CODE>. This will not
update any indexes and will therefore be very fast.

<LI>

If you have <CODE>myisampack</CODE> and want to compress the table, run
<CODE>myisampack</CODE> on it. See section <A HREF="manual.html#Compressed_format">10.6.3  Compressed table characteristics</A>.

<LI>

Recreate the indexes with <CODE>myisamchk -r -q
/path/to/db/tbl_name</CODE>. This will create the index tree in memory before
writing it to disk, which is much faster since it avoid lots of disk
seeks. The resulting index tree is also perfectly balanced.

<LI>

Execute a <CODE>FLUSH TABLES</CODE> statement or the shell command <CODE>mysqladmin
flush-tables</CODE>.
</OL>

This procedure will be built into <CODE>LOAD DATA INFILE</CODE> in some future
version of MySQL.
<LI>

You can speed up insertions by locking your tables:


<PRE>
mysql&#62; LOCK TABLES a WRITE;
mysql&#62; INSERT INTO a VALUES (1,23),(2,34),(4,33);
mysql&#62; INSERT INTO a VALUES (8,26),(6,29);
mysql&#62; UNLOCK TABLES;
</PRE>

The main speed difference is that the index buffer is flushed to disk only
once, after all <CODE>INSERT</CODE> statements have completed. Normally there would
be as many index buffer flushes as there are different <CODE>INSERT</CODE>
statements. Locking is not needed if you can insert all rows with a single
statement.

Locking will also lower the total time of multi-connection tests, but the
maximum wait time for some threads will go up (because they wait for
locks).  For example:


<PRE>
thread 1 does 1000 inserts
thread 2, 3, and 4 does 1 insert
thread 5 does 1000 inserts
</PRE>

If you don't use locking, 2, 3 and 4 will finish before 1 and 5. If you
use locking, 2, 3 and 4 probably will not finish before 1 or 5, but the
total time should be about 40% faster.

As <CODE>INSERT</CODE>, <CODE>UPDATE</CODE> and <CODE>DELETE</CODE> operations are very
fast in <STRONG>MySQL</STRONG>, you will obtain better overall performance by
adding locks around everything that does more than about 5 inserts or
updates in a row.  If you do very many inserts in a row, you could do a
<CODE>LOCK TABLES</CODE> followed by a <CODE>UNLOCK TABLES</CODE> once in a while
(about each 1000 rows) to allow other threads access to the table. This
would still result in a nice performance gain.

Of course, <CODE>LOAD DATA INFILE</CODE> is much faster still for loading data.
</UL>

<P>
To get some more speed for both <CODE>LOAD DATA INFILE</CODE> and
<CODE>INSERT</CODE>, enlarge the key buffer. See section <A HREF="manual.html#Server_parameters">10.2.3  Tuning server parameters</A>.

</P>


<H3><A NAME="Update_speed" HREF="manual_toc.html#Update_speed">10.5.7  Speed of <CODE>UPDATE</CODE> queries</A></H3>

<P>
Update queries are optimized as a <CODE>SELECT</CODE> query with the additional
overhead of a write. The speed of the write is dependent on the size of
the data that are being updated and the number of indexes that are
updated.  Indexes that are not changed will not be updated.

</P>
<P>
Also another way to get fast updates is to delay updates and then do
many updates in a row later. Doing many updates in a row is much quicker
than doing one at a time if you lock the table.

</P>
<P>
Not that with dynamic record format updating a record with to a longer
total length may split the record. So if you do this often it is very
important to <CODE>OPTIMIZE TABLE</CODE> sometimes. See section <A HREF="manual.html#OPTIMIZE_TABLE">7.9  <CODE>OPTIMIZE TABLE</CODE> syntax</A>.

</P>


<H3><A NAME="Delete_speed" HREF="manual_toc.html#Delete_speed">10.5.8  Speed of <CODE>DELETE</CODE> queries</A></H3>

<P>
The time to delete a record is exactly proportional to the number of
indexes. To delete records more quickly, you can increase the size of
the index cache. See section <A HREF="manual.html#Server_parameters">10.2.3  Tuning server parameters</A>.

</P>
<P>
Its also much faster to remove all rows than to remove a big part of the
rows from a table.

</P>
<P>
<A NAME="IDX635"></A>
<A NAME="IDX636"></A>


<H2><A NAME="Choosing_table_type" HREF="manual_toc.html#Choosing_table_type">10.6  Choosing a table type</A></H2>

<P>
With MySQL you can currently (version 3.23.5) choose between four usable
table formats from a speed point of view.

</P>
<DL COMPACT>

<DT><STRONG>MyISAM Static</STRONG>
<DD>
This format is the simplest and most secure format. It is also the
fastest of the on disk formats. The speed comes from the easy way data
can be found on disk. When looking up something with a index and static
format it very simple, just multiply the row number with the row length.

Also when scanning a table it is very easy to read a constant number of
records with each disk read.

The security comes from if your computer crashes when writing to a
static MyISAM file, <CODE>myisamchk</CODE> can easily figure out where each
row starts and ends. So it can usually reclaim all records except the
partially written one. Not that in MySQL all indexes can always be
reconstructed.

<DT><STRONG>MyISAM Dynamic</STRONG>
<DD>
This format is a litte more complex since each row has to have a header
that says how long it is. One record can also end up at more that one
location when it is made longer at a update.

You can use <CODE>OPTIMIZE table</CODE> or <CODE>myisamchk</CODE> to defragment a
table. If you have static data that you acess/change a lot in the same
table as some <CODE>VARCHAR</CODE> or <CODE>BLOB</CODE> columns, it might be a good
idea to move the dynamic columns to other tables just to avoid
fragmentation.

<DT><STRONG>MyISAM compressed</STRONG>
<DD>
This is a read only type that is generated with the optional
<CODE>myisampack</CODE> tool.

<DT><STRONG>In memory (HEAP)</STRONG>
<DD>
This table format is extremely useful for small/medium sized lookup
tables. It is possible to copy/create a frequently used lookup table (in
joins) to a (maybe temporary) HEAP table to speed up many joins.

Suppose we want to do the following join many times with the same data.

<PRE>
SELECT tab1.a, tab3.a FROM tab1, tab2, tab3
        WHERE tab1.a = tab2.a and tab2.a = tab3.a and tab2.c != 0;
</PRE>

To speed this up we could create a temporary table with the join of tab2
and tab3 since that are looked up using the same column (tab1.a). Here
is the command to create that table and the resulting select.

<PRE>
CREATE TEMPORARY TABLE test TYPE=HEAP
        SELECT
                tab2.a as a2, tab3.a as a3
        FROM
                tab2, tab3
        WHERE
                tab2.a = tab3.a and c = 0;
SELECT tab1.a, test.a3 from tab1, test where tab1.a = test.a2;
SELECT tab1.b, test.a3 from tab1, test where tab1.a = test.a2 and something;
</PRE>

</DL>



<H3><A NAME="Static_format" HREF="manual_toc.html#Static_format">10.6.1  Static (Fixed-length) table characteristics</A></H3>


<UL>
<LI>

This is the default format. It's used when the table contains no <CODE>VARCHAR</CODE>,
<CODE>BLOB</CODE> or <CODE>TEXT</CODE> columns.
<LI>

All <CODE>CHAR</CODE>, <CODE>NUMERIC</CODE> and <CODE>DECIMAL</CODE> columns are space-padded
to the column width.
<LI>

Very quick.
<LI>

Easy to cache.
<LI>

Easy to reconstruct after a crash, because records are located in fixed
positions.
<LI>

Doesn't have to be reorganized (with <CODE>myisamchk</CODE>) unless a huge number of
records are deleted and you want to return free disk space to the operating
system.
<LI>

Usually requires more disk space than dynamic tables.
</UL>



<H3><A NAME="Dynamic_format" HREF="manual_toc.html#Dynamic_format">10.6.2  Dynamic table characteristics</A></H3>


<UL>
<LI>

This format is used if the table contains any <CODE>VARCHAR</CODE>, <CODE>BLOB</CODE>
or <CODE>TEXT</CODE> columns.
<LI>

All string columns are dynamic (except those with a length less than 4).
<LI>

Each record is preceded by a bitmap indicating which columns are empty
(<CODE>''</CODE>) for string columns, or zero for numeric columns (this isn't
the same as columns containing <CODE>NULL</CODE> values).  If a string column
has a length of zero after removal of trailing spaces, or a numeric
column has a value of zero, it is marked in the bit map and not saved to
disk.  Non-empty strings are saved as a length byte plus the string
contents.
<LI>

Usually takes much less disk space than fixed-length tables.
<LI>

Each record uses only as much space as is required. If a record becomes
larger, it is split into as many pieces as required.  This results in record
fragmentation.
<LI>

If you update a row with information that extends the row length, the
row will be fragmented.  In this case, you may have to run <CODE>myisamchk
-r</CODE> from time to time to get better performance.  Use <CODE>myisamchk -ei
tbl_name</CODE> for some statistics.
<LI>

Not as easy to reconstruct after a crash, because a record may be fragmented
into many pieces and a link (fragment) may be missing.
<LI>

The expected row length for dynamic sized records is:


<PRE>
3
+ (number of columns + 7) / 8
+ (number of char columns)
+ packed size of numeric columns
+ length of strings
+ (number of NULL columns + 7) / 8
</PRE>

There is a penalty of 6 bytes for each link. A dynamic record is linked
whenever an update causes an enlargement of the record. Each new link will be
at least 20 bytes, so the next enlargement will probably go in the same link.
If not, there will be another link. You may check how many links there are
with <CODE>myisamchk -ed</CODE>. All links may be removed with <CODE>myisamchk -r</CODE>.
</UL>



<H3><A NAME="Compressed_format" HREF="manual_toc.html#Compressed_format">10.6.3  Compressed table characteristics</A></H3>


<UL>
<LI>

A read-only table made with the <CODE>myisampack</CODE> utility. All customers
with extended <STRONG>MySQL</STRONG> email support are entitled to a copy of
<CODE>myisampack</CODE> for their internal usage.
<LI>

The uncompress code exists in all <STRONG>MySQL</STRONG> distributions so that
even customers who don't have <CODE>myisampack</CODE> can read tables that
were compressed with <CODE>myisampack</CODE>
<LI>

Takes very little disk space. Minimises disk usage.
<LI>

Each record is compressed separately (very little access overhead).  The
header for a record is fixed (1-3 bytes) depending on the biggest record in the
table.  Each column is compressed differently. Some of the compression types
are:

<UL>
<LI>

There is usually a different Huffman table for each column.
<LI>

Suffix space compression.
<LI>

Prefix space compression.
<LI>

Numbers with value <CODE>0</CODE> are stored using 1 bit.
<LI>

If values in an integer column have a small range, the column is stored using
the smallest possible type. For example, a <CODE>BIGINT</CODE> column (8 bytes) may
be stored as a <CODE>TINYINT</CODE> column (1 byte) if all values are in the range
<CODE>0</CODE> to <CODE>255</CODE>.
<LI>

If a column has only a small set of possible values, the column type is
converted to <CODE>ENUM</CODE>.
<LI>

A column may use a combination of the above compressions.
</UL>

<LI>

Can handle fixed or dynamic length records, but not <CODE>BLOB</CODE> or <CODE>TEXT</CODE>
columns.
<LI>

Can be uncompressed with <CODE>myisamchk</CODE>.
</UL>

<P>
<STRONG>MySQL</STRONG> can support different index types, but the normal type is
ISAM.  This is a B-tree index and you can roughly calculate the size for the
index file as <CODE>(key_length+4)*0.67</CODE>, summed over all keys.  (This is for
the worst case when all keys are inserted in sorted order.)

</P>
<P>
String indexes are space compressed. If the first index part is a string, it
will also be prefix compressed.  Space compression makes the index file
smaller if the string column has a lot of trailing space or is a <CODE>VARCHAR</CODE>
column that is not always used to the full length. Prefix compression helps
if there are many strings with an identical prefix.

</P>
<P>
<A NAME="IDX637"></A>
<A NAME="IDX638"></A>


<H3><A NAME="HEAP_format" HREF="manual_toc.html#HEAP_format">10.6.4  In memory table characteristics</A></H3>

<P>
HEAP tables only exists in memory so they are lost if <CODE>mysqld</CODE> is
taken down or crashes. But since they are <STRONG>very</STRONG> fast they are
usefull as anyway.

</P>
<P>
The <STRONG>MySQL</STRONG> internal HEAP tables uses 100% dynamic hashing
without overflow areas and don't have problems with delete.

</P>
<P>
You can only access things by equality using a index (usually by the
<CODE>=</CODE> operator) whith a heap table. 

</P>
<P>
The downside with HEAPS are:

<OL>
<LI>

You need enough extra memory for all HEAP tables that you want to use at
the same time.
<LI>

You can't search on a part of a index.
<LI>

You can't search for the next entry in order (that is to use the index
to do a <CODE>ORDER BY</CODE>).
<LI>

<STRONG>MySQL</STRONG> also cannot find out how approximately many rows there
are between two values. This is used by the optimizer to chose which
index to use. But on the other hand no disk seeks are even needed.
</OL>



<H2><A NAME="Tips" HREF="manual_toc.html#Tips">10.7  Other optimization tips</A></H2>

<P>
Unsorted tips for faster systems:

</P>

<UL>
<LI>

Use persistent connections to the database to avoid the connection over
head.
<LI>

Always check that all your queries really uses the indexes you have created
in the tables. In <STRONG>MySQL</STRONG> you can do this with the <CODE>EXPLAIN</CODE>
command. See section <A HREF="manual.html#EXPLAIN">7.22  <CODE>EXPLAIN</CODE> syntax (Get information about a <CODE>SELECT</CODE>)</A>.
<LI>

Try to avoid complex <CODE>SELECT</CODE> queries on tables that are updated a
lot. This is to avoid problems with table locking.
<LI>

The new <CODE>MyISAM</CODE> tables in can insert rows in a table without deleted
rows at the same time another table is reading from it.  If this is important
for you, you should consider methods where you don't have to delete rows
or run <CODE>optimize table</CODE> after you have deleted a lot of rows.
<LI>

In some cases it may make sense to introduce a column that is 'hashed'
based on information from other columns. If this column is short and
reasonable unique it may be much faster than a big index on many
columns. In <STRONG>MySQL</STRONG> its very easy to use this extra column:
<CODE>SELECT * from table where hash='calculated hash on col1 and col2'
and col_1='constant' and col_2='constant' and ..</CODE>
<LI>

For tables that changes a lot you should try to avoid all <CODE>VARCHAR</CODE>
or <CODE>BLOB</CODE> columns. You will get dynamic row length as soon as you
are using a single <CODE>VARCHAR</CODE> or <CODE>BLOB</CODE> columns. See section <A HREF="manual.html#Table_types">9.4  MySQL table types</A>.
<LI>

It's not normally useful to split a table into different tables just
because the rows gets 'big'. To access a row, the biggest performance
hit is the disk seek to find the first byte of the row. After finding
the data most new disks can read the whole row fast enough for most
applications. The only cases it really matters to split up a table is if
its a dynamic row size table (see above) that you can change to a fixed
row size. Or if you very often need to scan the table and don't need
most of the columns. See section <A HREF="manual.html#Table_types">9.4  MySQL table types</A>.
<LI>

If you very often need to calculate things based on information from a
lot of rows (like counts of things) it's probably much better to
introduce a new table and update the counter in real time. An update of
type <CODE>UPDATE table set count=count+1 where index_column=constant</CODE>
is very fast!

This is really important when you use databases like <STRONG>MySQL</STRONG> that
only has table locking (multiple readers / single writers). This will
also give better performance with most databases as the row locking
manager in this case will have less to do.
<LI>

If you need to collect statistics from big log tables use summary tables
instead of scanning the whole table. Maintaing the summarys should be
much faster than trying to do statistics 'live'. It's much faster to
re-generate new summary tables from the logs when things changes
(depending on business decisions) than to have to change the running
application!
<LI>

If possible one should classify reports as 'live' or 'statistical',
where data needed for statistical reports are only generated based on
summary tables that are generated from the actual data.
<LI>

Take advantage of the fact that columns have default values. Insert
values explicitly only when the value to be inserted differs from the
default. This reduces the parsing that MySQL need to do and improves the
insert speed.
<LI>

In some cases its convenient to pack and store data into a blob In this
case you have to add some extra code in your appliction to pack/unpack
things in the blob but this may save a lot of accesses at some stage.
This is practical when you have data that doesn't conform to a static
table structure.
<LI>

Normally you should try to keep all data non redundant (what is in that
is called 3 normal form in database theory), but you should not be
afraid of duplication things or create summary tables if you need these
to gain more speed.
<LI>

Stored procedures or UDF (user defined functions) may be a good way to
get more performance.  In this case you should however always have a way
to do this some other (slower) way if you use some database that doesn't
support this.
<LI>

You can always gain something by caching queries/answers in your
application and try to do many inserts/updates at the same time.  If
your database supports lock tables (like <STRONG>MySQL</STRONG> and Oracle),
this should help to ensure that the index cache is only flushed once
after all updates.
<LI>

Use <CODE>INSERT /*! DELAYED */</CODE> when you do not need to now when your
data is written. This speeds things up since many records can be written
with a single disk write.
<LI>

Use <CODE>INSERT /*! LOW_PRIORITY */</CODE> when you want your selects are
more important.
<LI>

Use <CODE>SELECT /*! HIGH_PRIORITY */</CODE> to get selects that jumps the
queue. That is the select is done even if there is somebody waiting to
do a write.
<LI>

Use the multi-line <CODE>INSERT</CODE> statement to store many rows with one
SQL command (many SQL servers supports this)
<LI>

Use <CODE>LOAD DATA INFILE</CODE> to load bigger amounts of data. This if
faster than normal inserts and will be even faster when <CODE>myisamchk</CODE>
is integrated in <CODE>mysqld</CODE>.
<LI>

Use <CODE>AUTO_INCREMENT</CODE> columns to make unique values.
<LI>

Use <CODE>OPTIMIZE TABLE</CODE> once in a while to avoid fragmentation when
using dynamic table format.See section <A HREF="manual.html#OPTIMIZE_TABLE">7.9  <CODE>OPTIMIZE TABLE</CODE> syntax</A>.

<LI>

Use <CODE>HEAP</CODE> tables to get more speed when possibe. See section <A HREF="manual.html#Table_types">9.4  MySQL table types</A>.
<LI>

When using a normal Web server setup, images should be stored as
files. That is store only a file reference in the database.  The main
reason for this is that a normal web server is much better at caching
files than database contents. So it it's much easier to get a fast
system if you are using files.
<LI>

Use in memory tables for not critical data that are accessed often (like
information about the last shown banner for users that doesn't have
cookies)
<LI>

Columns with identical information in different tables should be
declared identical and have identical names. Before version 3.23 you
